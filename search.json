[
  {
    "objectID": "FDR_analysisResultsLFC.html",
    "href": "FDR_analysisResultsLFC.html",
    "title": "Results - Log Fold Change",
    "section": "",
    "text": "library(COTAN)\nlibrary(pROC)\noptions(parallelly.fork.enable = TRUE)\n#library(Seurat)\n#library(monocle3)\n#library(reticulate)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggpubr)\n\ndirOut &lt;- file.path(\".\", \"Results/FDR/\")\nif (!dir.exists(dirOut)) {\n  dir.create(dirOut)\n}\n\ndataSetDir &lt;- file.path(\"Data/MouseCortexFromLoom/FDR/\", \"MergedClusters_For_FDR\")",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#preamble",
    "href": "FDR_analysisResultsLFC.html#preamble",
    "title": "Results - Log Fold Change",
    "section": "",
    "text": "library(COTAN)\nlibrary(pROC)\noptions(parallelly.fork.enable = TRUE)\n#library(Seurat)\n#library(monocle3)\n#library(reticulate)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggpubr)\n\ndirOut &lt;- file.path(\".\", \"Results/FDR/\")\nif (!dir.exists(dirOut)) {\n  dir.create(dirOut)\n}\n\ndataSetDir &lt;- file.path(\"Data/MouseCortexFromLoom/FDR/\", \"MergedClusters_For_FDR\")",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#dataset-composition",
    "href": "FDR_analysisResultsLFC.html#dataset-composition",
    "title": "Results - Log Fold Change",
    "section": "Dataset composition",
    "text": "Dataset composition\n\ndatasets_csv &lt;- read.csv(file.path(dataSetDir,\"Cells_Usage_DataFrame.csv\"),\n                         row.names = 1, header = TRUE, quote = '\"'\n                        ) \n\ndatasets_csv[1:10, ]\n\n                    Group            Collection E13.5.432 E13.5.187 E13.5.434\n1    2_Clusters_even_near E13.5-434_+_E15.0-428         0         0       318\n2    2_Clusters_even_near E15.0-432_+_E13.5-432       536         0         0\n3    2_Clusters_even_near E15.0-508_+_E15.0-509         0         0         0\n4  2_Clusters_even_medium E13.5-187_+_E13.5-184         0       292         0\n5  2_Clusters_even_medium E15.0-434_+_E17.5-516         0         0         0\n6  2_Clusters_even_medium E15.0-437_+_E15.0-508         0         0         0\n7     2_Clusters_even_far E17.5-516_+_E13.5-187         0       297         0\n8     2_Clusters_even_far E15.0-510_+_E13.5-437         0         0         0\n9     2_Clusters_even_far E15.0-509_+_E13.5-184         0         0         0\n10 2_Clusters_uneven_near E13.5-434_+_E15.0-428         0         0       326\n   E13.5.184 E13.5.437 E13.5.510 E15.0.432 E15.0.509 E15.0.510 E15.0.508\n1          0         0         0         0         0         0         0\n2          0         0         0       536         0         0         0\n3          0         0         0         0       397         0       397\n4        292         0         0         0         0         0         0\n5          0         0         0         0         0         0         0\n6          0         0         0         0         0         0       258\n7          0         0         0         0         0         0         0\n8          0       259         0         0         0       259         0\n9        292         0         0         0       292         0         0\n10         0         0         0         0         0         0         0\n   E15.0.428 E15.0.434 E15.0.437 E17.5.516 E17.5.505\n1        318         0         0         0         0\n2          0         0         0         0         0\n3          0         0         0         0         0\n4          0         0         0         0         0\n5          0       273         0       273         0\n6          0         0       258         0         0\n7          0         0         0       297         0\n8          0         0         0         0         0\n9          0         0         0         0         0\n10        37         0         0         0         0\n\n\n\nDefine which genes are expressed\nFor each data set we need to define, independently from the DEA methods, which genes are specific for each cluster. So we need to define first which genes are expressed and which are not expressed. To do so we can take advantage from the fact that we have the original clusters from which the cells were sampled to create the artificial datasets. So looking to the original cluster we define as expressed all genes present for which there are at least 2 reads every 10 cells. We define as enriched for a cluster the genes that are present and have at least 3 times as many average reads as the average reads outside the cluster.\n\nreadsLogMeansPerCluster &lt;- readRDS(file.path(dirOut, \"readsLogAverageCount_PerCluster.RDS\"))\n\nthresholdLFC &lt;- log10(3.0) # presence if 3 times more reads on average\nthresholdLFM &lt;- log10(10000 * 2 / 10) # 2 reads each 10 cells\n\n10^thresholdLFC\n\n[1] 3\n\n10^(thresholdLFM-4)\n\n[1] 0.2",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#clusters_even_near",
    "href": "FDR_analysisResultsLFC.html#clusters_even_near",
    "title": "Results - Log Fold Change",
    "section": "2_Clusters_even_near",
    "text": "2_Clusters_even_near\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_near\", ]\n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind], pattern = \"_[+]_\", simplify = T)\n  \n  reads.LM.subset &lt;- readsLogMeansPerCluster[, clusters]\n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(reads.LM.subset),\n                                       ncol = ncol(reads.LM.subset)))\n  rownames(ground_truth) &lt;- rownames(reads.LM.subset)\n  colnames(ground_truth) &lt;- colnames(reads.LM.subset)\n\n  for (col in 1:ncol(ground_truth)) {\n    # log fold change\n    ground_truth[, col] &lt;- reads.LM.subset[, col] - rowMeans(reads.LM.subset[, -col, drop = FALSE])\n    ground_truth[, col] &lt;- ground_truth[, col] &gt; thresholdLFC & reads.LM.subset[, col] &gt; thresholdLFM\n  }\n\n  ground_truth$genes &lt;- rownames(ground_truth)\n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind, 1] \n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set             set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                     &lt;int&gt;\n1 Neil2 E13.5-434 FALSE 2_Clusters_even_near          1\n2 Neil2 E15.0-428 FALSE 2_Clusters_even_near          1\n3 Lamc1 E13.5-434 FALSE 2_Clusters_even_near          1\n4 Lamc1 E15.0-428 FALSE 2_Clusters_even_near          1\n5 Lama1 E13.5-434 FALSE 2_Clusters_even_near          1\n6 Lama1 E15.0-428 FALSE 2_Clusters_even_near          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 80\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n\n\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwoClusters_even_near &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwoClusters_even_nearPL &lt;- TwoClusters_even_near + xlab(\"FPR\") + ylab(\"TPR\")\nTwoClusters_even_nearPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#clusters_even_medium",
    "href": "FDR_analysisResultsLFC.html#clusters_even_medium",
    "title": "Results - Log Fold Change",
    "section": "2_Clusters_even_medium",
    "text": "2_Clusters_even_medium\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_medium\", ]\n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind], pattern = \"_[+]_\", simplify = T)\n  \n  reads.LM.subset &lt;- readsLogMeansPerCluster[, clusters]\n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(reads.LM.subset),\n                                       ncol = ncol(reads.LM.subset)))\n  rownames(ground_truth) &lt;- rownames(reads.LM.subset)\n  colnames(ground_truth) &lt;- colnames(reads.LM.subset)\n\n  for (col in 1:ncol(ground_truth)) {\n    # log fold change\n    ground_truth[, col] &lt;- reads.LM.subset[, col] - rowMeans(reads.LM.subset[, -col, drop = FALSE])\n    ground_truth[, col] &lt;- ground_truth[, col] &gt; thresholdLFC & reads.LM.subset[, col] &gt; thresholdLFM\n  }\n\n  ground_truth$genes &lt;- rownames(ground_truth)\n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind, 1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set               set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                       &lt;int&gt;\n1 Neil2 E13.5-187 FALSE 2_Clusters_even_medium          1\n2 Neil2 E13.5-184 FALSE 2_Clusters_even_medium          1\n3 Lamc1 E13.5-187 FALSE 2_Clusters_even_medium          1\n4 Lamc1 E13.5-184 FALSE 2_Clusters_even_medium          1\n5 Lama1 E13.5-187 FALSE 2_Clusters_even_medium          1\n6 Lama1 E13.5-184 FALSE 2_Clusters_even_medium          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 1559\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E13.5-184\"\n[1] \"E17.5-516\"\n[1] \"E15.0-434\"\n[1] \"E15.0-508\"\n[1] \"E15.0-437\"\n\n\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwoClusters_even_medium &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwoClusters_even_mediumPL &lt;- TwoClusters_even_medium + xlab(\"FPR\") + ylab(\"TPR\")\nTwoClusters_even_mediumPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#clusters_even_far",
    "href": "FDR_analysisResultsLFC.html#clusters_even_far",
    "title": "Results - Log Fold Change",
    "section": "2_Clusters_even_far",
    "text": "2_Clusters_even_far\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_far\", ]\n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind], pattern = \"_[+]_\", simplify = T)\n  \n  reads.LM.subset &lt;- readsLogMeansPerCluster[, clusters]\n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(reads.LM.subset),\n                                       ncol = ncol(reads.LM.subset)))\n  rownames(ground_truth) &lt;- rownames(reads.LM.subset)\n  colnames(ground_truth) &lt;- colnames(reads.LM.subset)\n\n  for (col in 1:ncol(ground_truth)) {\n    # log fold change\n    ground_truth[, col] &lt;- reads.LM.subset[, col] - rowMeans(reads.LM.subset[, -col, drop = FALSE])\n    ground_truth[, col] &lt;- ground_truth[, col] &gt; thresholdLFC & reads.LM.subset[, col] &gt; thresholdLFM\n  }\n\n  ground_truth$genes &lt;- rownames(ground_truth)\n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind, 1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set            set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                    &lt;int&gt;\n1 Neil2 E17.5-516 FALSE 2_Clusters_even_far          1\n2 Neil2 E13.5-187 FALSE 2_Clusters_even_far          1\n3 Lamc1 E17.5-516 FALSE 2_Clusters_even_far          1\n4 Lamc1 E13.5-187 FALSE 2_Clusters_even_far          1\n5 Lama1 E17.5-516 FALSE 2_Clusters_even_far          1\n6 Lama1 E13.5-187 FALSE 2_Clusters_even_far          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 4020\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E17.5-516\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-509\"\n[1] \"E13.5-184\"\n\n\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwoClusters_even_far &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwoClusters_even_farPL &lt;- TwoClusters_even_far + xlab(\"FPR\") + ylab(\"TPR\")\nTwoClusters_even_farPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#clusters_uneven_near",
    "href": "FDR_analysisResultsLFC.html#clusters_uneven_near",
    "title": "Results - Log Fold Change",
    "section": "2_Clusters_uneven_near",
    "text": "2_Clusters_uneven_near\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_near\", ]\n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind], pattern = \"_[+]_\", simplify = T)\n  \n  reads.LM.subset &lt;- readsLogMeansPerCluster[, clusters]\n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(reads.LM.subset),\n                                       ncol = ncol(reads.LM.subset)))\n  rownames(ground_truth) &lt;- rownames(reads.LM.subset)\n  colnames(ground_truth) &lt;- colnames(reads.LM.subset)\n\n  for (col in 1:ncol(ground_truth)) {\n    # log fold change\n    ground_truth[, col] &lt;- reads.LM.subset[, col] - rowMeans(reads.LM.subset[, -col, drop = FALSE])\n    ground_truth[, col] &lt;- ground_truth[, col] &gt; thresholdLFC & reads.LM.subset[, col] &gt; thresholdLFM\n  }\n\n  ground_truth$genes &lt;- rownames(ground_truth)\n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind, 1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set               set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                       &lt;int&gt;\n1 Neil2 E13.5-434 FALSE 2_Clusters_uneven_near          1\n2 Neil2 E15.0-428 FALSE 2_Clusters_uneven_near          1\n3 Lamc1 E13.5-434 FALSE 2_Clusters_uneven_near          1\n4 Lamc1 E15.0-428 FALSE 2_Clusters_uneven_near          1\n5 Lama1 E13.5-434 FALSE 2_Clusters_uneven_near          1\n6 Lama1 E15.0-428 FALSE 2_Clusters_uneven_near          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 80\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n\n\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwoClusters_uneven_near &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwoClusters_uneven_nearPL &lt;- TwoClusters_uneven_near + xlab(\"FPR\") + ylab(\"TPR\")\nTwoClusters_uneven_nearPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#clusters_uneven_medium",
    "href": "FDR_analysisResultsLFC.html#clusters_uneven_medium",
    "title": "Results - Log Fold Change",
    "section": "2_Clusters_uneven_medium",
    "text": "2_Clusters_uneven_medium\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_medium\", ]\n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind], pattern = \"_[+]_\", simplify = T)\n  \n  reads.LM.subset &lt;- readsLogMeansPerCluster[, clusters]\n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(reads.LM.subset),\n                                       ncol = ncol(reads.LM.subset)))\n  rownames(ground_truth) &lt;- rownames(reads.LM.subset)\n  colnames(ground_truth) &lt;- colnames(reads.LM.subset)\n\n  for (col in 1:ncol(ground_truth)) {\n    # log fold change\n    ground_truth[, col] &lt;- reads.LM.subset[, col] - rowMeans(reads.LM.subset[, -col, drop = FALSE])\n    ground_truth[, col] &lt;- ground_truth[, col] &gt; thresholdLFC & reads.LM.subset[, col] &gt; thresholdLFM\n  }\n\n  ground_truth$genes &lt;- rownames(ground_truth)\n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind, 1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set                 set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                         &lt;int&gt;\n1 Neil2 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n2 Neil2 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n3 Lamc1 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n4 Lamc1 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n5 Lama1 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n6 Lama1 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 1559\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E13.5-184\"\n[1] \"E17.5-516\"\n[1] \"E15.0-434\"\n[1] \"E15.0-508\"\n[1] \"E15.0-437\"\n\n\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwoClusters_uneven_medium &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwoClusters_uneven_mediumPL &lt;- TwoClusters_uneven_medium + xlab(\"FPR\") + ylab(\"TPR\")\nTwoClusters_uneven_mediumPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#clusters_uneven_far",
    "href": "FDR_analysisResultsLFC.html#clusters_uneven_far",
    "title": "Results - Log Fold Change",
    "section": "2_Clusters_uneven_far",
    "text": "2_Clusters_uneven_far\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_far\", ]\n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind], pattern = \"_[+]_\", simplify = T)\n  \n  reads.LM.subset &lt;- readsLogMeansPerCluster[, clusters]\n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(reads.LM.subset),\n                                       ncol = ncol(reads.LM.subset)))\n  rownames(ground_truth) &lt;- rownames(reads.LM.subset)\n  colnames(ground_truth) &lt;- colnames(reads.LM.subset)\n\n  for (col in 1:ncol(ground_truth)) {\n    # log fold change\n    ground_truth[, col] &lt;- reads.LM.subset[, col] - rowMeans(reads.LM.subset[, -col, drop = FALSE])\n    ground_truth[, col] &lt;- ground_truth[, col] &gt; thresholdLFC & reads.LM.subset[, col] &gt; thresholdLFM\n  }\n\n  ground_truth$genes &lt;- rownames(ground_truth)\n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind, 1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set              set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                      &lt;int&gt;\n1 Neil2 E17.5-516 FALSE 2_Clusters_uneven_far          1\n2 Neil2 E13.5-187 FALSE 2_Clusters_uneven_far          1\n3 Lamc1 E17.5-516 FALSE 2_Clusters_uneven_far          1\n4 Lamc1 E13.5-187 FALSE 2_Clusters_uneven_far          1\n5 Lama1 E17.5-516 FALSE 2_Clusters_uneven_far          1\n6 Lama1 E13.5-187 FALSE 2_Clusters_uneven_far          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 4020\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E17.5-516\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-509\"\n[1] \"E13.5-184\"\n\n\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwoClusters_uneven_far &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwoClusters_uneven_farPL &lt;- TwoClusters_uneven_far + xlab(\"FPR\") + ylab(\"TPR\")\nTwoClusters_uneven_farPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#clusters_even",
    "href": "FDR_analysisResultsLFC.html#clusters_even",
    "title": "Results - Log Fold Change",
    "section": "3_Clusters_even",
    "text": "3_Clusters_even\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"3_Clusters_even\", ]\n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind], pattern = \"_[+]_\", simplify = T)\n  \n  reads.LM.subset &lt;- readsLogMeansPerCluster[, clusters]\n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(reads.LM.subset),\n                                       ncol = ncol(reads.LM.subset)))\n  rownames(ground_truth) &lt;- rownames(reads.LM.subset)\n  colnames(ground_truth) &lt;- colnames(reads.LM.subset)\n\n  for (col in 1:ncol(ground_truth)) {\n    # log fold change\n    ground_truth[, col] &lt;- reads.LM.subset[, col] - rowMeans(reads.LM.subset[, -col, drop = FALSE])\n    ground_truth[, col] &lt;- ground_truth[, col] &gt; thresholdLFC & reads.LM.subset[, col] &gt; thresholdLFM\n  }\n\n  ground_truth$genes &lt;- rownames(ground_truth)\n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind, 1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set        set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                &lt;int&gt;\n1 Neil2 E15.0-437 FALSE 3_Clusters_even          1\n2 Neil2 E13.5-510 FALSE 3_Clusters_even          1\n3 Neil2 E13.5-437 FALSE 3_Clusters_even          1\n4 Lamc1 E15.0-437 FALSE 3_Clusters_even          1\n5 Lamc1 E13.5-510 FALSE 3_Clusters_even          1\n6 Lamc1 E13.5-437 FALSE 3_Clusters_even          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 2608\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-437\"\n[1] \"E15.0-437\"\n[1] \"E13.5-510\"\n[1] \"E17.5-516\"\n[1] \"E13.5-437\"\n[1] \"E17.5-505\"\n[1] \"E15.0-510\"\n[1] \"E15.0-428\"\n[1] \"E13.5-510\"\n\n\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nThreeClusters_even &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nThreeClusters_evenPL &lt;- ThreeClusters_even + xlab(\"FPR\") + ylab(\"TPR\")\nThreeClusters_evenPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#clusters_uneven",
    "href": "FDR_analysisResultsLFC.html#clusters_uneven",
    "title": "Results - Log Fold Change",
    "section": "3_Clusters_uneven",
    "text": "3_Clusters_uneven\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"3_Clusters_uneven\", ]\n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind], pattern = \"_[+]_\", simplify = T)\n  \n  reads.LM.subset &lt;- readsLogMeansPerCluster[, clusters]\n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(reads.LM.subset),\n                                       ncol = ncol(reads.LM.subset)))\n  rownames(ground_truth) &lt;- rownames(reads.LM.subset)\n  colnames(ground_truth) &lt;- colnames(reads.LM.subset)\n\n  for (col in 1:ncol(ground_truth)) {\n    # log fold change\n    ground_truth[, col] &lt;- reads.LM.subset[, col] - rowMeans(reads.LM.subset[, -col, drop = FALSE])\n    ground_truth[, col] &lt;- ground_truth[, col] &gt; thresholdLFC & reads.LM.subset[, col] &gt; thresholdLFM\n  }\n\n  ground_truth$genes &lt;- rownames(ground_truth)\n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind, 1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set          set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                  &lt;int&gt;\n1 Neil2 E15.0-428 FALSE 3_Clusters_uneven          1\n2 Neil2 E13.5-434 FALSE 3_Clusters_uneven          1\n3 Neil2 E15.0-510 FALSE 3_Clusters_uneven          1\n4 Lamc1 E15.0-428 FALSE 3_Clusters_uneven          1\n5 Lamc1 E13.5-434 FALSE 3_Clusters_uneven          1\n6 Lamc1 E15.0-510 FALSE 3_Clusters_uneven          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 3293\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E15.0-510\"\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E13.5-187\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n[1] \"E13.5-184\"\n\n\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nThreeClusters_uneven &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nThreeClusters_unevenPL &lt;- ThreeClusters_uneven + xlab(\"FPR\") + ylab(\"TPR\")\nThreeClusters_unevenPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#clusters_uneven-1",
    "href": "FDR_analysisResultsLFC.html#clusters_uneven-1",
    "title": "Results - Log Fold Change",
    "section": "5_Clusters_uneven",
    "text": "5_Clusters_uneven\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"5_Clusters_uneven\", ]\n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind], pattern = \"_[+]_\", simplify = T)\n  \n  reads.LM.subset &lt;- readsLogMeansPerCluster[, clusters]\n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(reads.LM.subset),\n                                       ncol = ncol(reads.LM.subset)))\n  rownames(ground_truth) &lt;- rownames(reads.LM.subset)\n  colnames(ground_truth) &lt;- colnames(reads.LM.subset)\n\n  for (col in 1:ncol(ground_truth)) {\n    # log fold change\n    ground_truth[, col] &lt;- reads.LM.subset[, col] - rowMeans(reads.LM.subset[, -col, drop = FALSE])\n    ground_truth[, col] &lt;- ground_truth[, col] &gt; thresholdLFC & reads.LM.subset[, col] &gt; thresholdLFM\n  }\n\n  ground_truth$genes &lt;- rownames(ground_truth)\n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind, 1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set          set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                  &lt;int&gt;\n1 Neil2 E13.5-510 FALSE 5_Clusters_uneven          1\n2 Neil2 E15.0-437 FALSE 5_Clusters_uneven          1\n3 Neil2 E15.0-510 FALSE 5_Clusters_uneven          1\n4 Neil2 E13.5-432 FALSE 5_Clusters_uneven          1\n5 Neil2 E13.5-437 FALSE 5_Clusters_uneven          1\n6 Lamc1 E13.5-510 FALSE 5_Clusters_uneven          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 3653\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-432\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-437\"\n[1] \"E13.5-510\"\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E13.5-184\"\n[1] \"E15.0-434\"\n[1] \"E17.5-505\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n[1] \"E13.5-187\"\n\n\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nFiveClusters_uneven &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nFiveClusters_unevenPL &lt;- FiveClusters_uneven + xlab(\"FPR\") + ylab(\"TPR\")\nFiveClusters_unevenPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#clusters-2",
    "href": "FDR_analysisResultsLFC.html#clusters-2",
    "title": "Results - Log Fold Change",
    "section": "2 Clusters",
    "text": "2 Clusters\n\nggarrange(TwoClusters_even_nearPL,TwoClusters_even_mediumPL, TwoClusters_even_farPL,TwoClusters_uneven_nearPL, TwoClusters_uneven_mediumPL,TwoClusters_uneven_farPL,\n          labels = c(\"Even_Near\", \"Even_Medium\", \"Even_Far\", \"Uneven_Near\",\"Uneven_Medium\",\"Uneven_Far\"),\n          ncol = 3, nrow = 2, common.legend = T, legend = \"bottom\")",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#and-5-clusters",
    "href": "FDR_analysisResultsLFC.html#and-5-clusters",
    "title": "Results - Log Fold Change",
    "section": "3 and 5 Clusters",
    "text": "3 and 5 Clusters\n\nggarrange(ThreeClusters_evenPL,ThreeClusters_unevenPL, NULL, FiveClusters_unevenPL,\n          labels = c(\"3_Even\", \"3_Uneven\", \"\", \"5_Uneven\"),\n          ncol = 2, nrow = 2, common.legend = T, legend = \"bottom\")",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analysisResultsLFC.html#footer",
    "href": "FDR_analysisResultsLFC.html#footer",
    "title": "Results - Log Fold Change",
    "section": "Footer",
    "text": "Footer\n\nsessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 22.04.5 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] ggpubr_0.6.0  ggplot2_4.0.1 tidyr_1.3.1   dplyr_1.1.4   stringr_1.5.1\n[6] pROC_1.18.5   COTAN_2.9.4  \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.22            splines_4.5.2              \n  [3] later_1.4.2                 tibble_3.3.0               \n  [5] polyclip_1.10-7             fastDummies_1.7.5          \n  [7] lifecycle_1.0.4             rstatix_0.7.2              \n  [9] doParallel_1.0.17           globals_0.18.0             \n [11] lattice_0.22-7              MASS_7.3-65                \n [13] backports_1.5.0             dendextend_1.19.0          \n [15] magrittr_2.0.4              plotly_4.11.0              \n [17] rmarkdown_2.29              yaml_2.3.10                \n [19] httpuv_1.6.16               Seurat_5.2.1               \n [21] sctransform_0.4.2           spam_2.11-1                \n [23] sp_2.2-0                    spatstat.sparse_3.1-0      \n [25] reticulate_1.42.0           cowplot_1.1.3              \n [27] pbapply_1.7-2               RColorBrewer_1.1-3         \n [29] abind_1.4-8                 Rtsne_0.17                 \n [31] GenomicRanges_1.60.0        purrr_1.2.0                \n [33] BiocGenerics_0.54.0         circlize_0.4.16            \n [35] GenomeInfoDbData_1.2.14     IRanges_2.42.0             \n [37] S4Vectors_0.46.0            ggrepel_0.9.6              \n [39] irlba_2.3.5.1               listenv_0.9.1              \n [41] spatstat.utils_3.1-4        goftest_1.2-3              \n [43] RSpectra_0.16-2             spatstat.random_3.4-1      \n [45] fitdistrplus_1.2-2          parallelly_1.45.0          \n [47] codetools_0.2-20            DelayedArray_0.34.1        \n [49] tidyselect_1.2.1            shape_1.4.6.1              \n [51] UCSC.utils_1.4.0            farver_2.1.2               \n [53] ScaledMatrix_1.16.0         viridis_0.6.5              \n [55] matrixStats_1.5.0           stats4_4.5.2               \n [57] spatstat.explore_3.4-2      jsonlite_2.0.0             \n [59] GetoptLong_1.0.5            gghalves_0.1.4             \n [61] Formula_1.2-5               progressr_0.15.1           \n [63] ggridges_0.5.6              survival_3.8-3             \n [65] iterators_1.0.14            foreach_1.5.2              \n [67] tools_4.5.2                 ica_1.0-3                  \n [69] Rcpp_1.0.14                 glue_1.8.0                 \n [71] gridExtra_2.3               SparseArray_1.8.0          \n [73] xfun_0.52                   MatrixGenerics_1.20.0      \n [75] ggthemes_5.1.0              GenomeInfoDb_1.44.0        \n [77] withr_3.0.2                 fastmap_1.2.0              \n [79] digest_0.6.37               rsvd_1.0.5                 \n [81] parallelDist_0.2.6          R6_2.6.1                   \n [83] mime_0.13                   colorspace_2.1-1           \n [85] scattermore_1.2             tensor_1.5                 \n [87] spatstat.data_3.1-6         utf8_1.2.5                 \n [89] generics_0.1.3              data.table_1.17.0          \n [91] httr_1.4.7                  htmlwidgets_1.6.4          \n [93] S4Arrays_1.8.0              uwot_0.2.3                 \n [95] pkgconfig_2.0.3             gtable_0.3.6               \n [97] ComplexHeatmap_2.24.0       lmtest_0.9-40              \n [99] S7_0.2.1                    SingleCellExperiment_1.30.0\n[101] XVector_0.48.0              htmltools_0.5.8.1          \n[103] carData_3.0-5               dotCall64_1.2              \n[105] zigg_0.0.2                  clue_0.3-66                \n[107] SeuratObject_5.1.0          scales_1.4.0               \n[109] Biobase_2.68.0              png_0.1-8                  \n[111] spatstat.univar_3.1-3       knitr_1.50                 \n[113] reshape2_1.4.4              rjson_0.2.23               \n[115] nlme_3.1-168                proxy_0.4-27               \n[117] zoo_1.8-14                  GlobalOptions_0.1.2        \n[119] KernSmooth_2.23-26          parallel_4.5.2             \n[121] miniUI_0.1.2                pillar_1.10.2              \n[123] grid_4.5.2                  vctrs_0.6.5                \n[125] RANN_2.6.2                  promises_1.3.2             \n[127] car_3.1-3                   BiocSingular_1.24.0        \n[129] beachmat_2.24.0             xtable_1.8-4               \n[131] cluster_2.1.8.1             evaluate_1.0.3             \n[133] zeallot_0.2.0               cli_3.6.5                  \n[135] compiler_4.5.2              rlang_1.1.6                \n[137] crayon_1.5.3                ggsignif_0.6.4             \n[139] future.apply_1.20.0         labeling_0.4.3             \n[141] plyr_1.8.9                  stringi_1.8.7              \n[143] viridisLite_0.4.2           deldir_2.0-4               \n[145] BiocParallel_1.42.0         assertthat_0.2.1           \n[147] lazyeval_0.2.2              spatstat.geom_3.4-1        \n[149] Matrix_1.7-4                RcppHNSW_0.6.0             \n[151] patchwork_1.3.2             future_1.58.0              \n[153] shiny_1.11.0                SummarizedExperiment_1.38.1\n[155] ROCR_1.0-11                 Rfast_2.1.5.1              \n[157] broom_1.0.8                 igraph_2.1.4               \n[159] RcppParallel_5.1.10",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - Log Fold Change"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html",
    "href": "FDR_analisysResults3_10.html",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "",
    "text": "library(COTAN)\nlibrary(pROC)\noptions(parallelly.fork.enable = TRUE)\nlibrary(Seurat)\nlibrary(monocle3)\nlibrary(reticulate)\nlibrary(cowplot)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggpubr)\n\nmethods.color &lt;- c(\"COTAN\"=\"#F73604\",\"Seurat\"=\"#ABD9E9\",\"Seurat_scTr\"=\"#74ADD1\",\"Seurat_Bimod\"=\"#4575B4\", \"Monocle\"=\"#DAABE9\", \"Scanpy\"=\"#7F9B5C\" )\n\ndirOut &lt;- \"Results/FDR/\"\nif (!dir.exists(dirOut)) {\n  dir.create(dirOut)\n}\n\ndataSetDir &lt;- \"Data/MouseCortexFromLoom/FDR/MergedClusters_For_FDR/\"",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#preamble",
    "href": "FDR_analisysResults3_10.html#preamble",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "",
    "text": "library(COTAN)\nlibrary(pROC)\noptions(parallelly.fork.enable = TRUE)\nlibrary(Seurat)\nlibrary(monocle3)\nlibrary(reticulate)\nlibrary(cowplot)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggpubr)\n\nmethods.color &lt;- c(\"COTAN\"=\"#F73604\",\"Seurat\"=\"#ABD9E9\",\"Seurat_scTr\"=\"#74ADD1\",\"Seurat_Bimod\"=\"#4575B4\", \"Monocle\"=\"#DAABE9\", \"Scanpy\"=\"#7F9B5C\" )\n\ndirOut &lt;- \"Results/FDR/\"\nif (!dir.exists(dirOut)) {\n  dir.create(dirOut)\n}\n\ndataSetDir &lt;- \"Data/MouseCortexFromLoom/FDR/MergedClusters_For_FDR/\"",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#dataset-composition",
    "href": "FDR_analisysResults3_10.html#dataset-composition",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "Dataset composition",
    "text": "Dataset composition\n\ndatasets_csv &lt;- read.csv(file.path(dataSetDir,\"Cells_Usage_DataFrame.csv\"),\n                         row.names = 1\n                        ) \n\ndatasets_csv[1:3,]\n\n                 Group            Collection E13.5.432 E13.5.187 E13.5.434\n1 2_Clusters_even_near E13.5-434_+_E15.0-428         0         0       318\n2 2_Clusters_even_near E15.0-432_+_E13.5-432       536         0         0\n3 2_Clusters_even_near E15.0-508_+_E15.0-509         0         0         0\n  E13.5.184 E13.5.437 E13.5.510 E15.0.432 E15.0.509 E15.0.510 E15.0.508\n1         0         0         0         0         0         0         0\n2         0         0         0       536         0         0         0\n3         0         0         0         0       397         0       397\n  E15.0.428 E15.0.434 E15.0.437 E17.5.516 E17.5.505\n1       318         0         0         0         0\n2         0         0         0         0         0\n3         0         0         0         0         0\n\n\n\nDefine which genes are expressed\nFor each data set we need to define, independently from the DEA methods, which genes are specific for each cluster. So we need to define first which genes are expressed and which are not expressed. To do so we can take advantage from the fact that we have the original clusters from which the cells were sampled to create the artificial datasets. So looking to the original cluster we define as expressed all genes present in at least the 10% of cells and we define as not expressed the genes completely absent or expressed in less than 3% of cells.\nSince these two thresholds can have a big influence on the tools performances we will test also others in other pages.\n\nfile.presence &lt;- readRDS(\"Data/MouseCortexFromLoom/FDR/Results/GenePresence_PerCluster.RDS\")\n\nfor (file in list.files(\"Data/MouseCortexFromLoom/SingleClusterRawData/\")) {\n#  print(file)\n  Code &lt;- str_split(file,pattern = \"_\",simplify = T)[1]\n  Time &lt;- str_split(Code,pattern = \"e\",simplify = T)[2]\n  Cluster &lt;- str_split(Code,pattern = \"e\",simplify = T)[1]\n  Cluster &lt;- str_remove(Cluster,pattern = \"Cl\")\n  Cluster &lt;- paste0(\"E\",Time,\"-\",Cluster)\n  file.presence[,Cluster] &lt;- \"Absent\"\n  dataset.cl &lt;- readRDS(file.path(\"Data/MouseCortexFromLoom/SingleClusterRawData/\",\n                                         file))\n  number.cell.expressing &lt;- rowSums(dataset.cl &gt; 0)\n  AbsentThreshold &lt;- round(0.03*dim(dataset.cl)[2],digits = 0)\n  PresenceThreshold &lt;- round(0.1*dim(dataset.cl)[2],digits = 0)\n  file.presence[names(number.cell.expressing[number.cell.expressing &gt; AbsentThreshold]),Cluster] &lt;- \"Uncertain\" \n  \n  file.presence[names(number.cell.expressing[number.cell.expressing &gt;= PresenceThreshold]),Cluster] &lt;- \"Present\"\n  print(Cluster)\n  print(table(file.presence[,Cluster]))\n  \n  }\n\n[1] \"E13.5-184\"\n\n   Absent   Present Uncertain \n     5519      6027      3149 \n[1] \"E13.5-187\"\n\n   Absent   Present Uncertain \n     4926      7151      2618 \n[1] \"E15.0-428\"\n\n   Absent   Present Uncertain \n     6386      5253      3056 \n[1] \"E13.5-432\"\n\n   Absent   Present Uncertain \n     5765      5975      2955 \n[1] \"E15.0-432\"\n\n   Absent   Present Uncertain \n     5912      5843      2940 \n[1] \"E13.5-434\"\n\n   Absent   Present Uncertain \n     6124      5487      3084 \n[1] \"E15.0-434\"\n\n   Absent   Present Uncertain \n     6301      5396      2998 \n[1] \"E13.5-437\"\n\n   Absent   Present Uncertain \n     5943      5783      2969 \n[1] \"E15.0-437\"\n\n   Absent   Present Uncertain \n     6017      5713      2965 \n[1] \"E17.5-505\"\n\n   Absent   Present Uncertain \n     6048      5662      2985 \n[1] \"E15.0-508\"\n\n   Absent   Present Uncertain \n     5625      6240      2830 \n[1] \"E15.0-509\"\n\n   Absent   Present Uncertain \n     5452      6454      2789 \n[1] \"E13.5-510\"\n\n   Absent   Present Uncertain \n     4924      6958      2813 \n[1] \"E15.0-510\"\n\n   Absent   Present Uncertain \n     5070      6952      2673 \n[1] \"E17.5-516\"\n\n   Absent   Present Uncertain \n     5821      5847      3027",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#clusters_even_near",
    "href": "FDR_analisysResults3_10.html#clusters_even_near",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2_Clusters_even_near",
    "text": "2_Clusters_even_near\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_near\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot,20)\n\n# A tibble: 20 × 5\n   genes  clusters  value data_set             set_number\n   &lt;chr&gt;  &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                     &lt;int&gt;\n 1 Neil2  E13.5-434 FALSE 2_Clusters_even_near          1\n 2 Neil2  E15.0-428 FALSE 2_Clusters_even_near          1\n 3 Lamc1  E13.5-434 FALSE 2_Clusters_even_near          1\n 4 Lamc1  E15.0-428 FALSE 2_Clusters_even_near          1\n 5 Lama1  E13.5-434 FALSE 2_Clusters_even_near          1\n 6 Lama1  E15.0-428 FALSE 2_Clusters_even_near          1\n 7 Hs3st1 E13.5-434 FALSE 2_Clusters_even_near          1\n 8 Hs3st1 E15.0-428 FALSE 2_Clusters_even_near          1\n 9 Fabp3  E13.5-434 FALSE 2_Clusters_even_near          1\n10 Fabp3  E15.0-428 FALSE 2_Clusters_even_near          1\n11 Nrg2   E13.5-434 FALSE 2_Clusters_even_near          1\n12 Nrg2   E15.0-428 FALSE 2_Clusters_even_near          1\n13 Kdelr3 E13.5-434 FALSE 2_Clusters_even_near          1\n14 Kdelr3 E15.0-428 FALSE 2_Clusters_even_near          1\n15 Bend4  E13.5-434 FALSE 2_Clusters_even_near          1\n16 Bend4  E15.0-428 FALSE 2_Clusters_even_near          1\n17 Gjb4   E13.5-434 FALSE 2_Clusters_even_near          1\n18 Gjb4   E15.0-428 FALSE 2_Clusters_even_near          1\n19 Mogs   E13.5-434 FALSE 2_Clusters_even_near          1\n20 Mogs   E15.0-428 FALSE 2_Clusters_even_near          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 24\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nTwoClusters_even_near &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nTwoClusters_even_nearPL &lt;- TwoClusters_even_near + \n  xlab(\"FPR\") + \n  ylab(\"TPR\")\nTwoClusters_even_nearPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#clusters_even_medium",
    "href": "FDR_analisysResults3_10.html#clusters_even_medium",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2_Clusters_even_medium",
    "text": "2_Clusters_even_medium\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_medium\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set               set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                       &lt;int&gt;\n1 Neil2 E13.5-187 FALSE 2_Clusters_even_medium          1\n2 Neil2 E13.5-184 FALSE 2_Clusters_even_medium          1\n3 Lamc1 E13.5-187 FALSE 2_Clusters_even_medium          1\n4 Lamc1 E13.5-184 FALSE 2_Clusters_even_medium          1\n5 Lama1 E13.5-187 FALSE 2_Clusters_even_medium          1\n6 Lama1 E13.5-184 FALSE 2_Clusters_even_medium          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 771\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E13.5-184\"\n[1] \"E17.5-516\"\n[1] \"E15.0-434\"\n[1] \"E15.0-508\"\n[1] \"E15.0-437\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_even_medium &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nTwo_Clusters_even_mediumPL &lt;- Two_Clusters_even_medium + xlab(\"FPR\") + ylab(\"TPR\")\nTwo_Clusters_even_mediumPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#clusters_even_far",
    "href": "FDR_analisysResults3_10.html#clusters_even_far",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2_Clusters_even_far",
    "text": "2_Clusters_even_far\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_far\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set            set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                    &lt;int&gt;\n1 Neil2 E17.5-516 FALSE 2_Clusters_even_far          1\n2 Neil2 E13.5-187 FALSE 2_Clusters_even_far          1\n3 Lamc1 E17.5-516 FALSE 2_Clusters_even_far          1\n4 Lamc1 E13.5-187 FALSE 2_Clusters_even_far          1\n5 Lama1 E17.5-516 FALSE 2_Clusters_even_far          1\n6 Lama1 E13.5-187 TRUE  2_Clusters_even_far          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 2325\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E17.5-516\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-509\"\n[1] \"E13.5-184\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_even_far &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nTwo_Clusters_even_farPL &lt;- Two_Clusters_even_far + xlab(\"FPR\") + ylab(\"TPR\")\nTwo_Clusters_even_farPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#clusters_uneven_near",
    "href": "FDR_analisysResults3_10.html#clusters_uneven_near",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2_Clusters_uneven_near",
    "text": "2_Clusters_uneven_near\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_near\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set               set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                       &lt;int&gt;\n1 Neil2 E13.5-434 FALSE 2_Clusters_uneven_near          1\n2 Neil2 E15.0-428 FALSE 2_Clusters_uneven_near          1\n3 Lamc1 E13.5-434 FALSE 2_Clusters_uneven_near          1\n4 Lamc1 E15.0-428 FALSE 2_Clusters_uneven_near          1\n5 Lama1 E13.5-434 FALSE 2_Clusters_uneven_near          1\n6 Lama1 E15.0-428 FALSE 2_Clusters_uneven_near          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 24\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\nplot(roc_resultSeurat)\n\n\n\n\n\n\n\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_uneven_near &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nTwo_Clusters_uneven_nearPL &lt;- Two_Clusters_uneven_near + xlab(\"FPR\") + ylab(\"TPR\")\nTwo_Clusters_uneven_nearPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#clusters_uneven_medium",
    "href": "FDR_analisysResults3_10.html#clusters_uneven_medium",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2_Clusters_uneven_medium",
    "text": "2_Clusters_uneven_medium\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_medium\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set                 set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                         &lt;int&gt;\n1 Neil2 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n2 Neil2 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n3 Lamc1 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n4 Lamc1 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n5 Lama1 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n6 Lama1 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 771\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E13.5-184\"\n[1] \"E17.5-516\"\n[1] \"E15.0-434\"\n[1] \"E15.0-508\"\n[1] \"E15.0-437\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_uneven_medium &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nTwo_Clusters_uneven_mediumPL &lt;- Two_Clusters_uneven_medium + xlab(\"FPR\") + ylab(\"TPR\")\n\nTwo_Clusters_uneven_mediumPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#clusters_uneven_far",
    "href": "FDR_analisysResults3_10.html#clusters_uneven_far",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2_Clusters_uneven_far",
    "text": "2_Clusters_uneven_far\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_far\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set              set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                      &lt;int&gt;\n1 Neil2 E17.5-516 FALSE 2_Clusters_uneven_far          1\n2 Neil2 E13.5-187 FALSE 2_Clusters_uneven_far          1\n3 Lamc1 E17.5-516 FALSE 2_Clusters_uneven_far          1\n4 Lamc1 E13.5-187 FALSE 2_Clusters_uneven_far          1\n5 Lama1 E17.5-516 FALSE 2_Clusters_uneven_far          1\n6 Lama1 E13.5-187 TRUE  2_Clusters_uneven_far          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 2325\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E17.5-516\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-509\"\n[1] \"E13.5-184\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_uneven_far &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nTwo_Clusters_uneven_farPL &lt;- Two_Clusters_uneven_far + xlab(\"FPR\") + ylab(\"TPR\")\n\nlg &lt;- get_legend(Two_Clusters_uneven_farPL)\n\nTwo_Clusters_uneven_farPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#clusters_even",
    "href": "FDR_analisysResults3_10.html#clusters_even",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "3_Clusters_even",
    "text": "3_Clusters_even\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"3_Clusters_even\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set        set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                &lt;int&gt;\n1 Neil2 E15.0-437 FALSE 3_Clusters_even          1\n2 Neil2 E13.5-510 FALSE 3_Clusters_even          1\n3 Neil2 E13.5-437 FALSE 3_Clusters_even          1\n4 Lamc1 E15.0-437 FALSE 3_Clusters_even          1\n5 Lamc1 E13.5-510 FALSE 3_Clusters_even          1\n6 Lamc1 E13.5-437 FALSE 3_Clusters_even          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 2512\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-437\"\n[1] \"E15.0-437\"\n[1] \"E13.5-510\"\n[1] \"E17.5-516\"\n[1] \"E13.5-437\"\n[1] \"E17.5-505\"\n[1] \"E15.0-510\"\n[1] \"E15.0-428\"\n[1] \"E13.5-510\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nThree_Clusters_even &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nThree_Clusters_evenPL &lt;- Three_Clusters_even + \n  xlab(\"FPR\") + ylab(\"TPR\")+theme(legend.position=\"none\")\nThree_Clusters_even",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#clusters_uneven",
    "href": "FDR_analisysResults3_10.html#clusters_uneven",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "3_Clusters_uneven",
    "text": "3_Clusters_uneven\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"3_Clusters_uneven\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set          set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                  &lt;int&gt;\n1 Neil2 E15.0-428 FALSE 3_Clusters_uneven          1\n2 Neil2 E13.5-434 FALSE 3_Clusters_uneven          1\n3 Neil2 E15.0-510 FALSE 3_Clusters_uneven          1\n4 Lamc1 E15.0-428 FALSE 3_Clusters_uneven          1\n5 Lamc1 E13.5-434 FALSE 3_Clusters_uneven          1\n6 Lamc1 E15.0-510 FALSE 3_Clusters_uneven          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 2816\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E15.0-510\"\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E13.5-187\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n[1] \"E13.5-184\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nThree_Clusters_uneven &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nThree_Clusters_unevenPL &lt;- Three_Clusters_uneven + xlab(\"FPR\") + ylab(\"TPR\")+theme(legend.position=\"none\")\n\nThree_Clusters_uneven",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#clusters_uneven-1",
    "href": "FDR_analisysResults3_10.html#clusters_uneven-1",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "5_Clusters_uneven",
    "text": "5_Clusters_uneven\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"5_Clusters_uneven\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\n\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set          set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                  &lt;int&gt;\n1 Neil2 E13.5-510 FALSE 5_Clusters_uneven          1\n2 Neil2 E15.0-437 FALSE 5_Clusters_uneven          1\n3 Neil2 E15.0-510 FALSE 5_Clusters_uneven          1\n4 Neil2 E13.5-432 FALSE 5_Clusters_uneven          1\n5 Neil2 E13.5-437 FALSE 5_Clusters_uneven          1\n6 Lamc1 E13.5-510 FALSE 5_Clusters_uneven          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 3544\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  genesLambda &lt;- getLambda(dataset)\n  genesLambda &lt;- as.data.frame(genesLambda)\n  genesLambda$genes &lt;- rownames(genesLambda)\n  \n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  \n  onlyPositive.pVal.Cotan &lt;- merge(onlyPositive.pVal.Cotan,genesLambda,by=\"genes\")\n  \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-432\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-437\"\n[1] \"E13.5-510\"\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E13.5-184\"\n[1] \"E15.0-434\"\n[1] \"E17.5-505\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n[1] \"E13.5-187\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\ncotan.threshold.pval &lt;- quantile(onlyPositive.pVal.Cotan_tot[onlyPositive.pVal.Cotan_tot$value == 0,]$p_values,probs = 0.05)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\ndeaSeurat_tot_base &lt;- deaSeurat_tot\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\nseurat.threshold.pval &lt;- quantile(deaSeurat_tot_base[deaSeurat_tot_base$value == 0,]$p_val,probs = 0.05)\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\ndeaSeurat_tot_scTr &lt;- deaSeurat_tot\n\nSeurat_scTr.threshold.pval &lt;- quantile(deaSeurat_tot_scTr[deaSeurat_tot_scTr$value == 0,]$p_val,probs = 0.05)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\ndeaSeurat_tot_Bimod &lt;- deaSeurat_tot\n\nseurat_bimod.threshold.pval &lt;- quantile(deaSeurat_tot_Bimod[deaSeurat_tot_Bimod$value == 0,]$p_val,probs = 0.05)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\nmonocle.threshold.pval &lt;- quantile(deaMonocle_tot[deaMonocle_tot$value == 0,]$marker_test_p_value,probs = 0.05)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\nscanpy.threshold.pval &lt;- quantile(deaScanpy_tot[deaScanpy_tot$value == 0,]$pval,probs = 0.05)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nFive_Clusters &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\n \nFive_Clusters_unevenPL &lt;- Five_Clusters + xlab(\"FPR\") + ylab(\"TPR\")\n\nFive_Clusters_unevenPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#clusters-2",
    "href": "FDR_analisysResults3_10.html#clusters-2",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2 Clusters",
    "text": "2 Clusters\n\nplot_2cl &lt;- ggarrange(TwoClusters_even_nearPL,Two_Clusters_even_mediumPL, Two_Clusters_even_farPL,Two_Clusters_uneven_nearPL, Two_Clusters_uneven_mediumPL,Two_Clusters_uneven_farPL,\n          labels = c(\"Even_Near\", \"Even_Medium\", \"Even_Far\", \"Uneven_Near\",\"Uneven_Medium\",\"Uneven_Far\"),\n          ncol = 3, nrow = 2, common.legend = T, legend = \"bottom\")\n\npdf(paste0(dirOut,\"ROC_two_supp.pdf\"),width = 15,height = 10)\nplot(plot_2cl)\ndev.off()\n\npng \n  2 \n\nplot_2cl",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#and-5-clusters",
    "href": "FDR_analisysResults3_10.html#and-5-clusters",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "3 and 5 Clusters",
    "text": "3 and 5 Clusters\n\nplot_3_5 &lt;- ggarrange(Three_Clusters_evenPL,Three_Clusters_unevenPL, NULL, Five_Clusters_unevenPL,\n          labels = c(\"3_Even\", \"3_Uneven\", \"\", \"5_Uneven\"),\n          ncol = 2, nrow = 2, common.legend = T, legend = \"bottom\")\n\npdf(paste0(dirOut,\"ROC_three_five_supp.pdf\"),width = 10,height = 10)\nplot(plot_3_5)\ndev.off()\n\npng \n  2 \n\nplot_3_5\n\n\n\n\n\n\n\n\n\nplot3 &lt;- ggarrange(Two_Clusters_uneven_farPL,Three_Clusters_unevenPL, Five_Clusters_unevenPL,\n          labels = c(\"A\", \"B\", \"C\"),\n          ncol = 3, nrow = 1, common.legend = T, legend = \"none\")\n\npdf(paste0(dirOut,\"ROC_three_main.pdf\"),width = 15,height = 5)\nplot(plot3)\ndev.off()\n\npng \n  2 \n\nplot3",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#histogram-with-gene-expression-level",
    "href": "FDR_analisysResults3_10.html#histogram-with-gene-expression-level",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "Histogram with gene expression level",
    "text": "Histogram with gene expression level\n\nground_truth_tot_subset &lt;- as.data.frame(ground_truth_tot[ground_truth_tot$value ==1,])\n\nCOTAN_data &lt;- onlyPositive.pVal.Cotan_tot[,c(\"genes\",\"set_number\",\"clusters\",\"p_values\",\"genesLambda\")]\n\ncolnames(COTAN_data) &lt;- c(\"genes\",\"set_number\",\"clusters\",\"p_value_COTAN\",\"genesLambda\")\n\nground_truth_tot_subset &lt;- merge(ground_truth_tot_subset,\n                                 COTAN_data,\n                                 by=c(\"genes\",\"set_number\", \"clusters\"),\n                                 all.x = T, all.y= FALSE)\n\nSeurat_data_base &lt;- deaSeurat_tot_base[,c(\"genes\",\"set_number\",\"clusters\", \"p_val\")]\ncolnames(Seurat_data_base) &lt;- c(\"genes\",\"set_number\",\"clusters\",\"p_value_Seurat\")\n\nground_truth_tot_subset &lt;- merge(ground_truth_tot_subset,\n                                 Seurat_data_base,\n                                 by=c(\"genes\",\"set_number\",\"clusters\"),\n                                 all.x = T, all.y= FALSE)\n\nSeurat_data_scTr &lt;- deaSeurat_tot_scTr[,c(\"genes\",\"set_number\",\"clusters\", \"p_val\")]\ncolnames(Seurat_data_scTr) &lt;- c(\"genes\",\"set_number\",\"clusters\",\"p_value_Seurat_scTr\")\n\nground_truth_tot_subset &lt;- merge(ground_truth_tot_subset,\n                                 Seurat_data_scTr,\n                                 by=c(\"genes\",\"set_number\",\"clusters\"),\n                                 all.x = T, all.y= FALSE)\n\nSeurat_data_Bimod &lt;- deaSeurat_tot_Bimod[,c(\"genes\",\"set_number\",\"clusters\", \"p_val\")]\ncolnames(Seurat_data_Bimod) &lt;- c(\"genes\",\"set_number\",\"clusters\",\"p_value_Seurat_Bimod\")\n\nground_truth_tot_subset &lt;- merge(ground_truth_tot_subset,\n                                 Seurat_data_Bimod,\n                                 by=c(\"genes\",\"set_number\",\"clusters\"),\n                                 all.x = T, all.y= FALSE)\n\n\ndata_Monocle &lt;- deaMonocle_tot[,c(\"genes\",\"set_number\",\"clusters\", \"marker_test_p_value\")]\ncolnames(data_Monocle) &lt;- c(\"genes\",\"set_number\",\"clusters\",\"p_value_Monocle\")\n\nground_truth_tot_subset &lt;- merge(ground_truth_tot_subset,\n                                 data_Monocle,\n                                 by=c(\"genes\",\"set_number\",\"clusters\"),\n                                 all.x = T, all.y= FALSE)\n\ndata_Scanpy &lt;- deaScanpy_tot[,c(\"genes\",\"set_number\",\"clusters\", \"pval\")]\ncolnames(data_Scanpy) &lt;- c(\"genes\",\"set_number\",\"clusters\",\"p_value_Scanpy\")\n\nground_truth_tot_subset &lt;- merge(ground_truth_tot_subset,\n                                 data_Scanpy,\n                                 by=c(\"genes\",\"set_number\",\"clusters\"),\n                                 all.x = T, all.y= FALSE)\n\nground_truth_tot_subset &lt;- ground_truth_tot_subset %&gt;% mutate(lambda_bin = cut(genesLambda, breaks=50))\n\nground_truth_tot_subset[is.na(ground_truth_tot_subset)] &lt;- 1\n\nhead(ground_truth_tot_subset)\n\n          genes set_number  clusters value          data_set p_value_COTAN\n1 A330008L17Rik          1 E13.5-432  TRUE 5_Clusters_uneven  2.397295e-10\n2 A330084C13Rik          1 E15.0-510  TRUE 5_Clusters_uneven  1.517987e-01\n3 A330084C13Rik          2 E17.5-505  TRUE 5_Clusters_uneven  1.871017e-01\n4 A330102I10Rik          1 E15.0-510  TRUE 5_Clusters_uneven  4.020632e-05\n5 A330102I10Rik          2 E17.5-505  TRUE 5_Clusters_uneven  3.580400e-01\n6 A630089N07Rik          2 E13.5-184  TRUE 5_Clusters_uneven  1.152963e-10\n  genesLambda p_value_Seurat p_value_Seurat_scTr p_value_Seurat_Bimod\n1  0.07870370   8.273625e-09        9.966968e-09         6.141385e-08\n2  0.09027778   1.000000e+00        8.095134e-03         8.676023e-05\n3  0.04289216   1.000000e+00        1.000000e+00         1.000000e+00\n4  0.08024691   2.547529e-07        1.579015e-07         1.104961e-05\n5  0.03431373   1.000000e+00        1.000000e+00         2.718294e-04\n6  0.06617647   1.632048e-12        7.812652e-13         1.731541e-09\n  p_value_Monocle p_value_Scanpy       lambda_bin\n1    7.760581e-09    0.012422646    (0.069,0.134]\n2    5.065628e-02    0.266934766    (0.069,0.134]\n3    2.001536e-01    0.671631728 (0.000846,0.069]\n4    1.989451e-06    0.028717392    (0.069,0.134]\n5    1.935776e-01    0.793509146 (0.000846,0.069]\n6    1.328598e-09    0.004754579 (0.000846,0.069]\n\n\n\nbins &lt;- levels(ground_truth_tot_subset$lambda_bin)\nbins &lt;- bins[!is.na(bins)]\n\nforBarChart &lt;- as.data.frame(matrix(nrow = length(bins),ncol = 7,data = 0))\n\ncolnames(forBarChart) &lt;- c(\"bins\",\"COTAN\",\"Seurat\",\"Seurat_Bimod\",\"Seurat_scTr\",\"Monocle\", \"Scanpy\")\nforBarChart$bins &lt;- bins\nrownames(forBarChart) &lt;- forBarChart$bins\n\n#p_val_threshold &lt;- 0.05\n\nfor (i in as.vector(forBarChart$bins)) {\n  forBarChart[ i,\"COTAN\"] &lt;- sum(ground_truth_tot_subset$lambda_bin == i & ground_truth_tot_subset$p_value_COTAN &lt;= cotan.threshold.pval)\n  \n  forBarChart[ i,\"Seurat\"] &lt;- sum(ground_truth_tot_subset$lambda_bin == i & ground_truth_tot_subset$p_value_Seurat &lt;= seurat.threshold.pval)\n  \n  forBarChart[ i,\"Seurat_Bimod\"] &lt;- sum(ground_truth_tot_subset$lambda_bin == i & ground_truth_tot_subset$p_value_Seurat_Bimod &lt;= seurat_bimod.threshold.pval)\n  \n  forBarChart[ i,\"Seurat_scTr\"] &lt;- sum(ground_truth_tot_subset$lambda_bin == i & ground_truth_tot_subset$p_value_Seurat_scTr &lt;= Seurat_scTr.threshold.pval)\n  \n  forBarChart[ i,\"Monocle\"] &lt;- sum(ground_truth_tot_subset$lambda_bin == i & ground_truth_tot_subset$p_value_Monocle &lt;= monocle.threshold.pval)\n  \n  forBarChart[ i,\"Scanpy\"] &lt;- sum(ground_truth_tot_subset$lambda_bin == i & ground_truth_tot_subset$p_value_Scanpy &lt;= scanpy.threshold.pval)\n  \n}\n\ntemp.bin &lt;- as.data.frame(str_split(forBarChart$bins,pattern = \",\",simplify = T))\ntemp.bin[,1] &lt;- as.numeric(str_remove(temp.bin[,1],pattern = \"[(]\"))\ntemp.bin[,2] &lt;- as.numeric(str_remove(temp.bin[,2],pattern = \"[]]\"))\n\nforBarChart$bins &lt;- round(rowMeans(temp.bin),digits = 2)\n\n\nforBarChart &lt;- forBarChart[rowSums(forBarChart[,2:ncol(forBarChart)]) &gt; 0,]\n\nforBarChart.perc &lt;- forBarChart[1:8,]\n\nforBarChart.perc$tot &lt;- rowSums(forBarChart.perc[,2:ncol(forBarChart.perc)])\n\nforBarChart.perc[,2:(ncol(forBarChart.perc)-1)] &lt;- round(forBarChart.perc[,2:(ncol(forBarChart.perc)-1)]/forBarChart.perc$tot,digits = 4)\n\nforBarChart.perc &lt;- pivot_longer(forBarChart.perc,\n                               cols = 2:(ncol(forBarChart.perc)-1),\n                               names_to = \"Methods\")\n\nforBarChart.number &lt;- pivot_longer(forBarChart[1:8,],\n                               cols = 2:(ncol(forBarChart)),\n                               names_to = \"Methods\")\n\ncolnames(forBarChart.number) &lt;- c(\"bins\",\"Methods\", \"valueOriginal\")\n\nforBarChart.perc &lt;- merge(forBarChart.perc,forBarChart.number, by = c(\"bins\",\"Methods\"))\n\nbarChart &lt;- ggplot(forBarChart.perc,aes(x=bins,y=value,fill=Methods))+\n  geom_bar(stat=\"identity\")+\n  geom_text(aes(label = valueOriginal), \n            position = position_stack(vjust = 0.5),  size=3)+\n  scale_fill_manual(\n    values = methods.color)+\n  theme_light()+\n  scale_x_continuous(breaks =forBarChart.perc$bins)+\n  theme(axis.title.y=element_blank(),axis.title.x=element_blank(),\n      legend.position=\"none\",axis.text.x = element_text(angle = 45, hjust=1)\n    )+\n  scale_y_continuous(labels = scales::percent_format())\n\npdf(paste0(dirOut,\"EnrichedGenesForExpressionLevel.pdf\"),height = 3,width = 5)\nbarChart\ndev.off()\n\npng \n  2 \n\nplot(barChart)\n\n\n\n\n\n\n\n\n\nplot.with.inset &lt;-\n  ggdraw() +\n  draw_plot(plot3) +\n  draw_plot(as_ggplot(lg), x = 0.18, y = 0.1, width = 0.2, height = .45)+\n  draw_plot(barChart, x = 0.78, y = 0.09, width = 0.22, height = .5)\n\npdf(paste0(dirOut,\"Plot3WihtGenesExLevel.pdf\"),height = 5,width = 15)\nplot(plot.with.inset)\ndev.off()\n\npng \n  2 \n\nplot(plot.with.inset)",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10.html#footer",
    "href": "FDR_analisysResults3_10.html#footer",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "Footer",
    "text": "Footer\n\nsessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 22.04.5 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] ggpubr_0.6.0                ggplot2_4.0.1              \n [3] tidyr_1.3.1                 dplyr_1.1.4                \n [5] stringr_1.5.1               cowplot_1.1.3              \n [7] reticulate_1.42.0           monocle3_1.3.7             \n [9] SingleCellExperiment_1.30.0 SummarizedExperiment_1.38.1\n[11] GenomicRanges_1.60.0        GenomeInfoDb_1.44.0        \n[13] IRanges_2.42.0              S4Vectors_0.46.0           \n[15] MatrixGenerics_1.20.0       matrixStats_1.5.0          \n[17] Biobase_2.68.0              BiocGenerics_0.54.0        \n[19] generics_0.1.3              Seurat_5.2.1               \n[21] SeuratObject_5.1.0          sp_2.2-0                   \n[23] pROC_1.18.5                 COTAN_2.9.4                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.22        splines_4.5.2           later_1.4.2            \n  [4] tibble_3.3.0            polyclip_1.10-7         fastDummies_1.7.5      \n  [7] lifecycle_1.0.4         rstatix_0.7.2           Rdpack_2.6.4           \n [10] doParallel_1.0.17       globals_0.18.0          lattice_0.22-7         \n [13] MASS_7.3-65             backports_1.5.0         dendextend_1.19.0      \n [16] magrittr_2.0.4          plotly_4.11.0           rmarkdown_2.29         \n [19] yaml_2.3.10             httpuv_1.6.16           sctransform_0.4.2      \n [22] spam_2.11-1             spatstat.sparse_3.1-0   minqa_1.2.8            \n [25] pbapply_1.7-2           RColorBrewer_1.1-3      abind_1.4-8            \n [28] Rtsne_0.17              purrr_1.2.0             circlize_0.4.16        \n [31] GenomeInfoDbData_1.2.14 ggrepel_0.9.6           irlba_2.3.5.1          \n [34] listenv_0.9.1           spatstat.utils_3.1-4    goftest_1.2-3          \n [37] RSpectra_0.16-2         spatstat.random_3.4-1   fitdistrplus_1.2-2     \n [40] parallelly_1.45.0       codetools_0.2-20        DelayedArray_0.34.1    \n [43] tidyselect_1.2.1        shape_1.4.6.1           UCSC.utils_1.4.0       \n [46] farver_2.1.2            lme4_1.1-37             ScaledMatrix_1.16.0    \n [49] viridis_0.6.5           spatstat.explore_3.4-2  jsonlite_2.0.0         \n [52] GetoptLong_1.0.5        gghalves_0.1.4          Formula_1.2-5          \n [55] progressr_0.15.1        ggridges_0.5.6          survival_3.8-3         \n [58] iterators_1.0.14        foreach_1.5.2           tools_4.5.2            \n [61] ica_1.0-3               Rcpp_1.0.14             glue_1.8.0             \n [64] gridExtra_2.3           SparseArray_1.8.0       xfun_0.52              \n [67] ggthemes_5.1.0          withr_3.0.2             fastmap_1.2.0          \n [70] boot_1.3-32             digest_0.6.37           rsvd_1.0.5             \n [73] parallelDist_0.2.6      R6_2.6.1                mime_0.13              \n [76] colorspace_2.1-1        scattermore_1.2         tensor_1.5             \n [79] spatstat.data_3.1-6     utf8_1.2.5              data.table_1.17.0      \n [82] httr_1.4.7              htmlwidgets_1.6.4       S4Arrays_1.8.0         \n [85] uwot_0.2.3              pkgconfig_2.0.3         gtable_0.3.6           \n [88] ComplexHeatmap_2.24.0   lmtest_0.9-40           S7_0.2.1               \n [91] XVector_0.48.0          htmltools_0.5.8.1       carData_3.0-5          \n [94] dotCall64_1.2           zigg_0.0.2              clue_0.3-66            \n [97] scales_1.4.0            png_0.1-8               reformulas_0.4.1       \n[100] spatstat.univar_3.1-3   knitr_1.50              reshape2_1.4.4         \n[103] rjson_0.2.23            nloptr_2.2.1            nlme_3.1-168           \n[106] proxy_0.4-27            zoo_1.8-14              GlobalOptions_0.1.2    \n[109] KernSmooth_2.23-26      parallel_4.5.2          miniUI_0.1.2           \n[112] pillar_1.10.2           grid_4.5.2              vctrs_0.6.5            \n[115] RANN_2.6.2              promises_1.3.2          car_3.1-3              \n[118] BiocSingular_1.24.0     beachmat_2.24.0         xtable_1.8-4           \n[121] cluster_2.1.8.1         evaluate_1.0.3          zeallot_0.2.0          \n[124] cli_3.6.5               compiler_4.5.2          rlang_1.1.6            \n[127] crayon_1.5.3            ggsignif_0.6.4          future.apply_1.20.0    \n[130] labeling_0.4.3          plyr_1.8.9              stringi_1.8.7          \n[133] viridisLite_0.4.2       deldir_2.0-4            BiocParallel_1.42.0    \n[136] assertthat_0.2.1        lazyeval_0.2.2          spatstat.geom_3.4-1    \n[139] Matrix_1.7-4            RcppHNSW_0.6.0          patchwork_1.3.2        \n[142] future_1.58.0           shiny_1.11.0            rbibutils_2.3          \n[145] ROCR_1.0-11             Rfast_2.1.5.1           broom_1.0.8            \n[148] igraph_2.1.4            RcppParallel_5.1.10",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 3% 10%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html",
    "href": "FDR_analisysResults5.html",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "",
    "text": "library(COTAN)\nlibrary(pROC)\noptions(parallelly.fork.enable = TRUE)\nlibrary(Seurat)\nlibrary(monocle3)\nlibrary(reticulate)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggpubr)\nlibrary(ggplot2)\n\ndirOut &lt;- \"Results/FDR/\"\nif (!dir.exists(dirOut)) {\n  dir.create(dirOut)\n}\n\ndataSetDir &lt;- \"Data/MouseCortexFromLoom/FDR/MergedClusters_For_FDR/\"",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#preamble",
    "href": "FDR_analisysResults5.html#preamble",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "",
    "text": "library(COTAN)\nlibrary(pROC)\noptions(parallelly.fork.enable = TRUE)\nlibrary(Seurat)\nlibrary(monocle3)\nlibrary(reticulate)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggpubr)\nlibrary(ggplot2)\n\ndirOut &lt;- \"Results/FDR/\"\nif (!dir.exists(dirOut)) {\n  dir.create(dirOut)\n}\n\ndataSetDir &lt;- \"Data/MouseCortexFromLoom/FDR/MergedClusters_For_FDR/\"",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#dataset-composition",
    "href": "FDR_analisysResults5.html#dataset-composition",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "Dataset composition",
    "text": "Dataset composition\n\ndatasets_csv &lt;- read.csv(file.path(dataSetDir,\"Cells_Usage_DataFrame.csv\"),\n                         row.names = 1\n                        ) \n\ndatasets_csv[1:3,]\n\n                 Group            Collection E13.5.432 E13.5.187 E13.5.434\n1 2_Clusters_even_near E13.5-434_+_E15.0-428         0         0       318\n2 2_Clusters_even_near E15.0-432_+_E13.5-432       536         0         0\n3 2_Clusters_even_near E15.0-508_+_E15.0-509         0         0         0\n  E13.5.184 E13.5.437 E13.5.510 E15.0.432 E15.0.509 E15.0.510 E15.0.508\n1         0         0         0         0         0         0         0\n2         0         0         0       536         0         0         0\n3         0         0         0         0       397         0       397\n  E15.0.428 E15.0.434 E15.0.437 E17.5.516 E17.5.505\n1       318         0         0         0         0\n2         0         0         0         0         0\n3         0         0         0         0         0\n\n\n\nDefine which genes are expressed\nFor each data set we need to define, independently from the DEA methods, which genes are specific for each cluster. So we need to define first which genes are expressed and which are not expressed. To do so we can take advantage from the fact that we have the original clusters from which the cells were sampled to create the artificial datasets. So looking to the original cluster we define as expressed all genes present in at least the 5% of cells and we define as not expressed the genes completely absent or expressed in less than 5% of cells.\nSince these two thresholds can have a big influence on the tools performances we will test also others in other pages.\n\nfile.presence &lt;- readRDS(\"Data/MouseCortexFromLoom/FDR/Results/GenePresence_PerCluster.RDS\")\n\nfor (file in list.files(\"Data/MouseCortexFromLoom/SingleClusterRawData/\")) {\n#  print(file)\n  Code &lt;- str_split(file,pattern = \"_\",simplify = T)[1]\n  Time &lt;- str_split(Code,pattern = \"e\",simplify = T)[2]\n  Cluster &lt;- str_split(Code,pattern = \"e\",simplify = T)[1]\n  Cluster &lt;- str_remove(Cluster,pattern = \"Cl\")\n  Cluster &lt;- paste0(\"E\",Time,\"-\",Cluster)\n  file.presence[,Cluster] &lt;- \"Absent\"\n  dataset.cl &lt;- readRDS(file.path(\"Data/MouseCortexFromLoom/SingleClusterRawData/\",\n                                         file))\n  number.cell.expressing &lt;- rowSums(dataset.cl &gt; 0)\n  AbsentThreshold &lt;- round(0.05*dim(dataset.cl)[2],digits = 0)\n  PresenceThreshold &lt;- round(0.05*dim(dataset.cl)[2],digits = 0)\n  file.presence[names(number.cell.expressing[number.cell.expressing &gt; AbsentThreshold]),Cluster] &lt;- \"Uncertain\" \n  \n  file.presence[names(number.cell.expressing[number.cell.expressing &gt;= PresenceThreshold]),Cluster] &lt;- \"Present\"\n  print(Cluster)\n  print(table(file.presence[,Cluster]))\n  \n  }\n\n[1] \"E13.5-184\"\n\n Absent Present \n   6536    8159 \n[1] \"E13.5-187\"\n\n Absent Present \n   5809    8886 \n[1] \"E15.0-428\"\n\n Absent Present \n   7304    7391 \n[1] \"E13.5-432\"\n\n Absent Present \n   6753    7942 \n[1] \"E15.0-432\"\n\n Absent Present \n   6873    7822 \n[1] \"E13.5-434\"\n\n Absent Present \n   7004    7691 \n[1] \"E15.0-434\"\n\n Absent Present \n   7380    7315 \n[1] \"E13.5-437\"\n\n Absent Present \n   6825    7870 \n[1] \"E15.0-437\"\n\n Absent Present \n   6891    7804 \n[1] \"E17.5-505\"\n\n Absent Present \n   6870    7825 \n[1] \"E15.0-508\"\n\n Absent Present \n   6520    8175 \n[1] \"E15.0-509\"\n\n Absent Present \n   6376    8319 \n[1] \"E13.5-510\"\n\n Absent Present \n   5790    8905 \n[1] \"E15.0-510\"\n\n Absent Present \n   5956    8739 \n[1] \"E17.5-516\"\n\n Absent Present \n   6777    7918",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#clusters_even_near",
    "href": "FDR_analisysResults5.html#clusters_even_near",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "2_Clusters_even_near",
    "text": "2_Clusters_even_near\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_near\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set             set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                     &lt;int&gt;\n1 Neil2 E13.5-434 FALSE 2_Clusters_even_near          1\n2 Neil2 E15.0-428 FALSE 2_Clusters_even_near          1\n3 Lamc1 E13.5-434 FALSE 2_Clusters_even_near          1\n4 Lamc1 E15.0-428 TRUE  2_Clusters_even_near          1\n5 Lama1 E13.5-434 FALSE 2_Clusters_even_near          1\n6 Lama1 E15.0-428 FALSE 2_Clusters_even_near          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 2320\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwoClusters_even_near &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwoClusters_even_nearPL &lt;- TwoClusters_even_near + xlab(\"FPR\") + ylab(\"TPR\")\nTwoClusters_even_nearPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#clusters_even_medium",
    "href": "FDR_analisysResults5.html#clusters_even_medium",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "2_Clusters_even_medium",
    "text": "2_Clusters_even_medium\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_medium\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set               set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                       &lt;int&gt;\n1 Neil2 E13.5-187 FALSE 2_Clusters_even_medium          1\n2 Neil2 E13.5-184 FALSE 2_Clusters_even_medium          1\n3 Lamc1 E13.5-187 FALSE 2_Clusters_even_medium          1\n4 Lamc1 E13.5-184 FALSE 2_Clusters_even_medium          1\n5 Lama1 E13.5-187 FALSE 2_Clusters_even_medium          1\n6 Lama1 E13.5-184 FALSE 2_Clusters_even_medium          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 4661\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E13.5-184\"\n[1] \"E17.5-516\"\n[1] \"E15.0-434\"\n[1] \"E15.0-508\"\n[1] \"E15.0-437\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_even_medium &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwo_Clusters_even_mediumPL &lt;- Two_Clusters_even_medium + xlab(\"FPR\") + ylab(\"TPR\")\nTwo_Clusters_even_mediumPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#clusters_even_far",
    "href": "FDR_analisysResults5.html#clusters_even_far",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "2_Clusters_even_far",
    "text": "2_Clusters_even_far\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_far\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set            set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                    &lt;int&gt;\n1 Neil2 E17.5-516 FALSE 2_Clusters_even_far          1\n2 Neil2 E13.5-187 FALSE 2_Clusters_even_far          1\n3 Lamc1 E17.5-516 FALSE 2_Clusters_even_far          1\n4 Lamc1 E13.5-187 FALSE 2_Clusters_even_far          1\n5 Lama1 E17.5-516 FALSE 2_Clusters_even_far          1\n6 Lama1 E13.5-187 TRUE  2_Clusters_even_far          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 7189\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E17.5-516\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-509\"\n[1] \"E13.5-184\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_even_far &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwo_Clusters_even_farPL &lt;- Two_Clusters_even_far + xlab(\"FPR\") + ylab(\"TPR\")\nTwo_Clusters_even_farPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#clusters_uneven_near",
    "href": "FDR_analisysResults5.html#clusters_uneven_near",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "2_Clusters_uneven_near",
    "text": "2_Clusters_uneven_near\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_near\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set               set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                       &lt;int&gt;\n1 Neil2 E13.5-434 FALSE 2_Clusters_uneven_near          1\n2 Neil2 E15.0-428 FALSE 2_Clusters_uneven_near          1\n3 Lamc1 E13.5-434 FALSE 2_Clusters_uneven_near          1\n4 Lamc1 E15.0-428 TRUE  2_Clusters_uneven_near          1\n5 Lama1 E13.5-434 FALSE 2_Clusters_uneven_near          1\n6 Lama1 E15.0-428 FALSE 2_Clusters_uneven_near          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 2320\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\nplot(roc_resultSeurat)\n\n\n\n\n\n\n\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_uneven_near &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwo_Clusters_uneven_nearPL &lt;- Two_Clusters_uneven_near + xlab(\"FPR\") + ylab(\"TPR\")\nTwo_Clusters_uneven_nearPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#clusters_uneven_medium",
    "href": "FDR_analisysResults5.html#clusters_uneven_medium",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "2_Clusters_uneven_medium",
    "text": "2_Clusters_uneven_medium\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_medium\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set                 set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                         &lt;int&gt;\n1 Neil2 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n2 Neil2 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n3 Lamc1 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n4 Lamc1 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n5 Lama1 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n6 Lama1 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 4661\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E13.5-184\"\n[1] \"E17.5-516\"\n[1] \"E15.0-434\"\n[1] \"E15.0-508\"\n[1] \"E15.0-437\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_uneven_medium &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwo_Clusters_uneven_mediumPL &lt;- Two_Clusters_uneven_medium + xlab(\"FPR\") + ylab(\"TPR\")\n\nTwo_Clusters_uneven_mediumPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#clusters_uneven_far",
    "href": "FDR_analisysResults5.html#clusters_uneven_far",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "2_Clusters_uneven_far",
    "text": "2_Clusters_uneven_far\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_far\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set              set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                      &lt;int&gt;\n1 Neil2 E17.5-516 FALSE 2_Clusters_uneven_far          1\n2 Neil2 E13.5-187 FALSE 2_Clusters_uneven_far          1\n3 Lamc1 E17.5-516 FALSE 2_Clusters_uneven_far          1\n4 Lamc1 E13.5-187 FALSE 2_Clusters_uneven_far          1\n5 Lama1 E17.5-516 FALSE 2_Clusters_uneven_far          1\n6 Lama1 E13.5-187 TRUE  2_Clusters_uneven_far          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 7189\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E17.5-516\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-509\"\n[1] \"E13.5-184\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_uneven_far &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwo_Clusters_uneven_farPL &lt;- Two_Clusters_uneven_far + xlab(\"FPR\") + ylab(\"TPR\")\n\nTwo_Clusters_uneven_farPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#clusters_even",
    "href": "FDR_analisysResults5.html#clusters_even",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "3_Clusters_even",
    "text": "3_Clusters_even\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"3_Clusters_even\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set        set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                &lt;int&gt;\n1 Neil2 E15.0-437 FALSE 3_Clusters_even          1\n2 Neil2 E13.5-510 FALSE 3_Clusters_even          1\n3 Neil2 E13.5-437 FALSE 3_Clusters_even          1\n4 Lamc1 E15.0-437 FALSE 3_Clusters_even          1\n5 Lamc1 E13.5-510 TRUE  3_Clusters_even          1\n6 Lamc1 E13.5-437 TRUE  3_Clusters_even          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 11529\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-437\"\n[1] \"E15.0-437\"\n[1] \"E13.5-510\"\n[1] \"E17.5-516\"\n[1] \"E13.5-437\"\n[1] \"E17.5-505\"\n[1] \"E15.0-510\"\n[1] \"E15.0-428\"\n[1] \"E13.5-510\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nThree_Clusters_even &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nThree_Clusters_evenPL &lt;- Three_Clusters_even + \n  xlab(\"FPR\") + ylab(\"TPR\")+theme(legend.position=\"none\")\nThree_Clusters_even",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#clusters_uneven",
    "href": "FDR_analisysResults5.html#clusters_uneven",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "3_Clusters_uneven",
    "text": "3_Clusters_uneven\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"3_Clusters_uneven\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set          set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                  &lt;int&gt;\n1 Neil2 E15.0-428 FALSE 3_Clusters_uneven          1\n2 Neil2 E13.5-434 FALSE 3_Clusters_uneven          1\n3 Neil2 E15.0-510 FALSE 3_Clusters_uneven          1\n4 Lamc1 E15.0-428 TRUE  3_Clusters_uneven          1\n5 Lamc1 E13.5-434 FALSE 3_Clusters_uneven          1\n6 Lamc1 E15.0-510 TRUE  3_Clusters_uneven          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 11195\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E15.0-510\"\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E13.5-187\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n[1] \"E13.5-184\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nThree_Clusters_uneven &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nThree_Clusters_unevenPL &lt;- Three_Clusters_uneven + xlab(\"FPR\") + ylab(\"TPR\")+theme(legend.position=\"none\")\n\nThree_Clusters_uneven",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#clusters_uneven-1",
    "href": "FDR_analisysResults5.html#clusters_uneven-1",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "5_Clusters_uneven",
    "text": "5_Clusters_uneven\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"5_Clusters_uneven\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set          set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                  &lt;int&gt;\n1 Neil2 E13.5-510 FALSE 5_Clusters_uneven          1\n2 Neil2 E15.0-437 FALSE 5_Clusters_uneven          1\n3 Neil2 E15.0-510 FALSE 5_Clusters_uneven          1\n4 Neil2 E13.5-432 FALSE 5_Clusters_uneven          1\n5 Neil2 E13.5-437 FALSE 5_Clusters_uneven          1\n6 Lamc1 E13.5-510 FALSE 5_Clusters_uneven          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 13080\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-432\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-437\"\n[1] \"E13.5-510\"\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E13.5-184\"\n[1] \"E15.0-434\"\n[1] \"E17.5-505\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n[1] \"E13.5-187\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nFive_Clusters &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\n \nFive_Clusters_unevenPL &lt;- Five_Clusters + xlab(\"FPR\") + ylab(\"TPR\")\n\nFive_Clusters_unevenPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#clusters-2",
    "href": "FDR_analisysResults5.html#clusters-2",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "2 Clusters",
    "text": "2 Clusters\n\nggarrange(TwoClusters_even_nearPL,Two_Clusters_even_mediumPL, Two_Clusters_even_farPL,Two_Clusters_uneven_nearPL, Two_Clusters_uneven_mediumPL,Two_Clusters_uneven_farPL,\n          labels = c(\"Even_Near\", \"Even_Medium\", \"Even_Far\", \"Uneven_Near\",\"Uneven_Medium\",\"Uneven_Far\"),\n          ncol = 3, nrow = 2, common.legend = T, legend = \"bottom\")",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#and-5-clusters",
    "href": "FDR_analisysResults5.html#and-5-clusters",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "3 and 5 Clusters",
    "text": "3 and 5 Clusters\n\nggarrange(Three_Clusters_evenPL,Three_Clusters_unevenPL, NULL, Five_Clusters_unevenPL,\n          labels = c(\"3_Even\", \"3_Uneven\", \"\", \"5_Uneven\"),\n          ncol = 2, nrow = 2, common.legend = T, legend = \"bottom\")",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5.html#footer",
    "href": "FDR_analisysResults5.html#footer",
    "title": "FDR analysis - Results - thresholds true 5%",
    "section": "Footer",
    "text": "Footer\n\nsessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 22.04.5 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] ggpubr_0.6.0                ggplot2_4.0.1              \n [3] tidyr_1.3.1                 dplyr_1.1.4                \n [5] stringr_1.5.1               reticulate_1.42.0          \n [7] monocle3_1.3.7              SingleCellExperiment_1.30.0\n [9] SummarizedExperiment_1.38.1 GenomicRanges_1.60.0       \n[11] GenomeInfoDb_1.44.0         IRanges_2.42.0             \n[13] S4Vectors_0.46.0            MatrixGenerics_1.20.0      \n[15] matrixStats_1.5.0           Biobase_2.68.0             \n[17] BiocGenerics_0.54.0         generics_0.1.3             \n[19] Seurat_5.2.1                SeuratObject_5.1.0         \n[21] sp_2.2-0                    pROC_1.18.5                \n[23] COTAN_2.9.4                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.22        splines_4.5.2           later_1.4.2            \n  [4] tibble_3.3.0            polyclip_1.10-7         fastDummies_1.7.5      \n  [7] lifecycle_1.0.4         rstatix_0.7.2           Rdpack_2.6.4           \n [10] doParallel_1.0.17       globals_0.18.0          lattice_0.22-7         \n [13] MASS_7.3-65             backports_1.5.0         dendextend_1.19.0      \n [16] magrittr_2.0.4          plotly_4.11.0           rmarkdown_2.29         \n [19] yaml_2.3.10             httpuv_1.6.16           sctransform_0.4.2      \n [22] spam_2.11-1             spatstat.sparse_3.1-0   minqa_1.2.8            \n [25] cowplot_1.1.3           pbapply_1.7-2           RColorBrewer_1.1-3     \n [28] abind_1.4-8             Rtsne_0.17              purrr_1.2.0            \n [31] circlize_0.4.16         GenomeInfoDbData_1.2.14 ggrepel_0.9.6          \n [34] irlba_2.3.5.1           listenv_0.9.1           spatstat.utils_3.1-4   \n [37] goftest_1.2-3           RSpectra_0.16-2         spatstat.random_3.4-1  \n [40] fitdistrplus_1.2-2      parallelly_1.45.0       codetools_0.2-20       \n [43] DelayedArray_0.34.1     tidyselect_1.2.1        shape_1.4.6.1          \n [46] UCSC.utils_1.4.0        farver_2.1.2            lme4_1.1-37            \n [49] ScaledMatrix_1.16.0     viridis_0.6.5           spatstat.explore_3.4-2 \n [52] jsonlite_2.0.0          GetoptLong_1.0.5        gghalves_0.1.4         \n [55] Formula_1.2-5           progressr_0.15.1        ggridges_0.5.6         \n [58] survival_3.8-3          iterators_1.0.14        foreach_1.5.2          \n [61] tools_4.5.2             ica_1.0-3               Rcpp_1.0.14            \n [64] glue_1.8.0              gridExtra_2.3           SparseArray_1.8.0      \n [67] xfun_0.52               ggthemes_5.1.0          withr_3.0.2            \n [70] fastmap_1.2.0           boot_1.3-32             digest_0.6.37          \n [73] rsvd_1.0.5              parallelDist_0.2.6      R6_2.6.1               \n [76] mime_0.13               colorspace_2.1-1        scattermore_1.2        \n [79] tensor_1.5              spatstat.data_3.1-6     utf8_1.2.5             \n [82] data.table_1.17.0       httr_1.4.7              htmlwidgets_1.6.4      \n [85] S4Arrays_1.8.0          uwot_0.2.3              pkgconfig_2.0.3        \n [88] gtable_0.3.6            ComplexHeatmap_2.24.0   lmtest_0.9-40          \n [91] S7_0.2.1                XVector_0.48.0          htmltools_0.5.8.1      \n [94] carData_3.0-5           dotCall64_1.2           zigg_0.0.2             \n [97] clue_0.3-66             scales_1.4.0            png_0.1-8              \n[100] reformulas_0.4.1        spatstat.univar_3.1-3   knitr_1.50             \n[103] reshape2_1.4.4          rjson_0.2.23            nloptr_2.2.1           \n[106] nlme_3.1-168            proxy_0.4-27            zoo_1.8-14             \n[109] GlobalOptions_0.1.2     KernSmooth_2.23-26      parallel_4.5.2         \n[112] miniUI_0.1.2            pillar_1.10.2           grid_4.5.2             \n[115] vctrs_0.6.5             RANN_2.6.2              promises_1.3.2         \n[118] car_3.1-3               BiocSingular_1.24.0     beachmat_2.24.0        \n[121] xtable_1.8-4            cluster_2.1.8.1         evaluate_1.0.3         \n[124] zeallot_0.2.0           cli_3.6.5               compiler_4.5.2         \n[127] rlang_1.1.6             crayon_1.5.3            ggsignif_0.6.4         \n[130] future.apply_1.20.0     labeling_0.4.3          plyr_1.8.9             \n[133] stringi_1.8.7           viridisLite_0.4.2       deldir_2.0-4           \n[136] BiocParallel_1.42.0     assertthat_0.2.1        lazyeval_0.2.2         \n[139] spatstat.geom_3.4-1     Matrix_1.7-4            RcppHNSW_0.6.0         \n[142] patchwork_1.3.2         future_1.58.0           shiny_1.11.0           \n[145] rbibutils_2.3           ROCR_1.0-11             Rfast_2.1.5.1          \n[148] broom_1.0.8             igraph_2.1.4            RcppParallel_5.1.10",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5%"
    ]
  },
  {
    "objectID": "ForebrainDorsal_E150-analysis.html",
    "href": "ForebrainDorsal_E150-analysis.html",
    "title": "Forebrain Dorsal E15.0 Data-set Anaysis",
    "section": "",
    "text": "library(ggplot2)\nlibrary(tibble)\nlibrary(zeallot)\nlibrary(COTAN)\n\noptions(parallelly.fork.enable = TRUE)\n\noutDir &lt;- \"Data/MouseCortexFromLoom/\"\n\nsetLoggingLevel(1)\nsetLoggingFile(file.path(outDir, \"ForebrainDorsal_E150-analysis.log\"))",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "E15.0 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "ForebrainDorsal_E150-analysis.html#cleaning",
    "href": "ForebrainDorsal_E150-analysis.html#cleaning",
    "title": "Forebrain Dorsal E15.0 Data-set Anaysis",
    "section": "Cleaning",
    "text": "Cleaning\nRead the already created COTAN object\n\nfb150Obj &lt;- readRDS(\"Data/MouseCortexFromLoom/SourceData/e15.0_ForebrainDorsal.cotan.RDS\")\nsampleCondition &lt;- getMetadataElement(fb150Obj, datasetTags()[[\"cond\"]])\n\nsampleCondition\n\n[1] \"e15.0_ForebrainDorsal\"\n\n\nInspect cells’ sizes\n\ncellSizePlot(fb150Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nDrop cells with too many ritz reads as they are probably duplets\n\ncellsSizeThr &lt;- 10000\nfb150Obj &lt;- addElementToMetaDataset(fb150Obj, \"Cells size threshold\", cellsSizeThr)\n\ncells_to_rem &lt;- getCells(fb150Obj)[getCellsSize(fb150Obj) &gt; cellsSizeThr]\nfb150Obj &lt;- dropGenesCells(fb150Obj, cells = cells_to_rem)\n\ncellSizePlot(fb150Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nInspect the number of expressed genes per cell\n\ngenesSizePlot(fb150Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nDrop cells with too low genes expession as they are probably dead\n\ngenesSizeLowThr &lt;- 700\nfb150Obj &lt;- addElementToMetaDataset(fb150Obj, \"Num genes low threshold\", genesSizeLowThr)\n\nnumExprGenes &lt;- getNumExpressedGenes(fb150Obj)\ncells_to_rem &lt;- names(numExprGenes)[numExprGenes &lt; genesSizeLowThr]\nfb150Obj &lt;- dropGenesCells(fb150Obj, cells = cells_to_rem)\n\ngenesSizePlot(fb150Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nCheck number of mitocondrial genes expressed in each cell\n\nmitGenesPattern &lt;- \"^mt.\"\ngetGenes(fb150Obj)[grep(mitGenesPattern, getGenes(fb150Obj))]\n\n[1] \"mt.Co1\"  \"mt.Nd4\"  \"mt.Nd5\"  \"mt.Nd1\"  \"mt.Nd2\"  \"mt.Atp6\"\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(fb150Obj, genePrefix = mitGenesPattern,\n                              splitPattern = \":\", numCol = 1)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCells with a too high percentage of mitocondrial genes are likely dead (or at the last problematic) cells. So we drop them!\n\nmitPercThr &lt;- 1.0\nfb150Obj &lt;- addElementToMetaDataset(fb150Obj, \"Mitoc. perc. threshold\", mitPercThr)\n\ncells_to_rem &lt;- rownames(mitSizes)[mitSizes[[\"mit.percentage\"]] &gt; mitPercThr]\n\nfb150Obj &lt;- dropGenesCells(fb150Obj, cells = cells_to_rem)\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(fb150Obj, genePrefix = mitGenesPattern,\n                              splitPattern = \":\", numCol = 1)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCheck no further outliers after all the culling\n\ncellSizePlot(fb150Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\ngenesSizePlot(fb150Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\n\nClean: round 1\n\nfb150Obj &lt;- clean(fb150Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(fb150Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nfb150Obj &lt;- addElementToMetaDataset(fb150Obj, \"Num drop B group\", 0)\n\nB group contains highly diverse cells: drop them!\n\ncells_to_rem &lt;- rownames(pcaCellsData)[pcaCellsData[[\"groups\"]] == \"B\"]\n\nfb150Obj &lt;- dropGenesCells(fb150Obj, cells = cells_to_rem)\n\n\n\nClean: round 2\n\nfb150Obj &lt;- clean(fb150Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot,\n  UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(fb150Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nfb150Obj &lt;- addElementToMetaDataset(fb150Obj, \"Num drop B group\", 1)\n\nB group contains one cell with high diversity in the higher components\n\nplot(pcaCellsData)\n\n\n\n\n\n\n\ncells_to_rem &lt;- rownames(pcaCellsData)[pcaCellsData[[\"groups\"]] == \"B\"]\n\nfb150Obj &lt;- dropGenesCells(fb150Obj, cells = cells_to_rem)\n\n\n\nClean: round 3\n\nfb150Obj &lt;- clean(fb150Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot,\n  UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(fb150Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nfb150Obj &lt;- addElementToMetaDataset(fb150Obj, \"Num drop B group\", 2)\n\nB group contains one cell with high diversity in the higher components\n\nplot(pcaCellsData)\n\n\n\n\n\n\n\ncells_to_rem &lt;- rownames(pcaCellsData)[pcaCellsData[[\"groups\"]] == \"B\"]\n\nfb150Obj &lt;- dropGenesCells(fb150Obj, cells = cells_to_rem)\n\n\n\nClean: round 4\n\nfb150Obj &lt;- clean(fb150Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot,\n  UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(fb150Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nfb150Obj &lt;- addElementToMetaDataset(fb150Obj, \"Num drop B group\", 3)\n\nB group contains few cell with high diversity\n\nplot(pcaCellsData)\n\n\n\n\n\n\n\ncells_to_rem &lt;- rownames(pcaCellsData)[pcaCellsData[[\"groups\"]] == \"B\"]\n\nfb150Obj &lt;- dropGenesCells(fb150Obj, cells = cells_to_rem)\n\n\n\nClean: round 5\n\nfb150Obj &lt;- clean(fb150Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot,\n  UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(fb150Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nfb150Obj &lt;- addElementToMetaDataset(fb150Obj, \"Num drop B group\", 4)\n\nVisualize if all is ok:\n\nplot(UDEPlot)\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\nlowUDEThr &lt;- 0.4 # the threshold to remove low UDE cells\n\nnuDf &lt;- data.frame(\"nu\" = sort(getNu(fb150Obj)), \"n\" = seq_along(getNu(fb150Obj)))\nUDEPlot_zoomed &lt;- ggplot(nuDf, aes(x = n, y = nu)) +\n            geom_point(colour = \"#8491B4B2\", size = 1.0) +\n            xlim(0L, 400L) +\n            ylim(0.0, 1.0) +\n            geom_hline(yintercept = lowUDEThr, linetype = \"dashed\",\n                       color = \"darkred\") +\n            annotate(geom = \"text\", x = 200L, y = 0.25,\n                     label = paste0(\"to remove cells with nu &lt; \", lowUDEThr),\n                     color = \"darkred\", size = 4.5)\n\nplot(UDEPlot_zoomed)\n\n\n\n\n\n\n\n\nFinal cleaning to check all is OK\n\nfb150Obj &lt;- clean(fb150Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(fb150Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\nplot(cellSizePlot(fb150Obj, splitPattern = \":\", numCol = 1))\n\n\n\n\n\n\n\nplot(genesSizePlot(fb150Obj, splitPattern = \":\", numCol = 1))\n\n\n\n\n\n\n\n\nCalculate genes’ COEX\n\nSys.time()\n\nfb150Obj &lt;- proceedToCoex(fb150Obj, calcCoex = TRUE, cores = 12,\n                          saveObj = TRUE, outDir = outDir)\n\nSys.time()\n\nSave the COTAN object\n\nsaveRDS(fb150Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\nfb150Obj &lt;- readRDS(file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "E15.0 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "ForebrainDorsal_E150-analysis.html#gdi",
    "href": "ForebrainDorsal_E150-analysis.html#gdi",
    "title": "Forebrain Dorsal E15.0 Data-set Anaysis",
    "section": "GDI",
    "text": "GDI\n\ngdiData &lt;- calculateGDI(fb150Obj)\n\ngenesToLabel &lt;- head(rownames(gdiData[order(gdiData[[\"GDI\"]],\n                                            decreasing = TRUE), ]), n = 10L)\n\ngenesToLabel\n\n [1] \"Myt1l\"   \"Aldoc\"   \"Rbfox1\"  \"Gas1\"    \"Zfp36l1\" \"Mapt\"    \"Ank3\"   \n [8] \"Stmn3\"   \"Tubb3\"   \"Pclaf\"  \n\ngdiPlot &lt;- GDIPlot(fb150Obj, GDIIn = gdiData, GDIThreshold = 1.4,\n                   genes = list(\"Top 10 GDI genes\" = genesToLabel))\n\nplot(gdiPlot)\n\n\n\n\n\n\n\n\n\nsplitClusters &lt;- cellsUniformClustering(fb150Obj, GDIThreshold = 1.4, cores = 13,\n                                        saveObj = TRUE, outDir = outDir)\n\nc(splitCoexDF, splitPValueDF) %&lt;-% DEAOnClusters(fb150Obj, clusters = splitClusters)\n\nfb150Obj &lt;- addClusterization(fb150Obj, clName = \"split\",\n                              clusters = splitClusters,\n                              coexDF = splitCoexDF, override = TRUE)\n\ntable(splitClusters)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "E15.0 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "ForebrainDorsal_E150-analysis.html#consistent-transcript-cohorts-clustering",
    "href": "ForebrainDorsal_E150-analysis.html#consistent-transcript-cohorts-clustering",
    "title": "Forebrain Dorsal E15.0 Data-set Anaysis",
    "section": "Consistent Transcript Cohorts (clustering)",
    "text": "Consistent Transcript Cohorts (clustering)\n\nc(mergedClusters, mergedCoexDF, mergedPValueDF) %&lt;-%\n  mergeUniformCellsClusters(fb150Obj, clusters = splitClusters,\n                            GDIThreshold = 1.4, cores = 13,\n                            saveObj = TRUE, outDir = outDir)\n\nfb150Obj &lt;- addClusterization(fb150Obj, clName = \"merge\",\n                              clusters = mergedClusters,\n                              coexDF = mergedCoexDF,\n                              override = TRUE)\n\ntable(mergedClusters)\n\n\n\nSys.time()\n\n[1] \"2023-11-17 12:57:25 CET\"\n\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] COTAN_2.3.0   zeallot_0.1.0 tibble_3.2.1  ggplot2_3.4.2\n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3        rstudioapi_0.15.0        \n  [3] jsonlite_1.8.7            shape_1.4.6              \n  [5] umap_0.2.10.0             magrittr_2.0.3           \n  [7] spatstat.utils_3.0-3      farver_2.1.1             \n  [9] rmarkdown_2.24            GlobalOptions_0.1.2      \n [11] vctrs_0.6.3               ROCR_1.0-11              \n [13] spatstat.explore_3.2-1    DelayedMatrixStats_1.22.5\n [15] askpass_1.2.0             htmltools_0.5.5          \n [17] S4Arrays_1.2.0            sctransform_0.4.1        \n [19] parallelly_1.36.0         KernSmooth_2.23-22       \n [21] htmlwidgets_1.6.2         ica_1.0-3                \n [23] plyr_1.8.8                plotly_4.10.2            \n [25] zoo_1.8-12                igraph_1.5.1             \n [27] mime_0.12                 lifecycle_1.0.3          \n [29] iterators_1.0.14          pkgconfig_2.0.3          \n [31] rsvd_1.0.5                Matrix_1.6-2             \n [33] R6_2.5.1                  fastmap_1.1.1            \n [35] MatrixGenerics_1.12.3     fitdistrplus_1.1-11      \n [37] future_1.33.0             shiny_1.7.5              \n [39] clue_0.3-64               digest_0.6.33            \n [41] colorspace_2.1-0          patchwork_1.1.2          \n [43] S4Vectors_0.38.1          tensor_1.5               \n [45] Seurat_5.0.0              dqrng_0.3.0              \n [47] RSpectra_0.16-1           irlba_2.3.5.1            \n [49] beachmat_2.16.0           labeling_0.4.2           \n [51] PCAtools_2.14.0           progressr_0.14.0         \n [53] RcppZiggurat_0.1.6        spatstat.sparse_3.0-2    \n [55] fansi_1.0.4               polyclip_1.10-4          \n [57] httr_1.4.6                abind_1.4-5              \n [59] compiler_4.3.2            withr_2.5.0              \n [61] doParallel_1.0.17         BiocParallel_1.34.2      \n [63] viridis_0.6.4             fastDummies_1.7.3        \n [65] dendextend_1.17.1         MASS_7.3-60              \n [67] openssl_2.1.0             DelayedArray_0.26.7      \n [69] rjson_0.2.21              tools_4.3.2              \n [71] lmtest_0.9-40             httpuv_1.6.11            \n [73] future.apply_1.11.0       goftest_1.2-3            \n [75] glue_1.6.2                nlme_3.1-163             \n [77] promises_1.2.0.1          grid_4.3.2               \n [79] Rtsne_0.16                cluster_2.1.4            \n [81] reshape2_1.4.4            generics_0.1.3           \n [83] spatstat.data_3.0-1       gtable_0.3.3             \n [85] tidyr_1.3.0               data.table_1.14.8        \n [87] BiocSingular_1.16.0       ScaledMatrix_1.8.1       \n [89] sp_2.1-1                  utf8_1.2.3               \n [91] spatstat.geom_3.2-4       BiocGenerics_0.46.0      \n [93] RcppAnnoy_0.0.21          ggrepel_0.9.3            \n [95] RANN_2.6.1                foreach_1.5.2            \n [97] pillar_1.9.0              stringr_1.5.0            \n [99] spam_2.10-0               RcppHNSW_0.5.0           \n[101] later_1.3.1               circlize_0.4.15          \n[103] splines_4.3.2             dplyr_1.1.2              \n[105] lattice_0.22-5            deldir_1.0-9             \n[107] survival_3.5-7            tidyselect_1.2.0         \n[109] ComplexHeatmap_2.16.0     miniUI_0.1.1.1           \n[111] pbapply_1.7-2             knitr_1.43               \n[113] gridExtra_2.3             IRanges_2.34.1           \n[115] scattermore_1.2           stats4_4.3.2             \n[117] xfun_0.39                 matrixStats_1.1.0        \n[119] stringi_1.8.1             lazyeval_0.2.2           \n[121] yaml_2.3.7                evaluate_0.21            \n[123] codetools_0.2-19          cli_3.6.1                \n[125] uwot_0.1.16               RcppParallel_5.1.7       \n[127] xtable_1.8-4              reticulate_1.34.0        \n[129] munsell_0.5.0             Rcpp_1.0.11              \n[131] spatstat.random_3.2-1     globals_0.16.2           \n[133] png_0.1-8                 parallel_4.3.2           \n[135] Rfast_2.1.0               ellipsis_0.3.2           \n[137] assertthat_0.2.1          dotCall64_1.1-0          \n[139] parallelDist_0.2.6        sparseMatrixStats_1.12.2 \n[141] listenv_0.9.0             ggthemes_4.2.4           \n[143] viridisLite_0.4.2         scales_1.2.1             \n[145] ggridges_0.5.4            SeuratObject_5.0.0       \n[147] leiden_0.4.3              purrr_1.0.1              \n[149] crayon_1.5.2              GetoptLong_1.0.5         \n[151] rlang_1.1.1               cowplot_1.1.1",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "E15.0 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "CorticalCells_GSM2861511_E135-analysis.html",
    "href": "CorticalCells_GSM2861511_E135-analysis.html",
    "title": "Cortical cells DGE E13.5 Data-set Anaysis",
    "section": "",
    "text": "library(ggplot2)\nlibrary(tibble)\nlibrary(zeallot)\nlibrary(COTAN)\n\noptions(parallelly.fork.enable = TRUE)\n\noutDir &lt;- \"Data/Yuzwa_MouseCortex/\"\n\nsetLoggingLevel(1)\nsetLoggingFile(file.path(outDir, \"CorticalCells_GSM2861511_E135-analysis.log\"))\nRead the dataset from file\ndataset &lt;- read.csv(file.path(\"Data/Yuzwa_MouseCortex/\", \"GSM2861511_E135_Only_Cortical_Cells_DGE.txt.gz\"),\n                    header = TRUE, sep = \"\\t\", strip.white = TRUE,\n                    row.names = 1)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "E13.5 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "CorticalCells_GSM2861511_E135-analysis.html#cleaning",
    "href": "CorticalCells_GSM2861511_E135-analysis.html#cleaning",
    "title": "Cortical cells DGE E13.5 Data-set Anaysis",
    "section": "Cleaning",
    "text": "Cleaning\nCrate the COTAN object\n\nsampleCondition &lt;- \"CorticalCells_GSM2861511_E135\"\ncc135Obj &lt;- COTAN(raw = dataset)\ncc135Obj &lt;- initializeMetaDataset(cc135Obj,\n                                  GEO = \"GSM2861511_E135\",\n                                  sequencingMethod = \"Drop_seq\",\n                                  sampleCondition = sampleCondition)\n\nInspect cells’ sizes\n\ncellSizePlot(cc135Obj)\n\n\n\n\n\n\n\n\nDrop cells with too many ritz reads as they are probably duplets\n\ncellsSizeThr &lt;- 8000\ncc135Obj &lt;- addElementToMetaDataset(cc135Obj, \"Cells size threshold\", cellsSizeThr)\n\ncells_to_rem &lt;- getCells(cc135Obj)[getCellsSize(cc135Obj) &gt; cellsSizeThr]\ncc135Obj &lt;- dropGenesCells(cc135Obj, cells = cells_to_rem)\n\ncellSizePlot(cc135Obj)\n\n\n\n\n\n\n\n\nInspect the number of expressed genes per cell\n\ngenesSizePlot(cc135Obj)\n\n\n\n\n\n\n\n\nDrop cells with too high genes expession as they are probably duplets\n\ngenesSizeThr &lt;- 3300\ncc135Obj &lt;- addElementToMetaDataset(cc135Obj, \"Num genes threshold\", genesSizeThr)\n\nnumExprGenes &lt;- getNumExpressedGenes(cc135Obj)\ncells_to_rem &lt;- names(numExprGenes)[numExprGenes &gt; genesSizeThr]\ncc135Obj &lt;- dropGenesCells(cc135Obj, cells = cells_to_rem)\n\ngenesSizePlot(cc135Obj)\n\n\n\n\n\n\n\n\nCheck number of mitocondrial genes expressed in each cell\n\nmitGenesPattern &lt;- \"^mt-\"\ngetGenes(cc135Obj)[grep(mitGenesPattern, getGenes(cc135Obj))]\n\n [1] \"mt-Co1\"  \"mt-Co3\"  \"mt-Cytb\" \"mt-Nd1\"  \"mt-Nd2\"  \"mt-Nd4\"  \"mt-Nd5\" \n [8] \"mt-Nd6\"  \"mt-Rnr1\" \"mt-Rnr2\" \"mt-Ta\"   \"mt-Tc\"   \"mt-Te\"   \"mt-Tf\"  \n[15] \"mt-Ti\"   \"mt-Tl1\"  \"mt-Tl2\"  \"mt-Tm\"   \"mt-Tn\"   \"mt-Tp\"   \"mt-Tq\"  \n[22] \"mt-Ts2\"  \"mt-Tt\"   \"mt-Tv\"   \"mt-Tw\"  \n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(cc135Obj, genePrefix = mitGenesPattern)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCells with a too high percentage of mitocondrial genes are likely dead (or at the last problematic) cells. So we drop them!\n\nmitPercThr &lt;- 10.0\ncc135Obj &lt;- addElementToMetaDataset(cc135Obj, \"Mitoc. perc. threshold\", mitPercThr)\n\ncells_to_rem &lt;- rownames(mitSizes)[mitSizes[[\"mit.percentage\"]] &gt; mitPercThr]\n\ncc135Obj &lt;- dropGenesCells(cc135Obj, cells = cells_to_rem)\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(cc135Obj, genePrefix = mitGenesPattern)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCheck no further outliers after all the culling\n\ncellSizePlot(cc135Obj)\n\n\n\n\n\n\n\ngenesSizePlot(cc135Obj)\n\n\n\n\n\n\n\n\n\nClean: round 1\n\ncc135Obj &lt;- clean(cc135Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot,\n  UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(cc135Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\n\nB group contains high number of hemoglobin genes: so they are not interesting\n\ncells_to_rem &lt;- rownames(pcaCellsData)[pcaCellsData[[\"groups\"]] == \"B\"]\n\ncc135Obj &lt;- dropGenesCells(cc135Obj, cells = cells_to_rem)\n\n\n\nClean: round 2\n\ncc135Obj &lt;- clean(cc135Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot,\n  UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(cc135Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(pcaCellsData)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\n\nB group contains just 3 cells quite different in the 3rd and 4th components: better to drop them\n\ncells_to_rem &lt;- rownames(pcaCellsData)[pcaCellsData[[\"groups\"]] == \"B\"]\n\ncc135Obj &lt;- dropGenesCells(cc135Obj, cells = cells_to_rem)\n\n\n\nClean: round 3\n\ncc135Obj &lt;- clean(cc135Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(cc135Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\ncc135Obj &lt;- addElementToMetaDataset(cc135Obj, \"Num drop B group\", 2)\n\nVisualize if all is ok:\n\nplot(UDEPlot)\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\n\n\nplot(zoomedNuPlot)\n\n\n\n\n\n\n\n\nDrop very low UDE cells as they are likely outliers\n\nlowUDEThr &lt;- 0.14 # the threshold to remove low UDE cells\n\ncc135Obj &lt;- addElementToMetaDataset(cc135Obj, \"Low UDE threshold\", lowUDEThr)\n\nnuDf &lt;- data.frame(\"nu\" = sort(getNu(cc135Obj)), \"n\" = seq_along(getNu(cc135Obj)))\n\n\ncells_to_rem &lt;- rownames(nuDf)[nuDf[[\"nu\"]] &lt; lowUDEThr]\ncc135Obj &lt;- dropGenesCells(cc135Obj, cells = cells_to_rem)\n\nFinal cleaning to check all is OK\n\ncc135Obj &lt;- clean(cc135Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(cc135Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\nplot(zoomedNuPlot)\n\n\n\n\n\n\n\nplot(cellSizePlot(cc135Obj))\n\n\n\n\n\n\n\nplot(genesSizePlot(cc135Obj))\n\n\n\n\n\n\n\n\n\ncc135Obj &lt;- proceedToCoex(cc135Obj, calcCoex = TRUE, cores = 12,\n                          saveObj = TRUE, outDir = outDir)\n\nSave the COTAN object\n\nsaveRDS(cc135Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "E13.5 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "CorticalCells_GSM2861511_E135-analysis.html#gdi",
    "href": "CorticalCells_GSM2861511_E135-analysis.html#gdi",
    "title": "Cortical cells DGE E13.5 Data-set Anaysis",
    "section": "GDI",
    "text": "GDI\n\ngdiData &lt;- calculateGDI(cc135Obj)\n\ngenesToLabel &lt;- head(rownames(gdiData[order(gdiData[[\"GDI\"]],\n                                            decreasing = TRUE), ]), n = 10L)\n\ngenesToLabel\n\n [1] \"Neurod6\"       \"2610017I09Rik\" \"Nr2e1\"         \"Ina\"          \n [5] \"Sox2\"          \"Stmn2\"         \"Mdk\"           \"Mapt\"         \n [9] \"Gas1\"          \"2810417H13Rik\"\n\ngdiPlot &lt;- GDIPlot(cc135Obj, GDIIn = gdiData, GDIThreshold = 1.4,\n                   genes = list(\"Top 10 GDI genes\" = genesToLabel))\n\nplot(gdiPlot)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "E13.5 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "CorticalCells_GSM2861511_E135-analysis.html#consistent-transcript-cohorts",
    "href": "CorticalCells_GSM2861511_E135-analysis.html#consistent-transcript-cohorts",
    "title": "Cortical cells DGE E13.5 Data-set Anaysis",
    "section": "Consistent Transcript Cohorts",
    "text": "Consistent Transcript Cohorts\n\nc(splitClusters, splitCoexDF) %&lt;-% \n  cellsUniformClustering(cc135Obj, GDIThreshold = 1.4, cores = 13,\n                         saveObj = TRUE, outDir = outDir)\n\n\ncc135Obj &lt;- addClusterization(cc135Obj, clName = \"split\",\n                              clusters = splitClusters,\n                              coexDF = splitCoexDF, override = TRUE)\n\n\ntable(splitClusters)\n\nsplitClusters\n -1  01  02  03  04  05  06  07  08  09  10  11  12  13  14 \n  6  94 106  47  69 127  92  11  25  12  41 113  59 161 149 \n\n\n\nsaveRDS(cc135Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\nc(mergedClusters, mergedCoexDF) %&lt;-%\n  mergeUniformCellsClusters(cc135Obj, clusters = splitClusters,\n                            GDIThreshold = 1.4, cores = 13,\n                            saveObj = TRUE, outDir = outDir)\n\ncc135Obj &lt;- addClusterization(cc135Obj, clName = \"merge\",\n                              clusters = mergedClusters,\n                              coexDF = mergedCoexDF,\n                              override = TRUE)\n\n\ntable(mergedClusters)\n\nmergedClusters\n  1   2   3   4   5   6   7   8   9 \n 94 153 161 127 113 102  52 161 149 \n\n\n\nsaveRDS(cc135Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\n\nSys.time()\n\n[1] \"2023-08-22 17:55:23 CEST\"\n\n\n\nsessionInfo()\n\nR version 4.3.1 (2023-06-16)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] COTAN_2.1.7   zeallot_0.1.0 tibble_3.2.1  ggplot2_3.4.2\n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3     rstudioapi_0.15.0      jsonlite_1.8.7        \n  [4] shape_1.4.6            umap_0.2.10.0          magrittr_2.0.3        \n  [7] spatstat.utils_3.0-3   farver_2.1.1           rmarkdown_2.24        \n [10] GlobalOptions_0.1.2    vctrs_0.6.3            ROCR_1.0-11           \n [13] spatstat.explore_3.2-1 askpass_1.1            htmltools_0.5.5       \n [16] sctransform_0.3.5      parallelly_1.36.0      KernSmooth_2.23-22    \n [19] htmlwidgets_1.6.2      ica_1.0-3              plyr_1.8.8            \n [22] plotly_4.10.2          zoo_1.8-12             igraph_1.5.1          \n [25] mime_0.12              lifecycle_1.0.3        iterators_1.0.14      \n [28] pkgconfig_2.0.3        Matrix_1.6-0           R6_2.5.1              \n [31] fastmap_1.1.1          fitdistrplus_1.1-11    future_1.33.0         \n [34] shiny_1.7.5            clue_0.3-64            digest_0.6.33         \n [37] colorspace_2.1-0       patchwork_1.1.2        S4Vectors_0.38.1      \n [40] Seurat_4.3.0.1         tensor_1.5             RSpectra_0.16-1       \n [43] irlba_2.3.5.1          labeling_0.4.2         progressr_0.14.0      \n [46] RcppZiggurat_0.1.6     fansi_1.0.4            spatstat.sparse_3.0-2 \n [49] httr_1.4.6             polyclip_1.10-4        abind_1.4-5           \n [52] compiler_4.3.1         withr_2.5.0            doParallel_1.0.17     \n [55] viridis_0.6.4          dendextend_1.17.1      MASS_7.3-60           \n [58] openssl_2.1.0          rjson_0.2.21           tools_4.3.1           \n [61] lmtest_0.9-40          httpuv_1.6.11          future.apply_1.11.0   \n [64] goftest_1.2-3          glue_1.6.2             nlme_3.1-162          \n [67] promises_1.2.0.1       grid_4.3.1             Rtsne_0.16            \n [70] cluster_2.1.4          reshape2_1.4.4         generics_0.1.3        \n [73] gtable_0.3.3           spatstat.data_3.0-1    tidyr_1.3.0           \n [76] data.table_1.14.8      sp_2.0-0               utf8_1.2.3            \n [79] BiocGenerics_0.46.0    spatstat.geom_3.2-4    RcppAnnoy_0.0.21      \n [82] ggrepel_0.9.3          RANN_2.6.1             foreach_1.5.2         \n [85] pillar_1.9.0           stringr_1.5.0          later_1.3.1           \n [88] circlize_0.4.15        splines_4.3.1          dplyr_1.1.2           \n [91] lattice_0.21-8         survival_3.5-5         deldir_1.0-9          \n [94] tidyselect_1.2.0       ComplexHeatmap_2.16.0  miniUI_0.1.1.1        \n [97] pbapply_1.7-2          knitr_1.43             gridExtra_2.3         \n[100] IRanges_2.34.1         scattermore_1.2        stats4_4.3.1          \n[103] xfun_0.39              factoextra_1.0.7       matrixStats_1.0.0     \n[106] stringi_1.7.12         lazyeval_0.2.2         yaml_2.3.7            \n[109] evaluate_0.21          codetools_0.2-19       cli_3.6.1             \n[112] RcppParallel_5.1.7     uwot_0.1.16            xtable_1.8-4          \n[115] reticulate_1.30        munsell_0.5.0          Rcpp_1.0.11           \n[118] globals_0.16.2         spatstat.random_3.1-5  png_0.1-8             \n[121] parallel_4.3.1         Rfast_2.0.8            ellipsis_0.3.2        \n[124] assertthat_0.2.1       parallelDist_0.2.6     listenv_0.9.0         \n[127] ggthemes_4.2.4         viridisLite_0.4.2      scales_1.2.1          \n[130] ggridges_0.5.4         SeuratObject_4.1.3     leiden_0.4.3          \n[133] purrr_1.0.1            crayon_1.5.2           GetoptLong_1.0.5      \n[136] rlang_1.1.1            cowplot_1.1.1",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "E13.5 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "PBMC3_filtering.html",
    "href": "PBMC3_filtering.html",
    "title": "Filtering of PBMC3 using COTAN",
    "section": "",
    "text": "Library import\n\nlibrary(dplyr)\nlibrary(COTAN)\nlibrary(Seurat)\nlibrary(tibble)\nlibrary(ggplot2)\nlibrary(zeallot)\nlibrary(DropletUtils)\n\nSettings\n\ndatasetName = 'PBMC3'\ndatasetFolder = './Data/'\n\ninDir  = paste(datasetFolder, datasetName, '/raw/10X/', sep='')\noutDir = paste(datasetFolder, datasetName, '/filtered/', sep='')\ndir10X = paste(outDir, '10X/', sep='')\n\nif (!dir.exists(outDir)) {\n  dir.create(outDir, recursive = TRUE, showWarnings = FALSE)\n}\n\nsetLoggingLevel(2)\nsetLoggingFile(paste(outDir, \"logfile.log\", sep=\"\"))\noptions(parallelly.fork.enable = TRUE)\n\nData loading\n\ndataset = Read10X(data.dir = inDir, strip.suffix = TRUE)\ndataset = dataset[[1]]\nsampleCond &lt;- datasetName\nPBMC3 &lt;- COTAN(raw = dataset)\nPBMC3 &lt;- initializeMetaDataset(\n  PBMC3,\n  GEO = paste(\"10X \", datasetName, sep=\"\"),\n  sequencingMethod = \"10X\",\n  sampleCond = sampleCond\n)\n\nInspect cells’ sizes\n\ncellSizePlot(PBMC3)\n\n\n\n\n\n\n\n\nDrop cells with too many reads as they are probably doublets\n\ncellsSizeThr &lt;- 20000\nPBMC3 &lt;- addElementToMetaDataset(PBMC3, \"Cells size threshold\", cellsSizeThr)\n\ncellsToRem &lt;- getCells(PBMC3)[getCellsSize(PBMC3) &gt; cellsSizeThr]\nPBMC3 &lt;- dropGenesCells(PBMC3, cells = cellsToRem)\n\ncellSizePlot(PBMC3, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nInspect the number of expressed genes per cell\n\ngenesSizePlot(PBMC3, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nDrop cells with too high genes expression as they are probably doublets\n\ngeneSizeThr &lt;- 3500\nPBMC3 &lt;- addElementToMetaDataset(PBMC3, \"Num genes threshold\", geneSizeThr)\n\nnumExprGenes &lt;- getNumExpressedGenes(PBMC3)\ncellsToRem &lt;- names(numExprGenes)[numExprGenes &gt; geneSizeThr]\nPBMC3 &lt;- dropGenesCells(PBMC3, cells = cellsToRem)\n\ngenesSizePlot(PBMC3, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nCheck number of mithocondrial genes expressed in each cell\n\nmitGenesPattern &lt;- \"^[Mm][Tt]-\"\ngetGenes(PBMC3)[grep(mitGenesPattern, getGenes(PBMC3))]\n\n [1] \"MT-ND1\"  \"MT-ND2\"  \"MT-CO1\"  \"MT-CO2\"  \"MT-ATP8\" \"MT-ATP6\" \"MT-CO3\" \n [8] \"MT-ND3\"  \"MT-ND4L\" \"MT-ND4\"  \"MT-ND5\"  \"MT-ND6\"  \"MT-CYB\" \n\n\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(PBMC3, genePrefix = mitGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nWe drop cells with a too high percentage of mitocondrial genes (are likely dead)\n\nmitPercThr &lt;- 10\nPBMC3 &lt;- addElementToMetaDataset(PBMC3, \"Mitoc. perc. threshold\", mitPercThr)\n\ncellsToRem &lt;- rownames(mitSizes)[mitSizes[[\"mit.percentage\"]] &gt; mitPercThr]\n\nPBMC3 &lt;- dropGenesCells(PBMC3, cells = cellsToRem)\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(PBMC3, genePrefix = mitGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCheck number of ribosomial genes expressed in each cell\n\nribGenesPattern &lt;- \"^RP[SL]\\\\d+\"\ngetGenes(PBMC3)[grep(ribGenesPattern, getGenes(PBMC3))]\n\n  [1] \"RPL22\"          \"RPL11\"          \"RPS6KA1\"        \"RPS8\"          \n  [5] \"RPL5\"           \"RPS27\"          \"RPS6KC1\"        \"RPS7\"          \n  [9] \"RPS27A\"         \"RPL31\"          \"RPL37A\"         \"RPL32\"         \n [13] \"RPL15\"          \"RPL14\"          \"RPL29\"          \"RPL24\"         \n [17] \"RPL22L1\"        \"RPL39L\"         \"RPL35A\"         \"RPL9\"          \n [21] \"RPL34-AS1\"      \"RPL34\"          \"RPS3A\"          \"RPL37\"         \n [25] \"RPS23\"          \"RPS14\"          \"RPL26L1\"        \"RPS18\"         \n [29] \"RPS10-NUDT3\"    \"RPS10\"          \"RPL10A\"         \"RPL7L1\"        \n [33] \"RPS12\"          \"RPS6KA2\"        \"RPS6KA2-AS1\"    \"RPS6KA3\"       \n [37] \"RPS4X\"          \"RPS6KA6\"        \"RPL36A\"         \"RPL36A-HNRNPH2\"\n [41] \"RPL39\"          \"RPL10\"          \"RPS20\"          \"RPL7\"          \n [45] \"RPL30\"          \"RPL8\"           \"RPS6\"           \"RPL35\"         \n [49] \"RPL12\"          \"RPL7A\"          \"RPL27A\"         \"RPS13\"         \n [53] \"RPS6KA4\"        \"RPS6KB2\"        \"RPS6KB2-AS1\"    \"RPS3\"          \n [57] \"RPS25\"          \"RPS24\"          \"RPS26\"          \"RPL41\"         \n [61] \"RPL6\"           \"RPL21\"          \"RPL10L\"         \"RPS29\"         \n [65] \"RPL36AL\"        \"RPS6KL1\"        \"RPS6KA5\"        \"RPS27L\"        \n [69] \"RPL4\"           \"RPS17\"          \"RPL3L\"          \"RPS2\"          \n [73] \"RPS15A\"         \"RPL13\"          \"RPL26\"          \"RPL23A\"        \n [77] \"RPL23\"          \"RPL19\"          \"RPL27\"          \"RPS6KB1\"       \n [81] \"RPL38\"          \"RPL17-C18orf32\" \"RPL17\"          \"RPS21\"         \n [85] \"RPS15\"          \"RPL36\"          \"RPS28\"          \"RPL18A\"        \n [89] \"RPS16\"          \"RPS19\"          \"RPL18\"          \"RPL13A\"        \n [93] \"RPS11\"          \"RPS9\"           \"RPL28\"          \"RPS5\"          \n [97] \"RPS4Y1\"         \"RPS4Y2\"         \"RPL3\"           \"RPS19BP1\"      \n\n\n\nc(ribPlot, ribSizes) %&lt;-%\n  mitochondrialPercentagePlot(PBMC3, genePrefix = ribGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(ribPlot)\n\n\n\n\n\n\n\n\nCheck no further outliers after all the culling\n\ncellSizePlot(PBMC3, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\n\ngenesSizePlot(PBMC3, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nCleaning, round 1\n\nPBMC3 &lt;- clean(PBMC3)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(PBMC3)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\n\n\nPBMC3 &lt;- addElementToMetaDataset(PBMC3, \"Num drop B group\", 0)\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\n\n\nplot(zoomedNuPlot)  \n\n\n\n\n\n\n\n\n\nyset=0.16\nnuDf &lt;- data.frame(\"nu\" = sort(getNu(PBMC3)), \"n\" = seq_along(getNu(PBMC3)))\nPBMC3 &lt;- addElementToMetaDataset(PBMC3, \"Threshold low UDE cells:\", yset)\ncellsToRem &lt;-rownames(nuDf)[nuDf[[\"nu\"]] &lt; yset]\nPBMC3 &lt;- dropGenesCells(PBMC3, cells = cellsToRem)\n\nCleaning, round 2\n\nPBMC3 &lt;- clean(PBMC3)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(PBMC3)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\n\n\nplot(pcaCellsData)\n\n\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\n\n\nplot(zoomedNuPlot)\n\n\n\n\n\n\n\n\n\nplot(cellSizePlot(PBMC3, splitPattern = \"-\", numCol = 2))\n\n\n\n\n\n\n\n\n\nplot(genesSizePlot(PBMC3, splitPattern = \"-\", numCol = 2))\n\n\n\n\n\n\n\n\nSave the filtered dataset\n\nif (!dir.exists(dir10X)) {\n  write10xCounts(dir10X, getRawData(PBMC3))\n}\n\n\nsaveRDS(PBMC3, file = paste0(outDir, sampleCond, \".cotan.RDS\"))\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] DropletUtils_1.20.0         SingleCellExperiment_1.22.0\n [3] SummarizedExperiment_1.30.2 Biobase_2.60.0             \n [5] GenomicRanges_1.52.0        GenomeInfoDb_1.36.1        \n [7] IRanges_2.34.1              S4Vectors_0.38.1           \n [9] BiocGenerics_0.46.0         MatrixGenerics_1.12.3      \n[11] matrixStats_1.2.0           zeallot_0.1.0              \n[13] ggplot2_3.4.2               tibble_3.2.1               \n[15] Seurat_5.0.0                SeuratObject_5.0.0         \n[17] sp_2.1-1                    COTAN_2.3.0                \n[19] dplyr_1.1.2                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               bitops_1.0-7             \n  [5] R.oo_1.25.0               polyclip_1.10-4          \n  [7] fastDummies_1.7.3         lifecycle_1.0.3          \n  [9] edgeR_3.42.4              doParallel_1.0.17        \n [11] globals_0.16.2            lattice_0.22-5           \n [13] MASS_7.3-60               dendextend_1.17.1        \n [15] magrittr_2.0.3            limma_3.56.2             \n [17] plotly_4.10.2             rmarkdown_2.24           \n [19] yaml_2.3.7                httpuv_1.6.11            \n [21] sctransform_0.4.1         spam_2.10-0              \n [23] askpass_1.2.0             spatstat.sparse_3.0-2    \n [25] reticulate_1.34.0         cowplot_1.1.1            \n [27] pbapply_1.7-2             RColorBrewer_1.1-3       \n [29] zlibbioc_1.46.0           abind_1.4-5              \n [31] Rtsne_0.16                R.utils_2.12.2           \n [33] purrr_1.0.1               RCurl_1.98-1.12          \n [35] circlize_0.4.15           GenomeInfoDbData_1.2.10  \n [37] ggrepel_0.9.3             irlba_2.3.5.1            \n [39] listenv_0.9.0             spatstat.utils_3.0-3     \n [41] umap_0.2.10.0             goftest_1.2-3            \n [43] RSpectra_0.16-1           spatstat.random_3.2-1    \n [45] dqrng_0.3.0               fitdistrplus_1.1-11      \n [47] parallelly_1.36.0         DelayedMatrixStats_1.22.5\n [49] leiden_0.4.3              codetools_0.2-19         \n [51] DelayedArray_0.26.7       scuttle_1.10.2           \n [53] tidyselect_1.2.0          shape_1.4.6              \n [55] farver_2.1.1              ScaledMatrix_1.8.1       \n [57] viridis_0.6.4             spatstat.explore_3.2-1   \n [59] jsonlite_1.8.7            GetoptLong_1.0.5         \n [61] ellipsis_0.3.2            progressr_0.14.0         \n [63] ggridges_0.5.4            survival_3.5-7           \n [65] iterators_1.0.14          foreach_1.5.2            \n [67] tools_4.3.2               ica_1.0-3                \n [69] Rcpp_1.0.11               glue_1.6.2               \n [71] gridExtra_2.3             xfun_0.39                \n [73] ggthemes_5.0.0            HDF5Array_1.28.1         \n [75] withr_2.5.0               fastmap_1.1.1            \n [77] rhdf5filters_1.12.1       fansi_1.0.4              \n [79] openssl_2.1.0             digest_0.6.33            \n [81] rsvd_1.0.5                parallelDist_0.2.6       \n [83] R6_2.5.1                  mime_0.12                \n [85] colorspace_2.1-0          scattermore_1.2          \n [87] tensor_1.5                spatstat.data_3.0-1      \n [89] R.methodsS3_1.8.2         utf8_1.2.3               \n [91] tidyr_1.3.0               generics_0.1.3           \n [93] data.table_1.14.8         httr_1.4.6               \n [95] htmlwidgets_1.6.2         S4Arrays_1.2.0           \n [97] uwot_0.1.16               pkgconfig_2.0.3          \n [99] gtable_0.3.3              ComplexHeatmap_2.16.0    \n[101] lmtest_0.9-40             XVector_0.40.0           \n[103] htmltools_0.5.7           dotCall64_1.1-0          \n[105] clue_0.3-64               scales_1.3.0             \n[107] png_0.1-8                 knitr_1.43               \n[109] rstudioapi_0.15.0         reshape2_1.4.4           \n[111] rjson_0.2.21              nlme_3.1-163             \n[113] rhdf5_2.44.0              zoo_1.8-12               \n[115] GlobalOptions_0.1.2       stringr_1.5.0            \n[117] KernSmooth_2.23-22        parallel_4.3.2           \n[119] miniUI_0.1.1.1            RcppZiggurat_0.1.6       \n[121] pillar_1.9.0              grid_4.3.2               \n[123] vctrs_0.6.3               RANN_2.6.1               \n[125] promises_1.2.0.1          BiocSingular_1.16.0      \n[127] beachmat_2.16.0           xtable_1.8-4             \n[129] cluster_2.1.6             evaluate_0.21            \n[131] locfit_1.5-9.8            cli_3.6.1                \n[133] compiler_4.3.2            rlang_1.1.1              \n[135] crayon_1.5.2              future.apply_1.11.0      \n[137] labeling_0.4.2            plyr_1.8.8               \n[139] stringi_1.8.1             viridisLite_0.4.2        \n[141] deldir_2.0-2              BiocParallel_1.34.2      \n[143] assertthat_0.2.1          munsell_0.5.0            \n[145] lazyeval_0.2.2            spatstat.geom_3.2-4      \n[147] PCAtools_2.14.0           Matrix_1.6-3             \n[149] RcppHNSW_0.5.0            patchwork_1.1.2          \n[151] sparseMatrixStats_1.12.2  future_1.33.0            \n[153] Rhdf5lib_1.22.0           shiny_1.8.0              \n[155] ROCR_1.0-11               Rfast_2.1.0              \n[157] igraph_1.6.0              RcppParallel_5.1.7",
    "crumbs": [
      "Datasets",
      "PBMC form 10X site",
      "Cleaning PBMC3"
    ]
  },
  {
    "objectID": "PBMC1_filtering.html",
    "href": "PBMC1_filtering.html",
    "title": "Filtering of PBMC1 using COTAN",
    "section": "",
    "text": "Library import\n\nlibrary(dplyr)\nlibrary(COTAN)\nlibrary(Seurat)\nlibrary(tibble)\nlibrary(ggplot2)\nlibrary(zeallot)\nlibrary(DropletUtils)\n\nSettings\n\ndatasetName = 'PBMC1'\ndatasetFolder = './Data/'\n\ninDir  = paste(datasetFolder, datasetName, '/raw/10X/', sep='')\noutDir = paste(datasetFolder, datasetName, '/filtered/', sep='')\ndir10X = paste(outDir, '10X/', sep='')\n\nif (!dir.exists(outDir)) {\n  dir.create(outDir, recursive = TRUE, showWarnings = FALSE)\n}\n\nsetLoggingLevel(2)\nsetLoggingFile(paste(outDir, \"logfile.log\", sep=\"\"))\noptions(parallelly.fork.enable = TRUE)\n\nData loading\n\ndataset = Read10X(data.dir = inDir, strip.suffix = TRUE)\ndataset = dataset[[1]]\nsampleCond &lt;- datasetName\nPBMC1 &lt;- COTAN(raw = dataset)\nPBMC1 &lt;- initializeMetaDataset(\n  PBMC1,\n  GEO = paste(\"10X \", datasetName, sep=\"\"),\n  sequencingMethod = \"10X\",\n  sampleCond = sampleCond\n)\n\nInspect cells’ sizes\n\ncellSizePlot(PBMC1)\n\n\n\n\n\n\n\n\nDrop cells with too many reads as they are probably doublets\n\ncellsSizeThr &lt;- 25000\nPBMC1 &lt;- addElementToMetaDataset(PBMC1, \"Cells size threshold\", cellsSizeThr)\n\ncellsToRem &lt;- getCells(PBMC1)[getCellsSize(PBMC1) &gt; cellsSizeThr]\nPBMC1 &lt;- dropGenesCells(PBMC1, cells = cellsToRem)\n\ncellSizePlot(PBMC1, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nInspect the number of expressed genes per cell\n\ngenesSizePlot(PBMC1, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nDrop cells with too high genes expression as they are probably doublets\n\ngeneSizeThr &lt;- 4500\nPBMC1 &lt;- addElementToMetaDataset(PBMC1, \"Num genes threshold\", geneSizeThr)\n\nnumExprGenes &lt;- getNumExpressedGenes(PBMC1)\ncellsToRem &lt;- names(numExprGenes)[numExprGenes &gt; geneSizeThr]\nPBMC1 &lt;- dropGenesCells(PBMC1, cells = cellsToRem)\n\ngenesSizePlot(PBMC1, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nCheck number of mithocondrial genes expressed in each cell\n\nmitGenesPattern &lt;- \"^[Mm][Tt]-\"\ngetGenes(PBMC1)[grep(mitGenesPattern, getGenes(PBMC1))]\n\n [1] \"MT-ND1\"  \"MT-ND2\"  \"MT-CO1\"  \"MT-CO2\"  \"MT-ATP8\" \"MT-ATP6\" \"MT-CO3\" \n [8] \"MT-ND3\"  \"MT-ND4L\" \"MT-ND4\"  \"MT-ND5\"  \"MT-ND6\"  \"MT-CYB\" \n\n\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(PBMC1, genePrefix = mitGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nWe drop cells with a too high percentage of mitocondrial genes (are likely dead)\n\nmitPercThr &lt;- 10\nPBMC1 &lt;- addElementToMetaDataset(PBMC1, \"Mitoc. perc. threshold\", mitPercThr)\n\ncellsToRem &lt;- rownames(mitSizes)[mitSizes[[\"mit.percentage\"]] &gt; mitPercThr]\n\nPBMC1 &lt;- dropGenesCells(PBMC1, cells = cellsToRem)\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(PBMC1, genePrefix = mitGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCheck number of ribosomial genes expressed in each cell\n\nribGenesPattern &lt;- \"^RP[SL]\\\\d+\"\ngetGenes(PBMC1)[grep(ribGenesPattern, getGenes(PBMC1))]\n\n  [1] \"RPL22\"          \"RPL11\"          \"RPS6KA1\"        \"RPS8\"          \n  [5] \"RPL5\"           \"RPS27\"          \"RPS6KC1\"        \"RPS7\"          \n  [9] \"RPS27A\"         \"RPL31\"          \"RPL37A\"         \"RPL32\"         \n [13] \"RPL15\"          \"RPL14\"          \"RPL29\"          \"RPL24\"         \n [17] \"RPL22L1\"        \"RPL39L\"         \"RPL35A\"         \"RPL9\"          \n [21] \"RPL34-AS1\"      \"RPL34\"          \"RPS3A\"          \"RPL37\"         \n [25] \"RPS23\"          \"RPS14\"          \"RPL26L1\"        \"RPS18\"         \n [29] \"RPS10-NUDT3\"    \"RPS10\"          \"RPL10A\"         \"RPL7L1\"        \n [33] \"RPS12\"          \"RPS6KA2\"        \"RPS6KA2-AS1\"    \"RPS6KA3\"       \n [37] \"RPS4X\"          \"RPS6KA6\"        \"RPL36A\"         \"RPL36A-HNRNPH2\"\n [41] \"RPL39\"          \"RPL10\"          \"RPS20\"          \"RPL7\"          \n [45] \"RPL30\"          \"RPL8\"           \"RPS6\"           \"RPL35\"         \n [49] \"RPL12\"          \"RPL7A\"          \"RPL27A\"         \"RPS13\"         \n [53] \"RPS6KA4\"        \"RPS6KB2\"        \"RPS6KB2-AS1\"    \"RPS3\"          \n [57] \"RPS25\"          \"RPS24\"          \"RPS26\"          \"RPL41\"         \n [61] \"RPL6\"           \"RPL21\"          \"RPL10L\"         \"RPS29\"         \n [65] \"RPL36AL\"        \"RPS6KL1\"        \"RPS6KA5\"        \"RPS27L\"        \n [69] \"RPL4\"           \"RPS17\"          \"RPL3L\"          \"RPS2\"          \n [73] \"RPS15A\"         \"RPL13\"          \"RPL26\"          \"RPL23A\"        \n [77] \"RPL23\"          \"RPL19\"          \"RPL27\"          \"RPS6KB1\"       \n [81] \"RPL38\"          \"RPL17-C18orf32\" \"RPL17\"          \"RPS21\"         \n [85] \"RPS15\"          \"RPL36\"          \"RPS28\"          \"RPL18A\"        \n [89] \"RPS16\"          \"RPS19\"          \"RPL18\"          \"RPL13A\"        \n [93] \"RPS11\"          \"RPS9\"           \"RPL28\"          \"RPS5\"          \n [97] \"RPS4Y1\"         \"RPS4Y2\"         \"RPL3\"           \"RPS19BP1\"      \n\n\n\nc(ribPlot, ribSizes) %&lt;-%\n  mitochondrialPercentagePlot(PBMC1, genePrefix = ribGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(ribPlot)\n\n\n\n\n\n\n\n\nCheck no further outliers after all the culling\n\ncellSizePlot(PBMC1, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\n\ngenesSizePlot(PBMC1, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nCleaning, round 1\n\nPBMC1 &lt;- clean(PBMC1)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(PBMC1)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\n\n\nPBMC1 &lt;- addElementToMetaDataset(PBMC1, \"Num drop B group\", 0)\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\n\n\nplot(zoomedNuPlot)  \n\n\n\n\n\n\n\n\n\nyset=0.16\nnuDf &lt;- data.frame(\"nu\" = sort(getNu(PBMC1)), \"n\" = seq_along(getNu(PBMC1)))\nPBMC1 &lt;- addElementToMetaDataset(PBMC1, \"Threshold low UDE cells:\", yset)\ncellsToRem &lt;-rownames(nuDf)[nuDf[[\"nu\"]] &lt; yset]\nPBMC1 &lt;- dropGenesCells(PBMC1, cells = cellsToRem)\n\nCleaning, round 2\n\nPBMC1 &lt;- clean(PBMC1)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(PBMC1)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\n\n\nplot(pcaCellsData)\n\n\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\n\n\nplot(zoomedNuPlot)\n\n\n\n\n\n\n\n\n\nplot(cellSizePlot(PBMC1, splitPattern = \"-\", numCol = 2))\n\n\n\n\n\n\n\n\n\nplot(genesSizePlot(PBMC1, splitPattern = \"-\", numCol = 2))\n\n\n\n\n\n\n\n\nSave the filtered dataset\n\nif (!dir.exists(dir10X)) {\n  write10xCounts(dir10X, getRawData(PBMC1))\n}\n\n\nsaveRDS(PBMC1, file = paste0(outDir, sampleCond, \".cotan.RDS\"))\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] DropletUtils_1.20.0         SingleCellExperiment_1.22.0\n [3] SummarizedExperiment_1.30.2 Biobase_2.60.0             \n [5] GenomicRanges_1.52.0        GenomeInfoDb_1.36.1        \n [7] IRanges_2.34.1              S4Vectors_0.38.1           \n [9] BiocGenerics_0.46.0         MatrixGenerics_1.12.3      \n[11] matrixStats_1.2.0           zeallot_0.1.0              \n[13] ggplot2_3.4.2               tibble_3.2.1               \n[15] Seurat_5.0.0                SeuratObject_5.0.0         \n[17] sp_2.1-1                    COTAN_2.3.0                \n[19] dplyr_1.1.2                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               bitops_1.0-7             \n  [5] R.oo_1.25.0               polyclip_1.10-4          \n  [7] fastDummies_1.7.3         lifecycle_1.0.3          \n  [9] edgeR_3.42.4              doParallel_1.0.17        \n [11] globals_0.16.2            lattice_0.22-5           \n [13] MASS_7.3-60               dendextend_1.17.1        \n [15] magrittr_2.0.3            limma_3.56.2             \n [17] plotly_4.10.2             rmarkdown_2.24           \n [19] yaml_2.3.7                httpuv_1.6.11            \n [21] sctransform_0.4.1         spam_2.10-0              \n [23] askpass_1.2.0             spatstat.sparse_3.0-2    \n [25] reticulate_1.34.0         cowplot_1.1.1            \n [27] pbapply_1.7-2             RColorBrewer_1.1-3       \n [29] zlibbioc_1.46.0           abind_1.4-5              \n [31] Rtsne_0.16                R.utils_2.12.2           \n [33] purrr_1.0.1               RCurl_1.98-1.12          \n [35] circlize_0.4.15           GenomeInfoDbData_1.2.10  \n [37] ggrepel_0.9.3             irlba_2.3.5.1            \n [39] listenv_0.9.0             spatstat.utils_3.0-3     \n [41] umap_0.2.10.0             goftest_1.2-3            \n [43] RSpectra_0.16-1           spatstat.random_3.2-1    \n [45] dqrng_0.3.0               fitdistrplus_1.1-11      \n [47] parallelly_1.36.0         DelayedMatrixStats_1.22.5\n [49] leiden_0.4.3              codetools_0.2-19         \n [51] DelayedArray_0.26.7       scuttle_1.10.2           \n [53] tidyselect_1.2.0          shape_1.4.6              \n [55] farver_2.1.1              ScaledMatrix_1.8.1       \n [57] viridis_0.6.4             spatstat.explore_3.2-1   \n [59] jsonlite_1.8.7            GetoptLong_1.0.5         \n [61] ellipsis_0.3.2            progressr_0.14.0         \n [63] ggridges_0.5.4            survival_3.5-7           \n [65] iterators_1.0.14          foreach_1.5.2            \n [67] tools_4.3.2               ica_1.0-3                \n [69] Rcpp_1.0.11               glue_1.6.2               \n [71] gridExtra_2.3             xfun_0.39                \n [73] ggthemes_5.0.0            HDF5Array_1.28.1         \n [75] withr_2.5.0               fastmap_1.1.1            \n [77] rhdf5filters_1.12.1       fansi_1.0.4              \n [79] openssl_2.1.0             digest_0.6.33            \n [81] rsvd_1.0.5                parallelDist_0.2.6       \n [83] R6_2.5.1                  mime_0.12                \n [85] colorspace_2.1-0          scattermore_1.2          \n [87] tensor_1.5                spatstat.data_3.0-1      \n [89] R.methodsS3_1.8.2         utf8_1.2.3               \n [91] tidyr_1.3.0               generics_0.1.3           \n [93] data.table_1.14.8         httr_1.4.6               \n [95] htmlwidgets_1.6.2         S4Arrays_1.2.0           \n [97] uwot_0.1.16               pkgconfig_2.0.3          \n [99] gtable_0.3.3              ComplexHeatmap_2.16.0    \n[101] lmtest_0.9-40             XVector_0.40.0           \n[103] htmltools_0.5.7           dotCall64_1.1-0          \n[105] clue_0.3-64               scales_1.3.0             \n[107] png_0.1-8                 knitr_1.43               \n[109] rstudioapi_0.15.0         reshape2_1.4.4           \n[111] rjson_0.2.21              nlme_3.1-163             \n[113] rhdf5_2.44.0              zoo_1.8-12               \n[115] GlobalOptions_0.1.2       stringr_1.5.0            \n[117] KernSmooth_2.23-22        parallel_4.3.2           \n[119] miniUI_0.1.1.1            RcppZiggurat_0.1.6       \n[121] pillar_1.9.0              grid_4.3.2               \n[123] vctrs_0.6.3               RANN_2.6.1               \n[125] promises_1.2.0.1          BiocSingular_1.16.0      \n[127] beachmat_2.16.0           xtable_1.8-4             \n[129] cluster_2.1.6             evaluate_0.21            \n[131] locfit_1.5-9.8            cli_3.6.1                \n[133] compiler_4.3.2            rlang_1.1.1              \n[135] crayon_1.5.2              future.apply_1.11.0      \n[137] labeling_0.4.2            plyr_1.8.8               \n[139] stringi_1.8.1             viridisLite_0.4.2        \n[141] deldir_2.0-2              BiocParallel_1.34.2      \n[143] assertthat_0.2.1          munsell_0.5.0            \n[145] lazyeval_0.2.2            spatstat.geom_3.2-4      \n[147] PCAtools_2.14.0           Matrix_1.6-3             \n[149] RcppHNSW_0.5.0            patchwork_1.1.2          \n[151] sparseMatrixStats_1.12.2  future_1.33.0            \n[153] Rhdf5lib_1.22.0           shiny_1.8.0              \n[155] ROCR_1.0-11               Rfast_2.1.0              \n[157] igraph_1.6.0              RcppParallel_5.1.7",
    "crumbs": [
      "Datasets",
      "PBMC form 10X site",
      "Cleaning PBMC1"
    ]
  },
  {
    "objectID": "probability_score.html",
    "href": "probability_score.html",
    "title": "Probability score computation",
    "section": "",
    "text": "library(rlang)\nlibrary(testthat)\nlibrary(ggplot2)\nlibrary(tibble)\nlibrary(zeallot)\nlibrary(Seurat)\nlibrary(aricode)\nlibrary(funtimes)\nlibrary(monocle3)\nlibrary(cluster)\nlibrary(COTAN)\n\ntunings = c('default', 'antibody', 'celltypist')\ntools = c('monocle', 'scanpy', 'seurat', 'scvi-tools', 'COTAN')\n\n\naverageClustersDistance &lt;- function(probMatrixDF,\n                                    clustersList, numDim) {\n  \n  squareDist &lt;- function(subMatrix) {\n    subMatrix &lt;- scale(subMatrix, scale = FALSE, center = TRUE)\n    return(sum(rowSums(subMatrix^2)))\n}\n  \n  pca &lt;- PCAtools::pca(mat = probMatrixDF, rank = numDim, transposed = TRUE)\n\n  residual_variance = 100 - sum(pca[[\"variance\"]])\n\n  normMatrix &lt;- scale(x = pca[[\"rotated\"]], center = TRUE, scale = TRUE)\n  rownames(normMatrix) &lt;- rownames(probMatrixDF)\n\n  final_dimensions = dim(normMatrix)[2]\n\n  sumDist &lt;- 0.0\n  for (cl in clustersList) {\n    sumDist &lt;- sumDist + squareDist(normMatrix[cl, , drop = FALSE])\n  }\n  score = sumDist / ncol(normMatrix) / (nrow(normMatrix) - length(clustersList))\n  return(list(\"residual_variance\" = residual_variance, \"final_dimensions\" = final_dimensions, \"score\" = score))\n}",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs probability score"
    ]
  },
  {
    "objectID": "probability_score.html#pbmc1",
    "href": "probability_score.html#pbmc1",
    "title": "Probability score computation",
    "section": "PBMC1",
    "text": "PBMC1\n\ndataset = 'PBMC1'\ncelltypistPath = paste('Data/', dataset, '/celltypist/Immune_All_Low_probability_matrix.csv', sep='')\noutPath = paste('Data/', dataset, '/probabilistic_score.csv', sep='')\n\nLoad CellTypist clusterization\n\nprobMatrixDF &lt;- read.csv(celltypistPath, header = TRUE)\nprobMatrixDF &lt;- column_to_rownames(probMatrixDF, var = \"X\")\nrownames(probMatrixDF) &lt;- gsub(\"[.]\", \":\", rownames(probMatrixDF))\nrownames(probMatrixDF) &lt;- gsub(\"X10X\", \"10X\", rownames(probMatrixDF))\nrownames(probMatrixDF) &lt;- substr(rownames(probMatrixDF), 1, nchar(rownames(probMatrixDF)) - 2)\n\nEstimate number of dimensions\n\nprc &lt;- PCAtools::pca(mat = probMatrixDF, rank = 50, transposed = TRUE)\nplot(prc$sdev)\n\n\n\n\n\n\n\n\n\nnDims &lt;- 20\n\nCalculate the projection to spherical distribution [Malahanobis distance]: the sum of square distances from center of sub-cluster in pca-projected space\n\nscores = data.frame()#\"tool\" = NA, \"dataset\" = dataset, \"tuning\" = NA, \"score\" = NA, \"residual_variance\" = NA, \"final_dimensions\" = NA)\nfor (tool in tools) {\n  for (tuning in tunings) {\n    labelsPath = paste('Data/', dataset, '/', tool, '/', tuning, '/clustering_labels.csv', sep='')\n    labels &lt;- read.csv(labelsPath, header = TRUE)\n    clustersList&lt;- split(as.character(labels$cell), labels$cluster)\n    score_data = averageClustersDistance(probMatrixDF, clustersList,numDim = nDims)\n    scores = rbind(\n      scores,\n      data.frame(\n        \"tool\" = tool,\n        \"dataset\" = dataset,\n        \"tuning\" = tuning,\n        \"score\" = score_data$score,\n        \"residual_variance\" = score_data$residual_variance,\n        \"final_dimensions\" = score_data$final_dimensions\n      )\n    )\n  }\n}\nwrite.csv(scores, outPath, row.names = FALSE)\nscores\n\n         tool dataset     tuning     score residual_variance final_dimensions\n1     monocle   PBMC1    default 0.9064319         0.6614691               20\n2     monocle   PBMC1   antibody 0.7098190         0.6614691               20\n3     monocle   PBMC1 celltypist 0.6698957         0.6614691               20\n4      scanpy   PBMC1    default 0.5717224         0.6614691               20\n5      scanpy   PBMC1   antibody 0.6405931         0.6614691               20\n6      scanpy   PBMC1 celltypist 0.5765256         0.6614691               20\n7      seurat   PBMC1    default 0.6290241         0.6614691               20\n8      seurat   PBMC1   antibody 0.6275275         0.6614691               20\n9      seurat   PBMC1 celltypist 0.5283759         0.6614691               20\n10 scvi-tools   PBMC1    default 0.6027325         0.6614691               20\n11 scvi-tools   PBMC1   antibody 0.6605860         0.6614691               20\n12 scvi-tools   PBMC1 celltypist 0.5735559         0.6614691               20\n13      COTAN   PBMC1    default 0.5470015         0.6614691               20\n14      COTAN   PBMC1   antibody 0.5467247         0.6614691               20\n15      COTAN   PBMC1 celltypist 0.5799735         0.6614691               20\n\n\n\nset.seed(42)\nshuffledCells &lt;- rownames(probMatrixDF)\nrndDist &lt;- function(n) {\n  clusters &lt;- set_names(rep(1:n, ceiling(9000/n))[1:nrow(probMatrixDF)], shuffledCells)\n  cluster_list &lt;- split(names(clusters), clusters)\n  d &lt;- averageClustersDistance(probMatrixDF, cluster_list,nDims)\n  return(d$score)\n}\nsizes &lt;- c(1:15, seq(20, 50, by = 5), seq(60, 100, by = 10),\n           seq(150, 1000, by = 50), seq(1500, 9000, by = 500))\nsizesToDists &lt;- vapply(sizes,rndDist, numeric(1)) \nnames(sizesToDists) &lt;- sizes\npdf(paste('Data/', dataset, '/probability_score_dim_dependency.pdf', sep=''))\nplot(names(sizesToDists), sizesToDists)\ndev.off()\n\npng \n  2 \n\nplot(names(sizesToDists), sizesToDists)",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs probability score"
    ]
  },
  {
    "objectID": "probability_score.html#pbmc2",
    "href": "probability_score.html#pbmc2",
    "title": "Probability score computation",
    "section": "PBMC2",
    "text": "PBMC2\n\ndataset = 'PBMC2'\ncelltypistPath = paste('Data/', dataset, '/celltypist/Immune_All_Low_probability_matrix.csv', sep='')\noutPath = paste('Data/', dataset, '/probabilistic_score.csv', sep='')\n\nLoad CellTypist clusterization\n\nprobMatrixDF &lt;- read.csv(celltypistPath, header = TRUE)\nprobMatrixDF &lt;- column_to_rownames(probMatrixDF, var = \"X\")\nrownames(probMatrixDF) &lt;- gsub(\"[.]\", \":\", rownames(probMatrixDF))\nrownames(probMatrixDF) &lt;- gsub(\"X10X\", \"10X\", rownames(probMatrixDF))\nrownames(probMatrixDF) &lt;- substr(rownames(probMatrixDF), 1, nchar(rownames(probMatrixDF)) - 2)\n\nEstimate number of dimensions\n\nprc &lt;- PCAtools::pca(mat = probMatrixDF, rank = 50, transposed = TRUE)\nplot(prc$sdev)\n\n\n\n\n\n\n\n\n\nnDims &lt;- 20\n\nCalculate the projection to spherical distribution [Malahanobis distance]: the sum of square distances from center of sub-cluster in pca-projected space\n\nscores = data.frame()#\"tool\" = NA, \"dataset\" = dataset, \"tuning\" = NA, \"score\" = NA, \"residual_variance\" = NA, \"final_dimensions\" = NA)\nfor (tool in tools) {\n  for (tuning in tunings) {\n    labelsPath = paste('Data/', dataset, '/', tool, '/', tuning, '/clustering_labels.csv', sep='')\n    labels &lt;- read.csv(labelsPath, header = TRUE)\n    clustersList&lt;- split(as.character(labels$cell), labels$cluster)\n    score_data = averageClustersDistance(probMatrixDF, clustersList,numDim = nDims)\n    scores = rbind(\n      scores,\n      data.frame(\n        \"tool\" = tool,\n        \"dataset\" = dataset,\n        \"tuning\" = tuning,\n        \"score\" = score_data$score,\n        \"residual_variance\" = score_data$residual_variance,\n        \"final_dimensions\" = score_data$final_dimensions\n      )\n    )\n  }\n}\nwrite.csv(scores, outPath, row.names = FALSE)\nscores\n\n         tool dataset     tuning     score residual_variance final_dimensions\n1     monocle   PBMC2    default 0.9547651          0.632864               20\n2     monocle   PBMC2   antibody 0.7238461          0.632864               20\n3     monocle   PBMC2 celltypist 0.6804478          0.632864               20\n4      scanpy   PBMC2    default 0.5757901          0.632864               20\n5      scanpy   PBMC2   antibody 0.4720212          0.632864               20\n6      scanpy   PBMC2 celltypist 0.5721244          0.632864               20\n7      seurat   PBMC2    default 0.5494186          0.632864               20\n8      seurat   PBMC2   antibody 0.3949425          0.632864               20\n9      seurat   PBMC2 celltypist 0.4951102          0.632864               20\n10 scvi-tools   PBMC2    default 0.5851914          0.632864               20\n11 scvi-tools   PBMC2   antibody 0.4727416          0.632864               20\n12 scvi-tools   PBMC2 celltypist 0.5576107          0.632864               20\n13      COTAN   PBMC2    default 0.5468319          0.632864               20\n14      COTAN   PBMC2   antibody 0.6612736          0.632864               20\n15      COTAN   PBMC2 celltypist 0.5599573          0.632864               20\n\n\n\nset.seed(42)\nshuffledCells &lt;- rownames(probMatrixDF)\nrndDist &lt;- function(n) {\n  clusters &lt;- set_names(rep(1:n, ceiling(9000/n))[1:nrow(probMatrixDF)], shuffledCells)\n  cluster_list &lt;- split(names(clusters), clusters)\n  d &lt;- averageClustersDistance(probMatrixDF, cluster_list,nDims)\n  return(d$score)\n}\nsizes &lt;- c(1:15, seq(20, 50, by = 5), seq(60, 100, by = 10),\n           seq(150, 1000, by = 50), seq(1500, 9000, by = 500))\nsizesToDists &lt;- vapply(sizes, rndDist, numeric(1)) \nnames(sizesToDists) &lt;- sizes\npdf(paste('Data/', dataset, '/probability_score_dim_dependency.pdf', sep=''))\nplot(names(sizesToDists), sizesToDists)\ndev.off()\n\npng \n  2 \n\nplot(names(sizesToDists), sizesToDists)",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs probability score"
    ]
  },
  {
    "objectID": "probability_score.html#pbmc3",
    "href": "probability_score.html#pbmc3",
    "title": "Probability score computation",
    "section": "PBMC3",
    "text": "PBMC3\n\ndataset = 'PBMC3'\ncelltypistPath = paste('Data/', dataset, '/celltypist/Immune_All_Low_probability_matrix.csv', sep='')\noutPath = paste('Data/', dataset, '/probabilistic_score.csv', sep='')\n\nLoad CellTypist clusterization\n\nprobMatrixDF &lt;- read.csv(celltypistPath, header = TRUE)\nprobMatrixDF &lt;- column_to_rownames(probMatrixDF, var = \"X\")\nrownames(probMatrixDF) &lt;- gsub(\"[.]\", \":\", rownames(probMatrixDF))\nrownames(probMatrixDF) &lt;- gsub(\"X10X\", \"10X\", rownames(probMatrixDF))\nrownames(probMatrixDF) &lt;- substr(rownames(probMatrixDF), 1, nchar(rownames(probMatrixDF)) - 2)\n\nEstimate number of dimensions\n\nprc &lt;- PCAtools::pca(mat = probMatrixDF, rank = 50, transposed = TRUE)\nplot(prc$sdev)\n\n\n\n\n\n\n\n\n\nnDims &lt;- 20\n\nCalculate the projection to spherical distribution [Malahanobis distance]: the sum of square distances from center of sub-cluster in pca-projected space\n\nscores = data.frame()#\"tool\" = NA, \"dataset\" = dataset, \"tuning\" = NA, \"score\" = NA, \"residual_variance\" = NA, \"final_dimensions\" = NA)\nfor (tool in tools) {\n  for (tuning in tunings) {\n    labelsPath = paste('Data/', dataset, '/', tool, '/', tuning, '/clustering_labels.csv', sep='')\n    labels &lt;- read.csv(labelsPath, header = TRUE)\n    clustersList&lt;- split(as.character(labels$cell), labels$cluster)\n    score_data = averageClustersDistance(probMatrixDF, clustersList,numDim = nDims)\n    scores = rbind(\n      scores,\n      data.frame(\n        \"tool\" = tool,\n        \"dataset\" = dataset,\n        \"tuning\" = tuning,\n        \"score\" = score_data$score,\n        \"residual_variance\" = score_data$residual_variance,\n        \"final_dimensions\" = score_data$final_dimensions\n      )\n    )\n  }\n}\nwrite.csv(scores, outPath, row.names = FALSE)\nscores\n\n         tool dataset     tuning     score residual_variance final_dimensions\n1     monocle   PBMC3    default 0.9116157          0.666637               20\n2     monocle   PBMC3   antibody 0.7342920          0.666637               20\n3     monocle   PBMC3 celltypist 0.7235588          0.666637               20\n4      scanpy   PBMC3    default 0.5771388          0.666637               20\n5      scanpy   PBMC3   antibody 0.4865492          0.666637               20\n6      scanpy   PBMC3 celltypist 0.5750278          0.666637               20\n7      seurat   PBMC3    default 0.5237283          0.666637               20\n8      seurat   PBMC3   antibody 0.4024118          0.666637               20\n9      seurat   PBMC3 celltypist 0.5238608          0.666637               20\n10 scvi-tools   PBMC3    default 0.5606163          0.666637               20\n11 scvi-tools   PBMC3   antibody 0.4673312          0.666637               20\n12 scvi-tools   PBMC3 celltypist 0.5082920          0.666637               20\n13      COTAN   PBMC3    default 0.4794518          0.666637               20\n14      COTAN   PBMC3   antibody 0.6774677          0.666637               20\n15      COTAN   PBMC3 celltypist 0.5843296          0.666637               20\n\n\n\nset.seed(42)\nshuffledCells &lt;- rownames(probMatrixDF)\nrndDist &lt;- function(n) {\n  clusters &lt;- set_names(rep(1:n, ceiling(9000/n))[1:nrow(probMatrixDF)], shuffledCells)\n  cluster_list &lt;- split(names(clusters), clusters)\n  d &lt;- averageClustersDistance(probMatrixDF, cluster_list,nDims)\n  return(d$score)\n}\nsizes &lt;- c(1:15, seq(20, 50, by = 5), seq(60, 100, by = 10),\n           seq(150, 1000, by = 50), seq(1500, 9000, by = 500))\nsizesToDists &lt;- vapply(sizes, rndDist, numeric(1)) \nnames(sizesToDists) &lt;- sizes\npdf(paste('Data/', dataset, '/probability_score_dim_dependency.pdf', sep=''))\nplot(names(sizesToDists), sizesToDists)\ndev.off()\n\npng \n  2 \n\nplot(names(sizesToDists), sizesToDists)",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs probability score"
    ]
  },
  {
    "objectID": "probability_score.html#pbmc4",
    "href": "probability_score.html#pbmc4",
    "title": "Probability score computation",
    "section": "PBMC4",
    "text": "PBMC4\n\ndataset = 'PBMC4'\ncelltypistPath = paste('Data/', dataset, '/celltypist/Immune_All_Low_probability_matrix.csv', sep='')\noutPath = paste('Data/', dataset, '/probabilistic_score.csv', sep='')\n\nLoad CellTypist clusterization\n\nprobMatrixDF &lt;- read.csv(celltypistPath, header = TRUE)\nprobMatrixDF &lt;- column_to_rownames(probMatrixDF, var = \"X\")\nrownames(probMatrixDF) &lt;- gsub(\"[.]\", \":\", rownames(probMatrixDF))\nrownames(probMatrixDF) &lt;- gsub(\"X10X\", \"10X\", rownames(probMatrixDF))\nrownames(probMatrixDF) &lt;- substr(rownames(probMatrixDF), 1, nchar(rownames(probMatrixDF)) - 2)\n\nEstimate number of dimensions\n\nprc &lt;- PCAtools::pca(mat = probMatrixDF, rank = 50, transposed = TRUE)\nplot(prc$sdev)\n\n\n\n\n\n\n\n\n\nnDims &lt;- 20\n\nCalculate the projection to spherical distribution [Malahanobis distance]: the sum of square distances from center of sub-cluster in pca-projected space\n\nscores = data.frame()#\"tool\" = NA, \"dataset\" = dataset, \"tuning\" = NA, \"score\" = NA, \"residual_variance\" = NA, \"final_dimensions\" = NA)\nfor (tool in tools) {\n  for (tuning in tunings) {\n    labelsPath = paste('Data/', dataset, '/', tool, '/', tuning, '/clustering_labels.csv', sep='')\n    labels &lt;- read.csv(labelsPath, header = TRUE)\n    clustersList&lt;- split(as.character(labels$cell), labels$cluster)\n    score_data = averageClustersDistance(probMatrixDF, clustersList,numDim = nDims)\n    scores = rbind(\n      scores,\n      data.frame(\n        \"tool\" = tool,\n        \"dataset\" = dataset,\n        \"tuning\" = tuning,\n        \"score\" = score_data$score,\n        \"residual_variance\" = score_data$residual_variance,\n        \"final_dimensions\" = score_data$final_dimensions\n      )\n    )\n  }\n}\nwrite.csv(scores, outPath, row.names = FALSE)\nscores\n\n         tool dataset     tuning     score residual_variance final_dimensions\n1     monocle   PBMC4    default 0.9079955         0.7881445               20\n2     monocle   PBMC4   antibody 0.6896226         0.7881445               20\n3     monocle   PBMC4 celltypist 0.6513185         0.7881445               20\n4      scanpy   PBMC4    default 0.5667508         0.7881445               20\n5      scanpy   PBMC4   antibody 0.5639221         0.7881445               20\n6      scanpy   PBMC4 celltypist 0.5916285         0.7881445               20\n7      seurat   PBMC4    default 0.5272270         0.7881445               20\n8      seurat   PBMC4   antibody 0.4877846         0.7881445               20\n9      seurat   PBMC4 celltypist 0.5265706         0.7881445               20\n10 scvi-tools   PBMC4    default 0.6212800         0.7881445               20\n11 scvi-tools   PBMC4   antibody 0.5174726         0.7881445               20\n12 scvi-tools   PBMC4 celltypist 0.5219027         0.7881445               20\n13      COTAN   PBMC4    default 0.5155869         0.7881445               20\n14      COTAN   PBMC4   antibody 0.6737801         0.7881445               20\n15      COTAN   PBMC4 celltypist 0.6209524         0.7881445               20\n\n\n\nset.seed(42)\nshuffledCells &lt;- rownames(probMatrixDF)\nrndDist &lt;- function(n) {\n  clusters &lt;- set_names(rep(1:n, ceiling(9000/n))[1:nrow(probMatrixDF)], shuffledCells)\n  cluster_list &lt;- split(names(clusters), clusters)\n  d &lt;- averageClustersDistance(probMatrixDF, cluster_list,nDims)\n  return(d$score)\n}\nsizes &lt;- c(1:15, seq(20, 50, by = 5), seq(60, 100, by = 10),\n           seq(150, 1000, by = 50), seq(1500, 9000, by = 500))\nsizesToDists &lt;- vapply(sizes, rndDist, numeric(1)) \nnames(sizesToDists) &lt;- sizes\npdf(paste('Data/', dataset, '/probability_score_dim_dependency.pdf', sep=''))\nplot(names(sizesToDists), sizesToDists)\ndev.off()\n\npng \n  2 \n\nplot(names(sizesToDists), sizesToDists)\n\n\n\n\n\n\n\n\n\n\nSys.time()\n\n[1] \"2025-12-18 09:12:39 CET\"\n\n\n\nsessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 22.04.5 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] COTAN_2.9.4                 cluster_2.1.8.1            \n [3] monocle3_1.3.7              SingleCellExperiment_1.30.0\n [5] SummarizedExperiment_1.38.1 GenomicRanges_1.60.0       \n [7] GenomeInfoDb_1.44.0         IRanges_2.42.0             \n [9] S4Vectors_0.46.0            MatrixGenerics_1.20.0      \n[11] matrixStats_1.5.0           Biobase_2.68.0             \n[13] BiocGenerics_0.54.0         generics_0.1.3             \n[15] funtimes_10.0               aricode_1.0.3              \n[17] Seurat_5.2.1                SeuratObject_5.1.0         \n[19] sp_2.2-0                    zeallot_0.2.0              \n[21] tibble_3.3.0                ggplot2_4.0.1              \n[23] testthat_3.2.3              rlang_1.1.6                \n\nloaded via a namespace (and not attached):\n  [1] spatstat.sparse_3.1-0     gghalves_0.1.4           \n  [3] httr_1.4.7                RColorBrewer_1.1-3       \n  [5] doParallel_1.0.17         tools_4.5.2              \n  [7] sctransform_0.4.2         backports_1.5.0          \n  [9] R6_2.6.1                  lazyeval_0.2.2           \n [11] uwot_0.2.3                GetoptLong_1.0.5         \n [13] withr_3.0.2               gridExtra_2.3            \n [15] parallelDist_0.2.6        fdrtool_1.2.18           \n [17] progressr_0.15.1          qgraph_1.9.8             \n [19] cli_3.6.5                 spatstat.explore_3.4-2   \n [21] fastDummies_1.7.5         mvtnorm_1.3-3            \n [23] S7_0.2.1                  spatstat.data_3.1-6      \n [25] proxy_0.4-27              ggridges_0.5.6           \n [27] pbapply_1.7-2             pbivnorm_0.6.0           \n [29] foreign_0.8-90            dbscan_1.2.3             \n [31] parallelly_1.45.0         rstudioapi_0.17.1        \n [33] shape_1.4.6.1             gtools_3.9.5             \n [35] ica_1.0-3                 spatstat.random_3.4-1    \n [37] dendextend_1.19.0         graphicalVAR_0.3.4       \n [39] dplyr_1.1.4               Matrix_1.7-4             \n [41] abind_1.4-8               PCAtools_2.20.0          \n [43] lifecycle_1.0.4           yaml_2.3.10              \n [45] clusterGeneration_1.3.8   SparseArray_1.8.0        \n [47] Rtsne_0.17                grid_4.5.2               \n [49] lavaan_0.6-20             mlVAR_0.5.2              \n [51] dqrng_0.4.1               promises_1.3.2           \n [53] crayon_1.5.3              miniUI_0.1.2             \n [55] lattice_0.22-7            beachmat_2.24.0          \n [57] cowplot_1.1.3             pillar_1.10.2            \n [59] knitr_1.50                ComplexHeatmap_2.24.0    \n [61] rjson_0.2.23              boot_1.3-32              \n [63] corpcor_1.6.10            future.apply_1.20.0      \n [65] codetools_0.2-20          glue_1.8.0               \n [67] spatstat.univar_3.1-3     data.table_1.17.0        \n [69] vctrs_0.6.5               png_0.1-8                \n [71] spam_2.11-1               Rdpack_2.6.4             \n [73] gtable_0.3.6              assertthat_0.2.1         \n [75] gsubfn_0.7                zigg_0.0.2               \n [77] xfun_0.52                 rbibutils_2.3            \n [79] S4Arrays_1.8.0            mime_0.13                \n [81] Rfast_2.1.5.1             coda_0.19-4.1            \n [83] reformulas_0.4.1          survival_3.8-3           \n [85] iterators_1.0.14          MplusAutomation_1.2      \n [87] fitdistrplus_1.2-2        ROCR_1.0-11              \n [89] nlme_3.1-168              RcppAnnoy_0.0.22         \n [91] irlba_2.3.5.1             KernSmooth_2.23-26       \n [93] rpart_4.1.24              colorspace_2.1-1         \n [95] Hmisc_5.2-3               nnet_7.3-20              \n [97] mnormt_2.1.1              tidyselect_1.2.1         \n [99] compiler_4.5.2            glmnet_4.1-8             \n[101] htmlTable_2.4.3           DelayedArray_0.34.1      \n[103] plotly_4.11.0             checkmate_2.3.2          \n[105] scales_1.4.0              psych_2.5.3              \n[107] lmtest_0.9-40             quadprog_1.5-8           \n[109] stringr_1.5.1             digest_0.6.37            \n[111] goftest_1.2-3             spatstat.utils_3.1-4     \n[113] minqa_1.2.8               rmarkdown_2.29           \n[115] XVector_0.48.0            htmltools_0.5.8.1        \n[117] pkgconfig_2.0.3           jpeg_0.1-11              \n[119] base64enc_0.1-3           lme4_1.1-37              \n[121] sparseMatrixStats_1.20.0  fastmap_1.2.0            \n[123] ggthemes_5.1.0            GlobalOptions_0.1.2      \n[125] htmlwidgets_1.6.4         UCSC.utils_1.4.0         \n[127] DelayedMatrixStats_1.30.0 shiny_1.11.0             \n[129] farver_2.1.2              zoo_1.8-14               \n[131] jsonlite_2.0.0            BiocParallel_1.42.0      \n[133] BiocSingular_1.24.0       magrittr_2.0.4           \n[135] Formula_1.2-5             GenomeInfoDbData_1.2.14  \n[137] dotCall64_1.2             patchwork_1.3.2          \n[139] texreg_1.39.4             Rcpp_1.0.14              \n[141] viridis_0.6.5             proto_1.0.0              \n[143] reticulate_1.42.0         stringi_1.8.7            \n[145] brio_1.1.5                MASS_7.3-65              \n[147] plyr_1.8.9                parallel_4.5.2           \n[149] listenv_0.9.1             ggrepel_0.9.6            \n[151] deldir_2.0-4              splines_4.5.2            \n[153] pander_0.6.6              tensor_1.5               \n[155] circlize_0.4.16           igraph_2.1.4             \n[157] spatstat.geom_3.4-1       RcppHNSW_0.6.0           \n[159] reshape2_1.4.4            ScaledMatrix_1.16.0      \n[161] evaluate_1.0.3            RcppParallel_5.1.10      \n[163] nloptr_2.2.1              foreach_1.5.2            \n[165] httpuv_1.6.16             RANN_2.6.2               \n[167] tidyr_1.3.1               purrr_1.2.0              \n[169] polyclip_1.10-7           future_1.58.0            \n[171] clue_0.3-66               scattermore_1.2          \n[173] rsvd_1.0.5                xtable_1.8-4             \n[175] RSpectra_0.16-2           later_1.4.2              \n[177] glasso_1.11               viridisLite_0.4.2        \n[179] arm_1.14-4                globals_0.18.0",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs probability score"
    ]
  },
  {
    "objectID": "ForebrainDorsal_E175-analysis.html",
    "href": "ForebrainDorsal_E175-analysis.html",
    "title": "Forebrain Dorsal E17.5 Data-set Anaysis",
    "section": "",
    "text": "library(ggplot2)\nlibrary(tibble)\nlibrary(zeallot)\nlibrary(COTAN)\n#devtools::load_all(\"../COTAN/\")\n\noptions(parallelly.fork.enable = TRUE)\n\noutDir &lt;- \"Data/MouseCortexFromLoom/\"\nif (!file.exists(outDir)) {\n  dir.create(outDir)\n}\n\nsetLoggingLevel(2)\nsetLoggingFile(file.path(outDir, \"ForebrainDorsal_E175-analysis.log\"))\n\nRead the already created COTAN object\n\nfb175Obj &lt;- readRDS(file.path(\"Data/MouseCortexFromLoom/SourceData/\", \"e17.5_ForebrainDorsal.cotan.RDS\"))\nsampleCondition &lt;- getMetadataElement(fb175Obj, datasetTags()[[\"cond\"]])\n\nsampleCondition\n\n[1] \"e17.5_ForebrainDorsal\"\n\n\nInspect cells’ sizes\n\ncellSizePlot(fb175Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nDrop cells with too many reads reads as they are probably doublets\n\ncellsSizeThr &lt;- 10000\nfb175Obj &lt;- addElementToMetaDataset(fb175Obj, \"Cells size threshold\", cellsSizeThr)\n\ncells_to_rem &lt;- getCells(fb175Obj)[getCellsSize(fb175Obj) &gt; cellsSizeThr]\nfb175Obj &lt;- dropGenesCells(fb175Obj, cells = cells_to_rem)\n\ncellSizePlot(fb175Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nInspect the number of expressed genes per cell\n\ngenesSizePlot(fb175Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nDrop cells with too low genes expression as they are probably dead\n\ngenesSizeLowThr &lt;- 700\nfb175Obj &lt;- addElementToMetaDataset(fb175Obj, \"Num genes low threshold\", genesSizeLowThr)\n\nnumExprGenes &lt;- getNumExpressedGenes(fb175Obj)\ncells_to_rem &lt;- names(numExprGenes)[numExprGenes &lt; genesSizeLowThr]\nfb175Obj &lt;- dropGenesCells(fb175Obj, cells = cells_to_rem)\n\ngenesSizePlot(fb175Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nCheck number of mitochondrial genes expressed in each cell\n\nmitGenesPattern &lt;- \"^mt.\"\ngetGenes(fb175Obj)[grep(mitGenesPattern, getGenes(fb175Obj))]\n\n[1] \"mt.Co1\" \"mt.Co3\" \"mt.Nd4\" \"mt.Nd5\" \"mt.Nd1\" \"mt.Nd2\"\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(fb175Obj, genePrefix = mitGenesPattern,\n                              splitPattern = \":\", numCol = 1)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCells with a too high percentage of mitochondrial genes are likely dead (or at the last problematic) cells. So we drop them!\n\nmitPercThr &lt;- 1.5\nfb175Obj &lt;- addElementToMetaDataset(fb175Obj, \"Mitoc. perc. threshold\", mitPercThr)\n\ncells_to_rem &lt;- rownames(mitSizes)[mitSizes[[\"mit.percentage\"]] &gt; mitPercThr]\n\nfb175Obj &lt;- dropGenesCells(fb175Obj, cells = cells_to_rem)\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(fb175Obj, genePrefix = mitGenesPattern,\n                              splitPattern = \":\", numCol = 1)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCheck no further outlines after all the culling\n\ncellSizePlot(fb175Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\ngenesSizePlot(fb175Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nClean: round 1\n\nfb175Obj &lt;- clean(fb175Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot,\n  UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(fb175Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nfb175Obj &lt;- addElementToMetaDataset(fb175Obj, \"Num drop B group\", 0)\n\nVisualize if all is ok:\n\nplot(UDEPlot)\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\nplot(zoomedNuPlot)\n\n\n\n\n\n\n\n\nFinal cleaning to check all is OK\n\nfb175Obj &lt;- clean(fb175Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot,\n  UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(fb175Obj)\n\nplot(pcaCellsPlot)\nplot(genesPlot)\nplot(UDEPlot)\nplot(nuPlot)\nplot(zoomedNuPlot)\n\nplot(cellSizePlot(fb175Obj, splitPattern = \":\", numCol = 1))\nplot(genesSizePlot(fb175Obj, splitPattern = \":\", numCol = 1))\n\nCalculate genes’ COEX\n\nfb175Obj &lt;- proceedToCoex(fb175Obj, calcCoex = TRUE, cores = 12,\n                          saveObj = TRUE, outDir = outDir)\n\n\ngdiData &lt;- calculateGDI(fb175Obj)\n\ngenesToLabel &lt;- head(rownames(gdiData[order(gdiData[[\"GDI\"]],\n                                            decreasing = TRUE), ]), n = 10L)\n\ngenesToLabel\n\n [1] \"Mfge8\"    \"Myt1l\"    \"Atp1a2\"   \"Sparc\"    \"Apoe\"     \"Phgdh\"   \n [7] \"Slc9a3r1\" \"Tnc\"      \"Ccdc80\"   \"Aldoc\"   \n\ngdiPlot &lt;- GDIPlot(fb175Obj, GDIIn = gdiData, GDIThreshold = 1.4,\n                   genes = list(\"Top 10 GDI genes\" = genesToLabel))\n\nplot(gdiPlot)\n\n\n\n\n\n\n\n\nSave the COTAN object\n\nsaveRDS(fb175Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\nc(splitClusters, splitCoexDF) %&lt;-%\n  cellsUniformClustering(fb175Obj, GDIThreshold = 1.4, cores = 13L,\n                         saveObj = TRUE, outDir = outDir)\n\nfb175Obj &lt;- addClusterization(fb175Obj, clName = \"split\",\n                              clusters = splitClusters,\n                              coexDF = splitCoexDF, override = TRUE)\n\n\nsplitClusters &lt;- getClusterizationData(fb175Obj,clName = \"split\")$clusters\n\ntable(splitClusters)\n\nsplitClusters\n -1  20  04  05  06  07  10  22  11  08  21  23  16  12  18  24  09  14  15  13 \n 10 384 130 119  82  53  44  40  32  22 413 166 159  91  55  50  15 202 146  70 \n 02  01  03  17  19 \n 50  37  32  35  30 \n\n\n\nc(mergedClusters, mergedCoexDF) %&lt;-%\n  mergeUniformCellsClusters(fb175Obj, clusters = splitClusters,\n                            GDIThreshold = 1.4, batchSize = 20L, cores = 13L,\n                            saveObj = TRUE, outDir = outDir)\n\nfb175Obj &lt;- addClusterization(fb175Obj, clName = \"merge\",\n                              clusters = mergedClusters,\n                              coexDF = mergedCoexDF,\n                              override = TRUE)\n\n\nmergedClusters &lt;- getClusterizationData(fb175Obj,clName = \"merge\")$clusters\ntable(mergedClusters)\n\nmergedClusters\n 16  03  04  05  06  07  18  01  02  12  19  14  13  15  17  08  09  10  11 \n 65  37  50  32 130 119 135  22  15  44  32 237 100 202 194 384 413  90 166 \n\n\n\n\nSys.time()\n\n[1] \"2023-08-22 11:46:58 CEST\"\n\n\n\nsessionInfo()\n\nR version 4.3.1 (2023-06-16)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] COTAN_2.1.7   zeallot_0.1.0 tibble_3.2.1  ggplot2_3.4.2\n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3     rstudioapi_0.15.0      jsonlite_1.8.7        \n  [4] shape_1.4.6            umap_0.2.10.0          magrittr_2.0.3        \n  [7] spatstat.utils_3.0-3   farver_2.1.1           rmarkdown_2.24        \n [10] GlobalOptions_0.1.2    vctrs_0.6.3            ROCR_1.0-11           \n [13] spatstat.explore_3.2-1 askpass_1.1            htmltools_0.5.5       \n [16] sctransform_0.3.5      parallelly_1.36.0      KernSmooth_2.23-22    \n [19] htmlwidgets_1.6.2      ica_1.0-3              plyr_1.8.8            \n [22] plotly_4.10.2          zoo_1.8-12             igraph_1.5.1          \n [25] mime_0.12              lifecycle_1.0.3        iterators_1.0.14      \n [28] pkgconfig_2.0.3        Matrix_1.6-0           R6_2.5.1              \n [31] fastmap_1.1.1          fitdistrplus_1.1-11    future_1.33.0         \n [34] shiny_1.7.5            clue_0.3-64            digest_0.6.33         \n [37] colorspace_2.1-0       patchwork_1.1.2        S4Vectors_0.38.1      \n [40] Seurat_4.3.0.1         tensor_1.5             RSpectra_0.16-1       \n [43] irlba_2.3.5.1          labeling_0.4.2         progressr_0.14.0      \n [46] RcppZiggurat_0.1.6     fansi_1.0.4            spatstat.sparse_3.0-2 \n [49] httr_1.4.6             polyclip_1.10-4        abind_1.4-5           \n [52] compiler_4.3.1         withr_2.5.0            doParallel_1.0.17     \n [55] viridis_0.6.4          dendextend_1.17.1      MASS_7.3-60           \n [58] openssl_2.1.0          rjson_0.2.21           tools_4.3.1           \n [61] lmtest_0.9-40          httpuv_1.6.11          future.apply_1.11.0   \n [64] goftest_1.2-3          glue_1.6.2             nlme_3.1-162          \n [67] promises_1.2.0.1       grid_4.3.1             Rtsne_0.16            \n [70] cluster_2.1.4          reshape2_1.4.4         generics_0.1.3        \n [73] gtable_0.3.3           spatstat.data_3.0-1    tidyr_1.3.0           \n [76] data.table_1.14.8      sp_2.0-0               utf8_1.2.3            \n [79] BiocGenerics_0.46.0    spatstat.geom_3.2-4    RcppAnnoy_0.0.21      \n [82] ggrepel_0.9.3          RANN_2.6.1             foreach_1.5.2         \n [85] pillar_1.9.0           stringr_1.5.0          later_1.3.1           \n [88] circlize_0.4.15        splines_4.3.1          dplyr_1.1.2           \n [91] lattice_0.21-8         survival_3.5-5         deldir_1.0-9          \n [94] tidyselect_1.2.0       ComplexHeatmap_2.16.0  miniUI_0.1.1.1        \n [97] pbapply_1.7-2          knitr_1.43             gridExtra_2.3         \n[100] IRanges_2.34.1         scattermore_1.2        stats4_4.3.1          \n[103] xfun_0.39              factoextra_1.0.7       matrixStats_1.0.0     \n[106] stringi_1.7.12         lazyeval_0.2.2         yaml_2.3.7            \n[109] evaluate_0.21          codetools_0.2-19       cli_3.6.1             \n[112] RcppParallel_5.1.7     uwot_0.1.16            xtable_1.8-4          \n[115] reticulate_1.30        munsell_0.5.0          Rcpp_1.0.11           \n[118] globals_0.16.2         spatstat.random_3.1-5  png_0.1-8             \n[121] parallel_4.3.1         Rfast_2.0.8            ellipsis_0.3.2        \n[124] assertthat_0.2.1       parallelDist_0.2.6     listenv_0.9.0         \n[127] ggthemes_4.2.4         viridisLite_0.4.2      scales_1.2.1          \n[130] ggridges_0.5.4         SeuratObject_4.1.3     leiden_0.4.3          \n[133] purrr_1.0.1            crayon_1.5.2           GetoptLong_1.0.5      \n[136] rlang_1.1.1            cowplot_1.1.1",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "E17.5 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "generalCoexAssess.html",
    "href": "generalCoexAssess.html",
    "title": "General Coex Evaluation",
    "section": "",
    "text": "library(tidyr)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(gghalves)\nlibrary(ggstatsplot)\nlibrary(\"gridExtra\")\nlibrary(cowplot)\nlibrary(Matrix)\nlibrary(ggstance)\nlibrary(scales)\nlibrary(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\n#Define colors\ncolors.methods &lt;- c(\"#ed5537\",\"#a3505c\",\"#95ba8f\",\"#B3CDE3\",\"#8856A7\" )\n#layer.genes &lt;- read.csv(\"CoexData/some_layer_maerkers.csv\", header = T,row.names = 1)\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") #unique(unlist(str_split(layer.genes$supertype.markers.combo,pattern = \",\"))) \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Coex score evaluation",
      "General Coex Evaluation"
    ]
  },
  {
    "objectID": "generalCoexAssess.html#coex-and-correlations",
    "href": "generalCoexAssess.html#coex-and-correlations",
    "title": "General Coex Evaluation",
    "section": "COEX and Correlations",
    "text": "COEX and Correlations\nImport COTAN coex and correlations data from file\n\ntable.tot.hk &lt;- NA\ntable.tot.neural &lt;- NA\nfor (file in list.files(\"CoexData/\",pattern = \"Corr|Coex\")) {\n#for (file in list.files(\"CoexData/\",pattern = \"Corr_e13.5|CorrSCT_e13.5|Coex_e13.5\")) {  \n  \n  #print(file)\n  #corr &lt;- readRDS(paste0(\"CoexData/\",file))\n  corr &lt;- read_fst(paste0(\"CoexData/\",file),to = 2)\n  colnames.corr &lt;- colnames(corr)\n  genesListPartial &lt;- genesList\n  for (na in names(genesListPartial)) {\n      if(!all(genesListPartial[[na]] %in% colnames.corr)){\n        print(na)\n        genesListPartial[[na]] &lt;- genesListPartial[[na]][-which(!genesList[[na]] %in% colnames.corr)]\n    }\n  }\n\n  \n  corr &lt;- read_fst(paste0(\"CoexData/\",file), \n        columns = unlist(genesListPartial))\n  corr &lt;- as.data.frame(as.matrix(corr))\n  rownames(corr) &lt;- colnames.corr\n  \n  if(str_detect(file,pattern = \"CotanCoex\")){\n    code &lt;- \"COTAN coex\"\n  }else if(str_detect(file,pattern = \"CorrSCT\")){\n    code &lt;- \"Seurat SCT corr.\"\n  }else if(str_detect(file,pattern = \"MonocleCorr\")){\n    code &lt;- \"Monocle corr.\"\n    #print(\"ok\")\n  }else if(str_detect(file,pattern = \"ScanPyCorr\")){\n    code &lt;- \"ScanPy corr.\"\n    #print(\"ok\")\n  }else if(str_detect(file,pattern = \"Corr\")){\n    code &lt;- \"Seurat corr.\"\n  }\n  \n  table.hk &lt;- as.data.frame(corr[,genesListPartial$hk])\n  table.hk$Gene1 &lt;- rownames(table.hk)\n  \n  table.hk &lt;- pivot_longer(as.data.frame(table.hk),cols = c(1:(ncol(table.hk)-1)),names_to = \"Gene2\")\n  table.hk$Method &lt;- code\n  \n  table.hk$Dataset &lt;- str_flatten(str_split(file,pattern = \"_\",simplify = T)[,c(2,3)],collapse = \"_\")\n\n  table.tot.hk &lt;- rbind(table.tot.hk,table.hk)\n  table.tot.hk &lt;- table.tot.hk[! table.tot.hk$Gene1 == table.tot.hk$Gene2,]\n \n  #Not hk\n  table.neural &lt;- as.data.frame(corr[rownames(corr) %in% c(genesListPartial$NPGs,genesListPartial$PNGs,genesListPartial$layers),\n                                     colnames(corr) %in% c(genesListPartial$NPGs,genesListPartial$PNGs,genesList$layers)])\n  \n  table.neural$Gene1 &lt;- rownames(table.neural)\n  \n  table.neural &lt;- pivot_longer(as.data.frame(table.neural),cols = c(1:(ncol(table.neural)-1)),names_to = \"Gene2\")\n  table.neural$Method &lt;- code\n  table.neural$Dataset &lt;- str_flatten(str_split(file,pattern = \"_\",simplify = T)[,c(2,3)],collapse = \"_\")\n  \n  table.tot.neural &lt;- rbind(table.tot.neural,table.neural)\n  table.tot.neural &lt;- table.tot.neural[! table.tot.neural$Gene1 == table.tot.neural$Gene2,]\n}\n\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"hk\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n\ntable.tot.hk$Method &lt;- factor(table.tot.hk$Method, levels = c(\"Seurat corr.\", \"Seurat SCT corr.\", \"Monocle corr.\", \"ScanPy corr.\", \"COTAN coex\"))\ntable.tot.neural$Method &lt;- factor(table.tot.neural$Method, levels = c(\"Seurat corr.\", \"Seurat SCT corr.\", \"Monocle corr.\", \"ScanPy corr.\", \"COTAN coex\"))\n\n\ntable.tot.hk &lt;- table.tot.hk[2:nrow(table.tot.hk),]\ntable.tot.hk$GeneType &lt;- \"Constitutive\" \ntable.tot.neural &lt;- table.tot.neural[2:nrow(table.tot.neural),]\ntable.tot.neural$GeneType &lt;- \"Neural\"\n\n## For ECDL\ntmp.tot &lt;- NA\nfor (method in unique(table.tot.hk$Method)) {\n  tmp &lt;- as.data.frame(table.tot.hk[table.tot.hk$Method == method,])\n  tmp$n &lt;- NA\n  tmp[order(abs(tmp$value)),]$n &lt;- c(1:dim(tmp)[1])/(dim(tmp)[1]+1)\n  tmp$Y_axis &lt;- 1-tmp$n\n  tmp.tot &lt;- rbind(tmp.tot,tmp)\n}\ntmp.tot &lt;- tmp.tot[2:nrow(tmp.tot),]\ntable.tot.hk &lt;- tmp.tot\n\ntmp.tot &lt;- NA\nfor (method in unique(table.tot.neural$Method)) {\n  tmp &lt;- as.data.frame(table.tot.neural[table.tot.neural$Method == method,])\n  tmp$n &lt;- NA\n  tmp[order(abs(tmp$value)),]$n &lt;- c(1:dim(tmp)[1])/(dim(tmp)[1]+1)\n  tmp$Y_axis &lt;- 1-tmp$n\n  tmp.tot &lt;- rbind(tmp.tot,tmp)\n}\ntmp.tot &lt;- tmp.tot[2:nrow(tmp.tot),]\ntable.tot.neural &lt;- tmp.tot\n\n############\n\ntable.tot &lt;- rbind(table.tot.hk,table.tot.neural) \ntable.tot &lt;- table.tot[!table.tot$Gene1 == table.tot$Gene2,]\n\nidentical(table.tot[table.tot$Method == \"COTAN coex\",]$Gene1,\n          table.tot[table.tot$Method == \"Seurat corr.\",]$Gene1 )\n\n[1] FALSE\n\nidentical(table.tot[table.tot$Method == \"COTAN coex\",]$Gene2,\n          table.tot[table.tot$Method == \"Seurat corr.\",]$Gene2 )\n\n[1] FALSE\n\ntable.tot$Method &lt;- factor(table.tot$Method, levels = c(\"Seurat corr.\", \"Seurat SCT corr.\", \"Monocle corr.\", \"ScanPy corr.\", \"COTAN coex\"))\n\nhead(table.tot)\n\n          Gene1  Gene2        value     Method                  Dataset\n2 0610007N19Rik  Calm1  0.030413962 COTAN coex CorticalCells_GSM2861511\n3 0610007N19Rik Cox6b1  0.008228765 COTAN coex CorticalCells_GSM2861511\n4 0610007N19Rik   Ppia -0.051969707 COTAN coex CorticalCells_GSM2861511\n5 0610007N19Rik  Rpl18  0.061781637 COTAN coex CorticalCells_GSM2861511\n6 0610007N19Rik  Cox7c  0.060690748 COTAN coex CorticalCells_GSM2861511\n7 0610007N19Rik    Erh  0.070534482 COTAN coex CorticalCells_GSM2861511\n      GeneType         n     Y_axis\n2 Constitutive 0.8021629 0.19783714\n3 Constitutive 0.3250217 0.67497834\n4 Constitutive 0.9391370 0.06086305\n5 Constitutive 0.9640681 0.03593190\n6 Constitutive 0.9620358 0.03796424\n7 Constitutive 0.9775790 0.02242102\n\n\n\ntable.tot$ValAbs &lt;- abs(table.tot$value)\ntable.tot$LogValAbs &lt;- log(table.tot$ValAbs+0.001)\ntable.tot$SqrValAbs &lt;- table.tot$ValAbs**2\n\nggplot(table.tot,aes(x=Method,y=ValAbs, fill=Method)) +\ngeom_half_violin(alpha=0.8) +\n  #geom_point(position = \"jitter\", size= 0.1,alpha = 0.3)+ \n  #geom_half_boxplot(width=0.1, alpha=0.8,side = \"r\") +\n  theme_bw()+   theme(legend.position=\"none\")+#ylim(0,1)+\n  facet_grid(GeneType ~ . , space = \"free_y\", scales = \"free\")+\n  scale_fill_manual(values = colors.methods)\n\n\n\n\n\n\n\n\n\nggplot(table.tot[table.tot$GeneType == \"Neural\",], aes(x = ValAbs, y = -0.5)) +\n\n  # horizontal box plot\n  geom_boxploth(aes(fill = Method)) +\n\n  # normal density plot\n  geom_density(aes(x = ValAbs), inherit.aes = FALSE) +\n\n  # # vertical lines at Q1 / Q2 / Q3\n  # stat_boxploth(geom = \"vline\", aes(xintercept = ..xlower..)) +\n   stat_boxploth(geom = \"vline\", aes(xintercept = ..xmiddle..)) +\n  # stat_boxploth(geom = \"vline\", aes(xintercept = ..xupper..)) +\n  # \n   facet_grid(Method ~ .) +\n  \n  # reproduce original chart's color scale (o/w ordered factors will result\n  # in viridis scale by default, using the current version of ggplot2)\n  #scale_fill_discrete()+\n  scale_fill_manual(values = colors.methods)+\n  theme_bw()+   theme(legend.position=\"none\")+xlim(0,0.2)\n\n\n\n\n\n\n\n\n\nggplot(table.tot[table.tot$GeneType == \"Constitutive\",], aes(x = ValAbs, y = -0.5)) +\n  # horizontal box plot\n  geom_boxploth(aes(fill = Method), outlier.size = 0.5,width=3) +\n  # normal density plot\n  geom_density(aes(x = ValAbs), inherit.aes = FALSE) +\n  # # vertical lines at Q1 / Q2 / Q3\n  # stat_boxploth(geom = \"vline\", aes(xintercept = ..xlower..)) +\n   stat_boxploth(geom = \"vline\", aes(xintercept = ..xmiddle..)) +\n  # stat_boxploth(geom = \"vline\", aes(xintercept = ..xupper..)) +\n  # \n   facet_grid(Method ~ .) +\n    # reproduce original chart's color scale (o/w ordered factors will result\n  # in viridis scale by default, using the current version of ggplot2)\n  #scale_fill_discrete()+\n  scale_fill_manual(values = colors.methods)+\n  theme_bw()+   theme(legend.position=\"none\")+xlim(0,0.1)\n\n\n\n\n\n\n\n\nWe can clearly observe that the coex is generally more near to zero than the correlations.\n\nggplot(table.tot,aes(x=ValAbs, color=Method, y = Y_axis)) + \n  geom_point(alpha=0.8) +\n  scale_color_manual(values = colors.methods)+\n  scale_y_continuous(trans= \"log\",breaks = c(0,0.1,0.25,0.5)\n                         )+\n  scale_x_continuous(trans= \"log\",\n                     breaks = c(0.1,0.2,0.3, 0.4,0.5,0.8), limits = c(0.01,0.85))+\n  theme_bw()+   theme(legend.position=\"bottom\")+ \n  facet_grid(GeneType ~  Dataset)\n\n\n\n\n\n\n\n\n\nggplot(table.tot.hk,aes(x=abs(value), color=Method))+stat_ecdf(geom = \"point\", size = 0.5 )+scale_color_manual(values = colors.methods)+\n  scale_y_continuous(trans= \"exp\")+facet_grid(. ~  Dataset)\n\n\n\n\n\n\n\n\n\nggplot(table.tot,aes(x=Method,y=LogValAbs, fill=Method)) +\n#geom_half_boxplot(alpha=0.8) +\n  #geom_point(position = \"jitter\", size= 0.1,alpha = 0.3)+ \n  geom_boxplot(alpha=0.8,outlier.size = 0.1,outlier.colour='blue') +\n  theme_bw()+   theme(legend.position=\"none\")+#ylim(0,0.2)+\n  facet_grid(GeneType ~ Dataset , space = \"free_y\", scales = \"free\")+\n  scale_fill_manual(values = colors.methods)",
    "crumbs": [
      "Coex score evaluation",
      "General Coex Evaluation"
    ]
  },
  {
    "objectID": "generalCoexAssess.html#p-values",
    "href": "generalCoexAssess.html#p-values",
    "title": "General Coex Evaluation",
    "section": "p-values",
    "text": "p-values\n\ntable.tot.hk &lt;- NA\ntable.tot.neural &lt;- NA\nfor (file in list.files(\"CoexData/\",pattern = \"PValue\")) {\n  pval &lt;- read_fst(paste0(\"CoexData/\",file),to = 2)\n\n  colnames.pval &lt;- colnames(pval)\n  genesListPartial &lt;- genesList\n  for (na in names(genesListPartial)) {\n      if(!all(genesListPartial[[na]] %in% colnames.pval)){\n        print(na)\n        genesListPartial[[na]] &lt;- genesListPartial[[na]][-which(!genesList[[na]] %in% colnames.pval)]\n    }\n  }\n\n\n  pval &lt;- read_fst(paste0(\"CoexData/\",file), \n        columns = unlist(genesListPartial),)\n  pval &lt;- as.matrix(pval)\n  rownames(pval) &lt;- colnames.pval\n  \n  \n  if(all(diag(pval[colnames(pval),]) == 1)){\n      diag(pval[colnames(pval),]) = 0\n    }\n  \n  #pval &lt;- as.data.frame(as.matrix(pval))\n  if(str_detect(file,pattern = \"Cotan\")){\n    code &lt;- \"COTAN\"\n  }else if(str_detect(file,pattern = \"PValuesSCT\")){\n    code &lt;- \"Seurat SCT\"\n  }else if(str_detect(file,pattern = \"SeuratPValues\")){\n    code &lt;- \"Seurat\"\n  }else if(str_detect(file,pattern = \"MonoclePValues\")){\n    code &lt;- \"Monocle\"\n  }else if(str_detect(file,pattern = \"ScanPyPValues\")){\n    code &lt;- \"ScanPy\"\n  }\n  \n  \n  table.hk &lt;- as.data.frame(pval[,genesListPartial$hk])\n  table.hk$Gene1 &lt;- rownames(table.hk)\n  \n  table.hk &lt;- pivot_longer(as.data.frame(table.hk),\n                           cols = c(1:(ncol(table.hk)-1)),names_to = \"Gene2\")\n  table.hk$Method &lt;- code\n  table.hk$Dataset &lt;- str_flatten(str_split(file,pattern = \"_\",simplify = T)[,c(2,3)],collapse = \"_\")\n\n  table.tot.hk &lt;- rbind(table.tot.hk,table.hk)\n  table.tot.hk &lt;- table.tot.hk[! table.tot.hk$Gene1 == table.tot.hk$Gene2,]\n \n  #Not hk\n  pval &lt;- as.data.frame(pval)\n  table.neural &lt;- pval[c(genesListPartial$NPGs,genesListPartial$PNGs,genesListPartial$layers),                              c(genesListPartial$NPGs,genesListPartial$PNGs,genesListPartial$layers)]\n  \n  table.neural$Gene1 &lt;- rownames(table.neural)\n  \n  table.neural &lt;- pivot_longer(as.data.frame(table.neural),\n                           cols = c(1:(ncol(table.neural)-1)),names_to = \"Gene2\")\n  \n  table.neural$Method &lt;- code\n  table.neural$Dataset &lt;- str_flatten(str_split(file,pattern = \"_\",simplify = T)[,c(2,3)],collapse = \"_\")\n  \n  table.tot.neural &lt;- rbind(table.tot.neural,table.neural)\n  table.tot.neural &lt;- table.tot.neural[! table.tot.neural$Gene1 == table.tot.neural$Gene2,]\n}\n\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"hk\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n[1] \"layers\"\n\ntable.tot.hk &lt;- table.tot.hk[2:nrow(table.tot.hk),]\ntable.tot.hk$GeneType &lt;- \"Constitutive\" \ntable.tot.neural &lt;- table.tot.neural[2:nrow(table.tot.neural),]\ntable.tot.neural$GeneType &lt;- \"Neural\"\n\n## For ECDL\ntmp.tot &lt;- NA\nfor (method in unique(table.tot.hk$Method)) {\n  tmp &lt;- as.data.frame(table.tot.hk[table.tot.hk$Method == method,])\n  tmp$n &lt;- NA\n  tmp[order(abs(tmp$value)),]$n &lt;- c(1:dim(tmp)[1])/(dim(tmp)[1]+1)\n  tmp$Y_axis &lt;- 1-tmp$n\n  tmp.tot &lt;- rbind(tmp.tot,tmp)\n}\ntmp.tot &lt;- tmp.tot[2:nrow(tmp.tot),]\ntable.tot.hk &lt;- tmp.tot\n\ntmp.tot &lt;- NA\nfor (method in unique(table.tot.neural$Method)) {\n  tmp &lt;- as.data.frame(table.tot.neural[table.tot.neural$Method == method,])\n  tmp$n &lt;- NA\n  tmp[order(abs(tmp$value)),]$n &lt;- c(1:dim(tmp)[1])/(dim(tmp)[1]+1)\n  tmp$Y_axis &lt;- 1-tmp$n\n  tmp.tot &lt;- rbind(tmp.tot,tmp)\n}\ntmp.tot &lt;- tmp.tot[2:nrow(tmp.tot),]\ntable.tot.neural &lt;- tmp.tot\n\n############\n\ntable.tot.hk$Method &lt;- factor(table.tot.hk$Method, levels = c(\"Seurat\", \"Seurat SCT\", \"Monocle\", \"ScanPy\", \"COTAN\"))\ntable.tot.neural$Method &lt;- factor(table.tot.neural$Method, levels = c(\"Seurat\", \"Seurat SCT\", \"Monocle\", \"ScanPy\", \"COTAN\"))\n\ntable.tot.neural &lt;- table.tot.neural[order(table.tot.neural$Method,decreasing = F),]\ntable.tot.hk &lt;- table.tot.hk[order(table.tot.hk$Method,decreasing = F),]\n\ntable.tot &lt;- rbind(table.tot.hk,table.tot.neural) \ntable.tot &lt;- table.tot[!table.tot$Gene1 == table.tot$Gene2,]\n\nidentical(table.tot[table.tot$Method == \"COTAN\",]$Gene1,\n          table.tot[table.tot$Method == \"Seurat\",]$Gene1 )\n\n[1] FALSE\n\nidentical(table.tot[table.tot$Method == \"COTAN\",]$Gene1,\n          table.tot[table.tot$Method == \"Monocle\",]$Gene1 )\n\n[1] TRUE\n\nhead(table.tot)\n\n                Gene1  Gene2       value Method                  Dataset\n3834146 0610007N19Rik  Calm1 0.849134106 Seurat CorticalCells_GSM2861511\n3834147 0610007N19Rik Cox6b1 0.143918297 Seurat CorticalCells_GSM2861511\n3834148 0610007N19Rik   Ppia 0.343763970 Seurat CorticalCells_GSM2861511\n3834149 0610007N19Rik  Rpl18 0.015566169 Seurat CorticalCells_GSM2861511\n3834150 0610007N19Rik  Cox7c 0.001363415 Seurat CorticalCells_GSM2861511\n3834151 0610007N19Rik    Erh 0.126004288 Seurat CorticalCells_GSM2861511\n            GeneType         n    Y_axis\n3834146 Constitutive 0.8971864 0.1028136\n3834147 Constitutive 0.3391140 0.6608860\n3834148 Constitutive 0.5164962 0.4835038\n3834149 Constitutive 0.1654806 0.8345194\n3834150 Constitutive 0.1020740 0.8979260\n3834151 Constitutive 0.3209477 0.6790523\n\n\n\nConstitutive genes\n\nggplot(table.tot[table.tot$GeneType == \"Constitutive\",], aes(y = value)) +\n  geom_boxplot(aes(fill = Method), outlier.size = 0.5,width=3) +\n  scale_fill_discrete()+ scale_fill_manual(values = colors.methods)+\n  facet_grid(. ~ Dataset )+\n  theme_bw()#+   theme(legend.position=\"none\")\n\n\n\n\n\n\n\n\n\nggplot(table.tot.hk,aes(x=value,y=n, color=Method))+geom_point(size = 0.5 )+\n  scale_color_manual(values = colors.methods)+\n  facet_grid(. ~ Dataset )+\n  theme_bw()\n\n\n\n\n\n\n\n\n\nggplot(table.tot.hk,aes(x=value,y=n, color=Method))+geom_point(size = 0.5 )+ scale_x_continuous(trans = log_trans(base = 10),\n    breaks = trans_breaks(\"log10\", function(x) 10^x),\n    labels = trans_format(\"log10\", math_format(10^.x)),limits = c(10^(-100),0.05)) + ylim(0,0.4) +scale_color_manual(values = colors.methods)+facet_grid(. ~ Dataset )+\n  theme_bw()\n\n\n\n\n\n\n\n\nWe can observe from this plot that COTAN has lower false positive error in fact the number of constitutive genes with p-values lower than 0.05 is quite smaller than from Seurat (both normalization).\n\nggplot(table.tot[table.tot$GeneType == \"Constitutive\",],aes(x=value, color=Method))+geom_density()+xlim(0,0.05)+\n  scale_color_manual(values = colors.methods)+facet_grid(. ~ Dataset )+\n  theme_bw() \n\n\n\n\n\n\n\n\n\n\nNeural genes\n\nggplot(table.tot[table.tot$GeneType == \"Neural\",], aes(y = (value))) +\n  geom_boxplot(aes(fill = Method), outlier.size = 0.5,width=3) +\n  scale_fill_discrete()+scale_fill_manual(values = colors.methods)+facet_grid(. ~ Dataset )+\n  theme_bw() #+ theme(legend.position=\"none\")\n\n\n\n\n\n\n\n\n\nggplot(table.tot[table.tot$GeneType == \"Neural\",], aes(y = log(value+0.001))) +\n  geom_boxplot(aes(fill = Method), outlier.size = 0.5,width=3) +\n  scale_fill_discrete()+scale_fill_manual(values = colors.methods)+facet_grid(. ~ Dataset )+\n  theme_bw() #+ theme(legend.position=\"none\")\n\n\n\n\n\n\n\n\n\nggplot(table.tot.neural,aes(x=value,y=n, color=Method))+geom_point(size = 0.5 )+scale_color_manual(values = colors.methods)+\n  theme_bw()\n\n\n\n\n\n\n\n\n\nggplot(table.tot.neural,aes(x=value,y=n, color=Method))+geom_point(size = 0.5 )+ \n  scale_x_continuous(trans = log_trans(base = 10),\n    breaks = trans_breaks(\"log10\", function(x) 10^x),\n    labels = trans_format(\"log10\", math_format(10^.x)),\n    limits = c(0.0001,0.05)) +\n  scale_color_manual(values = colors.methods)+facet_grid(. ~ Dataset )+\n  theme_bw()\n\n\n\n\n\n\n\n\n\nggplot(table.tot.neural,aes(x=value,y=n, color=Method))+geom_point(size = 0.5,alpha = 0.8)+ \n  scale_x_continuous(trans = log_trans(base = 10),\n    breaks = trans_breaks(\"log10\", function(x) 10^x),\n    labels = trans_format(\"log10\", math_format(10^.x)),\n    limits = c(10^(-300),0.05)) + ylim(0,0.5)+\n  scale_color_manual(values = colors.methods)+facet_grid(. ~ Dataset )+\n  theme_bw()\n\n\n\n\n\n\n\n\n\n\nDirect comparision\n\nggplot(table.tot,aes(x=value, color=Method))+geom_density()+\n  facet_grid(GeneType ~ Dataset,scales=\"free\")+\n  scale_color_manual(values = colors.methods)+\n  theme_bw()\n\n\n\n\n\n\n\n\n\nggplot(table.tot,aes(x=value,y=n, color=Method))+geom_point(size = 0.8, alpha=0.8 )+ \n  scale_x_continuous(trans = log_trans(base = 10),\n    breaks = trans_breaks(\"log10\", function(x) 10^x),\n    labels = trans_format(\"log10\", math_format(10^.x)),\n    limits = c(1e-10,0.05)\n    ) + \n  facet_grid(. ~ GeneType ,scales=\"free\") +\n  scale_color_manual(values = colors.methods)+xlab(\"p-values\")+\n  theme_bw()+ theme(legend.position=\"right\")\n\n\n\n\n\n\n\n\n\nggplot(table.tot,aes(x=value,y=n, color=Method))+geom_point(size = 0.8, alpha=0.8 )+ \n  scale_x_continuous(trans = log_trans(base = 10),\n    breaks = trans_breaks(\"log10\", function(x) 10^x),\n    labels = trans_format(\"log10\", math_format(10^.x)),\n    limits = c(1e-10,0.05)\n    ) + \n  facet_grid(Dataset ~ GeneType ,scales=\"free\") +\n  scale_color_manual(values = colors.methods)+xlab(\"p-values\")+\n  theme_bw()+ theme(legend.position=\"right\")\n\n\n\n\n\n\n\n\n\n\nSys.time()\n\n[1] \"2024-05-08 19:52:31 CEST\"\n\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] grid      stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] fstcore_0.9.18        fst_0.9.8             dplyr_1.1.2          \n [4] circlize_0.4.15       ComplexHeatmap_2.16.0 COTAN_2.5.0          \n [7] scales_1.3.0          ggstance_0.3.6        Matrix_1.6-3         \n[10] cowplot_1.1.1         gridExtra_2.3         ggstatsplot_0.12.0   \n[13] gghalves_0.1.4        ggplot2_3.5.0         stringr_1.5.0        \n[16] tidyr_1.3.0          \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               tibble_3.2.1             \n  [5] polyclip_1.10-4           datawizard_0.9.0         \n  [7] fastDummies_1.7.3         lifecycle_1.0.3          \n  [9] doParallel_1.0.17         globals_0.16.2           \n [11] lattice_0.22-5            MASS_7.3-60              \n [13] insight_0.19.6            dendextend_1.17.1        \n [15] magrittr_2.0.3            plotly_4.10.2            \n [17] rmarkdown_2.24            yaml_2.3.7               \n [19] httpuv_1.6.11             Seurat_5.0.0             \n [21] sctransform_0.4.1         askpass_1.2.0            \n [23] spam_2.10-0               sp_2.1-1                 \n [25] spatstat.sparse_3.0-2     reticulate_1.36.1        \n [27] pbapply_1.7-2             RColorBrewer_1.1-3       \n [29] multcomp_1.4-25           abind_1.4-5              \n [31] Rtsne_0.17                purrr_1.0.1              \n [33] BiocGenerics_0.46.0       TH.data_1.1-2            \n [35] sandwich_3.1-0            IRanges_2.34.1           \n [37] S4Vectors_0.38.1          ggrepel_0.9.5            \n [39] irlba_2.3.5.1             listenv_0.9.0            \n [41] spatstat.utils_3.0-3      correlation_0.8.4        \n [43] umap_0.2.10.0             goftest_1.2-3            \n [45] RSpectra_0.16-1           spatstat.random_3.2-1    \n [47] dqrng_0.3.0               fitdistrplus_1.1-11      \n [49] parallelly_1.37.1         DelayedMatrixStats_1.22.5\n [51] leiden_0.4.3              codetools_0.2-19         \n [53] DelayedArray_0.26.7       tidyselect_1.2.0         \n [55] shape_1.4.6               farver_2.1.1             \n [57] viridis_0.6.4             ScaledMatrix_1.8.1       \n [59] matrixStats_1.2.0         stats4_4.3.2             \n [61] spatstat.explore_3.2-1    jsonlite_1.8.7           \n [63] GetoptLong_1.0.5          ellipsis_0.3.2           \n [65] progressr_0.14.0          ggridges_0.5.4           \n [67] survival_3.5-8            iterators_1.0.14         \n [69] emmeans_1.10.0            foreach_1.5.2            \n [71] tools_4.3.2               ica_1.0-3                \n [73] Rcpp_1.0.11               glue_1.7.0               \n [75] xfun_0.39                 MatrixGenerics_1.12.3    \n [77] ggthemes_5.1.0            withr_3.0.0              \n [79] fastmap_1.1.1             fansi_1.0.4              \n [81] openssl_2.1.0             digest_0.6.33            \n [83] rsvd_1.0.5                parallelDist_0.2.6       \n [85] R6_2.5.1                  mime_0.12                \n [87] estimability_1.5          colorspace_2.1-0         \n [89] scattermore_1.2           tensor_1.5               \n [91] spatstat.data_3.0-1       utf8_1.2.3               \n [93] generics_0.1.3            data.table_1.15.0        \n [95] httr_1.4.6                htmlwidgets_1.6.2        \n [97] S4Arrays_1.2.0            parameters_0.21.1        \n [99] uwot_0.1.16               pkgconfig_2.0.3          \n[101] gtable_0.3.3              statsExpressions_1.5.1   \n[103] lmtest_0.9-40             htmltools_0.5.8          \n[105] dotCall64_1.1-0           clue_0.3-64              \n[107] SeuratObject_5.0.0        png_0.1-8                \n[109] knitr_1.43                rstudioapi_0.15.0        \n[111] reshape2_1.4.4            rjson_0.2.21             \n[113] nlme_3.1-163              coda_0.19-4              \n[115] zoo_1.8-12                GlobalOptions_0.1.2      \n[117] KernSmooth_2.23-22        parallel_4.3.2           \n[119] miniUI_0.1.1.1            RcppZiggurat_0.1.6       \n[121] pillar_1.9.0              vctrs_0.6.3              \n[123] RANN_2.6.1                promises_1.2.0.1         \n[125] BiocSingular_1.16.0       beachmat_2.16.0          \n[127] xtable_1.8-4              cluster_2.1.6            \n[129] paletteer_1.6.0           evaluate_0.21            \n[131] zeallot_0.1.0             mvtnorm_1.2-2            \n[133] cli_3.6.1                 compiler_4.3.2           \n[135] rlang_1.1.1               crayon_1.5.2             \n[137] future.apply_1.11.0       labeling_0.4.2           \n[139] rematch2_2.1.2            plyr_1.8.8               \n[141] stringi_1.8.1             viridisLite_0.4.2        \n[143] deldir_2.0-2              BiocParallel_1.34.2      \n[145] assertthat_0.2.1          munsell_0.5.0            \n[147] lazyeval_0.2.2            spatstat.geom_3.2-4      \n[149] bayestestR_0.13.1         PCAtools_2.14.0          \n[151] RcppHNSW_0.6.0            patchwork_1.2.0          \n[153] sparseMatrixStats_1.12.2  future_1.33.0            \n[155] shiny_1.8.0               ROCR_1.0-11              \n[157] Rfast_2.1.0               igraph_2.0.3             \n[159] RcppParallel_5.1.7",
    "crumbs": [
      "Coex score evaluation",
      "General Coex Evaluation"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE17.5MouseBrain.html",
    "href": "geneCoexAnalysisE17.5MouseBrain.html",
    "title": "Gene Correlation Analysis E17.5 Mouse Brain",
    "section": "",
    "text": "library(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(Hmisc)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(Rfast)\nlibrary(parallel)\nlibrary(doParallel)\nlibrary(HiClimR)\nlibrary(stringr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\ndataSetFile &lt;- \"Data/MouseCortexFromLoom/e17.5_ForebrainDorsal.cotan.RDS\"\nname &lt;- str_split(dataSetFile,pattern = \"/\",simplify = T)[3]\nname &lt;- str_remove(name,pattern = \".RDS\")\n\nproject = \"E17.5\"\n\n\nsetLoggingLevel(1)\noutDir &lt;- \"CoexData/\"\nsetLoggingFile(paste0(outDir, \"Logs/\",name,\".log\"))\n\nobj &lt;- readRDS(dataSetFile)\nfile_code = getMetadataElement(obj, datasetTags()[[\"cond\"]])\n\n\nsource(\"src/Functions.R\")\n\nTo compare the ability of COTAN to asses the real correlation between genes we define some pools of genes:\n\nConstitutive genes\nNeural progenitor genes\nPan neuronal genes\nSome layer marker genes\n\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = \n    c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E17.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE17.5MouseBrain.html#prologue",
    "href": "geneCoexAnalysisE17.5MouseBrain.html#prologue",
    "title": "Gene Correlation Analysis E17.5 Mouse Brain",
    "section": "",
    "text": "library(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(Hmisc)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(Rfast)\nlibrary(parallel)\nlibrary(doParallel)\nlibrary(HiClimR)\nlibrary(stringr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\ndataSetFile &lt;- \"Data/MouseCortexFromLoom/e17.5_ForebrainDorsal.cotan.RDS\"\nname &lt;- str_split(dataSetFile,pattern = \"/\",simplify = T)[3]\nname &lt;- str_remove(name,pattern = \".RDS\")\n\nproject = \"E17.5\"\n\n\nsetLoggingLevel(1)\noutDir &lt;- \"CoexData/\"\nsetLoggingFile(paste0(outDir, \"Logs/\",name,\".log\"))\n\nobj &lt;- readRDS(dataSetFile)\nfile_code = getMetadataElement(obj, datasetTags()[[\"cond\"]])\n\n\nsource(\"src/Functions.R\")\n\nTo compare the ability of COTAN to asses the real correlation between genes we define some pools of genes:\n\nConstitutive genes\nNeural progenitor genes\nPan neuronal genes\nSome layer marker genes\n\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = \n    c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E17.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE17.5MouseBrain.html#cotan",
    "href": "geneCoexAnalysisE17.5MouseBrain.html#cotan",
    "title": "Gene Correlation Analysis E17.5 Mouse Brain",
    "section": "COTAN",
    "text": "COTAN\n\nint.genes &lt;-getGenes(obj)\n\n\ncoexMat.big &lt;- getGenesCoex(obj)#[int.genes,int.genes]\n\ncoexMat &lt;- getGenesCoex(obj)[c(genesList$NPGs,genesList$hk,genesList$PNGs),c(genesList$NPGs,genesList$hk,genesList$PNGs)]\n\nf1 = colorRamp2(seq(-0.5,0.5, length = 3), c(\"#DC0000B2\", \"white\",\"#3C5488B2\" ))\n\nsplit.genes &lt;- factor(c(rep(\"NPGs\",length(genesList[[\"NPGs\"]])),\n                         rep(\"HK\",length(genesList[[\"hk\"]])),\n                         rep(\"PNGs\",length(genesList[[\"PNGs\"]]))\n                        ),\n                         levels = c(\"NPGs\",\"HK\",\"PNGs\"))\n\nlgd = Legend(col_fun = f1, title = \"COTAN coex\")\n\nhtmp &lt;- Heatmap(as.matrix(coexMat),\n        #width = ncol(coexMat)*unit(2.5, \"mm\"), \n        height = nrow(coexMat)*unit(3, \"mm\"),\n        cluster_rows = FALSE,\n        cluster_columns = FALSE,\n        col = f1,\n        row_names_side = \"left\",\n        row_names_gp = gpar(fontsize = 11),\n        column_names_gp  = gpar(fontsize = 11),\n        column_split = split.genes,\n        row_split = split.genes,\n        cluster_row_slices = FALSE, \n    cluster_column_slices = FALSE,\n    heatmap_legend_param = list(\n        title = \"COTAN coex\", at = c(-0.5, 0, 0.5),direction = \"horizontal\",\n        labels = c(\"-0.5\", \"0\", \"0.5\")\n    )\n   )\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\nGDI_DF &lt;- calculateGDI(obj)\nGDI_DF$geneType &lt;- NA\nfor (cat in names(genesList)) {\n  GDI_DF[rownames(GDI_DF) %in% genesList[[cat]],]$geneType &lt;- cat\n}\n\nGDI_DF$GDI_centered &lt;- scale(GDI_DF$GDI,center = T,scale = T)\n\nwrite.csv(GDI_DF,paste0(\"CoexData/\",\"Variance_GDI_genes\",file_code,\".csv\"))\n\n\nGDI_DF[unlist(genesList),]\n\n         sum.raw.norm      GDI  exp.cells geneType GDI_centered\nNes          5.354860 2.677591  7.6611269     NPGs   2.12164684\nVim          7.975351 3.653910 23.7130118     NPGs   4.21500654\nSox2         5.379522 3.446151  6.6477503     NPGs   3.76954465\nSox1         4.826847 2.321489  3.8913660     NPGs   1.35811585\nNotch1       5.491804 3.644973  8.1070126     NPGs   4.19584566\nHes1         5.241888 3.715489  4.4183218     NPGs   4.34704054\nHes5         6.367234 3.706690  6.9720308     NPGs   4.32817408\nPax6         6.445184 3.410841 15.2006486     NPGs   3.69383388\nMap2         8.945220 2.919301 87.3530604     PNGs   2.63990577\nTubb3       10.669909 3.802683 93.9602756     PNGs   4.53399718\nNeurod1      4.512176 1.570675  3.2833401     PNGs  -0.25172970\nNefm         5.320286 2.010487  6.2829347     PNGs   0.69128553\nNefl         5.592561 2.179108  5.2695582     PNGs   1.05283171\nDcx          8.048568 2.850882 60.6404540     PNGs   2.49320624\nTbr1         6.829413 1.953272 23.6724767     PNGs   0.56860885\nCalm1        9.893664 1.604866 97.6489664       hk  -0.17841926\nCox6b1       9.028070 2.184997 90.8796109       hk   1.06545895\nPpia         9.189622 2.372214 90.7580057       hk   1.46687705\nRpl18        9.554798 2.279009 96.3518443       hk   1.26703311\nCox7c        9.114185 2.170535 91.9740576       hk   1.03444998\nErh          7.929830 2.390307 62.5050669       hk   1.50567107\nH3f3a        9.697620 2.349951 96.3518443       hk   1.41914319\nTaf1         6.206264 1.475777 16.9436563       hk  -0.45520422\nTaf2         5.648276 1.342082 10.2959060       hk  -0.74186428\nGapdh        8.621629 2.367727 80.5026348       hk   1.45725765\nActb        10.484376 1.292044 99.6351844       hk  -0.84915323\nGolph3       5.947435 1.643738 13.8629915       hk  -0.09507358\nZfr          7.359818 1.675085 43.6157276       hk  -0.02786120\nSub1         8.434336 2.419785 75.3952169       hk   1.56887719\nTars         5.930970 1.571117 13.5387110       hk  -0.25078126\nAmacr        4.339515 1.454028  2.9995946       hk  -0.50183660\nReln         6.723819 2.232753  4.7020673   layers   1.16785364\nLhx5         4.079754 2.579243  1.3376571   layers   1.91077584\nCux1         7.968038 2.190834 50.0202675   layers   1.07797409\nSatb2        9.062287 3.390857 57.7219295   layers   3.65098593\nTle1         6.594351 1.618541 21.7673287   layers  -0.14909808\nMef2c        9.071730 3.175241 51.6011350   layers   3.18867667\nRorb         6.282362 1.926899 13.1333604   layers   0.51206224\nSox5         8.049776 2.285548 43.4130523   layers   1.28105506\nBcl11b       7.109492 2.116159 21.4835833   layers   0.91786051\nFezf2        6.506386 2.096344 18.1597081   layers   0.87537638\nFoxp2        6.557695 2.455294 14.4304824   layers   1.64501202\nNtf3         6.051423 2.225961  6.9314957   layers   1.15329231\nRasgrf2      4.096064 1.795794  2.0267531   layers   0.23095491\nNA                 NA       NA         NA     &lt;NA&gt;           NA\nCux2         7.067401 2.518402 26.4288610   layers   1.78032434\nSlc17a6      6.228895 2.065176 14.4304824   layers   0.80854728\nSema3c       7.553723 2.676192 31.6984191   layers   2.11864837\nThsd7a       5.951856 1.810789  9.6068099   layers   0.26310666\nSulf2        4.348066 1.725374  2.3915687   layers   0.07996546\nKcnk2        7.512577 1.895654 41.7511147   layers   0.44506877\nGrik3        5.173332 1.974505  4.4993920   layers   0.61413535\nEtv1         5.383398 2.639083  5.8775841   layers   2.03908090\nTle4         5.664300 1.881239  8.4718281   layers   0.41416114\nTmem200a     5.235004 2.081666  6.3234698   layers   0.84390268\nGlra2        6.076633 2.094562 11.2687475   layers   0.87155349\nEtv1.1       5.383398 2.639083  5.8775841   layers   2.03908090\nHtr1f        3.780477 1.777503  1.2160519   layers   0.19173786\nSulf1        2.631257 1.128008  0.3648156   layers  -1.20086709\nNA.1               NA       NA         NA     &lt;NA&gt;           NA\nSyt6         4.757520 1.609693  2.6347791   layers  -0.16807098\n\n\n\nGDIPlot(obj,GDIIn = GDI_DF, genes = genesList,GDIThreshold = 1.4)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E17.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE17.5MouseBrain.html#seurat-correlation",
    "href": "geneCoexAnalysisE17.5MouseBrain.html#seurat-correlation",
    "title": "Gene Correlation Analysis E17.5 Mouse Brain",
    "section": "Seurat correlation",
    "text": "Seurat correlation\n\nsrat&lt;- CreateSeuratObject(counts = getRawData(obj), \n                          project = project, \n                          min.cells = 3, \n                          min.features = 200)\nsrat[[\"percent.mt\"]] &lt;- PercentageFeatureSet(srat, pattern = \"^mt-\")\nsrat &lt;- NormalizeData(srat)\nsrat &lt;- FindVariableFeatures(srat, selection.method = \"vst\", nfeatures = 2000)\n\n# plot variable features with and without labels\nplot1 &lt;- VariableFeaturePlot(srat)\n\nplot1$data$centered_variance &lt;- scale(plot1$data$variance.standardized,\n                                      center = T,scale = F)\n\nwrite.csv(plot1$data,paste0(\"CoexData/\",\n                            \"Variance_Seurat_genes\",\n                            getMetadataElement(obj, \n                                               datasetTags()[[\"cond\"]]),\".csv\"))\n\nLabelPoints(plot = plot1, points = c(genesList$NPGs,genesList$PNGs,genesList$layers), repel = TRUE)\n\n\n\n\n\n\n\n\n\nLabelPoints(plot = plot1, points = c(genesList$hk), repel = TRUE)\n\n\n\n\n\n\n\n\n\nall.genes &lt;- rownames(srat)\nsrat &lt;- ScaleData(srat, features = all.genes)\nseurat.data = GetAssayData(srat[[\"RNA\"]],layer = \"data\")\n\n\ncorr.pval.list &lt;- correlation_pvalues(data = seurat.data,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nseurat.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(seurat.data.cor.big, \n                         genesList, title=\"Seurat corr\")\n\n\np_values.fromSeurat &lt;- corr.pval.list$p_values\nseurat.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger   (Mb)   max used   (Mb)\nNcells   7121123  380.4   11454522  611.8   11454522  611.8\nVcells 766000052 5844.2 1271129210 9698.0 1191235271 9088.5\n\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\nSeurat SC Transform\n\nsrat &lt;-  SCTransform(srat, \n                     method = \"glmGamPoi\", \n                     vars.to.regress = \"percent.mt\", \n                     verbose = FALSE)\n\nseurat.data &lt;- GetAssayData(srat[[\"SCT\"]],layer = \"data\")\n\n#Remove genes with all zeros\nseurat.data &lt;-seurat.data[rowSums(seurat.data) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(seurat.data,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nseurat.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(seurat.data.cor.big, \n                         genesList, title=\"Seurat corr SCT\")\n\n\n\np_values.fromSeurat &lt;- corr.pval.list$p_values\nseurat.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   8850105  472.7   16721112   893.1   13569547   724.7\nVcells 721897666 5507.7 1757477180 13408.5 1525429261 11638.2\n\ndraw(htmp, heatmap_legend_side=\"right\")",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E17.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE17.5MouseBrain.html#monocle",
    "href": "geneCoexAnalysisE17.5MouseBrain.html#monocle",
    "title": "Gene Correlation Analysis E17.5 Mouse Brain",
    "section": "Monocle",
    "text": "Monocle\n\nlibrary(monocle3)\n\n\ncds &lt;- new_cell_data_set(getRawData(obj),\n                         cell_metadata = getMetadataCells(obj),\n                         gene_metadata = getMetadataGenes(obj)\n                         )\ncds &lt;- preprocess_cds(cds, num_dim = 100)\n\nnormalized_counts &lt;- normalized_counts(cds)\n\n\n#Remove genes with all zeros\nnormalized_counts &lt;- normalized_counts[rowSums(normalized_counts) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(normalized_counts,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nrm(normalized_counts)\n\nmonocle.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(data.cor.big = monocle.data.cor.big,\n                         genesList,\n                         title = \"Monocle corr\")\n\n\np_values.from.monocle &lt;- corr.pval.list$p_values\nmonocle.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   9961818  532.1   16721112   893.1   16721112   893.1\nVcells 795023729 6065.6 1757477180 13408.5 1757464389 13408.4\n\ndraw(htmp, heatmap_legend_side=\"right\")",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E17.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE17.5MouseBrain.html#scanpy",
    "href": "geneCoexAnalysisE17.5MouseBrain.html#scanpy",
    "title": "Gene Correlation Analysis E17.5 Mouse Brain",
    "section": "ScanPy",
    "text": "ScanPy\n\nlibrary(reticulate)\n\ndirOutScP &lt;- paste0(\"CoexData/ScanPy/\")\nif (!dir.exists(dirOutScP)) {\n  dir.create(dirOutScP)\n}\n\nSys.setenv(RETICULATE_PYTHON = \"../../../bin/python3\")\n  py &lt;- import(\"sys\")\n  \n  source_python(\"src/scanpyGenesExpression.py\")\n  scanpyFDR(getRawData(obj), \n                  getMetadataCells(obj), \n                  getMetadataGenes(obj), \n                   \"mt\", \n                   dirOutScP, \n                   file_code,\n            int.genes)\n\nnormalized_counts &lt;- read.csv(paste0(dirOutScP,\n                                     file_code,\"_Scampy_expression_all_genes.gz\"),header = T,row.names = 1)\n\nnormalized_counts &lt;- t(normalized_counts)\n\n\n#Remove genes with all zeros\nnormalized_counts &lt;-normalized_counts[rowSums(normalized_counts) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(normalized_counts,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nScanPy.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\n\nhtmp &lt;- correlation_plot(data.cor.big = ScanPy.data.cor.big,\n                         genesList,\n                         title = \"ScanPy corr\")\n\np_values.from.ScanPy &lt;- corr.pval.list$p_values\nScanPy.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   9985106  533.3   16721112   893.1   16721112   893.1\nVcells 829560962 6329.1 1757477180 13408.5 1757476100 13408.5\n\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\n\nSys.time()\n\n[1] \"2024-05-06 13:29:24 CEST\"\n\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3;  LAPACK version 3.9.0\n\nlocale:\n[1] C.UTF-8\n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n [1] stats4    parallel  grid      stats     graphics  grDevices utils    \n [8] datasets  methods   base     \n\nother attached packages:\n [1] reticulate_1.36.1           monocle3_1.3.4             \n [3] SingleCellExperiment_1.22.0 SummarizedExperiment_1.30.2\n [5] GenomicRanges_1.52.0        GenomeInfoDb_1.36.1        \n [7] IRanges_2.34.1              S4Vectors_0.38.1           \n [9] MatrixGenerics_1.12.3       matrixStats_1.2.0          \n[11] Biobase_2.60.0              BiocGenerics_0.46.0        \n[13] fstcore_0.9.18              fst_0.9.8                  \n[15] stringr_1.5.0               HiClimR_2.2.1              \n[17] doParallel_1.0.17           iterators_1.0.14           \n[19] foreach_1.5.2               Rfast_2.1.0                \n[21] RcppParallel_5.1.7          RcppZiggurat_0.1.6         \n[23] Rcpp_1.0.11                 patchwork_1.2.0            \n[25] Seurat_5.0.0                SeuratObject_5.0.0         \n[27] sp_2.1-1                    Hmisc_5.1-0                \n[29] dplyr_1.1.2                 circlize_0.4.15            \n[31] ComplexHeatmap_2.16.0       COTAN_2.5.0                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               bitops_1.0-7             \n  [5] tibble_3.2.1              polyclip_1.10-4          \n  [7] rpart_4.1.23              fastDummies_1.7.3        \n  [9] lifecycle_1.0.3           globals_0.16.2           \n [11] lattice_0.22-5            MASS_7.3-60              \n [13] backports_1.4.1           dendextend_1.17.1        \n [15] magrittr_2.0.3            plotly_4.10.2            \n [17] rmarkdown_2.24            yaml_2.3.7               \n [19] httpuv_1.6.11             glmGamPoi_1.12.2         \n [21] sctransform_0.4.1         spam_2.10-0              \n [23] askpass_1.2.0             spatstat.sparse_3.0-2    \n [25] minqa_1.2.5               cowplot_1.1.1            \n [27] pbapply_1.7-2             RColorBrewer_1.1-3       \n [29] zlibbioc_1.46.0           abind_1.4-5              \n [31] Rtsne_0.17                purrr_1.0.1              \n [33] RCurl_1.98-1.12           nnet_7.3-19              \n [35] GenomeInfoDbData_1.2.10   ggrepel_0.9.5            \n [37] irlba_2.3.5.1             listenv_0.9.0            \n [39] spatstat.utils_3.0-3      terra_1.7-39             \n [41] umap_0.2.10.0             goftest_1.2-3            \n [43] RSpectra_0.16-1           spatstat.random_3.2-1    \n [45] dqrng_0.3.0               fitdistrplus_1.1-11      \n [47] parallelly_1.37.1         DelayedMatrixStats_1.22.5\n [49] ncdf4_1.22                leiden_0.4.3             \n [51] codetools_0.2-19          DelayedArray_0.26.7      \n [53] tidyselect_1.2.0          shape_1.4.6              \n [55] farver_2.1.1              lme4_1.1-34              \n [57] ScaledMatrix_1.8.1        viridis_0.6.4            \n [59] base64enc_0.1-3           spatstat.explore_3.2-1   \n [61] jsonlite_1.8.7            GetoptLong_1.0.5         \n [63] ellipsis_0.3.2            progressr_0.14.0         \n [65] Formula_1.2-5             ggridges_0.5.4           \n [67] survival_3.5-8            tools_4.3.2              \n [69] ica_1.0-3                 glue_1.7.0               \n [71] gridExtra_2.3             xfun_0.39                \n [73] ggthemes_5.1.0            withr_3.0.0              \n [75] fastmap_1.1.1             boot_1.3-28              \n [77] fansi_1.0.4               openssl_2.1.0            \n [79] digest_0.6.33             rsvd_1.0.5               \n [81] parallelDist_0.2.6        R6_2.5.1                 \n [83] mime_0.12                 colorspace_2.1-0         \n [85] Cairo_1.6-1               scattermore_1.2          \n [87] tensor_1.5                spatstat.data_3.0-1      \n [89] utf8_1.2.3                tidyr_1.3.0              \n [91] generics_0.1.3            data.table_1.15.0        \n [93] httr_1.4.6                htmlwidgets_1.6.2        \n [95] S4Arrays_1.2.0            uwot_0.1.16              \n [97] pkgconfig_2.0.3           gtable_0.3.3             \n [99] lmtest_0.9-40             XVector_0.40.0           \n[101] htmltools_0.5.8           dotCall64_1.1-0          \n[103] clue_0.3-64               scales_1.3.0             \n[105] png_0.1-8                 knitr_1.43               \n[107] rstudioapi_0.15.0         reshape2_1.4.4           \n[109] rjson_0.2.21              nloptr_2.0.3             \n[111] checkmate_2.3.0           nlme_3.1-163             \n[113] zoo_1.8-12                GlobalOptions_0.1.2      \n[115] KernSmooth_2.23-22        miniUI_0.1.1.1           \n[117] foreign_0.8-86            pillar_1.9.0             \n[119] vctrs_0.6.3               RANN_2.6.1               \n[121] promises_1.2.0.1          BiocSingular_1.16.0      \n[123] beachmat_2.16.0           xtable_1.8-4             \n[125] cluster_2.1.6             htmlTable_2.4.1          \n[127] evaluate_0.21             zeallot_0.1.0            \n[129] cli_3.6.1                 compiler_4.3.2           \n[131] rlang_1.1.1               crayon_1.5.2             \n[133] future.apply_1.11.0       labeling_0.4.2           \n[135] plyr_1.8.8                stringi_1.8.1            \n[137] viridisLite_0.4.2         deldir_2.0-2             \n[139] BiocParallel_1.34.2       assertthat_0.2.1         \n[141] munsell_0.5.0             lazyeval_0.2.2           \n[143] spatstat.geom_3.2-4       PCAtools_2.14.0          \n[145] Matrix_1.6-3              RcppHNSW_0.6.0           \n[147] sparseMatrixStats_1.12.2  future_1.33.0            \n[149] ggplot2_3.5.0             shiny_1.8.0              \n[151] ROCR_1.0-11               igraph_2.0.3",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E17.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE13.5Yuzwa.html",
    "href": "geneCoexAnalysisE13.5Yuzwa.html",
    "title": "Gene Correlation Analysis E13.5 for Mouse Cortex",
    "section": "",
    "text": "library(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(Hmisc)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(Rfast)\nlibrary(parallel)\nlibrary(doParallel)\nlibrary(HiClimR)\nlibrary(stringr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\ndataSetFile &lt;- \"Data/Yuzwa_MouseCortex/CorticalCells_GSM2861511_E135.cotan.RDS\"\nname &lt;- str_split(dataSetFile,pattern = \"/\",simplify = T)[3]\nname &lt;- str_remove(name,pattern = \".RDS\")\n\nproject = \"E13.5\"\n\nsetLoggingLevel(1)\noutDir &lt;- \"CoexData/\"\nsetLoggingFile(paste0(outDir, \"Logs/\",name,\".log\"))\n\nobj &lt;- readRDS(dataSetFile)\nfile_code = getMetadataElement(obj, datasetTags()[[\"cond\"]])\n\n\nsource(\"src/Functions.R\")\n\nTo compare the ability of COTAN to asses the real correlation between genes we define some pools of genes:\n\nConstitutive genes\nNeural progenitor genes\nPan neuronal genes\nSome layer marker genes\n\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = \n    c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "Correlation analysis for E13.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE13.5Yuzwa.html#prologue",
    "href": "geneCoexAnalysisE13.5Yuzwa.html#prologue",
    "title": "Gene Correlation Analysis E13.5 for Mouse Cortex",
    "section": "",
    "text": "library(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(Hmisc)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(Rfast)\nlibrary(parallel)\nlibrary(doParallel)\nlibrary(HiClimR)\nlibrary(stringr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\ndataSetFile &lt;- \"Data/Yuzwa_MouseCortex/CorticalCells_GSM2861511_E135.cotan.RDS\"\nname &lt;- str_split(dataSetFile,pattern = \"/\",simplify = T)[3]\nname &lt;- str_remove(name,pattern = \".RDS\")\n\nproject = \"E13.5\"\n\nsetLoggingLevel(1)\noutDir &lt;- \"CoexData/\"\nsetLoggingFile(paste0(outDir, \"Logs/\",name,\".log\"))\n\nobj &lt;- readRDS(dataSetFile)\nfile_code = getMetadataElement(obj, datasetTags()[[\"cond\"]])\n\n\nsource(\"src/Functions.R\")\n\nTo compare the ability of COTAN to asses the real correlation between genes we define some pools of genes:\n\nConstitutive genes\nNeural progenitor genes\nPan neuronal genes\nSome layer marker genes\n\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = \n    c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "Correlation analysis for E13.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE13.5Yuzwa.html#cotan",
    "href": "geneCoexAnalysisE13.5Yuzwa.html#cotan",
    "title": "Gene Correlation Analysis E13.5 for Mouse Cortex",
    "section": "COTAN",
    "text": "COTAN\n\nint.genes &lt;-getGenes(obj)\n\n\ncoexMat.big &lt;- getGenesCoex(obj)#[int.genes,int.genes]\n\ncoexMat &lt;- getGenesCoex(obj)[c(genesList$NPGs,genesList$hk,genesList$PNGs),c(genesList$NPGs,genesList$hk,genesList$PNGs)]\n\nf1 = colorRamp2(seq(-0.5,0.5, length = 3), c(\"#DC0000B2\", \"white\",\"#3C5488B2\" ))\n\nsplit.genes &lt;- factor(c(rep(\"NPGs\",length(genesList[[\"NPGs\"]])),\n                         rep(\"HK\",length(genesList[[\"hk\"]])),\n                         rep(\"PNGs\",length(genesList[[\"PNGs\"]]))\n                        ),\n                         levels = c(\"NPGs\",\"HK\",\"PNGs\"))\n\nlgd = Legend(col_fun = f1, title = \"COTAN coex\")\n\nhtmp &lt;- Heatmap(as.matrix(coexMat),\n        #width = ncol(coexMat)*unit(2.5, \"mm\"), \n        height = nrow(coexMat)*unit(3, \"mm\"),\n        cluster_rows = FALSE,\n        cluster_columns = FALSE,\n        col = f1,\n        row_names_side = \"left\",\n        row_names_gp = gpar(fontsize = 11),\n        column_names_gp  = gpar(fontsize = 11),\n        column_split = split.genes,\n        row_split = split.genes,\n        cluster_row_slices = FALSE, \n    cluster_column_slices = FALSE,\n    heatmap_legend_param = list(\n        title = \"COTAN coex\", at = c(-0.5, 0, 0.5),direction = \"horizontal\",\n        labels = c(\"-0.5\", \"0\", \"0.5\")\n    )\n   )\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\nGDI_DF &lt;- calculateGDI(obj)\nGDI_DF$geneType &lt;- NA\nfor (cat in names(genesList)) {\n  GDI_DF[rownames(GDI_DF) %in% genesList[[cat]],]$geneType &lt;- cat\n}\n\nGDI_DF$GDI_centered &lt;- scale(GDI_DF$GDI,center = T,scale = T)\n\nwrite.csv(GDI_DF,paste0(\"CoexData/\",\"Variance_GDI_genes\",file_code,\".csv\"))\n\n\nGDI_DF[unlist(genesList),]\n\n         sum.raw.norm      GDI  exp.cells geneType GDI_centered\nNes          6.408692 2.647419 23.1115108     NPGs  4.418329327\nVim          7.312324 2.551967 41.3669065     NPGs  4.083250142\nSox2         6.185654 2.911622 19.1546763     NPGs  5.345792150\nSox1         3.559135 1.880001  2.7877698     NPGs  1.724370053\nNotch1       4.800041 2.166044  7.4640288     NPGs  2.728500194\nHes1         4.886836 2.553616  7.9136691     NPGs  4.089038941\nHes5         5.693747 2.751355 11.5107914     NPGs  4.783186933\nPax6         5.993715 2.670699 17.7158273     NPGs  4.500049648\nMap2         7.442345 2.359424 59.3525180     PNGs  3.407343330\nTubb3        8.588602 2.719463 79.4964029     PNGs  4.671233319\nNeurod1      6.711720 2.015698 26.1690647     PNGs  2.200723866\nNefm         4.837197 1.791972  8.4532374     PNGs  1.415351634\nNefl         3.221387 1.405750  1.8884892     PNGs  0.059550935\nDcx          7.327976 2.605916 53.6870504     PNGs  4.272634438\nTbr1         6.713621 2.557574 37.1402878     PNGs  4.102935005\nCalm1        8.848612 1.258354 93.7949640       hk -0.457871717\nCox6b1       7.730664 1.403952 77.6079137       hk  0.053235962\nPpia         5.880634 1.517396 24.1007194       hk  0.451472872\nRpl18        7.242657 1.440153 61.6906475       hk  0.180318242\nCox7c        6.139111 1.409634 31.8345324       hk  0.073183680\nErh          4.868970 1.538559 10.9712230       hk  0.525765263\nH3f3a        7.360796 1.375840 68.1654676       hk -0.045447274\nTaf1         5.871166 1.296737 20.7733813       hk -0.323130578\nTaf2         5.310284 1.282004 13.4892086       hk -0.374852844\nGapdh        3.206206 1.449379  2.3381295       hk  0.212705058\nActb         9.921265 0.894289 99.1906475       hk -1.735893435\nGolph3       5.007818 1.281697 10.1618705       hk -0.375928017\nZfr          6.490652 1.446589 35.9712230       hk  0.202909958\nSub1         7.383003 1.618534 62.5899281       hk  0.806510422\nTars         5.450030 1.285601 16.0071942       hk -0.362225062\nAmacr        3.191098 1.096773  1.5287770       hk -1.025089118\nReln         3.726806 1.242825  2.1582734   layers -0.512384761\nNA                 NA       NA         NA     &lt;NA&gt;           NA\nCux1         5.933575 1.939433 20.8633094   layers  1.933000923\nSatb2        5.368174 1.665243 12.6798561   layers  0.970477743\nTle1         4.897234 1.760796  9.8021583   layers  1.305910297\nMef2c        6.152818 2.759922 21.0431655   layers  4.813259827\nRorb         4.875888 1.660140  8.3633094   layers  0.952565229\nSox5         7.276191 2.404274 47.9316547   layers  3.564787044\nBcl11b       7.571149 2.656745 54.0467626   layers  4.451065776\nFezf2        6.718361 2.297884 36.1510791   layers  3.191312576\nFoxp2        4.357485 1.350679  4.9460432   layers -0.133772145\nNtf3         2.147161 1.266745  0.8093525   layers -0.428416587\nNA.1               NA       NA         NA     &lt;NA&gt;           NA\nPvrl3        4.546763 1.600616  6.8345324   layers  0.743609475\nCux2         4.718140 1.538965  6.7446043   layers  0.527188512\nSlc17a6      5.699010 1.917841 14.0287770   layers  1.857203373\nSema3c       4.866232 1.435579  7.1942446   layers  0.164262095\nThsd7a       3.836608 1.257654  1.7086331   layers -0.460330847\nSulf2        2.671440 1.498034  1.6187050   layers  0.383504826\nKcnk2        4.495542 1.271818  6.1151079   layers -0.410607221\nGrik3        4.020369 1.928627  3.8669065   layers  1.895067663\nEtv1         3.735043 1.388003  2.5179856   layers -0.002748532\nTle4         5.288375 1.877388 10.9712230   layers  1.715197034\nTmem200a     2.905427 1.228125  1.5287770   layers -0.563988740\nGlra2        4.296262 2.230806  6.3848921   layers  2.955840432\nEtv1.1       3.735043 1.388003  2.5179856   layers -0.002748532\nNA.2               NA       NA         NA     &lt;NA&gt;           NA\nSulf1        1.254408 1.057413  0.3597122   layers -1.163260269\nNA.3               NA       NA         NA     &lt;NA&gt;           NA\nSyt6         4.757203 2.197045  7.5539568   layers  2.837327266\n\n\n\nGDIPlot(obj,GDIIn = GDI_DF, genes = genesList,GDIThreshold = 1.4)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "Correlation analysis for E13.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE13.5Yuzwa.html#seurat-correlation",
    "href": "geneCoexAnalysisE13.5Yuzwa.html#seurat-correlation",
    "title": "Gene Correlation Analysis E13.5 for Mouse Cortex",
    "section": "Seurat correlation",
    "text": "Seurat correlation\n\nsrat&lt;- CreateSeuratObject(counts = getRawData(obj), \n                          project = project, \n                          min.cells = 3, \n                          min.features = 200)\nsrat[[\"percent.mt\"]] &lt;- PercentageFeatureSet(srat, pattern = \"^mt-\")\nsrat &lt;- NormalizeData(srat)\nsrat &lt;- FindVariableFeatures(srat, selection.method = \"vst\", nfeatures = 2000)\n\n# plot variable features with and without labels\nplot1 &lt;- VariableFeaturePlot(srat)\n\nplot1$data$centered_variance &lt;- scale(plot1$data$variance.standardized,\n                                      center = T,scale = F)\n\nwrite.csv(plot1$data,paste0(\"CoexData/\",\n                            \"Variance_Seurat_genes\",\n                            getMetadataElement(obj, \n                                               datasetTags()[[\"cond\"]]),\".csv\"))\n\nLabelPoints(plot = plot1, points = c(genesList$NPGs,genesList$PNGs,genesList$layers), repel = TRUE)\n\n\n\n\n\n\n\n\n\nLabelPoints(plot = plot1, points = c(genesList$hk), repel = TRUE)\n\n\n\n\n\n\n\n\n\nall.genes &lt;- rownames(srat)\nsrat &lt;- ScaleData(srat, features = all.genes)\nseurat.data = GetAssayData(srat[[\"RNA\"]],layer = \"data\")\n\n\ncorr.pval.list &lt;- correlation_pvalues(data = seurat.data,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nseurat.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(seurat.data.cor.big, \n                         genesList, title=\"Seurat corr\")\n\n\np_values.fromSeurat &lt;- corr.pval.list$p_values\nseurat.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger   (Mb)  max used   (Mb)\nNcells   7108938  379.7   11454455  611.8  11454455  611.8\nVcells 595844235 4546.0  957583000 7305.8 957583000 7305.8\n\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\nSeurat SC Transform\n\nsrat &lt;-  SCTransform(srat, \n                     method = \"glmGamPoi\", \n                     vars.to.regress = \"percent.mt\", \n                     verbose = FALSE)\n\nseurat.data &lt;- GetAssayData(srat[[\"SCT\"]],layer = \"data\")\n\n#Remove genes with all zeros\nseurat.data &lt;-seurat.data[rowSums(seurat.data) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(seurat.data,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nseurat.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(seurat.data.cor.big, \n                         genesList, title=\"Seurat corr SCT\")\n\n\n\np_values.fromSeurat &lt;- corr.pval.list$p_values\nseurat.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger   (Mb)   max used   (Mb)\nNcells   8837923  472.0   16667718  890.2   13557124  724.1\nVcells 520365727 3970.1 1189358788 9074.1 1099004564 8384.8\n\ndraw(htmp, heatmap_legend_side=\"right\")",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "Correlation analysis for E13.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE13.5Yuzwa.html#monocle",
    "href": "geneCoexAnalysisE13.5Yuzwa.html#monocle",
    "title": "Gene Correlation Analysis E13.5 for Mouse Cortex",
    "section": "Monocle",
    "text": "Monocle\n\nlibrary(monocle3)\n\n\ncds &lt;- new_cell_data_set(getRawData(obj),\n                         cell_metadata = getMetadataCells(obj),\n                         gene_metadata = getMetadataGenes(obj)\n                         )\ncds &lt;- preprocess_cds(cds, num_dim = 100)\n\nnormalized_counts &lt;- normalized_counts(cds)\n\n\n#Remove genes with all zeros\nnormalized_counts &lt;- normalized_counts[rowSums(normalized_counts) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(normalized_counts,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nrm(normalized_counts)\n\nmonocle.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(data.cor.big = monocle.data.cor.big,\n                         genesList,\n                         title = \"Monocle corr\")\n\n\np_values.from.monocle &lt;- corr.pval.list$p_values\nmonocle.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger   (Mb)   max used   (Mb)\nNcells   9949636  531.4   16667718  890.2   16667718  890.2\nVcells 610053653 4654.4 1301028864 9926.1 1301028864 9926.1\n\ndraw(htmp, heatmap_legend_side=\"right\")",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "Correlation analysis for E13.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE13.5Yuzwa.html#scanpy",
    "href": "geneCoexAnalysisE13.5Yuzwa.html#scanpy",
    "title": "Gene Correlation Analysis E13.5 for Mouse Cortex",
    "section": "ScanPy",
    "text": "ScanPy\n\nlibrary(reticulate)\n\ndirOutScP &lt;- paste0(\"CoexData/ScanPy/\")\nif (!dir.exists(dirOutScP)) {\n  dir.create(dirOutScP)\n}\n\nSys.setenv(RETICULATE_PYTHON = \"../../../bin/python3\")\n  py &lt;- import(\"sys\")\n  \n  source_python(\"src/scanpyGenesExpression.py\")\n  scanpyFDR(getRawData(obj), \n                  getMetadataCells(obj), \n                  getMetadataGenes(obj), \n                   \"mt\", \n                   dirOutScP, \n                   file_code,\n            int.genes)\n\nnormalized_counts &lt;- read.csv(paste0(dirOutScP,\n                                     file_code,\"_Scampy_expression_all_genes.gz\"),header = T,row.names = 1)\n\nnormalized_counts &lt;- t(normalized_counts)\n\n\n#Remove genes with all zeros\nnormalized_counts &lt;-normalized_counts[rowSums(normalized_counts) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(normalized_counts,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nScanPy.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\n\nhtmp &lt;- correlation_plot(data.cor.big = ScanPy.data.cor.big,\n                         genesList,\n                         title = \"ScanPy corr\")\n\np_values.from.ScanPy &lt;- corr.pval.list$p_values\nScanPy.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   9973487  532.7   16667718   890.2   16667718   890.2\nVcells 582421870 4443.6 1366198826 10423.3 1366198826 10423.3\n\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\n\nSys.time()\n\n[1] \"2024-05-06 12:11:56 CEST\"\n\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3;  LAPACK version 3.9.0\n\nlocale:\n[1] C.UTF-8\n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n [1] stats4    parallel  grid      stats     graphics  grDevices utils    \n [8] datasets  methods   base     \n\nother attached packages:\n [1] reticulate_1.36.1           monocle3_1.3.4             \n [3] SingleCellExperiment_1.22.0 SummarizedExperiment_1.30.2\n [5] GenomicRanges_1.52.0        GenomeInfoDb_1.36.1        \n [7] IRanges_2.34.1              S4Vectors_0.38.1           \n [9] MatrixGenerics_1.12.3       matrixStats_1.2.0          \n[11] Biobase_2.60.0              BiocGenerics_0.46.0        \n[13] fstcore_0.9.18              fst_0.9.8                  \n[15] stringr_1.5.0               HiClimR_2.2.1              \n[17] doParallel_1.0.17           iterators_1.0.14           \n[19] foreach_1.5.2               Rfast_2.1.0                \n[21] RcppParallel_5.1.7          RcppZiggurat_0.1.6         \n[23] Rcpp_1.0.11                 patchwork_1.2.0            \n[25] Seurat_5.0.0                SeuratObject_5.0.0         \n[27] sp_2.1-1                    Hmisc_5.1-0                \n[29] dplyr_1.1.2                 circlize_0.4.15            \n[31] ComplexHeatmap_2.16.0       COTAN_2.5.0                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               bitops_1.0-7             \n  [5] tibble_3.2.1              polyclip_1.10-4          \n  [7] rpart_4.1.23              fastDummies_1.7.3        \n  [9] lifecycle_1.0.3           globals_0.16.2           \n [11] lattice_0.22-5            MASS_7.3-60              \n [13] backports_1.4.1           dendextend_1.17.1        \n [15] magrittr_2.0.3            plotly_4.10.2            \n [17] rmarkdown_2.24            yaml_2.3.7               \n [19] httpuv_1.6.11             glmGamPoi_1.12.2         \n [21] sctransform_0.4.1         spam_2.10-0              \n [23] askpass_1.2.0             spatstat.sparse_3.0-2    \n [25] minqa_1.2.5               cowplot_1.1.1            \n [27] pbapply_1.7-2             RColorBrewer_1.1-3       \n [29] zlibbioc_1.46.0           abind_1.4-5              \n [31] Rtsne_0.17                purrr_1.0.1              \n [33] RCurl_1.98-1.12           nnet_7.3-19              \n [35] GenomeInfoDbData_1.2.10   ggrepel_0.9.5            \n [37] irlba_2.3.5.1             listenv_0.9.0            \n [39] spatstat.utils_3.0-3      terra_1.7-39             \n [41] umap_0.2.10.0             goftest_1.2-3            \n [43] RSpectra_0.16-1           spatstat.random_3.2-1    \n [45] dqrng_0.3.0               fitdistrplus_1.1-11      \n [47] parallelly_1.37.1         DelayedMatrixStats_1.22.5\n [49] ncdf4_1.22                leiden_0.4.3             \n [51] codetools_0.2-19          DelayedArray_0.26.7      \n [53] tidyselect_1.2.0          shape_1.4.6              \n [55] farver_2.1.1              lme4_1.1-34              \n [57] ScaledMatrix_1.8.1        viridis_0.6.4            \n [59] base64enc_0.1-3           spatstat.explore_3.2-1   \n [61] jsonlite_1.8.7            GetoptLong_1.0.5         \n [63] ellipsis_0.3.2            progressr_0.14.0         \n [65] Formula_1.2-5             ggridges_0.5.4           \n [67] survival_3.5-8            tools_4.3.2              \n [69] ica_1.0-3                 glue_1.7.0               \n [71] gridExtra_2.3             xfun_0.39                \n [73] ggthemes_5.1.0            withr_3.0.0              \n [75] fastmap_1.1.1             boot_1.3-28              \n [77] fansi_1.0.4               openssl_2.1.0            \n [79] digest_0.6.33             rsvd_1.0.5               \n [81] parallelDist_0.2.6        R6_2.5.1                 \n [83] mime_0.12                 colorspace_2.1-0         \n [85] Cairo_1.6-1               scattermore_1.2          \n [87] tensor_1.5                spatstat.data_3.0-1      \n [89] utf8_1.2.3                tidyr_1.3.0              \n [91] generics_0.1.3            data.table_1.15.0        \n [93] httr_1.4.6                htmlwidgets_1.6.2        \n [95] S4Arrays_1.2.0            uwot_0.1.16              \n [97] pkgconfig_2.0.3           gtable_0.3.3             \n [99] lmtest_0.9-40             XVector_0.40.0           \n[101] htmltools_0.5.8           dotCall64_1.1-0          \n[103] clue_0.3-64               scales_1.3.0             \n[105] png_0.1-8                 knitr_1.43               \n[107] rstudioapi_0.15.0         reshape2_1.4.4           \n[109] rjson_0.2.21              nloptr_2.0.3             \n[111] checkmate_2.3.0           nlme_3.1-163             \n[113] zoo_1.8-12                GlobalOptions_0.1.2      \n[115] KernSmooth_2.23-22        miniUI_0.1.1.1           \n[117] foreign_0.8-86            pillar_1.9.0             \n[119] vctrs_0.6.3               RANN_2.6.1               \n[121] promises_1.2.0.1          BiocSingular_1.16.0      \n[123] beachmat_2.16.0           xtable_1.8-4             \n[125] cluster_2.1.6             htmlTable_2.4.1          \n[127] evaluate_0.21             zeallot_0.1.0            \n[129] cli_3.6.1                 compiler_4.3.2           \n[131] rlang_1.1.1               crayon_1.5.2             \n[133] future.apply_1.11.0       labeling_0.4.2           \n[135] plyr_1.8.8                stringi_1.8.1            \n[137] viridisLite_0.4.2         deldir_2.0-2             \n[139] BiocParallel_1.34.2       assertthat_0.2.1         \n[141] munsell_0.5.0             lazyeval_0.2.2           \n[143] spatstat.geom_3.2-4       PCAtools_2.14.0          \n[145] Matrix_1.6-3              RcppHNSW_0.6.0           \n[147] sparseMatrixStats_1.12.2  future_1.33.0            \n[149] ggplot2_3.5.0             shiny_1.8.0              \n[151] ROCR_1.0-11               igraph_2.0.3",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "Correlation analysis for E13.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisDataset1.html",
    "href": "geneCoexAnalysisDataset1.html",
    "title": "Gene Correlation Analysis E14.5 Mouse Cortex",
    "section": "",
    "text": "library(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(Hmisc)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(Rfast)\nlibrary(parallel)\nlibrary(doParallel)\nlibrary(HiClimR)\nlibrary(stringr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\ndataSetFile &lt;- \"Data/MouseCortex/MouseCortex_E14.5.cotan.RDS\"\nname &lt;- str_split(dataSetFile,pattern = \"/\",simplify = T)[3]\nname &lt;- str_remove(name,pattern = \".RDS\")\n\nproject = \"E14.5\"\n\n\nsetLoggingLevel(1)\noutDir &lt;- \"CoexData/\"\nsetLoggingFile(paste0(outDir, \"Logs/\",name,\".log\"))\n\nobj &lt;- readRDS(dataSetFile)\nfile_code = getMetadataElement(obj, datasetTags()[[\"cond\"]])\n\n\nsource(\"src/Functions.R\")\n\nTo compare the ability of COTAN to asses the real correlation between genes we define some pools of genes:\n\nConstitutive genes\nNeural progenitor genes\nPan neuronal genes\nSome layer marker genes\n\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = \n    c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Loo 2019",
      "Coexpression analaysis"
    ]
  },
  {
    "objectID": "geneCoexAnalysisDataset1.html#prologue",
    "href": "geneCoexAnalysisDataset1.html#prologue",
    "title": "Gene Correlation Analysis E14.5 Mouse Cortex",
    "section": "",
    "text": "library(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(Hmisc)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(Rfast)\nlibrary(parallel)\nlibrary(doParallel)\nlibrary(HiClimR)\nlibrary(stringr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\ndataSetFile &lt;- \"Data/MouseCortex/MouseCortex_E14.5.cotan.RDS\"\nname &lt;- str_split(dataSetFile,pattern = \"/\",simplify = T)[3]\nname &lt;- str_remove(name,pattern = \".RDS\")\n\nproject = \"E14.5\"\n\n\nsetLoggingLevel(1)\noutDir &lt;- \"CoexData/\"\nsetLoggingFile(paste0(outDir, \"Logs/\",name,\".log\"))\n\nobj &lt;- readRDS(dataSetFile)\nfile_code = getMetadataElement(obj, datasetTags()[[\"cond\"]])\n\n\nsource(\"src/Functions.R\")\n\nTo compare the ability of COTAN to asses the real correlation between genes we define some pools of genes:\n\nConstitutive genes\nNeural progenitor genes\nPan neuronal genes\nSome layer marker genes\n\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = \n    c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Loo 2019",
      "Coexpression analaysis"
    ]
  },
  {
    "objectID": "geneCoexAnalysisDataset1.html#cotan",
    "href": "geneCoexAnalysisDataset1.html#cotan",
    "title": "Gene Correlation Analysis E14.5 Mouse Cortex",
    "section": "COTAN",
    "text": "COTAN\n\nint.genes &lt;-getGenes(obj)\n\n\ncoexMat.big &lt;- getGenesCoex(obj)\n\ncoexMat &lt;- getGenesCoex(obj)[c(genesList$NPGs,genesList$hk,genesList$PNGs),c(genesList$NPGs,genesList$hk,genesList$PNGs)]\n\nf1 = colorRamp2(seq(-0.5,0.5, length = 3), c(\"#DC0000B2\", \"white\",\"#3C5488B2\" ))\n\nsplit.genes &lt;- factor(c(rep(\"NPGs\",length(genesList[[\"NPGs\"]])),\n                         rep(\"HK\",length(genesList[[\"hk\"]])),\n                         rep(\"PNGs\",length(genesList[[\"PNGs\"]]))\n                        ),\n                         levels = c(\"NPGs\",\"HK\",\"PNGs\"))\n\nlgd = Legend(col_fun = f1, title = \"COTAN coex\")\n\nhtmp &lt;- Heatmap(as.matrix(coexMat),\n        #width = ncol(coexMat)*unit(2.5, \"mm\"), \n        height = nrow(coexMat)*unit(3, \"mm\"),\n        cluster_rows = FALSE,\n        cluster_columns = FALSE,\n        col = f1,\n        row_names_side = \"left\",\n        row_names_gp = gpar(fontsize = 11),\n        column_names_gp  = gpar(fontsize = 11),\n        column_split = split.genes,\n        row_split = split.genes,\n        cluster_row_slices = FALSE, \n    cluster_column_slices = FALSE,\n    heatmap_legend_param = list(\n        title = \"COTAN coex\", at = c(-0.5, 0, 0.5),direction = \"horizontal\",\n        labels = c(\"-0.5\", \"0\", \"0.5\")\n    )\n   )\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\nGDI_DF &lt;- calculateGDI(obj)\nGDI_DF$geneType &lt;- NA\nfor (cat in names(genesList)) {\n  GDI_DF[rownames(GDI_DF) %in% genesList[[cat]],]$geneType &lt;- cat\n}\n\nGDI_DF$GDI_centered &lt;- scale(GDI_DF$GDI,center = T,scale = T)\n\nwrite.csv(GDI_DF,paste0(\"CoexData/\",\"Variance_GDI_genes\",file_code,\".csv\"))\n\n\nGDI_DF[unlist(genesList),]\n\n         sum.raw.norm      GDI  exp.cells geneType GDI_centered\nNes          8.839957 4.678500 27.7337997     NPGs   3.63695691\nVim         10.246463 4.534465 51.0309278     NPGs   3.42694609\nSox2         9.124228 4.566666 31.4709131     NPGs   3.47389659\nSox1         7.368458 3.455731  9.5636966     NPGs   1.85409012\nNotch1       7.469284 4.355698 11.6623711     NPGs   3.16629269\nHes1         7.698079 4.634264 10.5946244     NPGs   3.57245806\nHes5         9.405265 4.812530 22.7908689     NPGs   3.83238101\nPax6         8.144613 4.367938 17.3877025     NPGs   3.18413945\nMap2        10.172685 3.768818 72.7172312     PNGs   2.31058907\nTubb3       11.537925 4.586213 88.3836524     PNGs   3.50239807\nNeurod1      8.881391 3.388955 22.9657585     PNGs   1.75672703\nNefm         8.288330 3.346732 17.5441826     PNGs   1.69516332\nNefl         7.678477 3.544436  8.6340206     PNGs   1.98342736\nDcx         10.120356 4.821636 66.9090574     PNGs   3.84565720\nTbr1         8.472723 3.926272 24.1715758     PNGs   2.54016525\nCalm1       11.491577 1.857652 96.5114138       hk  -0.47600225\nCox6b1      10.398257 1.992891 84.6833579       hk  -0.27881530\nPpia         7.666735 2.386108 17.4797496       hk   0.29451755\nRpl18        9.176712 2.575898 51.5187776       hk   0.57124278\nCox7c        8.439961 1.902976 31.8206922       hk  -0.40991709\nErh          6.593118 2.307720  6.5721649       hk   0.18022355\nH3f3a        9.388420 1.886267 58.1093520       hk  -0.43428010\nTaf1         8.315368 2.138643 26.8869661       hk  -0.06630076\nTaf2         8.017975 1.861938 21.1432253       hk  -0.46975224\nGapdh        5.018736 1.853094  1.5648012       hk  -0.48264772\nActb        12.609181 1.492016 99.6778351       hk  -1.00911996\nGolph3       7.150183 1.851371 10.8891753       hk  -0.48515921\nZfr          9.269238 2.273001 50.7916053       hk   0.12960056\nSub1        10.018254 2.583820 74.7238586       hk   0.58279347\nTars         8.056910 2.487556 22.8645066       hk   0.44243393\nAmacr        5.492910 1.714319  2.2551546       hk  -0.68499008\nReln         7.095360 3.011725  4.5563328   layers   1.20670295\nLhx5         6.037778 2.901306  2.0434462   layers   1.04570542\nCux1         8.597262 3.026589 31.3512518   layers   1.22837610\nSatb2        7.603191 3.121471 11.0916789   layers   1.36671855\nTle1         7.891909 2.322600 17.8111193   layers   0.20191897\nMef2c        8.776162 4.057560 23.6377025   layers   2.73159053\nRorb         6.523092 1.943768  4.6023564   layers  -0.35043950\nSox5         9.301863 3.584350 38.2639912   layers   2.04162343\nBcl11b       9.860621 4.189936 53.4057437   layers   2.92460213\nFezf2        8.804060 3.630239 28.8751841   layers   2.10853283\nFoxp2        7.474618 2.254280  8.4867452   layers   0.10230519\nNtf3         4.673267 2.314479  0.8560383   layers   0.19007802\nNA                 NA       NA         NA     &lt;NA&gt;           NA\nPvrl3        7.255727 3.417288 10.6866716   layers   1.79803751\nCux2         7.652690 3.088322 11.2573638   layers   1.31838644\nSlc17a6      7.901396 2.998305 14.0648012   layers   1.18713575\nSema3c       7.222013 2.481806  7.6307069   layers   0.43405122\nThsd7a       7.472372 3.054089  8.0449190   layers   1.26847311\nSulf2        6.491056 2.379550  4.6759941   layers   0.28495572\nKcnk2        7.151877 1.901258  9.0390280   layers  -0.41242163\nGrik3        6.673233 2.781234  5.3019146   layers   0.87063375\nEtv1         6.743118 2.264998  4.8232695   layers   0.11793173\nTle4         7.880978 2.635418 15.0405007   layers   0.65802538\nTmem200a     6.188517 2.926026  3.8751841   layers   1.08174899\nGlra2        7.057638 3.858495  8.1369661   layers   2.44134235\nEtv1.1       6.743118 2.264998  4.8232695   layers   0.11793173\nNA.1               NA       NA         NA     &lt;NA&gt;           NA\nSulf1        5.465717 2.461515  1.0125184   layers   0.40446505\nNA.2               NA       NA         NA     &lt;NA&gt;           NA\nSyt6         7.555334 3.052113  8.8457290   layers   1.26559064\n\n\n\nGDIPlot(obj,GDIIn = GDI_DF, genes = genesList,GDIThreshold = 1.4)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Loo 2019",
      "Coexpression analaysis"
    ]
  },
  {
    "objectID": "geneCoexAnalysisDataset1.html#seurat-correlation",
    "href": "geneCoexAnalysisDataset1.html#seurat-correlation",
    "title": "Gene Correlation Analysis E14.5 Mouse Cortex",
    "section": "Seurat correlation",
    "text": "Seurat correlation\n\nsrat&lt;- CreateSeuratObject(counts = getRawData(obj), \n                          project = project, \n                          min.cells = 3, \n                          min.features = 200)\nsrat[[\"percent.mt\"]] &lt;- PercentageFeatureSet(srat, pattern = \"^mt-\")\nsrat &lt;- NormalizeData(srat)\nsrat &lt;- FindVariableFeatures(srat, selection.method = \"vst\", nfeatures = 2000)\n\n# plot variable features with and without labels\nplot1 &lt;- VariableFeaturePlot(srat)\n\nplot1$data$centered_variance &lt;- scale(plot1$data$variance.standardized,\n                                      center = T,scale = F)\n\nwrite.csv(plot1$data,paste0(\"CoexData/\",\n                            \"Variance_Seurat_genes\",\n                            getMetadataElement(obj, \n                                               datasetTags()[[\"cond\"]]),\".csv\"))\n\nLabelPoints(plot = plot1, points = c(genesList$NPGs,genesList$PNGs,genesList$layers), repel = TRUE)\n\n\n\n\n\n\n\n\n\nLabelPoints(plot = plot1, points = c(genesList$hk), repel = TRUE)\n\n\n\n\n\n\n\n\n\nall.genes &lt;- rownames(srat)\nsrat &lt;- ScaleData(srat, features = all.genes)\nseurat.data = GetAssayData(srat[[\"RNA\"]],layer = \"data\")\n\n\ncorr.pval.list &lt;- correlation_pvalues(data = seurat.data,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nseurat.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(seurat.data.cor.big, \n                         genesList, title=\"Seurat corr\")\n\n\np_values.fromSeurat &lt;- corr.pval.list$p_values\nseurat.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   7120021  380.3   11454531   611.8   11454531   611.8\nVcells 940272073 7173.8 1885882011 14388.2 1571501676 11989.7\n\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\nSeurat SC Transform\n\nsrat &lt;-  SCTransform(srat, \n                     method = \"glmGamPoi\", \n                     vars.to.regress = \"percent.mt\", \n                     verbose = FALSE)\n\nseurat.data &lt;- GetAssayData(srat[[\"SCT\"]],layer = \"data\")\n\n#Remove genes with all zeros\nseurat.data &lt;-seurat.data[rowSums(seurat.data) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(seurat.data,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nseurat.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(seurat.data.cor.big, \n                         genesList, title=\"Seurat corr SCT\")\n\n\n\np_values.fromSeurat &lt;- corr.pval.list$p_values\nseurat.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n             used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells    8854790  472.9   16718127   892.9   12172573   650.1\nVcells 1002434648 7648.0 2263138413 17266.4 1885879002 14388.2\n\ndraw(htmp, heatmap_legend_side=\"right\")",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Loo 2019",
      "Coexpression analaysis"
    ]
  },
  {
    "objectID": "geneCoexAnalysisDataset1.html#monocle",
    "href": "geneCoexAnalysisDataset1.html#monocle",
    "title": "Gene Correlation Analysis E14.5 Mouse Cortex",
    "section": "Monocle",
    "text": "Monocle\n\nlibrary(monocle3)\n\n\ncds &lt;- new_cell_data_set(getRawData(obj),\n                         cell_metadata = getMetadataCells(obj),\n                         gene_metadata = getMetadataGenes(obj)\n                         )\ncds &lt;- preprocess_cds(cds, num_dim = 100)\n\nnormalized_counts &lt;- normalized_counts(cds)\n\n\n#Remove genes with all zeros\nnormalized_counts &lt;- normalized_counts[rowSums(normalized_counts) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(normalized_counts,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nrm(normalized_counts)\n\nmonocle.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(data.cor.big = monocle.data.cor.big,\n                         genesList,\n                         title = \"Monocle corr\")\n\n\np_values.from.monocle &lt;- corr.pval.list$p_values\nmonocle.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n             used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells    9966472  532.3   16718127   892.9   16718127   892.9\nVcells 1006589306 7679.7 2358214745 17991.8 2358214745 17991.8\n\ndraw(htmp, heatmap_legend_side=\"right\")",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Loo 2019",
      "Coexpression analaysis"
    ]
  },
  {
    "objectID": "geneCoexAnalysisDataset1.html#scanpy",
    "href": "geneCoexAnalysisDataset1.html#scanpy",
    "title": "Gene Correlation Analysis E14.5 Mouse Cortex",
    "section": "ScanPy",
    "text": "ScanPy\n\nlibrary(reticulate)\n\ndirOutScP &lt;- paste0(\"CoexData/ScanPy/\")\nif (!dir.exists(dirOutScP)) {\n  dir.create(dirOutScP)\n}\n\nSys.setenv(RETICULATE_PYTHON = \"../../../bin/python3\")\n  py &lt;- import(\"sys\")\n  \n  source_python(\"src/scanpyGenesExpression.py\")\n  scanpyFDR(getRawData(obj), \n                  getMetadataCells(obj), \n                  getMetadataGenes(obj), \n                   \"mt\", \n                   dirOutScP, \n                   file_code,\n            int.genes)\n\nnormalized_counts &lt;- read.csv(paste0(dirOutScP,\n                                     file_code,\"_Scampy_expression_all_genes.gz\"),header = T,row.names = 1)\n\nnormalized_counts &lt;- t(normalized_counts)\n\n\n#Remove genes with all zeros\nnormalized_counts &lt;-normalized_counts[rowSums(normalized_counts) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(normalized_counts,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nScanPy.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\n\nhtmp &lt;- correlation_plot(data.cor.big = ScanPy.data.cor.big,\n                         genesList,\n                         title = \"ScanPy corr\")\n\np_values.from.ScanPy &lt;- corr.pval.list$p_values\nScanPy.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n             used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells    9990389  533.6   16718127   892.9   16718127   892.9\nVcells 1104918338 8429.9 2358214745 17991.8 2358214745 17991.8\n\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\n\nSys.time()\n\n[1] \"2024-05-08 19:37:36 CEST\"\n\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3;  LAPACK version 3.9.0\n\nlocale:\n[1] C.UTF-8\n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n [1] stats4    parallel  grid      stats     graphics  grDevices utils    \n [8] datasets  methods   base     \n\nother attached packages:\n [1] reticulate_1.36.1           monocle3_1.3.4             \n [3] SingleCellExperiment_1.22.0 SummarizedExperiment_1.30.2\n [5] GenomicRanges_1.52.0        GenomeInfoDb_1.36.1        \n [7] IRanges_2.34.1              S4Vectors_0.38.1           \n [9] MatrixGenerics_1.12.3       matrixStats_1.2.0          \n[11] Biobase_2.60.0              BiocGenerics_0.46.0        \n[13] fstcore_0.9.18              fst_0.9.8                  \n[15] stringr_1.5.0               HiClimR_2.2.1              \n[17] doParallel_1.0.17           iterators_1.0.14           \n[19] foreach_1.5.2               Rfast_2.1.0                \n[21] RcppParallel_5.1.7          RcppZiggurat_0.1.6         \n[23] Rcpp_1.0.11                 patchwork_1.2.0            \n[25] Seurat_5.0.0                SeuratObject_5.0.0         \n[27] sp_2.1-1                    Hmisc_5.1-0                \n[29] dplyr_1.1.2                 circlize_0.4.15            \n[31] ComplexHeatmap_2.16.0       COTAN_2.5.0                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               bitops_1.0-7             \n  [5] tibble_3.2.1              polyclip_1.10-4          \n  [7] rpart_4.1.23              fastDummies_1.7.3        \n  [9] lifecycle_1.0.3           globals_0.16.2           \n [11] lattice_0.22-5            MASS_7.3-60              \n [13] backports_1.4.1           dendextend_1.17.1        \n [15] magrittr_2.0.3            plotly_4.10.2            \n [17] rmarkdown_2.24            yaml_2.3.7               \n [19] httpuv_1.6.11             glmGamPoi_1.12.2         \n [21] sctransform_0.4.1         spam_2.10-0              \n [23] askpass_1.2.0             spatstat.sparse_3.0-2    \n [25] minqa_1.2.5               cowplot_1.1.1            \n [27] pbapply_1.7-2             RColorBrewer_1.1-3       \n [29] zlibbioc_1.46.0           abind_1.4-5              \n [31] Rtsne_0.17                purrr_1.0.1              \n [33] RCurl_1.98-1.12           nnet_7.3-19              \n [35] GenomeInfoDbData_1.2.10   ggrepel_0.9.5            \n [37] irlba_2.3.5.1             listenv_0.9.0            \n [39] spatstat.utils_3.0-3      terra_1.7-39             \n [41] umap_0.2.10.0             goftest_1.2-3            \n [43] RSpectra_0.16-1           spatstat.random_3.2-1    \n [45] dqrng_0.3.0               fitdistrplus_1.1-11      \n [47] parallelly_1.37.1         DelayedMatrixStats_1.22.5\n [49] ncdf4_1.22                leiden_0.4.3             \n [51] codetools_0.2-19          DelayedArray_0.26.7      \n [53] tidyselect_1.2.0          shape_1.4.6              \n [55] farver_2.1.1              lme4_1.1-34              \n [57] ScaledMatrix_1.8.1        viridis_0.6.4            \n [59] base64enc_0.1-3           spatstat.explore_3.2-1   \n [61] jsonlite_1.8.7            GetoptLong_1.0.5         \n [63] ellipsis_0.3.2            progressr_0.14.0         \n [65] Formula_1.2-5             ggridges_0.5.4           \n [67] survival_3.5-8            tools_4.3.2              \n [69] ica_1.0-3                 glue_1.7.0               \n [71] gridExtra_2.3             xfun_0.39                \n [73] ggthemes_5.1.0            withr_3.0.0              \n [75] fastmap_1.1.1             boot_1.3-28              \n [77] fansi_1.0.4               openssl_2.1.0            \n [79] digest_0.6.33             rsvd_1.0.5               \n [81] parallelDist_0.2.6        R6_2.5.1                 \n [83] mime_0.12                 colorspace_2.1-0         \n [85] Cairo_1.6-1               scattermore_1.2          \n [87] tensor_1.5                spatstat.data_3.0-1      \n [89] utf8_1.2.3                tidyr_1.3.0              \n [91] generics_0.1.3            data.table_1.15.0        \n [93] httr_1.4.6                htmlwidgets_1.6.2        \n [95] S4Arrays_1.2.0            uwot_0.1.16              \n [97] pkgconfig_2.0.3           gtable_0.3.3             \n [99] lmtest_0.9-40             XVector_0.40.0           \n[101] htmltools_0.5.8           dotCall64_1.1-0          \n[103] clue_0.3-64               scales_1.3.0             \n[105] png_0.1-8                 knitr_1.43               \n[107] rstudioapi_0.15.0         reshape2_1.4.4           \n[109] rjson_0.2.21              nloptr_2.0.3             \n[111] checkmate_2.3.0           nlme_3.1-163             \n[113] zoo_1.8-12                GlobalOptions_0.1.2      \n[115] KernSmooth_2.23-22        miniUI_0.1.1.1           \n[117] foreign_0.8-86            pillar_1.9.0             \n[119] vctrs_0.6.3               RANN_2.6.1               \n[121] promises_1.2.0.1          BiocSingular_1.16.0      \n[123] beachmat_2.16.0           xtable_1.8-4             \n[125] cluster_2.1.6             htmlTable_2.4.1          \n[127] evaluate_0.21             zeallot_0.1.0            \n[129] cli_3.6.1                 compiler_4.3.2           \n[131] rlang_1.1.1               crayon_1.5.2             \n[133] future.apply_1.11.0       labeling_0.4.2           \n[135] plyr_1.8.8                stringi_1.8.1            \n[137] viridisLite_0.4.2         deldir_2.0-2             \n[139] BiocParallel_1.34.2       assertthat_0.2.1         \n[141] munsell_0.5.0             lazyeval_0.2.2           \n[143] spatstat.geom_3.2-4       PCAtools_2.14.0          \n[145] Matrix_1.6-3              RcppHNSW_0.6.0           \n[147] sparseMatrixStats_1.12.2  future_1.33.0            \n[149] ggplot2_3.5.0             shiny_1.8.0              \n[151] ROCR_1.0-11               igraph_2.0.3",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Loo 2019",
      "Coexpression analaysis"
    ]
  },
  {
    "objectID": "ForebrainLaManno2021ClustersGDI.html",
    "href": "ForebrainLaManno2021ClustersGDI.html",
    "title": "Forebrain La Manno 2021 Clusters GDI",
    "section": "",
    "text": "For the evaluation of GDI sensitivity and also to test type I error and FDR for the differential expressed gene in a cluster we need to have some Coherent Transcript Cell Cluster (cluster formed by cells as similar as possible). So we tested all clusters defined in the original paper for this data set (focusing on E13.5, E15.0, and E17.5).\n\nlibrary(rlang)\nlibrary(zeallot)\nlibrary(data.table)\nlibrary(COTAN)\n#devtools::load_all(\"~/dev/COTAN/COTAN/\")\n\noptions(parallelly.fork.enable = TRUE)\n\nsetLoggingLevel(2)\nsetLoggingFile(file.path(\".\", \"ClusterizationsGDI_AllForebrainDorsal.log\"))\n\n\n\n\ngetClData &lt;- function(objCOTAN, clList, cl) {\n  cluster &lt;- names(clList)[[cl]]\n  cells &lt;- clList[[cl]]\n  res &lt;- checkClusterUniformity(objCOTAN, cluster = cluster, cells = cells,\n                                GDIThreshold = 1.4, cores = 6, saveObj = FALSE)\n  res &lt;- c(list(\"cluster\" = cluster, \"size\" = length(cells)), res)\n  res &lt;- as.data.frame(res)\n  rownames(res) &lt;- cluster\n  colnames(res)\n  return(res)\n}\n\nclDataVal &lt;- list(\"cluster\" = NULL, \"size\" = NULL, \"isUniform\" = NULL,\n                  \"fractionAbove\" = NULL, \"1stPercentile\" = NULL)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Original Clusters GDI evaluation"
    ]
  },
  {
    "objectID": "ForebrainLaManno2021ClustersGDI.html#preamble",
    "href": "ForebrainLaManno2021ClustersGDI.html#preamble",
    "title": "Forebrain La Manno 2021 Clusters GDI",
    "section": "",
    "text": "For the evaluation of GDI sensitivity and also to test type I error and FDR for the differential expressed gene in a cluster we need to have some Coherent Transcript Cell Cluster (cluster formed by cells as similar as possible). So we tested all clusters defined in the original paper for this data set (focusing on E13.5, E15.0, and E17.5).\n\nlibrary(rlang)\nlibrary(zeallot)\nlibrary(data.table)\nlibrary(COTAN)\n#devtools::load_all(\"~/dev/COTAN/COTAN/\")\n\noptions(parallelly.fork.enable = TRUE)\n\nsetLoggingLevel(2)\nsetLoggingFile(file.path(\".\", \"ClusterizationsGDI_AllForebrainDorsal.log\"))\n\n\n\n\ngetClData &lt;- function(objCOTAN, clList, cl) {\n  cluster &lt;- names(clList)[[cl]]\n  cells &lt;- clList[[cl]]\n  res &lt;- checkClusterUniformity(objCOTAN, cluster = cluster, cells = cells,\n                                GDIThreshold = 1.4, cores = 6, saveObj = FALSE)\n  res &lt;- c(list(\"cluster\" = cluster, \"size\" = length(cells)), res)\n  res &lt;- as.data.frame(res)\n  rownames(res) &lt;- cluster\n  colnames(res)\n  return(res)\n}\n\nclDataVal &lt;- list(\"cluster\" = NULL, \"size\" = NULL, \"isUniform\" = NULL,\n                  \"fractionAbove\" = NULL, \"1stPercentile\" = NULL)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Original Clusters GDI evaluation"
    ]
  },
  {
    "objectID": "ForebrainLaManno2021ClustersGDI.html#forebrain-dorsal-e13.5",
    "href": "ForebrainLaManno2021ClustersGDI.html#forebrain-dorsal-e13.5",
    "title": "Forebrain La Manno 2021 Clusters GDI",
    "section": "Forebrain Dorsal E13.5",
    "text": "Forebrain Dorsal E13.5\n\nLoad dataset\n\nfb135Obj &lt;- readRDS(file = file.path(\"Data/MouseCortexFromLoom/\", \"e13.5_ForebrainDorsal.cotan.RDS\"))\n\nsampleCondition &lt;- getMetadataElement(fb135Obj, datasetTags()[[\"cond\"]])\n\nlogThis(sampleCondition)\n\nallClust &lt;- getClusterizations(fb135Obj)\n\nlogThis(\"\")\nlogThis(paste(\"Number of cells:\", getNumCells(fb135Obj)))\n\nlogThis(\"\")\nlogThis(\"Available clusterizations:\")\nlogThis(paste0(allClust, collapse = \", \"))\n\nclSizes &lt;- vapply(allClust, function(x) { nlevels(getClusters(fb135Obj, x))}, integer(1L))\nclSizes\n\n            split             merge original.clusters original.subclass \n               35                31               159                40 \n   original.class       cell.typist            seurat   seurat.high.res \n               13                13                19                36 \n          monocle  monocle.high.res \n               11                27 \n\nlogThis(paste(names(clSizes), clSizes, sep = \": \", collapse = \", \"))\n\n\n\nExtract original cluster\n\noriginalFB135 &lt;- getClusters(fb135Obj, clName = \"original.clusters\")\n\nnlevels(originalFB135)\n\n[1] 159\n\nsort(table(originalFB135), decreasing = TRUE)\n\noriginalFB135\n432 186 187 434 184 437 510 509 183 185 438 433 525 443 446 192 568 188 441 565 \n536 423 334 326 292 259 248 239 178 168 155 141 130  82  74  65  65  63  56  53 \n428 181 679 440 189 118 507 431 442 445 497 444 193 426 511 439 178 436 508 135 \n 52  51  49  46  39  36  35  32  30  29  29  26  25  25  23  22  20  20  20  19 \n 68 177 427 435 175 225 120 271  67 173 430 494 524 176 429 493 496 502 566 117 \n 17  14  14  13  12  12  11  11  11  10  10  10  10   9   9   9   9   9   9   8 \n136 161 194 332 504 112 174 222 228 675 115 158 270 505 670 114 133 159 227 267 \n  8   8   8   8   8   7   7   6   6   6   5   5   5   5   5   4   4   4   4   4 \n359  41 470 564 162 179 329 447 492 519 535 671 119 130 146 163 168 195 224 226 \n  4   4   4   4   3   3   3   3   3   3   3   3   2   2   2   2   2   2   2   2 \n251 263 273 326 453 516 520 528 538 569 575 672 676 677 683 691 793 107 113 125 \n  2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   2   1   1   1 \n137 138 144 180 182 196 216 254 259 269 333 355 358 374  40 420 454 458 468 471 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n495 498 499 523 549  55 559 658 666 673 678 686 688 689 731 744 760 795  82 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n\n# drop too small clusters: those whose size is less than 15\nlargeClFB135 &lt;- which(table(originalFB135) &gt;= 50)\nlargeOrigFB135 &lt;- originalFB135[(originalFB135 %in% names(largeClFB135)),\n                                drop = TRUE]\n\nlargeOrigFB135 &lt;- toClustersList(largeOrigFB135)\n\n\n\nCalculate GDI for each cluster in E13.5\n\nprint(\"Length larger clusters\")\nvapply(largeOrigFB135, length, integer(1))\n\nresDataFB135 &lt;- lapply(seq_along(largeOrigFB135), FUN = getClData,\n                       objCOTAN = fb135Obj, clList = largeOrigFB135)\n\n\nclDataFB135 &lt;- data.table::rbindlist(resDataFB135)\nclDataFB135 &lt;- column_to_rownames(clDataFB135, var = \"cluster\")\n\n\nsaveRDS(clDataFB135,\n        file = file.path(\"Data/MouseCortexFromLoom/ClustersGDI/\", \"e13.5_ForebrainDorsal_GDI_of_original_clusterization.RDS\"))\n\n\nclDataFB135 &lt;- readRDS(\"Data/MouseCortexFromLoom/ClustersGDI/e13.5_ForebrainDorsal_GDI_of_original_clusterization.RDS\")\nclDataFB135[order(clDataFB135$size, decreasing = T),]\n\n    size isUniform fractionAbove X1stPercentile\n432  536     FALSE  3.770380e-02       1.484698\n186  423     FALSE  4.307131e-02       1.609718\n187  334     FALSE  1.303433e-02       1.423035\n434  326      TRUE  4.379562e-03       1.376828\n184  292     FALSE  1.170610e-02       1.414304\n437  259      TRUE  4.410239e-03       1.364885\n510  248      TRUE  9.610563e-03       1.397472\n509  239      TRUE  4.471580e-03       1.373229\n183  178     FALSE  1.458630e-02       1.427795\n185  168     FALSE  1.630482e-02       1.428907\n438  155      TRUE  1.080901e-03       1.320271\n433  141      TRUE  4.997501e-03       1.363220\n525  130      TRUE  1.488711e-03       1.329041\n443   82      TRUE  2.276508e-03       1.344695\n446   74      TRUE  8.701706e-05       1.300874\n192   65      TRUE  2.597852e-04       1.310808\n568   65      TRUE  0.000000e+00       1.233130\n188   63      TRUE  1.147802e-03       1.314789\n441   56      TRUE  0.000000e+00       1.277716\n565   53      TRUE  0.000000e+00       1.232690\n428   52      TRUE  0.000000e+00       1.263561\n181   51      TRUE  3.013116e-03       1.330148\n\n\nSo we can use the following clusters (at least 100 cells - cell number in the parenthesis - and GDI lower than 1.5):\n\ncl432 (n.cells 536),\ncl187 (334),\ncl434 (326),\ncl184 (292),\ncl437 (259),\ncl510 (248)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Original Clusters GDI evaluation"
    ]
  },
  {
    "objectID": "ForebrainLaManno2021ClustersGDI.html#forebrain-dorsal-e15.0",
    "href": "ForebrainLaManno2021ClustersGDI.html#forebrain-dorsal-e15.0",
    "title": "Forebrain La Manno 2021 Clusters GDI",
    "section": "Forebrain Dorsal E15.0",
    "text": "Forebrain Dorsal E15.0\n\nLoad dataset\n\nfb150Obj &lt;- readRDS(file = file.path(\"Data/MouseCortexFromLoom/\", \"e15.0_ForebrainDorsal.cotan.RDS\"))\n\nsampleCondition &lt;- getMetadataElement(fb150Obj, datasetTags()[[\"cond\"]])\n\nlogThis(sampleCondition)\n\nallClust &lt;- getClusterizations(fb150Obj)\n\nlogThis(\"\")\nlogThis(paste(\"Number of cells:\", getNumCells(fb150Obj)))\n\nlogThis(\"\")\nlogThis(\"Available clusterizations:\")\nlogThis(paste0(allClust, collapse = \", \"))\n\nclSizes &lt;- vapply(allClust, function(x) { nlevels(getClusters(fb150Obj, x))}, integer(1L))\nclSizes\n\n            split             merge            seurat   seurat.high.res \n               57                50                21                40 \noriginal.clusters original.subclass    original.class           monocle \n              229                47                14                11 \n monocle.high.res       cell.typist \n               46                13 \n\nlogThis(paste(names(clSizes), clSizes, sep = \": \", collapse = \", \"))\n\n\n\nExtract original cluster\n\noriginalFB150 &lt;- getClusters(fb150Obj, clName = \"original.clusters\")\n\nnlevels(originalFB150)\n\n[1] 229\n\nsort(table(originalFB150), decreasing = TRUE)\n\noriginalFB150\n525 432 511 509 510 508 184 428 434 437 507 568 433 504 426 185 187 505 516 565 \n826 586 540 402 402 397 322 318 273 258 183 181 176 174 173 172 163 147 137 133 \n427 524 679 439 436 493 498 446 438 441 183 497 192 506 188 443 502 494 574 575 \n120 108 105 102  93  93  79  66  63  60  54  51  46  46  43  42  42  41  41  41 \n492 118 177 519 526 566 182 181 501 573 193 429 445 499 518 440 560 178 442 514 \n 38  36  31  31  28  28  27  26  24  24  23  23  23  23  22  21  20  19  19  19 \n523 186 569 444 557 271 452 495 520 535 542 677 527 431 135 455 458 496 512 676 \n 19  18  18  17  16  15  15  15  15  14  14  14  13  12  11  11  11  11  11  11 \n120 159 517 145 161 174 179 558 227 332 457 470 503 739 117 175 176 189 559 564 \n 10  10  10   9   9   9   9   9   8   8   8   8   8   8   7   7   7   7   7   7 \n180 225 538 549 561 671  68 695 738 747 136 144 222 226 273 500 536 678 112 114 \n  6   6   6   6   6   6   6   6   6   6   5   5   5   5   5   5   5   5   4   4 \n115 157 267 328 453 456 534 550 570 686 731 737 133 146 147 158 172 173 270 326 \n  4   4   4   4   4   4   4   4   4   4   4   4   3   3   3   3   3   3   3   3 \n430 513 515 528 533 539 544 571 674 675 732 113 125 130 143 152 162 163 195 259 \n  3   3   3   3   3   3   3   3   3   3   3   2   2   2   2   2   2   2   2   2 \n435 451 454 531 543 548 552 554 562 670 689 740 119 122 134 137 142 151 156 191 \n  2   2   2   2   2   2   2   2   2   2   2   2   1   1   1   1   1   1   1   1 \n194 223 224 228 234 240 262 268 269 275 286 296 308 314 329 333 359  41 448 450 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n468 529 530 532 537 540 553 567 572 601 614 634 647 649  67 672 680 681 684 693 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n696 726 734 749 750 751 760 771  88 \n  1   1   1   1   1   1   1   1   1 \n\n# drop too small clusters: those whose size is less than 15\nlargeClFB150 &lt;- which(table(originalFB150) &gt;= 50)\nlargeOrigFB150 &lt;- originalFB150[(originalFB150 %in% names(largeClFB150)),\n                                drop = TRUE]\n\nlargeOrigFB150 &lt;- toClustersList(largeOrigFB150)\n\n\n\nCalculate GDI for each cluster\n\nprint(\"Length larger clusters\")\nvapply(largeOrigFB150, length, integer(1))\n\nresDataFB150 &lt;- lapply(seq_along(largeOrigFB150), FUN = getClData,\n                       objCOTAN = fb150Obj, clList = largeOrigFB150)\n\n\nclDataFB150 &lt;- data.table::rbindlist(resDataFB150)\nclDataFB150 &lt;- column_to_rownames(clDataFB150, var = \"cluster\")\n\n\nsaveRDS(clDataFB150,\n        file = file.path(\"Data/MouseCortexFromLoom/ClustersGDI/\", \"e15.0_ForebrainDorsal_GDI_of_original_clusterization.RDS\"))\n\n\nclDataFB150 &lt;- readRDS(\"Data/MouseCortexFromLoom/ClustersGDI/e15.0_ForebrainDorsal_GDI_of_original_clusterization.RDS\")\n\nclDataFB150[order(clDataFB150$size,decreasing = T),]\n\n    size isUniform fractionAbove X1stPercentile\n525  826     FALSE  0.3016472479       2.352178\n432  586     FALSE  0.0254880232       1.459100\n511  540     FALSE  0.1510725315       1.913734\n509  402      TRUE  0.0067395414       1.381121\n510  402     FALSE  0.0152561426       1.420390\n508  397      TRUE  0.0046488461       1.370125\n184  322     FALSE  0.0268745853       1.498304\n428  318      TRUE  0.0012377332       1.342660\n434  273      TRUE  0.0004509380       1.329601\n437  258      TRUE  0.0025343004       1.342904\n507  183      TRUE  0.0094123856       1.393946\n568  181      TRUE  0.0000000000       1.305810\n433  176      TRUE  0.0011034483       1.336980\n504  174      TRUE  0.0039181957       1.361682\n426  173      TRUE  0.0004750143       1.330498\n185  172     FALSE  0.0101354303       1.400158\n187  163      TRUE  0.0054207120       1.359734\n505  147      TRUE  0.0001728011       1.293017\n516  137      TRUE  0.0014539856       1.328445\n565  133      TRUE  0.0073304826       1.385537\n427  120      TRUE  0.0000000000       1.274314\n524  108     FALSE  0.0187910535       1.439259\n679  105      TRUE  0.0023903726       1.339173\n439  102      TRUE  0.0000000000       1.267754\n436   93      TRUE  0.0000000000       1.253222\n493   93      TRUE  0.0007476325       1.324079\n498   79      TRUE  0.0010643016       1.321372\n446   66      TRUE  0.0000000000       1.296987\n438   63      TRUE  0.0000000000       1.265541\n441   60      TRUE  0.0000000000       1.277497\n183   54      TRUE  0.0002659810       1.305260\n497   51      TRUE  0.0003751993       1.301691\n\n\nSo we can use the following clusters (at least 100 cells - cell number in the parenthesis - and GDI lower than 1.5):\n\ncl432 (586),\ncl509 (402),\ncl510 (402),\ncl508 (397),\ncl428 (318),\ncl434 (273),\ncl437 (258)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Original Clusters GDI evaluation"
    ]
  },
  {
    "objectID": "ForebrainLaManno2021ClustersGDI.html#forebrain-dorsal-e17.5",
    "href": "ForebrainLaManno2021ClustersGDI.html#forebrain-dorsal-e17.5",
    "title": "Forebrain La Manno 2021 Clusters GDI",
    "section": "Forebrain Dorsal E17.5",
    "text": "Forebrain Dorsal E17.5\n\nLoad dataset\n\nfb175Obj &lt;- readRDS(file = file.path(\"Data/MouseCortexFromLoom/\", \"e17.5_ForebrainDorsal.cotan.RDS\"))\n\nsampleCondition &lt;- getMetadataElement(fb175Obj, datasetTags()[[\"cond\"]])\n\nlogThis(sampleCondition)\n\nallClust &lt;- getClusterizations(fb175Obj)\n\nlogThis(\"\")\nlogThis(paste(\"Number of cells:\", getNumCells(fb175Obj)))\n\nlogThis(\"\")\nlogThis(\"Available clusterizations:\")\nlogThis(paste0(allClust, collapse = \", \"))\n\nclSizes &lt;- vapply(allClust, function(x) { nlevels(getClusters(fb175Obj, x))}, integer(1L))\nclSizes\n\n            split             merge original.clusters original.subclass \n               25                19               136                27 \n   original.class       cell.typist            seurat   seurat.high.res \n                9                10                19                21 \n          monocle  monocle.high.res \n                7                24 \n\nlogThis(paste(names(clSizes), clSizes, sep = \": \", collapse = \", \"))\n\n\n\nExtract original cluster\n\noriginalFB175 &lt;- getClusters(fb175Obj, clName = \"original.clusters\")\n\nnlevels(originalFB175)\n\n[1] 136\n\nsort(table(originalFB175), decreasing = TRUE)\n\noriginalFB175\n516 505 515 427 504 514 428 493 506 513 508 517 523 177 436 498 512 507 524 172 \n297 203 159 147 135 119 110  80  72  69  58  58  55  38  38  38  37  36  29  28 \n568 439 492 495 503 574 575 179 426 526 521 441 433 442 494 497 502 178 501 565 \n 27  26  23  22  22  22  20  18  17  17  16  15  13  13  13  13  13  12  12  12 \n678 446 518 677 180 536 573 135 159 174 309 564 225 452 453 522 525 676 679 161 \n 11  10  10  10   9   8   8   7   7   7   7   7   6   6   6   6   6   6   6   5 \n176 184 277 437 458 520 535 539 144 175 182 187 457 499 519 537 569 117 185 262 \n  5   5   5   5   5   5   5   5   4   4   4   4   4   4   4   4   4   3   3   3 \n355 359 425 509 511 689 142 158 189 307 315 429 432 434 443 448 538 543 690 737 \n  3   3   3   3   3   3   2   2   2   2   2   2   2   2   2   2   2   2   2   2 \n115 120 124 132 136 151 160 173 183 188 227 245 261 273 286 298 306 308 310 316 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n317 438 440 455 500 510 557 560 562 570 572 671 673 688 740 796 \n  1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 \n\n# drop too small clusters: those whose size is less than 15\nlargeClFB175 &lt;- which(table(originalFB175) &gt;= 50)\nlargeOrigFB175 &lt;- originalFB175[(originalFB175 %in% names(largeClFB175)),\n                                drop = TRUE]\n\nlargeOrigFB175 &lt;- toClustersList(largeOrigFB175)\n\n\n\nCalculate GDI for each cluster\n\nprint(\"Length larger clusters\")\nvapply(largeOrigFB175, length, integer(1))\n\nresDataFB175 &lt;- lapply(seq_along(largeOrigFB175), FUN = getClData,\n                       objCOTAN = fb175Obj, clList = largeOrigFB175)\n\n\nclDataFB175 &lt;- data.table::rbindlist(resDataFB175)\nclDataFB175 &lt;- column_to_rownames(clDataFB175, var = \"cluster\")\n\n\nsaveRDS(clDataFB175,\n        file = file.path(\"Data/MouseCortexFromLoom/ClustersGDI/\", \"e17.5_ForebrainDorsal_GDI_of_original_clusterization.RDS\"))\n\n\nclDataFB175 &lt;- readRDS(\"Data/MouseCortexFromLoom/ClustersGDI/e17.5_ForebrainDorsal_GDI_of_original_clusterization.RDS\")\nclDataFB175[order(clDataFB175$size,decreasing = T),]\n\n    size isUniform fractionAbove X1stPercentile\n516  297      TRUE  5.787234e-03       1.380640\n505  203      TRUE  7.261505e-04       1.330011\n515  159     FALSE  8.098331e-02       1.736907\n427  147      TRUE  0.000000e+00       1.275390\n504  135      TRUE  0.000000e+00       1.265854\n514  119     FALSE  3.665886e-02       1.517923\n428  110      TRUE  0.000000e+00       1.263149\n493   80      TRUE  1.512224e-03       1.331605\n506   72      TRUE  8.827684e-05       1.285308\n513   69     FALSE  7.475535e-02       1.649405\n508   58      TRUE  0.000000e+00       1.255277\n517   58      TRUE  8.074475e-03       1.383811\n523   55     FALSE  1.395007e-02       1.416125\n\n\nSo we can use the following clusters (at least 100 cells - cell number in the parenthesis - and GDI lower than 1.5):\n\ncl516 (297),\ncl505 (203)\n\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] COTAN_2.3.0       data.table_1.14.8 zeallot_0.1.0     rlang_1.1.1      \n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3        rstudioapi_0.15.0        \n  [3] jsonlite_1.8.7            shape_1.4.6              \n  [5] umap_0.2.10.0             magrittr_2.0.3           \n  [7] spatstat.utils_3.0-3      rmarkdown_2.24           \n  [9] GlobalOptions_0.1.2       vctrs_0.6.3              \n [11] ROCR_1.0-11               spatstat.explore_3.2-1   \n [13] DelayedMatrixStats_1.22.5 askpass_1.2.0            \n [15] htmltools_0.5.5           S4Arrays_1.2.0           \n [17] sctransform_0.4.1         parallelly_1.36.0        \n [19] KernSmooth_2.23-22        htmlwidgets_1.6.2        \n [21] ica_1.0-3                 plyr_1.8.8               \n [23] plotly_4.10.2             zoo_1.8-12               \n [25] igraph_1.5.1              mime_0.12                \n [27] lifecycle_1.0.3           iterators_1.0.14         \n [29] pkgconfig_2.0.3           rsvd_1.0.5               \n [31] Matrix_1.6-2              R6_2.5.1                 \n [33] fastmap_1.1.1             MatrixGenerics_1.12.3    \n [35] fitdistrplus_1.1-11       future_1.33.0            \n [37] shiny_1.7.5               clue_0.3-64              \n [39] digest_0.6.33             colorspace_2.1-0         \n [41] patchwork_1.1.2           S4Vectors_0.38.1         \n [43] tensor_1.5                Seurat_5.0.0             \n [45] dqrng_0.3.0               RSpectra_0.16-1          \n [47] irlba_2.3.5.1             beachmat_2.16.0          \n [49] PCAtools_2.14.0           progressr_0.14.0         \n [51] RcppZiggurat_0.1.6        spatstat.sparse_3.0-2    \n [53] fansi_1.0.4               polyclip_1.10-4          \n [55] httr_1.4.6                abind_1.4-5              \n [57] compiler_4.3.2            withr_2.5.0              \n [59] doParallel_1.0.17         BiocParallel_1.34.2      \n [61] viridis_0.6.4             fastDummies_1.7.3        \n [63] dendextend_1.17.1         MASS_7.3-60              \n [65] openssl_2.1.0             DelayedArray_0.26.7      \n [67] rjson_0.2.21              tools_4.3.2              \n [69] lmtest_0.9-40             httpuv_1.6.11            \n [71] future.apply_1.11.0       goftest_1.2-3            \n [73] glue_1.6.2                nlme_3.1-163             \n [75] promises_1.2.0.1          grid_4.3.2               \n [77] Rtsne_0.16                cluster_2.1.4            \n [79] reshape2_1.4.4            generics_0.1.3           \n [81] spatstat.data_3.0-1       gtable_0.3.3             \n [83] tidyr_1.3.0               BiocSingular_1.16.0      \n [85] ScaledMatrix_1.8.1        sp_2.1-1                 \n [87] utf8_1.2.3                spatstat.geom_3.2-4      \n [89] BiocGenerics_0.46.0       RcppAnnoy_0.0.21         \n [91] ggrepel_0.9.3             RANN_2.6.1               \n [93] foreach_1.5.2             pillar_1.9.0             \n [95] stringr_1.5.0             spam_2.10-0              \n [97] RcppHNSW_0.5.0            later_1.3.1              \n [99] circlize_0.4.15           splines_4.3.2            \n[101] dplyr_1.1.2               lattice_0.22-5           \n[103] deldir_1.0-9              survival_3.5-7           \n[105] tidyselect_1.2.0          ComplexHeatmap_2.16.0    \n[107] miniUI_0.1.1.1            pbapply_1.7-2            \n[109] knitr_1.43                gridExtra_2.3            \n[111] IRanges_2.34.1            scattermore_1.2          \n[113] stats4_4.3.2              xfun_0.39                \n[115] matrixStats_1.1.0         stringi_1.8.1            \n[117] lazyeval_0.2.2            yaml_2.3.7               \n[119] evaluate_0.21             codetools_0.2-19         \n[121] tibble_3.2.1              cli_3.6.1                \n[123] uwot_0.1.16               RcppParallel_5.1.7       \n[125] xtable_1.8-4              reticulate_1.34.0        \n[127] munsell_0.5.0             Rcpp_1.0.11              \n[129] spatstat.random_3.2-1     globals_0.16.2           \n[131] png_0.1-8                 parallel_4.3.2           \n[133] Rfast_2.1.0               ellipsis_0.3.2           \n[135] assertthat_0.2.1          ggplot2_3.4.2            \n[137] dotCall64_1.1-0           parallelDist_0.2.6       \n[139] sparseMatrixStats_1.12.2  listenv_0.9.0            \n[141] ggthemes_4.2.4            viridisLite_0.4.2        \n[143] scales_1.2.1              ggridges_0.5.4           \n[145] SeuratObject_5.0.0        leiden_0.4.3             \n[147] purrr_1.0.1               crayon_1.5.2             \n[149] GetoptLong_1.0.5          cowplot_1.1.1",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Original Clusters GDI evaluation"
    ]
  },
  {
    "objectID": "GDI_Increment_From_Mixing.html",
    "href": "GDI_Increment_From_Mixing.html",
    "title": "GDI Increment From Mixing",
    "section": "",
    "text": "library(assertthat)\nlibrary(rlang)\nlibrary(scales)\nlibrary(ggplot2)\nlibrary(zeallot)\nlibrary(data.table)\nlibrary(parallelDist)\nlibrary(tidyr)\nlibrary(tidyverse)\nlibrary(ggh4x)\nlibrary(gridExtra)\n\n#options(parallelly.fork.enable = TRUE)\n\ninDir &lt;- file.path(\"Results\")\n\n#setLoggingLevel(2)\n#setLoggingFile(file.path(inDir, \"MixingClustersGDI_ForebrainDorsal.log\"))\n\noutDir &lt;- file.path(inDir, \"GDI_Sensitivity\")\nif (!file.exists(outDir)) {\n  dir.create(outDir)\n}",
    "crumbs": [
      "GDI sensitivity",
      "GDI Increment From Mixing"
    ]
  },
  {
    "objectID": "GDI_Increment_From_Mixing.html#preamble",
    "href": "GDI_Increment_From_Mixing.html#preamble",
    "title": "GDI Increment From Mixing",
    "section": "",
    "text": "library(assertthat)\nlibrary(rlang)\nlibrary(scales)\nlibrary(ggplot2)\nlibrary(zeallot)\nlibrary(data.table)\nlibrary(parallelDist)\nlibrary(tidyr)\nlibrary(tidyverse)\nlibrary(ggh4x)\nlibrary(gridExtra)\n\n#options(parallelly.fork.enable = TRUE)\n\ninDir &lt;- file.path(\"Results\")\n\n#setLoggingLevel(2)\n#setLoggingFile(file.path(inDir, \"MixingClustersGDI_ForebrainDorsal.log\"))\n\noutDir &lt;- file.path(inDir, \"GDI_Sensitivity\")\nif (!file.exists(outDir)) {\n  dir.create(outDir)\n}",
    "crumbs": [
      "GDI sensitivity",
      "GDI Increment From Mixing"
    ]
  },
  {
    "objectID": "GDI_Increment_From_Mixing.html#load-calculated-data-for-analysis",
    "href": "GDI_Increment_From_Mixing.html#load-calculated-data-for-analysis",
    "title": "GDI Increment From Mixing",
    "section": "Load calculated data for analysis",
    "text": "Load calculated data for analysis",
    "crumbs": [
      "GDI sensitivity",
      "GDI Increment From Mixing"
    ]
  },
  {
    "objectID": "GDI_Increment_From_Mixing.html#recall-cluster-distance-and-add-it-to-the-results",
    "href": "GDI_Increment_From_Mixing.html#recall-cluster-distance-and-add-it-to-the-results",
    "title": "GDI Increment From Mixing",
    "section": "Recall cluster distance and add it to the results",
    "text": "Recall cluster distance and add it to the results\n\nzeroOneAvg &lt;- readRDS(file.path(outDir, \"allZeroOne.RDS\"))\ndistZeroOne &lt;- as.matrix(parDist(t(zeroOneAvg), method = \"hellinger\", diag = TRUE, upper = TRUE))^2\n\ndistZeroOneLong &lt;- rownames_to_column(as.data.frame(distZeroOne), var = \"MainCluster\")\ndistZeroOneLong &lt;-pivot_longer(distZeroOneLong,\n                               cols = !MainCluster,\n                               names_to = \"OtherCluster\", \n                               values_to = \"Distance\")\n\ndistZeroOneLong &lt;- as.data.frame(distZeroOneLong[distZeroOneLong[[\"Distance\"]] != 0.0, ])\n\nassert_that(identical(distZeroOneLong[, 1:2], resMix20[, 1:2]))\n\n[1] TRUE\n\nperm &lt;- order(distZeroOneLong[[\"Distance\"]])\n\n\n# Scatter plot of the effective increment at 40% mixing [Y]\n# against estimated distance [X]\ndistDF &lt;- cbind(distZeroOneLong[, \"Distance\", drop = FALSE],\n                sqrt(distZeroOneLong[, \"Distance\", drop = FALSE]))\ncolnames(distDF) &lt;- c(\"Distance\", \"DistanceSqrt\")\n\nD2IPlot &lt;- ggplot(cbind(resMix40, distDF),\n                  aes(x=Distance, y=GDIIncrement)) +\n             geom_point() +\n             geom_smooth(method=lm, formula = y ~ x)+\n             ylab(\"Top GDI percentile Increment\") \n           # +  xlim(0, 1.5) + ylim(0, 1.5) + coord_fixed()\n\nplot(D2IPlot)",
    "crumbs": [
      "GDI sensitivity",
      "GDI Increment From Mixing"
    ]
  },
  {
    "objectID": "GDI_Increment_From_Mixing.html#merge-all-data-and-plot-it-using-the-distance-as-discriminant",
    "href": "GDI_Increment_From_Mixing.html#merge-all-data-and-plot-it-using-the-distance-as-discriminant",
    "title": "GDI Increment From Mixing",
    "section": "Merge all data and plot it using the distance as discriminant",
    "text": "Merge all data and plot it using the distance as discriminant\n\nallRes &lt;- rbind(resMix05[perm, ], resMix10[perm, ], resMix20[perm, ], resMix40[perm, ], resMix80[perm, ])\nallRes &lt;- cbind(allRes, \"Distance\" = rep(distZeroOneLong[[\"Distance\"]][perm], 5))\nrownames(allRes) &lt;- NULL\nallRes &lt;- cbind(allRes, \"ClusterPair\" = rep.int(c(1:210),5))\n\n\nallResWithBase &lt;- cbind(resMix00[perm, ], \"Distance\" = distZeroOneLong[[\"Distance\"]][perm])\nrownames(allResWithBase) &lt;- NULL\nallResWithBase &lt;- cbind(allResWithBase, \"ClusterPair\" = c(1:210))\nallResWithBase &lt;- rbind(allResWithBase, allRes)\n\nassert_that(identical(allRes[, 4], allResWithBase[211:1260, 4]))\n\n[1] TRUE\n\n\n\ndim(allRes)\n\n[1] 1050    7\n\n\n\nIScPlot &lt;- ggplot(allRes, aes(x=MixingFraction, y=GDIIncrement, color=Distance,)) +\n  geom_point() +\n  scale_color_continuous(type = \"viridis\") +\n  scale_x_log10()+\n             ylab(\"Top GDI percentile Increment\") \n\nplot(IScPlot)\n\n\n\n\n\n\n\nGScPlot &lt;- ggplot(allResWithBase, aes(x=MixingFraction, y=GDI, color=Distance,)) +\n  geom_point() +\n  scale_color_continuous(type = \"viridis\")+\n             ylab(\"Top GDI percentile\") \n\nplot(GScPlot)\n\n\n\n\n\n\n\n\n\nreOrder &lt;- function(df, numBlocks) {\n  blockLength &lt;- nrow(df) / numBlocks\n  permut &lt;- rep(1:blockLength, each = numBlocks) +\n              rep(seq(0, nrow(df) - 1, by = blockLength), times = numBlocks)\n  return(df[permut, ])\n}\n\nallRes2 &lt;- reOrder(allRes, 5)\nallResWithBase2 &lt;- reOrder(allResWithBase, 6)\n\n\nrng &lt;- c(1,210)\n#rng &lt;- c(1,42)\n#rng &lt;- c(43,84)\n#rng &lt;- c(85,126)\n#rng &lt;- c(127,168)\n#rng &lt;- c(169,210)\n\nILinesPLot &lt;- ggplot(allRes2[allRes2[[\"ClusterPair\"]] %between% rng, ],\n                     aes(x = MixingFraction, y = GDIIncrement,\n                         color = (ClusterPair - 1) %/% 35 + 0.5)) + \n  geom_path(aes(group = ClusterPair)) +\n  theme(legend.position = \"none\") +\n  #scale_x_log10() + \n  scale_colour_stepsn(colours = hcl.colors(6, palette = \"Dark 2\")[6:1])+\n             ylab(\"Top GDI percentile Increment\") \n\nplot(ILinesPLot)\n\n\n\n\n\n\n\nGLinesPLot &lt;- ggplot(allResWithBase2[allResWithBase2[[\"ClusterPair\"]] %between% rng, ],\n                     aes(x = MixingFraction, y = GDI,\n                         color = (ClusterPair - 1) %/% 35 + 0.5)) + \n  geom_path(aes(group = ClusterPair)) +\n  theme(legend.position = \"none\") +\n  #scale_x_log10() + \n  scale_colour_stepsn(colours = hcl.colors(6, palette = \"Dark 2\")[6:1]) +\n             ylab(\"Top GDI percentile\") \n#  geom_line(data = data.frame(cbind(MixingFraction = c(0,0.8), GDI = c(1.4,1.4))),\n#            aes(x = MixingFraction, y = GDI))\n\n\nplot(GLinesPLot)\n\n\n\n\n\n\n\n\n\nmg &lt;- function(mixings) {\n  res &lt;- mixings\n  res[res !=0 ] &lt;- ceiling(log2(round(res[res !=0 ] * 40)))\n  return(res)\n}\n\nrng &lt;- c(1,35)\n#rng &lt;- c(43,84)\n#rng &lt;- c(85,126)\n#rng &lt;- c(127,168)\n#rng &lt;- c(169,210)\n\nallRes$Group &lt;- factor((allRes$ClusterPair - 1) %/% 35 + 1)\nlevels(allRes$Group) &lt;- paste0(\"Distance bin \",c(1:6))\n\nallRes$discreteMixing &lt;- factor(mg(allRes$MixingFraction))\nlevels(allRes$discreteMixing) &lt;- c(\"5%\",\"10%\",\"20%\",\"40%\",\"80%\")\n\ndesign &lt;- \"\n  ABC\n  DEF\n  DEF\n\"\n\nfirst.part &lt;- c(\"Distance bin 1\", \"Distance bin 2\", \"Distance bin 3\")\nsecond.part &lt;-c(\"Distance bin 4\", \"Distance bin 5\", \"Distance bin 6\") \n\nIBoxPlotA &lt;- ggplot(allRes[allRes$Group %in% first.part,], aes(x=discreteMixing, \n                       y=GDIIncrement, \n                       fill=Group,\n                       group = discreteMixing)) +\n  geom_boxplot()+\n  geom_jitter(width=0.25, alpha=0.5) +\n  scale_fill_manual(values = c(\"#0B5345\",\"#117A65\",\"#16A085\")) +\n  facet_grid2(cols = vars(Group))+\n  theme_light()+\n  theme(legend.position = \"none\",axis.title.x=element_blank(),\n        axis.title.y =element_blank()) #+\n             #ylab(\"Top GDI percentile Increment\") \n\nIBoxPlotB &lt;- ggplot(allRes[allRes$Group %in% second.part,], aes(x=discreteMixing, \n                       y=GDIIncrement, \n                       fill=Group,\n                       group = discreteMixing)) +\n  geom_boxplot()+\n  geom_jitter(width=0.25, alpha=0.5) +\n  scale_fill_manual(values = c(\"#1ABC9C\",\"#48C9B0\",\"#A3E4D7\")) +\n  facet_grid2(cols = vars(Group))+\n  theme_light()+\n  theme(legend.position = \"none\",axis.title.x=element_blank(),\n        axis.title.y =element_blank()) \n\nfinal.plot1 &lt;- grid.arrange(IBoxPlotA,IBoxPlotB,ncol = 2, nrow = 3,\n             layout_matrix = rbind(c(1,1), c(2,2), c(2,2)))\n\n\n\n\n\n\n\npdf(\"Results/GDI_Sensitivity/GDI_increment.pdf\",width = 7, height = 7)\nplot(final.plot1)\ndev.off()\n\npng \n  2 \n\nplot(final.plot1)\n\n\n\n\n\n\n\nallResWithBase$Group &lt;- factor((allResWithBase$ClusterPair - 1) %/% 35 + 1)\nlevels(allResWithBase$Group) &lt;- paste0(\"Distance bin \",c(1:6))\n\n\nallResWithBase$discreteMixing &lt;- factor(mg(allResWithBase$MixingFraction))\nlevels(allResWithBase$discreteMixing) &lt;- c(\"0%\",\"5%\",\"10%\",\"20%\",\"40%\",\"80%\")\n\n\nGBoxPlotA &lt;- ggplot(allResWithBase[allResWithBase$Group %in% first.part,], aes(x=discreteMixing, y=GDI, fill=Group,\n                              group = discreteMixing))+\n  geom_boxplot()+\n  geom_jitter(width=0.25, alpha=0.5) +\n  scale_fill_manual(values = c(\"#0B5345\",\"#117A65\",\"#16A085\")) +\n  facet_grid2(cols = vars(Group))+\n  theme_light()+\n  theme(legend.position = \"none\",axis.title.x=element_blank(),\n        axis.title.y =element_blank()) #+\n             #ylab(\"Top GDI percentile Increment\") \n\nGBoxPlotB &lt;- ggplot(allResWithBase[allResWithBase$Group %in% second.part,], aes(x=discreteMixing, y=GDI, fill=Group,\n                              group = discreteMixing)) +\n  geom_boxplot()+\n  geom_jitter(width=0.25, alpha=0.5) +\n  scale_fill_manual(values = c(\"#1ABC9C\",\"#48C9B0\",\"#A3E4D7\")) +\n  facet_grid2(cols = vars(Group))+\n  theme_light()+\n  theme(legend.position = \"none\",axis.title.x=element_blank(),\n        axis.title.y =element_blank()) \n\nfinal.plot2 &lt;- grid.arrange(GBoxPlotA,GBoxPlotB,ncol = 2, nrow = 5,\n             layout_matrix = rbind(c(1,1),c(1,1),c(2,2), c(2,2), c(2,2)))\n\n\n\n\n\n\n\npdf(\"Results/GDI_Sensitivity/GDI_TopPercentile.pdf\",width = 7, height = 7 )\nplot(final.plot2)\ndev.off()\n\npng \n  2 \n\nplot(final.plot2)",
    "crumbs": [
      "GDI sensitivity",
      "GDI Increment From Mixing"
    ]
  },
  {
    "objectID": "GDI_Increment_From_Mixing.html#load-calculated-data-about-multi-clusters-cases-for-analysis",
    "href": "GDI_Increment_From_Mixing.html#load-calculated-data-about-multi-clusters-cases-for-analysis",
    "title": "GDI Increment From Mixing",
    "section": "Load calculated data about multi clusters cases for analysis",
    "text": "Load calculated data about multi clusters cases for analysis",
    "crumbs": [
      "GDI sensitivity",
      "GDI Increment From Mixing"
    ]
  },
  {
    "objectID": "GDI_Increment_From_Mixing.html#compare-estimated-vs-real-gdi-increment",
    "href": "GDI_Increment_From_Mixing.html#compare-estimated-vs-real-gdi-increment",
    "title": "GDI Increment From Mixing",
    "section": "Compare estimated vs real GDI increment",
    "text": "Compare estimated vs real GDI increment\n\n# Scatter plot of the effective increment [Y] against estimated increment [X]\npg &lt;- ggplot(resMix20_2, aes(x=PredictedGDIIncrement, y=GDIIncrement)) +\n  geom_point() +\n  geom_smooth(method=lm, formula = y ~ x + 0) +\n  coord_fixed() +\n  xlim(0, 1.5) + ylim(0, 1.5)+\n             ylab(\"Top GDI percentile Increment\") \n  #scale_x_log10() + scale_y_log10() \n\n\n\nplot(pg)\n\n\n\n\n\n\n\n\nThe plot shows that having the 20% extraneous cells in the mixture coming from multiple clusters does not affect significantly the sensitivity of the GDI to score cluster uniformity.\n\nsessionInfo()\n\nR version 4.4.0 (2024-04-24)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] gridExtra_2.3      ggh4x_0.2.8        lubridate_1.9.3    forcats_1.0.0     \n [5] stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2        readr_2.1.5       \n [9] tibble_3.2.1       tidyverse_2.0.0    tidyr_1.3.1        parallelDist_0.2.6\n[13] data.table_1.15.4  zeallot_0.1.0      ggplot2_3.5.1      scales_1.3.0      \n[17] rlang_1.1.3        assertthat_0.2.1  \n\nloaded via a namespace (and not attached):\n [1] utf8_1.2.4         generics_0.1.3     lattice_0.22-6     stringi_1.8.4     \n [5] hms_1.1.3          digest_0.6.35      magrittr_2.0.3     evaluate_0.23     \n [9] grid_4.4.0         timechange_0.3.0   fastmap_1.2.0      Matrix_1.7-0      \n[13] jsonlite_1.8.8     mgcv_1.9-1         fansi_1.0.6        viridisLite_0.4.2 \n[17] cli_3.6.2          munsell_0.5.1      splines_4.4.0      withr_3.0.0       \n[21] yaml_2.3.8         tools_4.4.0        tzdb_0.4.0         colorspace_2.1-0  \n[25] vctrs_0.6.5        R6_2.5.1           lifecycle_1.0.4    htmlwidgets_1.6.4 \n[29] pkgconfig_2.0.3    RcppParallel_5.1.7 pillar_1.9.0       gtable_0.3.5      \n[33] glue_1.7.0         Rcpp_1.0.12        xfun_0.44          tidyselect_1.2.1  \n[37] knitr_1.46         farver_2.1.2       nlme_3.1-164       htmltools_0.5.8.1 \n[41] labeling_0.4.3     rmarkdown_2.27     compiler_4.4.0",
    "crumbs": [
      "GDI sensitivity",
      "GDI Increment From Mixing"
    ]
  },
  {
    "objectID": "Real_UT_clustersByCotan.html",
    "href": "Real_UT_clustersByCotan.html",
    "title": "Real UT clusters",
    "section": "",
    "text": "Cl432 E13.5 E15.0",
    "crumbs": [
      "Cluster evaluation",
      "Real UT clusters with LR"
    ]
  },
  {
    "objectID": "Real_UT_clustersByCotan.html#preamble",
    "href": "Real_UT_clustersByCotan.html#preamble",
    "title": "Real UT clusters",
    "section": "Preamble",
    "text": "Preamble\n\nlibrary(ggplot2)\nlibrary(zeallot)\nlibrary(data.table)\nlibrary(parallelDist)\nlibrary(tidyr)\nlibrary(tidyverse)\nlibrary(caret)\ntheme_set(theme_bw())\nlibrary(COTAN)\nlibrary(stringr)\nlibrary(nnet)\n\noptions(parallelly.fork.enable = TRUE)\ninDir &lt;- file.path(\"Data/MouseCortexFromLoom/\")\n\n#setLoggingLevel(2)\n#setLoggingFile(file.path(inDir, \"MixingClustersGDI_ForebrainDorsal.log\"))\n\noutDir &lt;- file.path(\"Data/MouseCortexFromLoom/PureClusters/\")\nif (!file.exists(outDir)) {\n  dir.create(outDir)\n}",
    "crumbs": [
      "Cluster evaluation",
      "Real UT clusters with LR"
    ]
  },
  {
    "objectID": "Real_UT_clustersByCotan.html#and-434-e15.0",
    "href": "Real_UT_clustersByCotan.html#and-434-e15.0",
    "title": "Real UT clusters",
    "section": "428 and 434 e15.0",
    "text": "428 and 434 e15.0\n\ne15.0 &lt;- readRDS(paste0(inDir,\"e15.0_ForebrainDorsal.cotan.RDS\"))\n\ncells &lt;- c(rownames(getMetadataCells(e15.0)[getMetadataCells(e15.0)[,\"Clusters\"] == 428,]),\n           rownames(getMetadataCells(e15.0)[getMetadataCells(e15.0)[,\"Clusters\"] == 434,]))\n\ncl428_cl434 &lt;- dropGenesCells(e15.0,cells = getCells(e15.0)[!getCells(e15.0) %in% cells] )\n\ncl428_cl434 &lt;- clean(cl428_cl434)\ncl428_cl434 &lt;- proceedToCoex(cl428_cl434)\n\n#saveRDS(cl428_cl434,past0(outDir,\"cl428_cl434.cotan.RDS\"))\n\n\ncl428_cl434GDI &lt;- calculateGDI(cl428_cl434)\n\nsubsetGDIcl428_cl434 &lt;- cl428_cl434GDI[cl428_cl434GDI$sum.raw.norm &gt; 7,]\ntop.GDI.genes &lt;- rownames(subsetGDIcl428_cl434[order(subsetGDIcl428_cl434$GDI,decreasing = T),])[1:50]\n\nGDIPlot(cl428_cl434,genes = \"\",GDIIn = cl428_cl434GDI)\n\n\n\n\n\n\n\n\n\ndata &lt;- getNormalizedData(cl428_cl434)\ndata &lt;- data[!rowSums(as.matrix(data)) &lt; 1,]\ndata &lt;- log(data*10000+1)\n\nrow_stdev &lt;- apply(data, 1, sd, na.rm=TRUE)\nrow_stdev &lt;- row_stdev[order(row_stdev,decreasing = T)]\n\ngenes.to.keep &lt;- c(names(row_stdev[1:100]),top.GDI.genes)\n\ndata.small &lt;- data[rownames(data) %in% genes.to.keep,]\n\n#data &lt;- t(as.matrix(data))\ndata.small &lt;- t(as.matrix(data.small))\n\n\nCOTAN_Cl.code &lt;- as.numeric(getClusterizationData(cl428_cl434,clName = \"original.clusters\")[[1]])\n\nCOTAN_Cl.code &lt;- COTAN_Cl.code -1\n\ndata.small &lt;- cbind(data.small,COTAN_Cl.code)\ndata.small &lt;- as.data.frame(data.small)\n\n# Split the data into training and test set\nset.seed(123)\ntraining.samples &lt;- data.small[,\"COTAN_Cl.code\"] %&gt;% \n  createDataPartition(p = 0.8, list = FALSE)\ntrain.data  &lt;- data.small[training.samples, ]\ntest.data &lt;- data.small[-training.samples, ]\nhead(train.data)\n\n                               Abracl  Cdkn1c    Cited2     Mllt3  Fam210b\n10X74_4_A_1:GTAACGTGCCATAGx 10.128836 0.00000  9.435728  9.435728 0.000000\n10X73_3_A_1:ACGCCGGATCGTAGx 10.211198 0.00000 10.904327 10.211198 9.518087\n10X74_4_A_1:GATTCGGAGGTGAGx 10.518544 9.13233  9.825424  9.132330 9.132330\n10X74_4_A_1:CTGAGCCTGGTAAAx 10.916737 0.00000  9.307371 10.405923 9.307371\n10X74_4_A_1:CCTAGAGAGTCACAx  9.585177 0.00000 11.194560  0.000000 0.000000\n10X74_4_A_1:CTAGGATGCTTGCCx 11.828628 0.00000 10.941336  8.995532 8.995532\n                                Mfap4   Cxcl12  Cdc42ep3    Limch1     Ier2\n10X74_4_A_1:GTAACGTGCCATAGx  9.435728 9.435728  0.000000  0.000000 0.000000\n10X73_3_A_1:ACGCCGGATCGTAGx  9.518087 0.000000  9.518087  0.000000 0.000000\n10X74_4_A_1:GATTCGGAGGTGAGx 11.078148 9.825424  0.000000  9.132330 9.132330\n10X74_4_A_1:CTGAGCCTGGTAAAx 10.405923 0.000000 10.000473 10.000473 9.307371\n10X74_4_A_1:CCTAGAGAGTCACAx  9.585177 9.585177  0.000000  0.000000 0.000000\n10X74_4_A_1:CTAGGATGCTTGCCx 10.941336 9.688617  0.000000  8.995532 8.995532\n                                Ptprk   Gm29260    Sfrp1    Pantr1     Magi2\n10X74_4_A_1:GTAACGTGCCATAGx  9.435728  0.000000 9.435728 10.534287  0.000000\n10X73_3_A_1:ACGCCGGATCGTAGx 10.211198  9.518087 9.518087  9.518087  9.518087\n10X74_4_A_1:GATTCGGAGGTGAGx  9.132330  9.825424 9.825424 10.518544  0.000000\n10X74_4_A_1:CTGAGCCTGGTAAAx  9.307371 10.000473 0.000000 10.405923  0.000000\n10X74_4_A_1:CCTAGAGAGTCACAx  9.585177  0.000000 9.585177  0.000000  0.000000\n10X74_4_A_1:CTAGGATGCTTGCCx  0.000000  8.995532 9.688617 10.604871 10.381733\n                             Tmem108     Ddr1       Ezr    Sncaip CT025619.1\n10X74_4_A_1:GTAACGTGCCATAGx 0.000000 0.000000  9.435728  0.000000   9.435728\n10X73_3_A_1:ACGCCGGATCGTAGx 0.000000 0.000000  0.000000  9.518087  10.211198\n10X74_4_A_1:GATTCGGAGGTGAGx 0.000000 0.000000 10.230871  9.825424   9.132330\n10X74_4_A_1:CTGAGCCTGGTAAAx 9.307371 0.000000  0.000000 10.000473   9.307371\n10X74_4_A_1:CCTAGAGAGTCACAx 0.000000 0.000000 10.278290  0.000000   9.585177\n10X74_4_A_1:CTAGGATGCTTGCCx 8.995532 8.995532  8.995532  0.000000   8.995532\n                               Fabp7 Ctnnd2       Ptn    Frmd4a    Sorbs2\n10X74_4_A_1:GTAACGTGCCATAGx 0.000000      0 10.128836 11.227421 10.534287\n10X73_3_A_1:ACGCCGGATCGTAGx 9.518087      0  9.518087  9.518087 10.616651\n10X74_4_A_1:GATTCGGAGGTGAGx 9.132330      0  0.000000  0.000000  9.825424\n10X74_4_A_1:CTGAGCCTGGTAAAx 9.307371      0 10.693598  9.307371 10.000473\n10X74_4_A_1:CCTAGAGAGTCACAx 9.585177      0 10.278290  0.000000  9.585177\n10X74_4_A_1:CTAGGATGCTTGCCx 9.688617      0  0.000000  0.000000 10.094061\n                                Hes6       Dcc   Neurog2     Tcf12  Fam110a\n10X74_4_A_1:GTAACGTGCCATAGx 0.000000  9.435728  0.000000  0.000000 0.000000\n10X73_3_A_1:ACGCCGGATCGTAGx 9.518087  0.000000  0.000000 10.616651 0.000000\n10X74_4_A_1:GATTCGGAGGTGAGx 9.825424  9.825424 10.741682  9.825424 9.825424\n10X74_4_A_1:CTGAGCCTGGTAAAx 0.000000 10.916737  0.000000 10.000473 0.000000\n10X74_4_A_1:CCTAGAGAGTCACAx 9.585177  0.000000  0.000000 11.194560 9.585177\n10X74_4_A_1:CTAGGATGCTTGCCx 0.000000  8.995532  8.995532 10.094061 0.000000\n                               Dhrs4     Ccnd2    Elavl4      Ank3    Klf12\n10X74_4_A_1:GTAACGTGCCATAGx 0.000000  0.000000  9.435728  9.435728 0.000000\n10X73_3_A_1:ACGCCGGATCGTAGx 0.000000  9.518087  0.000000  9.518087 0.000000\n10X74_4_A_1:GATTCGGAGGTGAGx 9.132330 10.924000  9.132330  0.000000 9.132330\n10X74_4_A_1:CTGAGCCTGGTAAAx 0.000000  0.000000 10.000473 10.916737 9.307371\n10X74_4_A_1:CCTAGAGAGTCACAx 0.000000 10.278290 10.971420  9.585177 9.585177\n10X74_4_A_1:CTAGGATGCTTGCCx 9.688617 10.094061 10.094061  9.688617 0.000000\n                             Slc17a6     Lzts1      Map2      Lhx2   Neurod2\n10X74_4_A_1:GTAACGTGCCATAGx 0.000000  0.000000  0.000000 10.128836 10.534287\n10X73_3_A_1:ACGCCGGATCGTAGx 0.000000  9.518087 10.211198  9.518087  9.518087\n10X74_4_A_1:GATTCGGAGGTGAGx 9.132330 10.518544  9.825424 10.230871  9.825424\n10X74_4_A_1:CTGAGCCTGGTAAAx 0.000000 10.405923  0.000000 10.000473 11.099055\n10X74_4_A_1:CCTAGAGAGTCACAx 0.000000  0.000000 10.971420 10.971420 10.278290\n10X74_4_A_1:CTAGGATGCTTGCCx 8.995532 10.381733  8.995532 10.787188 10.604871\n                               Sstr2     Eomes   Vps37b      Ier5  Cttnbp2\n10X74_4_A_1:GTAACGTGCCATAGx 10.82196  0.000000  0.00000 10.128836  0.00000\n10X73_3_A_1:ACGCCGGATCGTAGx 10.21120  0.000000  0.00000  9.518087 11.12747\n10X74_4_A_1:GATTCGGAGGTGAGx 10.51854  9.825424  9.13233  0.000000 10.23087\n10X74_4_A_1:CTGAGCCTGGTAAAx 10.69360  0.000000  0.00000  0.000000  0.00000\n10X74_4_A_1:CCTAGAGAGTCACAx 10.27829 10.278290 10.27829  9.585177 11.19456\n10X74_4_A_1:CTAGGATGCTTGCCx 10.94134  0.000000 10.60487  0.000000 10.94134\n                              Tmem178   Plxna4      Aff3     Tiam2  Ppp2r2b\n10X74_4_A_1:GTAACGTGCCATAGx  9.435728 9.435728  9.435728  9.435728 10.82196\n10X73_3_A_1:ACGCCGGATCGTAGx  0.000000 0.000000 10.616651 10.211198 10.21120\n10X74_4_A_1:GATTCGGAGGTGAGx  9.132330 0.000000  0.000000 10.230871  9.13233\n10X74_4_A_1:CTGAGCCTGGTAAAx 10.405923 0.000000  0.000000  9.307371 10.91674\n10X74_4_A_1:CCTAGAGAGTCACAx  0.000000 0.000000  0.000000  0.000000 10.27829\n10X74_4_A_1:CTAGGATGCTTGCCx  0.000000 0.000000  0.000000 10.094061 10.09406\n                                 Zeb2     Gria2     Nbea     Ptprd      Sox5\n10X74_4_A_1:GTAACGTGCCATAGx  9.435728 10.534287 0.000000  9.435728 10.821963\n10X73_3_A_1:ACGCCGGATCGTAGx  0.000000 10.211198 9.518087  0.000000  9.518087\n10X74_4_A_1:GATTCGGAGGTGAGx  9.825424  9.132330 0.000000  0.000000  9.132330\n10X74_4_A_1:CTGAGCCTGGTAAAx  0.000000 10.405923 0.000000 10.405923 10.000473\n10X74_4_A_1:CCTAGAGAGTCACAx  9.585177  9.585177 0.000000  0.000000 10.278290\n10X74_4_A_1:CTAGGATGCTTGCCx 10.381733  0.000000 0.000000  0.000000  0.000000\n                               Mpped2   Bcl11b    Epha5     Nol4    Grik2\n10X74_4_A_1:GTAACGTGCCATAGx 10.534287 9.435728 10.53429  0.00000 9.435728\n10X73_3_A_1:ACGCCGGATCGTAGx 10.211198 0.000000 10.61665 10.21120 0.000000\n10X74_4_A_1:GATTCGGAGGTGAGx 10.924000 0.000000 10.23087  0.00000 9.132330\n10X74_4_A_1:CTGAGCCTGGTAAAx  9.307371 0.000000 10.00047 10.91674 0.000000\n10X74_4_A_1:CCTAGAGAGTCACAx  0.000000 0.000000 10.68374 10.97142 0.000000\n10X74_4_A_1:CTAGGATGCTTGCCx  9.688617 0.000000 10.38173  0.00000 8.995532\n                            Mir124.2hg      Pcp4   Ccser1     Kcnb2   Dscaml1\n10X74_4_A_1:GTAACGTGCCATAGx   0.000000  0.000000 11.63288 10.128836  0.000000\n10X73_3_A_1:ACGCCGGATCGTAGx   0.000000 11.127466 10.90433  0.000000  0.000000\n10X74_4_A_1:GATTCGGAGGTGAGx   0.000000 10.741682  0.00000  9.132330  9.132330\n10X74_4_A_1:CTGAGCCTGGTAAAx   0.000000  0.000000 11.09906  0.000000  0.000000\n10X74_4_A_1:CCTAGAGAGTCACAx   0.000000 10.971420 10.27829  0.000000 10.278290\n10X74_4_A_1:CTAGGATGCTTGCCx   8.995532  9.688617 10.38173  8.995532  9.688617\n                                Kcnh7       Pam     Negr1     Ppm1e     Myt1l\n10X74_4_A_1:GTAACGTGCCATAGx  0.000000  0.000000  9.435728 10.534287 11.515100\n10X73_3_A_1:ACGCCGGATCGTAGx  0.000000 10.616651 10.616651  9.518087 10.211198\n10X74_4_A_1:GATTCGGAGGTGAGx  9.132330  9.825424 10.518544  9.825424  0.000000\n10X74_4_A_1:CTGAGCCTGGTAAAx  9.307371  9.307371  0.000000  0.000000 10.405923\n10X74_4_A_1:CCTAGAGAGTCACAx  9.585177 10.683744 11.194560  0.000000  9.585177\n10X74_4_A_1:CTAGGATGCTTGCCx 10.381733  8.995532  0.000000  9.688617 10.094061\n                                Foxp2     Gpc6     Masp1 Serpini1    Pcdh7\n10X74_4_A_1:GTAACGTGCCATAGx  9.435728 10.12884  0.000000 9.435728 10.12884\n10X73_3_A_1:ACGCCGGATCGTAGx  9.518087 10.21120  9.518087 0.000000 11.12747\n10X74_4_A_1:GATTCGGAGGTGAGx  0.000000  0.00000  9.132330 0.000000  9.13233\n10X74_4_A_1:CTGAGCCTGGTAAAx 10.405923  0.00000 10.693598 0.000000  0.00000\n10X74_4_A_1:CCTAGAGAGTCACAx  0.000000  0.00000  0.000000 0.000000 10.97142\n10X74_4_A_1:CTAGGATGCTTGCCx  0.000000  0.00000  9.688617 0.000000 10.09406\n                               Rbfox1    Robo2     Fhod3     Rprm      Gng3\n10X74_4_A_1:GTAACGTGCCATAGx 10.821963 11.38157  9.435728 0.000000 10.128836\n10X73_3_A_1:ACGCCGGATCGTAGx 11.463934 11.71525 10.211198 0.000000  0.000000\n10X74_4_A_1:GATTCGGAGGTGAGx  9.132330 11.32946  9.132330 9.825424  9.132330\n10X74_4_A_1:CTGAGCCTGGTAAAx 11.099055 10.69360  0.000000 0.000000  0.000000\n10X74_4_A_1:CCTAGAGAGTCACAx  9.585177 10.68374  0.000000 0.000000  0.000000\n10X74_4_A_1:CTAGGATGCTTGCCx  0.000000 11.19265  9.688617 8.995532  8.995532\n                               Uchl1  Tmem176b      Nrn1   Snap25     Nrg1\n10X74_4_A_1:GTAACGTGCCATAGx 0.000000  9.435728  0.000000 9.435728 11.04510\n10X73_3_A_1:ACGCCGGATCGTAGx 0.000000 10.211198  0.000000 0.000000 10.90433\n10X74_4_A_1:GATTCGGAGGTGAGx 0.000000  9.132330  9.825424 0.000000 10.74168\n10X74_4_A_1:CTGAGCCTGGTAAAx 9.307371  0.000000 10.916737 9.307371 11.38673\n10X74_4_A_1:CCTAGAGAGTCACAx 0.000000  9.585177  9.585177 9.585177 10.97142\n10X74_4_A_1:CTAGGATGCTTGCCx 0.000000  8.995532  9.688617 9.688617 11.19265\n                                Cdh8   Trim17     Chga    Rpl26     Rack1\n10X74_4_A_1:GTAACGTGCCATAGx 10.12884 0.000000 0.000000 10.82196  0.000000\n10X73_3_A_1:ACGCCGGATCGTAGx 11.30979 0.000000 9.518087 11.30979  0.000000\n10X74_4_A_1:GATTCGGAGGTGAGx 10.74168 0.000000 0.000000 10.92400 10.230871\n10X74_4_A_1:CTGAGCCTGGTAAAx 10.40592 9.307371 9.307371 10.91674  9.307371\n10X74_4_A_1:CCTAGAGAGTCACAx 10.27829 9.585177 0.000000 10.68374 10.278290\n10X74_4_A_1:CTAGGATGCTTGCCx 10.38173 8.995532 0.000000 11.29801 10.094061\n                             Hsp90b1    Aldoa   Tuba1b    Sf3b6      Top1\n10X74_4_A_1:GTAACGTGCCATAGx 9.435728 9.435728 9.435728  0.00000 10.534287\n10X73_3_A_1:ACGCCGGATCGTAGx 0.000000 9.518087 9.518087  0.00000  9.518087\n10X74_4_A_1:GATTCGGAGGTGAGx 0.000000 9.132330 9.132330  9.13233 10.230871\n10X74_4_A_1:CTGAGCCTGGTAAAx 0.000000 9.307371 9.307371  0.00000  9.307371\n10X74_4_A_1:CCTAGAGAGTCACAx 0.000000 0.000000 0.000000  0.00000  9.585177\n10X74_4_A_1:CTAGGATGCTTGCCx 0.000000 8.995532 0.000000 10.09406 10.094061\n                                  Tpr     Smc3     Rplp1     Rpl22   Rpl36a\n10X74_4_A_1:GTAACGTGCCATAGx  9.435728 0.000000 10.128836  0.000000 10.53429\n10X73_3_A_1:ACGCCGGATCGTAGx  0.000000 0.000000 10.616651  0.000000  0.00000\n10X74_4_A_1:GATTCGGAGGTGAGx 10.230871 0.000000 10.518544  9.132330  0.00000\n10X74_4_A_1:CTGAGCCTGGTAAAx  0.000000 0.000000  9.307371 10.000473 11.09906\n10X74_4_A_1:CCTAGAGAGTCACAx  9.585177 0.000000 10.683744  0.000000 10.68374\n10X74_4_A_1:CTAGGATGCTTGCCx  0.000000 8.995532 10.094061  9.688617 10.09406\n                                Rps21    Eif4a1      Erh      Mdk     Pde4d\n10X74_4_A_1:GTAACGTGCCATAGx  9.435728  9.435728 0.000000  0.00000  9.435728\n10X73_3_A_1:ACGCCGGATCGTAGx  0.000000 10.211198 0.000000 10.61665 10.616651\n10X74_4_A_1:GATTCGGAGGTGAGx 10.741682  9.825424 0.000000 11.07815  0.000000\n10X74_4_A_1:CTGAGCCTGGTAAAx  9.307371 10.916737 0.000000 11.79219  0.000000\n10X74_4_A_1:CCTAGAGAGTCACAx  9.585177 10.278290 0.000000 11.19456  9.585177\n10X74_4_A_1:CTAGGATGCTTGCCx 10.381733  9.688617 9.688617 10.94134 10.941336\n                              Pgrmc1    Ube2r2     Bri3     Rps28     Mbtd1\n10X74_4_A_1:GTAACGTGCCATAGx 0.000000  0.000000 0.000000  9.435728  0.000000\n10X73_3_A_1:ACGCCGGATCGTAGx 0.000000  9.518087 0.000000  9.518087 10.616651\n10X74_4_A_1:GATTCGGAGGTGAGx 9.132330  0.000000 9.132330  9.132330  0.000000\n10X74_4_A_1:CTGAGCCTGGTAAAx 9.307371 10.000473 9.307371 10.000473  9.307371\n10X74_4_A_1:CCTAGAGAGTCACAx 9.585177  0.000000 9.585177  0.000000 10.683744\n10X74_4_A_1:CTAGGATGCTTGCCx 0.000000  0.000000 9.688617  8.995532  9.688617\n                               Rpl15     Macf1   Phf21a     Oaz2      Gnb1\n10X74_4_A_1:GTAACGTGCCATAGx 10.53429  9.435728 0.000000 10.12884  0.000000\n10X73_3_A_1:ACGCCGGATCGTAGx  0.00000  9.518087 0.000000  0.00000 10.211198\n10X74_4_A_1:GATTCGGAGGTGAGx 10.51854  0.000000 9.825424  9.13233  0.000000\n10X74_4_A_1:CTGAGCCTGGTAAAx 10.40592  9.307371 0.000000  0.00000  9.307371\n10X74_4_A_1:CCTAGAGAGTCACAx 10.68374  0.000000 0.000000  0.00000  9.585177\n10X74_4_A_1:CTAGGATGCTTGCCx 10.60487 10.381733 8.995532  0.00000  0.000000\n                               Zfp422    Rpl35a     Cox8a   Nt5dc2\n10X74_4_A_1:GTAACGTGCCATAGx 10.128836 10.821963 10.128836  0.00000\n10X73_3_A_1:ACGCCGGATCGTAGx  0.000000  9.518087 10.211198  0.00000\n10X74_4_A_1:GATTCGGAGGTGAGx  9.132330 10.518544  9.132330 10.92400\n10X74_4_A_1:CTGAGCCTGGTAAAx  0.000000 10.000473  9.307371 10.00047\n10X74_4_A_1:CCTAGAGAGTCACAx  0.000000  0.000000  0.000000  0.00000\n10X74_4_A_1:CTAGGATGCTTGCCx  8.995532  9.688617  8.995532 10.09406\n                            X4930402H24Rik     Ttc28      Ckb   Sh3bgrl\n10X74_4_A_1:GTAACGTGCCATAGx      10.821963 10.128836 9.435728  0.000000\n10X73_3_A_1:ACGCCGGATCGTAGx       9.518087 10.616651 0.000000  9.518087\n10X74_4_A_1:GATTCGGAGGTGAGx       0.000000 10.741682 9.132330  0.000000\n10X74_4_A_1:CTGAGCCTGGTAAAx      10.000473 11.253204 0.000000  0.000000\n10X74_4_A_1:CCTAGAGAGTCACAx       0.000000 10.278290 0.000000 10.278290\n10X74_4_A_1:CTAGGATGCTTGCCx       0.000000  9.688617 8.995532  9.688617\n                               Top2b  Ndufa10 C530008M17Rik     Basp1  Gpatch8\n10X74_4_A_1:GTAACGTGCCATAGx 9.435728  0.00000      0.000000 10.534287 9.435728\n10X73_3_A_1:ACGCCGGATCGTAGx 0.000000  0.00000      0.000000 10.616651 9.518087\n10X74_4_A_1:GATTCGGAGGTGAGx 0.000000 10.23087      0.000000 10.518544 9.132330\n10X74_4_A_1:CTGAGCCTGGTAAAx 0.000000 10.00047      0.000000  9.307371 9.307371\n10X74_4_A_1:CCTAGAGAGTCACAx 0.000000  0.00000      9.585177  0.000000 0.000000\n10X74_4_A_1:CTAGGATGCTTGCCx 8.995532  0.00000     10.094061  9.688617 8.995532\n                                Map1b  Ccdc88a     Xist    Ctnna2     Rnf7\n10X74_4_A_1:GTAACGTGCCATAGx 10.534287 0.000000  0.00000 10.534287 9.435728\n10X73_3_A_1:ACGCCGGATCGTAGx  9.518087 9.518087 10.61665 11.463934 0.000000\n10X74_4_A_1:GATTCGGAGGTGAGx  0.000000 0.000000  0.00000  9.825424 0.000000\n10X74_4_A_1:CTGAGCCTGGTAAAx 10.000473 0.000000 10.69360 10.000473 9.307371\n10X74_4_A_1:CCTAGAGAGTCACAx  9.585177 0.000000 11.78234  0.000000 0.000000\n10X74_4_A_1:CTAGGATGCTTGCCx  0.000000 8.995532 10.38173  9.688617 9.688617\n                                Fabp5    Usmg5     Phip     Rbmx    Zbtb20\n10X74_4_A_1:GTAACGTGCCATAGx  0.000000 9.435728 9.435728 10.12884  9.435728\n10X73_3_A_1:ACGCCGGATCGTAGx  9.518087 0.000000 0.000000  0.00000 10.211198\n10X74_4_A_1:GATTCGGAGGTGAGx  9.825424 0.000000 9.132330  9.13233 10.518544\n10X74_4_A_1:CTGAGCCTGGTAAAx 10.000473 9.307371 0.000000  0.00000  9.307371\n10X74_4_A_1:CCTAGAGAGTCACAx  0.000000 0.000000 0.000000  0.00000 10.278290\n10X74_4_A_1:CTAGGATGCTTGCCx 10.381733 8.995532 0.000000  0.00000  8.995532\n                                Eif1b      Lcor      Nsg1      Evl      Meg3\n10X74_4_A_1:GTAACGTGCCATAGx  9.435728  0.000000  9.435728 9.435728  0.000000\n10X73_3_A_1:ACGCCGGATCGTAGx 10.616651  9.518087  9.518087 9.518087  0.000000\n10X74_4_A_1:GATTCGGAGGTGAGx  9.132330  9.825424  9.825424 0.000000  0.000000\n10X74_4_A_1:CTGAGCCTGGTAAAx 10.693598 10.000473 10.693598 0.000000 10.000473\n10X74_4_A_1:CCTAGAGAGTCACAx  9.585177  0.000000 10.683744 0.000000  9.585177\n10X74_4_A_1:CTAGGATGCTTGCCx 10.094061  0.000000  9.688617 8.995532  8.995532\n                               Eif4a2     Rab10    Mllt11 COTAN_Cl.code\n10X74_4_A_1:GTAACGTGCCATAGx 10.821963  0.000000 10.128836             0\n10X73_3_A_1:ACGCCGGATCGTAGx  0.000000  9.518087  0.000000             0\n10X74_4_A_1:GATTCGGAGGTGAGx  0.000000 10.230871  9.132330             0\n10X74_4_A_1:CTGAGCCTGGTAAAx  0.000000  0.000000 10.405923             0\n10X74_4_A_1:CCTAGAGAGTCACAx  9.585177  0.000000  9.585177             0\n10X74_4_A_1:CTAGGATGCTTGCCx  0.000000  0.000000 10.381733             0\n\n\n\n# Fit the model\nmodel &lt;- glm( COTAN_Cl.code ~., data = train.data, family = binomial,control = list(maxit = 50))\n# Summarize the model\nsummary(model)\n\n\nCall:\nglm(formula = COTAN_Cl.code ~ ., family = binomial, data = train.data, \n    control = list(maxit = 50))\n\nCoefficients:\n                 Estimate Std. Error    z value Pr(&gt;|z|)    \n(Intercept)    -1.392e+15  5.418e+07  -25692175   &lt;2e-16 ***\nAbracl         -3.668e+13  1.108e+06  -33117531   &lt;2e-16 ***\nCdkn1c          9.057e+13  8.449e+05  107200885   &lt;2e-16 ***\nCited2         -1.192e+14  1.158e+06 -102925237   &lt;2e-16 ***\nMllt3          -1.411e+12  9.271e+05   -1522016   &lt;2e-16 ***\nFam210b        -4.090e+12  7.886e+05   -5185950   &lt;2e-16 ***\nMfap4          -6.719e+12  1.105e+06   -6082731   &lt;2e-16 ***\nCxcl12          3.911e+13  8.228e+05   47537816   &lt;2e-16 ***\nCdc42ep3        1.404e+13  8.102e+05   17326401   &lt;2e-16 ***\nLimch1          4.103e+13  7.629e+05   53781940   &lt;2e-16 ***\nIer2           -1.632e+13  8.096e+05  -20155968   &lt;2e-16 ***\nPtprk          -3.990e+13  7.877e+05  -50648051   &lt;2e-16 ***\nGm29260        -1.591e+14  8.513e+05 -186868495   &lt;2e-16 ***\nSfrp1          -1.001e+13  7.665e+05  -13056648   &lt;2e-16 ***\nPantr1         -4.908e+13  1.184e+06  -41449633   &lt;2e-16 ***\nMagi2           2.042e+13  7.718e+05   26452066   &lt;2e-16 ***\nTmem108         3.884e+13  8.406e+05   46203169   &lt;2e-16 ***\nDdr1           -6.061e+13  7.777e+05  -77935451   &lt;2e-16 ***\nEzr            -1.538e+12  8.165e+05   -1883070   &lt;2e-16 ***\nSncaip         -6.607e+13  7.615e+05  -86758312   &lt;2e-16 ***\nCT025619.1      5.786e+13  7.693e+05   75220795   &lt;2e-16 ***\nFabp7          -1.160e+13  7.987e+05  -14523404   &lt;2e-16 ***\nCtnnd2          5.243e+13  7.989e+05   65626431   &lt;2e-16 ***\nPtn            -5.180e+13  8.866e+05  -58423528   &lt;2e-16 ***\nFrmd4a         -9.865e+12  8.139e+05  -12119603   &lt;2e-16 ***\nSorbs2          7.082e+13  1.040e+06   68115662   &lt;2e-16 ***\nHes6            5.248e+13  8.207e+05   63952536   &lt;2e-16 ***\nDcc            -1.086e+14  1.091e+06  -99558297   &lt;2e-16 ***\nNeurog2         8.885e+12  8.991e+05    9882478   &lt;2e-16 ***\nTcf12           4.439e+13  7.580e+05   58560212   &lt;2e-16 ***\nFam110a        -3.762e+12  7.726e+05   -4870098   &lt;2e-16 ***\nDhrs4          -6.585e+13  8.280e+05  -79533727   &lt;2e-16 ***\nCcnd2           2.088e+13  8.477e+05   24635620   &lt;2e-16 ***\nElavl4          5.882e+13  1.040e+06   56574947   &lt;2e-16 ***\nAnk3            1.621e+12  8.158e+05    1986603   &lt;2e-16 ***\nKlf12           1.858e+13  8.113e+05   22905550   &lt;2e-16 ***\nSlc17a6         3.336e+13  7.777e+05   42892923   &lt;2e-16 ***\nLzts1          -3.340e+11  7.629e+05    -437779   &lt;2e-16 ***\nMap2            1.529e+13  1.049e+06   14565916   &lt;2e-16 ***\nLhx2            6.076e+13  1.073e+06   56647519   &lt;2e-16 ***\nNeurod2         1.156e+14  1.308e+06   88402243   &lt;2e-16 ***\nSstr2           2.958e+13  1.123e+06   26328080   &lt;2e-16 ***\nEomes           2.323e+13  8.998e+05   25818313   &lt;2e-16 ***\nVps37b          2.378e+13  7.719e+05   30806540   &lt;2e-16 ***\nIer5           -6.635e+13  7.933e+05  -83638912   &lt;2e-16 ***\nCttnbp2         7.413e+12  1.026e+06    7226886   &lt;2e-16 ***\nTmem178         5.869e+13  7.711e+05   76112402   &lt;2e-16 ***\nPlxna4          6.142e+12  8.247e+05    7447401   &lt;2e-16 ***\nAff3            3.216e+13  8.494e+05   37865603   &lt;2e-16 ***\nTiam2           3.504e+13  8.431e+05   41564359   &lt;2e-16 ***\nPpp2r2b         1.014e+12  1.343e+06     755110   &lt;2e-16 ***\nZeb2           -8.426e+13  8.214e+05 -102580264   &lt;2e-16 ***\nGria2           3.458e+13  8.115e+05   42614466   &lt;2e-16 ***\nNbea           -2.142e+13  7.864e+05  -27232237   &lt;2e-16 ***\nPtprd          -8.085e+12  8.432e+05   -9588010   &lt;2e-16 ***\nSox5            1.043e+13  9.521e+05   10952629   &lt;2e-16 ***\nMpped2          1.653e+13  9.316e+05   17741622   &lt;2e-16 ***\nBcl11b         -5.000e+13  8.186e+05  -61072633   &lt;2e-16 ***\nEpha5           7.168e+13  1.438e+06   49838920   &lt;2e-16 ***\nNol4            5.393e+13  8.773e+05   61475929   &lt;2e-16 ***\nGrik2          -8.502e+12  7.828e+05  -10860942   &lt;2e-16 ***\nMir124.2hg      3.667e+12  8.306e+05    4415594   &lt;2e-16 ***\nPcp4           -9.935e+12  7.703e+05  -12897946   &lt;2e-16 ***\nCcser1          6.731e+13  1.011e+06   66545181   &lt;2e-16 ***\nKcnb2          -3.395e+13  7.809e+05  -43477366   &lt;2e-16 ***\nDscaml1        -3.299e+13  8.061e+05  -40923228   &lt;2e-16 ***\nKcnh7          -3.625e+13  8.216e+05  -44124624   &lt;2e-16 ***\nPam            -2.266e+13  9.566e+05  -23682478   &lt;2e-16 ***\nNegr1          -5.486e+13  8.125e+05  -67527681   &lt;2e-16 ***\nPpm1e          -1.101e+13  7.777e+05  -14161188   &lt;2e-16 ***\nMyt1l           1.275e+13  9.473e+05   13455861   &lt;2e-16 ***\nFoxp2          -4.217e+12  7.833e+05   -5382953   &lt;2e-16 ***\nGpc6           -7.684e+12  7.945e+05   -9671234   &lt;2e-16 ***\nMasp1           4.292e+13  7.665e+05   55993994   &lt;2e-16 ***\nSerpini1       -5.105e+12  8.061e+05   -6333133   &lt;2e-16 ***\nPcdh7           5.837e+13  8.073e+05   72299867   &lt;2e-16 ***\nRbfox1          7.461e+12  8.031e+05    9289560   &lt;2e-16 ***\nRobo2          -6.876e+13  1.420e+06  -48418494   &lt;2e-16 ***\nFhod3           4.399e+13  7.980e+05   55121613   &lt;2e-16 ***\nRprm            3.484e+13  7.835e+05   44465376   &lt;2e-16 ***\nGng3            2.281e+13  7.680e+05   29706841   &lt;2e-16 ***\nUchl1          -1.332e+13  7.594e+05  -17544470   &lt;2e-16 ***\nTmem176b        8.467e+12  8.030e+05   10544314   &lt;2e-16 ***\nNrn1           -5.681e+13  9.557e+05  -59447760   &lt;2e-16 ***\nSnap25         -4.422e+13  7.898e+05  -55987310   &lt;2e-16 ***\nNrg1           -3.190e+13  1.511e+06  -21119116   &lt;2e-16 ***\nCdh8           -9.450e+13  9.459e+05  -99906199   &lt;2e-16 ***\nTrim17         -5.827e+13  7.920e+05  -73573697   &lt;2e-16 ***\nChga            1.515e+13  7.864e+05   19260283   &lt;2e-16 ***\nRpl26          -1.381e+14  1.158e+06 -119242819   &lt;2e-16 ***\nRack1          -3.030e+13  1.065e+06  -28463399   &lt;2e-16 ***\nHsp90b1         1.513e+12  7.764e+05    1949079   &lt;2e-16 ***\nAldoa           5.999e+13  7.895e+05   75985414   &lt;2e-16 ***\nTuba1b         -2.984e+13  7.673e+05  -38893858   &lt;2e-16 ***\nSf3b6          -1.751e+13  7.754e+05  -22583944   &lt;2e-16 ***\nTop1           -4.635e+13  1.256e+06  -36914861   &lt;2e-16 ***\nTpr             2.535e+13  8.111e+05   31258405   &lt;2e-16 ***\nSmc3            1.778e+13  7.864e+05   22614692   &lt;2e-16 ***\nRplp1           6.245e+13  1.506e+06   41453287   &lt;2e-16 ***\nRpl22           5.820e+13  9.818e+05   59284313   &lt;2e-16 ***\nRpl36a          7.624e+13  1.286e+06   59290521   &lt;2e-16 ***\nRps21          -1.722e+13  9.803e+05  -17562653   &lt;2e-16 ***\nEif4a1          3.635e+13  1.107e+06   32824725   &lt;2e-16 ***\nErh             3.879e+13  8.249e+05   47018259   &lt;2e-16 ***\nMdk             6.137e+13  1.311e+06   46812498   &lt;2e-16 ***\nPde4d           9.697e+13  8.054e+05  120403478   &lt;2e-16 ***\nPgrmc1          4.160e+13  7.890e+05   52731940   &lt;2e-16 ***\nUbe2r2         -4.281e+12  7.630e+05   -5610419   &lt;2e-16 ***\nBri3           -4.674e+12  7.624e+05   -6130738   &lt;2e-16 ***\nRps28           2.337e+13  1.081e+06   21624714   &lt;2e-16 ***\nMbtd1          -3.431e+13  8.020e+05  -42787850   &lt;2e-16 ***\nRpl15           4.540e+13  1.056e+06   42976360   &lt;2e-16 ***\nMacf1          -3.898e+13  7.456e+05  -52271693   &lt;2e-16 ***\nPhf21a         -1.085e+13  7.941e+05  -13663454   &lt;2e-16 ***\nOaz2           -2.184e+13  7.671e+05  -28476312   &lt;2e-16 ***\nGnb1            3.086e+13  7.786e+05   39638926   &lt;2e-16 ***\nZfp422         -2.665e+13  7.937e+05  -33579867   &lt;2e-16 ***\nRpl35a         -4.777e+13  1.012e+06  -47191386   &lt;2e-16 ***\nCox8a           3.798e+12  9.384e+05    4047518   &lt;2e-16 ***\nNt5dc2         -2.355e+13  7.820e+05  -30114999   &lt;2e-16 ***\nX4930402H24Rik -3.421e+13  8.011e+05  -42703505   &lt;2e-16 ***\nTtc28          -2.613e+13  9.395e+05  -27807041   &lt;2e-16 ***\nCkb            -4.380e+13  8.412e+05  -52071863   &lt;2e-16 ***\nSh3bgrl        -1.422e+13  7.831e+05  -18158721   &lt;2e-16 ***\nTop2b           4.336e+13  7.850e+05   55234013   &lt;2e-16 ***\nNdufa10        -8.308e+13  7.998e+05 -103871878   &lt;2e-16 ***\nC530008M17Rik  -4.875e+13  8.134e+05  -59928713   &lt;2e-16 ***\nBasp1           1.084e+14  1.002e+06  108114394   &lt;2e-16 ***\nGpatch8         4.789e+12  7.653e+05    6257168   &lt;2e-16 ***\nMap1b          -3.338e+13  9.207e+05  -36254006   &lt;2e-16 ***\nCcdc88a         9.193e+12  7.736e+05   11882326   &lt;2e-16 ***\nXist           -2.576e+13  7.861e+05  -32765738   &lt;2e-16 ***\nCtnna2         -4.233e+13  9.718e+05  -43552178   &lt;2e-16 ***\nRnf7           -5.865e+11  8.067e+05    -727059   &lt;2e-16 ***\nFabp5           6.801e+13  9.924e+05   68526316   &lt;2e-16 ***\nUsmg5           3.478e+13  7.931e+05   43858152   &lt;2e-16 ***\nPhip            3.203e+13  7.823e+05   40942232   &lt;2e-16 ***\nRbmx            5.754e+12  7.791e+05    7384674   &lt;2e-16 ***\nZbtb20         -4.798e+13  1.022e+06  -46936751   &lt;2e-16 ***\nEif1b          -7.349e+13  1.019e+06  -72109569   &lt;2e-16 ***\nLcor            1.574e+13  7.874e+05   19989987   &lt;2e-16 ***\nNsg1           -8.545e+12  9.945e+05   -8592451   &lt;2e-16 ***\nEvl            -1.350e+13  7.905e+05  -17079400   &lt;2e-16 ***\nMeg3            4.731e+13  8.077e+05   58571895   &lt;2e-16 ***\nEif4a2         -3.366e+13  7.879e+05  -42721584   &lt;2e-16 ***\nRab10          -3.012e+13  7.727e+05  -38981490   &lt;2e-16 ***\nMllt11          9.241e+13  1.233e+06   74972937   &lt;2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance:  653.13  on 472  degrees of freedom\nResidual deviance: 4685.67  on 326  degrees of freedom\nAIC: 4979.7\n\nNumber of Fisher Scoring iterations: 32\n\n# Make predictions\nprobabilities &lt;- model %&gt;% predict(test.data, type = \"response\")\npredicted.classes &lt;- ifelse(probabilities &gt; 0.5, \"1\", \"0\")\n# Model accuracy\nmean(predicted.classes == test.data$COTAN_Cl.code)\n\n[1] 0.6949153",
    "crumbs": [
      "Cluster evaluation",
      "Real UT clusters with LR"
    ]
  },
  {
    "objectID": "Real_UT_clustersByCotan.html#e13.5-e14.5",
    "href": "Real_UT_clustersByCotan.html#e13.5-e14.5",
    "title": "Real UT clusters",
    "section": "434 e13.5 e14.5",
    "text": "434 e13.5 e14.5\n\n\nSys.time()\n\n[1] \"2025-12-16 18:58:42 CET\"\n\n\n\nsessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 22.04.5 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] nnet_7.3-20        COTAN_2.9.4        caret_7.0-1        lattice_0.22-7    \n [5] lubridate_1.9.4    forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4       \n [9] purrr_1.2.0        readr_2.1.5        tibble_3.3.0       tidyverse_2.0.0   \n[13] tidyr_1.3.1        parallelDist_0.2.6 data.table_1.17.0  zeallot_0.2.0     \n[17] ggplot2_4.0.1     \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.22            splines_4.5.2              \n  [3] later_1.4.2                 polyclip_1.10-7            \n  [5] hardhat_1.4.1               pROC_1.18.5                \n  [7] rpart_4.1.24                fastDummies_1.7.5          \n  [9] lifecycle_1.0.4             doParallel_1.0.17          \n [11] processx_3.8.6              globals_0.18.0             \n [13] MASS_7.3-65                 dendextend_1.19.0          \n [15] magrittr_2.0.4              plotly_4.11.0              \n [17] rmarkdown_2.29              yaml_2.3.10                \n [19] httpuv_1.6.16               Seurat_5.2.1               \n [21] sctransform_0.4.2           spam_2.11-1                \n [23] sp_2.2-0                    spatstat.sparse_3.1-0      \n [25] reticulate_1.42.0           cowplot_1.1.3              \n [27] pbapply_1.7-2               RColorBrewer_1.1-3         \n [29] abind_1.4-8                 GenomicRanges_1.60.0       \n [31] Rtsne_0.17                  BiocGenerics_0.54.0        \n [33] coro_1.1.0                  torch_0.14.2               \n [35] ipred_0.9-15                GenomeInfoDbData_1.2.14    \n [37] circlize_0.4.16             lava_1.8.1                 \n [39] IRanges_2.42.0              S4Vectors_0.46.0           \n [41] ggrepel_0.9.6               irlba_2.3.5.1              \n [43] listenv_0.9.1               spatstat.utils_3.1-4       \n [45] goftest_1.2-3               RSpectra_0.16-2            \n [47] spatstat.random_3.4-1       fitdistrplus_1.2-2         \n [49] parallelly_1.45.0           codetools_0.2-20           \n [51] DelayedArray_0.34.1         tidyselect_1.2.1           \n [53] shape_1.4.6.1               UCSC.utils_1.4.0           \n [55] farver_2.1.2                viridis_0.6.5              \n [57] ScaledMatrix_1.16.0         matrixStats_1.5.0          \n [59] stats4_4.5.2                spatstat.explore_3.4-2     \n [61] jsonlite_2.0.0              GetoptLong_1.0.5           \n [63] gghalves_0.1.4              progressr_0.15.1           \n [65] ggridges_0.5.6              survival_3.8-3             \n [67] iterators_1.0.14            foreach_1.5.2              \n [69] tools_4.5.2                 ica_1.0-3                  \n [71] Rcpp_1.0.14                 glue_1.8.0                 \n [73] prodlim_2025.04.28          gridExtra_2.3              \n [75] SparseArray_1.8.0           xfun_0.52                  \n [77] MatrixGenerics_1.20.0       ggthemes_5.1.0             \n [79] GenomeInfoDb_1.44.0         withr_3.0.2                \n [81] fastmap_1.2.0               callr_3.7.6                \n [83] digest_0.6.37               rsvd_1.0.5                 \n [85] timechange_0.3.0            R6_2.6.1                   \n [87] mime_0.13                   colorspace_2.1-1           \n [89] scattermore_1.2             tensor_1.5                 \n [91] spatstat.data_3.1-6         generics_0.1.3             \n [93] recipes_1.3.0               class_7.3-23               \n [95] httr_1.4.7                  htmlwidgets_1.6.4          \n [97] S4Arrays_1.8.0              uwot_0.2.3                 \n [99] ModelMetrics_1.2.2.2        pkgconfig_2.0.3            \n[101] gtable_0.3.6                timeDate_4041.110          \n[103] ComplexHeatmap_2.24.0       lmtest_0.9-40              \n[105] S7_0.2.1                    SingleCellExperiment_1.30.0\n[107] XVector_0.48.0              htmltools_0.5.8.1          \n[109] dotCall64_1.2               zigg_0.0.2                 \n[111] clue_0.3-66                 Biobase_2.68.0             \n[113] SeuratObject_5.1.0          scales_1.4.0               \n[115] png_0.1-8                   gower_1.0.2                \n[117] spatstat.univar_3.1-3       knitr_1.50                 \n[119] tzdb_0.5.0                  reshape2_1.4.4             \n[121] rjson_0.2.23                nlme_3.1-168               \n[123] proxy_0.4-27                zoo_1.8-14                 \n[125] GlobalOptions_0.1.2         KernSmooth_2.23-26         \n[127] parallel_4.5.2              miniUI_0.1.2               \n[129] pillar_1.10.2               grid_4.5.2                 \n[131] vctrs_0.6.5                 RANN_2.6.2                 \n[133] promises_1.3.2              BiocSingular_1.24.0        \n[135] beachmat_2.24.0             xtable_1.8-4               \n[137] cluster_2.1.8.1             evaluate_1.0.3             \n[139] cli_3.6.5                   compiler_4.5.2             \n[141] rlang_1.1.6                 crayon_1.5.3               \n[143] future.apply_1.20.0         labeling_0.4.3             \n[145] ps_1.9.1                    plyr_1.8.9                 \n[147] stringi_1.8.7               deldir_2.0-4               \n[149] viridisLite_0.4.2           BiocParallel_1.42.0        \n[151] assertthat_0.2.1            lazyeval_0.2.2             \n[153] spatstat.geom_3.4-1         Matrix_1.7-4               \n[155] RcppHNSW_0.6.0              hms_1.1.3                  \n[157] patchwork_1.3.2             bit64_4.6.0-1              \n[159] future_1.58.0               shiny_1.11.0               \n[161] SummarizedExperiment_1.38.1 ROCR_1.0-11                \n[163] Rfast_2.1.5.1               igraph_2.1.4               \n[165] RcppParallel_5.1.10         bit_4.6.0",
    "crumbs": [
      "Cluster evaluation",
      "Real UT clusters with LR"
    ]
  },
  {
    "objectID": "FDR_analisys.html",
    "href": "FDR_analisys.html",
    "title": "FDR analysis - define DE genes",
    "section": "",
    "text": "library(COTAN)\noptions(parallelly.fork.enable = TRUE)\nlibrary(Seurat)\nlibrary(monocle3)\nlibrary(reticulate)\nlibrary(stringr)\nlibrary(dplyr)\n\ndirOut &lt;- \"Results/FDR/\"\nif (!dir.exists(dirOut)) {\n  dir.create(dirOut)\n}\n\ndataSetDir &lt;- \"Data/MouseCortexFromLoom/FDR/MergedClusters_For_FDR/\"\n\n\nSeurat.DEA &lt;- function(dataSet,clusters.list, project, dirOut#,percentage\n                       ){\n  pbmc &lt;- CreateSeuratObject(counts = dataSet,\n                             project = project, min.cells = 3, min.features = 20)\n  \n  stopifnot(length(clusters.list)==length(pbmc$orig.ident))\n  \n  \n  pbmc &lt;- NormalizeData(pbmc, normalization.method = \"LogNormalize\", scale.factor = 10000)\n  pbmc &lt;- FindVariableFeatures(pbmc, selection.method = \"vst\", nfeatures = 2000)\n  all.genes &lt;- rownames(pbmc)\n  pbmc &lt;- ScaleData(pbmc, features = all.genes)\n  \n  pbmc &lt;- RunPCA(pbmc)\n  pbmc &lt;- RunUMAP(pbmc, dims = 1:20)\n  \n  pbmc@meta.data$TestCl &lt;- NA\n  pbmc@meta.data[names(clusters.list),]$TestCl &lt;- factor(clusters.list)\n  \n  pbmc &lt;- SetIdent(pbmc,value = \"TestCl\")\n  \n  pbmc.markers &lt;- FindAllMarkers(pbmc, only.pos = TRUE)\n  \n  \n  \n  n.genes.DEA &lt;- sum(pbmc.markers$p_val_adj &lt; 0.05)\n  \n  print(n.genes.DEA)\n  \n  #write.csv(pbmc.markers, file = paste0(dirOut,project,\"_de_genes_Seurat_\",percentage,\".csv\"))\n  \n  return(list(\"n.genes.DEA\"=n.genes.DEA,\"markers\"= pbmc.markers))\n}\n\n\nSeurat.DEA.bimod &lt;- function(dataSet,clusters.list, project, dirOut#,percentage\n                       ){\n  pbmc &lt;- CreateSeuratObject(counts = dataSet,\n                             project = project, min.cells = 3, min.features = 20)\n  \n  stopifnot(length(clusters.list)==length(pbmc$orig.ident))\n  \n  \n  pbmc &lt;- NormalizeData(pbmc, normalization.method = \"LogNormalize\", scale.factor = 10000)\n  pbmc &lt;- FindVariableFeatures(pbmc, selection.method = \"vst\", nfeatures = 2000)\n  all.genes &lt;- rownames(pbmc)\n  pbmc &lt;- ScaleData(pbmc, features = all.genes)\n  \n  pbmc &lt;- RunPCA(pbmc)\n  pbmc &lt;- RunUMAP(pbmc, dims = 1:20)\n  \n  pbmc@meta.data$TestCl &lt;- NA\n  pbmc@meta.data[names(clusters.list),]$TestCl &lt;- factor(clusters.list)\n  \n  pbmc &lt;- SetIdent(pbmc,value = \"TestCl\")\n  \n  pbmc.markers &lt;- FindAllMarkers(pbmc, only.pos = TRUE,test.use = \"bimod\" )\n  \n  \n  \n  n.genes.DEA &lt;- sum(pbmc.markers$p_val_adj &lt; 0.05)\n  \n  print(n.genes.DEA)\n  \n  #write.csv(pbmc.markers, file = paste0(dirOut,project,\"_de_genes_Seurat_\",percentage,\".csv\"))\n  \n  return(list(\"n.genes.DEA\"=n.genes.DEA,\"markers\"= pbmc.markers))\n}\n\nSeurat.DEAScTransform &lt;- function(dataSet,clusters.list, project, dirOut#,percentage\n                       ){\n  pbmc &lt;- CreateSeuratObject(counts = dataSet,\n                             project = project, min.cells = 3, min.features = 20)\n  \n  stopifnot(length(clusters.list)==length(pbmc$orig.ident))\n\n  # store mitochondrial percentage in object meta data\n  pbmc &lt;- PercentageFeatureSet(pbmc, pattern = \"^mt-\", col.name = \"percent.mt\")\n\n# run sctransform\n  pbmc &lt;- SCTransform(pbmc, vars.to.regress = \"percent.mt\", verbose = FALSE)\n\n  \n  pbmc &lt;- RunPCA(pbmc)\n  pbmc &lt;- RunUMAP(pbmc, dims = 1:20)\n  \n  pbmc@meta.data$TestCl &lt;- NA\n  pbmc@meta.data[names(clusters.list),]$TestCl &lt;- factor(clusters.list)\n  \n  pbmc &lt;- SetIdent(pbmc,value = \"TestCl\")\n  \n  pbmc.markers &lt;- FindAllMarkers(pbmc, only.pos = TRUE)\n  \n  \n  \n  n.genes.DEA &lt;- sum(pbmc.markers$p_val_adj &lt; 0.05)\n  \n  print(n.genes.DEA)\n  \n  #write.csv(pbmc.markers, file = paste0(dirOut,project,\"_de_genes_Seurat_\",percentage,\".csv\"))\n  \n  return(list(\"n.genes.DEA\"=n.genes.DEA,\"markers\"= pbmc.markers))\n}\n\n\n\n\nMonocle.DEA &lt;- function(dataSet,clusters.list,project, dirOut#,percentage\n                        ){\n  \n  cell_metadata = as.data.frame(clusters.list[colnames(dataSet)])\n  colnames(cell_metadata) &lt;- \"Clusters\"\n  cds &lt;- new_cell_data_set(dataSet[rowSums(dataSet) &gt; 3,],\n                         cell_metadata = cell_metadata\n                         )\n  colData(cds)$cluster &lt;- clusters.list[rownames(colData(cds))]\n\n  #cds &lt;- preprocess_cds(cds, num_dim = 100)\n  #cds &lt;- reduce_dimension(cds)\n  #cds &lt;- cluster_cells(cds, resolution=1e-5)\n  marker_test_res &lt;- top_markers(cds, \n                                 group_cells_by=\"Clusters\", \n                                 genes_to_test_per_group = dim(cds)[1],\n                                  cores=10)\n  \n  # de_results &lt;- fit_models(cds,model_formula_str = \" ~ cluster\",cores = 10,verbose = T)\n  # fit_coefs &lt;- coefficient_table(de_results)\n  # \n  # fit_coefs &lt;- fit_coefs %&gt;% filter(grepl(\"cluster\",term))\n  # fit_coefs &lt;- as.data.frame(fit_coefs)\n  #write.csv(as.data.frame(fit_coefs[,c(\"num_cells_expressed\" ,\"gene_id\",\"p_value\",\"q_value\")]), file = paste0(dirOut,project,\"_de_genes_Monocle_\",percentage,\".csv\"))\n  \n  return(list(\"n.genes.DEA\"=sum(marker_test_res$marker_test_q_value &lt; 0.05, na.rm = T),\n              \"marker_test_res\"= marker_test_res\n              ))\n}\n\n\nScamPy.DEA &lt;- function(dataSet,\n                       clusters.list, \n                       project, \n                       dirOut,\n                       percentage){\n  pbmc &lt;- CreateSeuratObject(counts = dataSet, project = project, min.cells = 3, min.features = 20)\n  \n  \n  pbmc@meta.data$TestCl &lt;- NA\n  pbmc@meta.data[names(clusters.list),]$TestCl &lt;- clusters.list\n  \n  exprs &lt;- pbmc@assays$RNA$counts\n  \n  meta &lt;- pbmc[[]]\n  #feature_meta &lt;- GetAssay(pbmc)[[]]\n  tmp &lt;- as.data.frame(matrix(data = NA, \n                              ncol = 1, \n                              nrow = nrow(pbmc@assays$RNA$counts)))\n  rownames(tmp) &lt;- rownames(pbmc@assays$RNA$counts)\n  \n  feature_meta &lt;- tmp\n  #embedding &lt;- Embeddings(pbmc, \"umap\")\n  \n  Sys.setenv(RETICULATE_PYTHON = \"../../../bin/python3\")\n  py &lt;- import(\"sys\")\n  \n  source_python(\"src/scanpyFDR.py\")\n  scanpyFDR(exprs, \n                   meta, \n                   feature_meta, \n                   \"mt\", \n                   dirOut, \n                   project)\n\n  out &lt;- read.csv(file = paste0(dirOut,\n                                project,\n                                \"_Scampy_DEA_all_genes.csv\"\n                               ),\n                  header = T,\n                  row.names = 1)\n\n  gc()\n\n  return(out)\n}",
    "crumbs": [
      "DEA evaluation",
      "FDR analysis - define DE genes"
    ]
  },
  {
    "objectID": "FDR_analisys.html#automatic-functions",
    "href": "FDR_analisys.html#automatic-functions",
    "title": "FDR analysis - define DE genes",
    "section": "",
    "text": "library(COTAN)\noptions(parallelly.fork.enable = TRUE)\nlibrary(Seurat)\nlibrary(monocle3)\nlibrary(reticulate)\nlibrary(stringr)\nlibrary(dplyr)\n\ndirOut &lt;- \"Results/FDR/\"\nif (!dir.exists(dirOut)) {\n  dir.create(dirOut)\n}\n\ndataSetDir &lt;- \"Data/MouseCortexFromLoom/FDR/MergedClusters_For_FDR/\"\n\n\nSeurat.DEA &lt;- function(dataSet,clusters.list, project, dirOut#,percentage\n                       ){\n  pbmc &lt;- CreateSeuratObject(counts = dataSet,\n                             project = project, min.cells = 3, min.features = 20)\n  \n  stopifnot(length(clusters.list)==length(pbmc$orig.ident))\n  \n  \n  pbmc &lt;- NormalizeData(pbmc, normalization.method = \"LogNormalize\", scale.factor = 10000)\n  pbmc &lt;- FindVariableFeatures(pbmc, selection.method = \"vst\", nfeatures = 2000)\n  all.genes &lt;- rownames(pbmc)\n  pbmc &lt;- ScaleData(pbmc, features = all.genes)\n  \n  pbmc &lt;- RunPCA(pbmc)\n  pbmc &lt;- RunUMAP(pbmc, dims = 1:20)\n  \n  pbmc@meta.data$TestCl &lt;- NA\n  pbmc@meta.data[names(clusters.list),]$TestCl &lt;- factor(clusters.list)\n  \n  pbmc &lt;- SetIdent(pbmc,value = \"TestCl\")\n  \n  pbmc.markers &lt;- FindAllMarkers(pbmc, only.pos = TRUE)\n  \n  \n  \n  n.genes.DEA &lt;- sum(pbmc.markers$p_val_adj &lt; 0.05)\n  \n  print(n.genes.DEA)\n  \n  #write.csv(pbmc.markers, file = paste0(dirOut,project,\"_de_genes_Seurat_\",percentage,\".csv\"))\n  \n  return(list(\"n.genes.DEA\"=n.genes.DEA,\"markers\"= pbmc.markers))\n}\n\n\nSeurat.DEA.bimod &lt;- function(dataSet,clusters.list, project, dirOut#,percentage\n                       ){\n  pbmc &lt;- CreateSeuratObject(counts = dataSet,\n                             project = project, min.cells = 3, min.features = 20)\n  \n  stopifnot(length(clusters.list)==length(pbmc$orig.ident))\n  \n  \n  pbmc &lt;- NormalizeData(pbmc, normalization.method = \"LogNormalize\", scale.factor = 10000)\n  pbmc &lt;- FindVariableFeatures(pbmc, selection.method = \"vst\", nfeatures = 2000)\n  all.genes &lt;- rownames(pbmc)\n  pbmc &lt;- ScaleData(pbmc, features = all.genes)\n  \n  pbmc &lt;- RunPCA(pbmc)\n  pbmc &lt;- RunUMAP(pbmc, dims = 1:20)\n  \n  pbmc@meta.data$TestCl &lt;- NA\n  pbmc@meta.data[names(clusters.list),]$TestCl &lt;- factor(clusters.list)\n  \n  pbmc &lt;- SetIdent(pbmc,value = \"TestCl\")\n  \n  pbmc.markers &lt;- FindAllMarkers(pbmc, only.pos = TRUE,test.use = \"bimod\" )\n  \n  \n  \n  n.genes.DEA &lt;- sum(pbmc.markers$p_val_adj &lt; 0.05)\n  \n  print(n.genes.DEA)\n  \n  #write.csv(pbmc.markers, file = paste0(dirOut,project,\"_de_genes_Seurat_\",percentage,\".csv\"))\n  \n  return(list(\"n.genes.DEA\"=n.genes.DEA,\"markers\"= pbmc.markers))\n}\n\nSeurat.DEAScTransform &lt;- function(dataSet,clusters.list, project, dirOut#,percentage\n                       ){\n  pbmc &lt;- CreateSeuratObject(counts = dataSet,\n                             project = project, min.cells = 3, min.features = 20)\n  \n  stopifnot(length(clusters.list)==length(pbmc$orig.ident))\n\n  # store mitochondrial percentage in object meta data\n  pbmc &lt;- PercentageFeatureSet(pbmc, pattern = \"^mt-\", col.name = \"percent.mt\")\n\n# run sctransform\n  pbmc &lt;- SCTransform(pbmc, vars.to.regress = \"percent.mt\", verbose = FALSE)\n\n  \n  pbmc &lt;- RunPCA(pbmc)\n  pbmc &lt;- RunUMAP(pbmc, dims = 1:20)\n  \n  pbmc@meta.data$TestCl &lt;- NA\n  pbmc@meta.data[names(clusters.list),]$TestCl &lt;- factor(clusters.list)\n  \n  pbmc &lt;- SetIdent(pbmc,value = \"TestCl\")\n  \n  pbmc.markers &lt;- FindAllMarkers(pbmc, only.pos = TRUE)\n  \n  \n  \n  n.genes.DEA &lt;- sum(pbmc.markers$p_val_adj &lt; 0.05)\n  \n  print(n.genes.DEA)\n  \n  #write.csv(pbmc.markers, file = paste0(dirOut,project,\"_de_genes_Seurat_\",percentage,\".csv\"))\n  \n  return(list(\"n.genes.DEA\"=n.genes.DEA,\"markers\"= pbmc.markers))\n}\n\n\n\n\nMonocle.DEA &lt;- function(dataSet,clusters.list,project, dirOut#,percentage\n                        ){\n  \n  cell_metadata = as.data.frame(clusters.list[colnames(dataSet)])\n  colnames(cell_metadata) &lt;- \"Clusters\"\n  cds &lt;- new_cell_data_set(dataSet[rowSums(dataSet) &gt; 3,],\n                         cell_metadata = cell_metadata\n                         )\n  colData(cds)$cluster &lt;- clusters.list[rownames(colData(cds))]\n\n  #cds &lt;- preprocess_cds(cds, num_dim = 100)\n  #cds &lt;- reduce_dimension(cds)\n  #cds &lt;- cluster_cells(cds, resolution=1e-5)\n  marker_test_res &lt;- top_markers(cds, \n                                 group_cells_by=\"Clusters\", \n                                 genes_to_test_per_group = dim(cds)[1],\n                                  cores=10)\n  \n  # de_results &lt;- fit_models(cds,model_formula_str = \" ~ cluster\",cores = 10,verbose = T)\n  # fit_coefs &lt;- coefficient_table(de_results)\n  # \n  # fit_coefs &lt;- fit_coefs %&gt;% filter(grepl(\"cluster\",term))\n  # fit_coefs &lt;- as.data.frame(fit_coefs)\n  #write.csv(as.data.frame(fit_coefs[,c(\"num_cells_expressed\" ,\"gene_id\",\"p_value\",\"q_value\")]), file = paste0(dirOut,project,\"_de_genes_Monocle_\",percentage,\".csv\"))\n  \n  return(list(\"n.genes.DEA\"=sum(marker_test_res$marker_test_q_value &lt; 0.05, na.rm = T),\n              \"marker_test_res\"= marker_test_res\n              ))\n}\n\n\nScamPy.DEA &lt;- function(dataSet,\n                       clusters.list, \n                       project, \n                       dirOut,\n                       percentage){\n  pbmc &lt;- CreateSeuratObject(counts = dataSet, project = project, min.cells = 3, min.features = 20)\n  \n  \n  pbmc@meta.data$TestCl &lt;- NA\n  pbmc@meta.data[names(clusters.list),]$TestCl &lt;- clusters.list\n  \n  exprs &lt;- pbmc@assays$RNA$counts\n  \n  meta &lt;- pbmc[[]]\n  #feature_meta &lt;- GetAssay(pbmc)[[]]\n  tmp &lt;- as.data.frame(matrix(data = NA, \n                              ncol = 1, \n                              nrow = nrow(pbmc@assays$RNA$counts)))\n  rownames(tmp) &lt;- rownames(pbmc@assays$RNA$counts)\n  \n  feature_meta &lt;- tmp\n  #embedding &lt;- Embeddings(pbmc, \"umap\")\n  \n  Sys.setenv(RETICULATE_PYTHON = \"../../../bin/python3\")\n  py &lt;- import(\"sys\")\n  \n  source_python(\"src/scanpyFDR.py\")\n  scanpyFDR(exprs, \n                   meta, \n                   feature_meta, \n                   \"mt\", \n                   dirOut, \n                   project)\n\n  out &lt;- read.csv(file = paste0(dirOut,\n                                project,\n                                \"_Scampy_DEA_all_genes.csv\"\n                               ),\n                  header = T,\n                  row.names = 1)\n\n  gc()\n\n  return(out)\n}",
    "crumbs": [
      "DEA evaluation",
      "FDR analysis - define DE genes"
    ]
  },
  {
    "objectID": "FDR_analisys.html#cluster-gene-enrichment",
    "href": "FDR_analisys.html#cluster-gene-enrichment",
    "title": "FDR analysis - define DE genes",
    "section": "Cluster Gene Enrichment",
    "text": "Cluster Gene Enrichment\n\ndatasets_csv &lt;- read.csv(file.path(dataSetDir,\"Cells_Usage_DataFrame.csv\"),\n                         row.names = 1\n                        ) \n\ndatasets_csv\n\n                      Group\n1      2_Clusters_even_near\n2      2_Clusters_even_near\n3      2_Clusters_even_near\n4    2_Clusters_even_medium\n5    2_Clusters_even_medium\n6    2_Clusters_even_medium\n7       2_Clusters_even_far\n8       2_Clusters_even_far\n9       2_Clusters_even_far\n10   2_Clusters_uneven_near\n11   2_Clusters_uneven_near\n12   2_Clusters_uneven_near\n13 2_Clusters_uneven_medium\n14 2_Clusters_uneven_medium\n15 2_Clusters_uneven_medium\n16    2_Clusters_uneven_far\n17    2_Clusters_uneven_far\n18    2_Clusters_uneven_far\n19          3_Clusters_even\n20          3_Clusters_even\n21          3_Clusters_even\n22        3_Clusters_uneven\n23        3_Clusters_uneven\n24        3_Clusters_uneven\n25        5_Clusters_uneven\n26        5_Clusters_uneven\n27        5_Clusters_uneven\n                                                  Collection E13.5.432\n1                                      E13.5-434_+_E15.0-428         0\n2                                      E15.0-432_+_E13.5-432       536\n3                                      E15.0-508_+_E15.0-509         0\n4                                      E13.5-187_+_E13.5-184         0\n5                                      E15.0-434_+_E17.5-516         0\n6                                      E15.0-437_+_E15.0-508         0\n7                                      E17.5-516_+_E13.5-187         0\n8                                      E15.0-510_+_E13.5-437         0\n9                                      E15.0-509_+_E13.5-184         0\n10                                     E13.5-434_+_E15.0-428         0\n11                                     E15.0-432_+_E13.5-432        66\n12                                     E15.0-508_+_E15.0-509         0\n13                                     E13.5-187_+_E13.5-184         0\n14                                     E15.0-434_+_E17.5-516         0\n15                                     E15.0-437_+_E15.0-508         0\n16                                     E17.5-516_+_E13.5-187         0\n17                                     E15.0-510_+_E13.5-437         0\n18                                     E15.0-509_+_E13.5-184         0\n19                         E15.0-437_+_E13.5-510_+_E13.5-437         0\n20                         E17.5-505_+_E17.5-516_+_E13.5-437         0\n21                         E15.0-510_+_E15.0-428_+_E13.5-510         0\n22                         E15.0-428_+_E13.5-434_+_E15.0-510         0\n23                         E13.5-187_+_E13.5-432_+_E15.0-432       168\n24                         E15.0-509_+_E13.5-184_+_E15.0-508         0\n25 E13.5-510_+_E15.0-437_+_E15.0-510_+_E13.5-432_+_E13.5-437       518\n26 E15.0-428_+_E13.5-434_+_E15.0-434_+_E17.5-505_+_E13.5-184         0\n27 E13.5-432_+_E15.0-509_+_E15.0-432_+_E13.5-187_+_E15.0-508       440\n   E13.5.187 E13.5.434 E13.5.184 E13.5.437 E13.5.510 E15.0.432 E15.0.509\n1          0       318         0         0         0         0         0\n2          0         0         0         0         0       536         0\n3          0         0         0         0         0         0       397\n4        292         0       292         0         0         0         0\n5          0         0         0         0         0         0         0\n6          0         0         0         0         0         0         0\n7        297         0         0         0         0         0         0\n8          0         0         0       259         0         0         0\n9          0         0       292         0         0         0       292\n10         0       326         0         0         0         0         0\n11         0         0         0         0         0       586         0\n12         0         0         0         0         0         0       402\n13       334         0        38         0         0         0         0\n14         0         0         0         0         0         0         0\n15         0         0         0         0         0         0         0\n16       334         0         0         0         0         0         0\n17         0         0         0        45         0         0         0\n18         0         0        45         0         0         0       402\n19         0         0         0       248       248         0         0\n20         0         0         0       203         0         0         0\n21         0         0         0         0       248         0         0\n22         0       115         0         0         0         0         0\n23        84         0         0         0         0       586         0\n24         0         0        58         0         0         0       402\n25         0         0         0       259        65         0         0\n26         0       326       163         0         0         0         0\n27        74         0         0         0         0       586       293\n   E15.0.510 E15.0.508 E15.0.428 E15.0.434 E15.0.437 E17.5.516 E17.5.505\n1          0         0       318         0         0         0         0\n2          0         0         0         0         0         0         0\n3          0       397         0         0         0         0         0\n4          0         0         0         0         0         0         0\n5          0         0         0       273         0       273         0\n6          0       258         0         0       258         0         0\n7          0         0         0         0         0       297         0\n8        259         0         0         0         0         0         0\n9          0         0         0         0         0         0         0\n10         0         0        37         0         0         0         0\n11         0         0         0         0         0         0         0\n12         0        45         0         0         0         0         0\n13         0         0         0         0         0         0         0\n14         0         0         0        33         0       297         0\n15         0       397         0         0        45         0         0\n16         0         0         0         0         0        38         0\n17       402         0         0         0         0         0         0\n18         0         0         0         0         0         0         0\n19         0         0         0         0       248         0         0\n20         0         0         0         0         0       203       203\n21       248         0       248         0         0         0         0\n22       402         0        58         0         0         0         0\n23         0         0         0         0         0         0         0\n24         0       115         0         0         0         0         0\n25       389         0         0         0        65         0         0\n26         0         0       245        41         0         0        41\n27         0        74         0         0         0         0         0\n\n\n\nDEA genes for COTAN\n\nfor (ind in 1:dim(datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(datasets_csv$Group[ind],\"_\",datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),method = \"bonferroni\")\n\n  df.genes &lt;- deaCOTAN[rowMin(as.matrix(pvalCOTAN)) &lt; 0.05,]\n  \n  write.csv(df.genes,file.path(dirOut,paste0(file.code,\"COTAN_DEA_genes.csv\")))\n  \n  }\n\n\n\nDEA genes for Seurat\n\nfor (ind in 1:dim(datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(datasets_csv$Group[ind],\"_\",datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusters &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[1]]\n  deaSeurat &lt;- Seurat.DEA(getRawData(dataset),\n                          clusters.list = clusters,\n                          project = file.code,\n                          dirOut = dirOut)\n  write.csv(deaSeurat$markers,\n          file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")))\n}\n\n\n\nDEA genes for Seurat scTransform\n\nfor (ind in 1:dim(datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(datasets_csv$Group[ind],\"_\",datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusters &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[1]]\n  deaSeurat &lt;- Seurat.DEAScTransform(getRawData(dataset),\n                          clusters.list = clusters,\n                          project = file.code,\n                          dirOut = dirOut)\n  write.csv(deaSeurat$markers,\n          file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")))\n}\n\n\n\nDEA genes for Seurat test: bimod\n\nfor (ind in 1:dim(datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(datasets_csv$Group[ind],\"_\",datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusters &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[1]]\n  deaSeurat &lt;- Seurat.DEA.bimod(getRawData(dataset),\n                          clusters.list = clusters,\n                          project = file.code,\n                          dirOut = dirOut)\n  write.csv(deaSeurat$markers,\n          file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")))\n}\n\n\n\nDEA from Monocle\n\nfor (ind in 1:dim(datasets_csv)[1]) {\n  file.code &lt;- paste0(datasets_csv$Group[ind],\"_\",datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  print(file.code)\n  clusters &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[1]]\n  \n  deaMonocle &lt;- Monocle.DEA(dataSet = getRawData(dataset),\n                          clusters.list = clusters,\n                          project = file.code,\n                          dirOut = dirOut)\n  \n  # deaMonocleOut &lt;- deaMonocle$fit_coefs[,c(\"num_cells_expressed\", \n  #                                         \"gene_id\",\"term\",\"estimate\",\n  #                                         \"std_err\", \"test_val\",\"p_value\", \n  #                                         \"normalized_effect\",\"q_value\")]\n  \n  \n  write.csv(deaMonocle$marker_test_res,\n          file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\"))) \n  \n  #rm(deaMonocleOut)\n  rm(deaMonocle)\n  gc()\n}\n\n\n\nDEA from ScamPy\n\nfor (ind in 1:dim(datasets_csv)[1]) {\n  file.code &lt;- paste0(datasets_csv$Group[ind],\"_\",datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusters &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[1]]\n  \n  deaScamPy &lt;- ScamPy.DEA(dataSet = getRawData(dataset),\n                          clusters.list = clusters,\n                          project = file.code,\n                          dirOut = dirOut)\n  \n  write.csv(deaScamPy,\n          file.path(dirOut,paste0(file.code,\"ScamPy_DEA_genes.csv\"))) \n  \n}",
    "crumbs": [
      "DEA evaluation",
      "FDR analysis - define DE genes"
    ]
  },
  {
    "objectID": "FDR_analisys.html#footer",
    "href": "FDR_analisys.html#footer",
    "title": "FDR analysis - define DE genes",
    "section": "Footer",
    "text": "Footer\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] dplyr_1.1.2                 stringr_1.5.0              \n [3] reticulate_1.35.0           monocle3_1.3.4             \n [5] SingleCellExperiment_1.22.0 SummarizedExperiment_1.30.2\n [7] GenomicRanges_1.52.0        GenomeInfoDb_1.36.1        \n [9] IRanges_2.34.1              S4Vectors_0.38.1           \n[11] MatrixGenerics_1.12.3       matrixStats_1.2.0          \n[13] Biobase_2.60.0              BiocGenerics_0.46.0        \n[15] Seurat_5.0.0                SeuratObject_5.0.0         \n[17] sp_2.1-1                    COTAN_2.3.3                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               bitops_1.0-7             \n  [5] tibble_3.2.1              polyclip_1.10-4          \n  [7] fastDummies_1.7.3         lifecycle_1.0.3          \n  [9] doParallel_1.0.17         globals_0.16.2           \n [11] lattice_0.22-5            MASS_7.3-60              \n [13] dendextend_1.17.1         magrittr_2.0.3           \n [15] plotly_4.10.2             rmarkdown_2.24           \n [17] yaml_2.3.7                httpuv_1.6.11            \n [19] sctransform_0.4.1         spam_2.10-0              \n [21] askpass_1.2.0             spatstat.sparse_3.0-2    \n [23] minqa_1.2.5               cowplot_1.1.1            \n [25] pbapply_1.7-2             RColorBrewer_1.1-3       \n [27] zlibbioc_1.46.0           abind_1.4-5              \n [29] Rtsne_0.16                purrr_1.0.1              \n [31] RCurl_1.98-1.12           GenomeInfoDbData_1.2.10  \n [33] circlize_0.4.15           ggrepel_0.9.3            \n [35] irlba_2.3.5.1             listenv_0.9.0            \n [37] spatstat.utils_3.0-3      terra_1.7-39             \n [39] umap_0.2.10.0             goftest_1.2-3            \n [41] RSpectra_0.16-1           spatstat.random_3.2-1    \n [43] dqrng_0.3.0               fitdistrplus_1.1-11      \n [45] parallelly_1.36.0         DelayedMatrixStats_1.22.5\n [47] leiden_0.4.3              codetools_0.2-19         \n [49] DelayedArray_0.26.7       tidyselect_1.2.0         \n [51] shape_1.4.6               lme4_1.1-34              \n [53] ScaledMatrix_1.8.1        viridis_0.6.4            \n [55] spatstat.explore_3.2-1    jsonlite_1.8.7           \n [57] GetoptLong_1.0.5          ellipsis_0.3.2           \n [59] progressr_0.14.0          ggridges_0.5.4           \n [61] survival_3.5-7            iterators_1.0.14         \n [63] foreach_1.5.2             tools_4.3.2              \n [65] ica_1.0-3                 Rcpp_1.0.11              \n [67] glue_1.7.0                gridExtra_2.3            \n [69] xfun_0.39                 ggthemes_5.0.0           \n [71] withr_3.0.0               fastmap_1.1.1            \n [73] boot_1.3-28               fansi_1.0.4              \n [75] openssl_2.1.0             digest_0.6.33            \n [77] rsvd_1.0.5                parallelDist_0.2.6       \n [79] R6_2.5.1                  mime_0.12                \n [81] colorspace_2.1-0          scattermore_1.2          \n [83] tensor_1.5                spatstat.data_3.0-1      \n [85] utf8_1.2.3                tidyr_1.3.0              \n [87] generics_0.1.3            data.table_1.15.0        \n [89] httr_1.4.6                htmlwidgets_1.6.2        \n [91] S4Arrays_1.2.0            uwot_0.1.16              \n [93] pkgconfig_2.0.3           gtable_0.3.3             \n [95] ComplexHeatmap_2.16.0     lmtest_0.9-40            \n [97] XVector_0.40.0            htmltools_0.5.7          \n [99] dotCall64_1.1-0           clue_0.3-64              \n[101] scales_1.3.0              png_0.1-8                \n[103] knitr_1.43                rstudioapi_0.15.0        \n[105] reshape2_1.4.4            rjson_0.2.21             \n[107] nloptr_2.0.3              nlme_3.1-163             \n[109] zoo_1.8-12                GlobalOptions_0.1.2      \n[111] KernSmooth_2.23-22        parallel_4.3.2           \n[113] miniUI_0.1.1.1            RcppZiggurat_0.1.6       \n[115] pillar_1.9.0              grid_4.3.2               \n[117] vctrs_0.6.3               RANN_2.6.1               \n[119] promises_1.2.0.1          BiocSingular_1.16.0      \n[121] beachmat_2.16.0           xtable_1.8-4             \n[123] cluster_2.1.6             evaluate_0.21            \n[125] zeallot_0.1.0             cli_3.6.1                \n[127] compiler_4.3.2            rlang_1.1.1              \n[129] crayon_1.5.2              future.apply_1.11.0      \n[131] plyr_1.8.8                stringi_1.8.1            \n[133] viridisLite_0.4.2         deldir_2.0-2             \n[135] BiocParallel_1.34.2       assertthat_0.2.1         \n[137] munsell_0.5.0             lazyeval_0.2.2           \n[139] spatstat.geom_3.2-4       PCAtools_2.14.0          \n[141] Matrix_1.6-3              RcppHNSW_0.6.0           \n[143] patchwork_1.2.0           sparseMatrixStats_1.12.2 \n[145] future_1.33.0             ggplot2_3.4.2            \n[147] shiny_1.8.0               ROCR_1.0-11              \n[149] Rfast_2.1.0               igraph_1.6.0             \n[151] RcppParallel_5.1.7",
    "crumbs": [
      "DEA evaluation",
      "FDR analysis - define DE genes"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "COTAN V2.0 Datasets analysis",
    "section": "",
    "text": "Number\nData-set name\nTissue\nOrganism\nInitial cell number\nOriginal paper\nDatabase code\nCell number after cleaning\nsc Method\nLabelled/Surface proteins\n\n\n\n\n1\nE14.5 Mouse Cortex Loo 2019\nBrain\nmm\n11069\n📖\nGSE123335\n10864\nDrop-seq\nNO\n\n\n2\nE13.5 Mouse Cortex Yuzwa 2017\nBrain\nmm\n1137\n📖\nGSE107122\n1112\nDrop-seq\nNO\n\n\n3\nE17.5 Mouse Cortex Yuzwa 2017\nBrain\nmm\n880\n📖\nGSE107122\n874\nDrop-seq\nNO\n\n\n4\nE13.5 Forebrain La Manno 2021\nBrain\nmm\n5376\n📖\nPRJNA637987\n4981\n10X\nYes\n\n\n5\nE15.0 Forebrain La Manno 2021\nBrain\nmm\n8987\n📖\nPRJNA637987\n8562\n10X\nYes\n\n\n6\nE17.5 Forebrain La Manno 2021\nBrain\nmm\n2611\n📖\nPRJNA637987\n2467\n10X\nYes\n\n\n7\nCD14+\nPBMC\nH.s.\n2612\n📖\nSRP073767\n2434\n10X\nNO\n\n\n8\nPBMC1\nPBMC\nH.s.\n5 527\n\n10X website\n3610\n10X\nyes\n\n\n9\nPBMC2\nPBMC\nH.s.\n6574\n\n10X website\n5975\n10X\nyes\n\n\n10\nPBMC3\nPBMC\nH.s.\n11715\n\n10X website\n10944\n10X\nyes\n\n\n11\nPBMC4\nPBMC\nH.s.\n8258\n\n10X website\n6966\n10X\nyes\n\n\n12\n\n\n\n\n\n\n\n10X\nyes\n\n\n13\n\n\n\n\n\n\n\n10X\nyes\n\n\n14\n\n\n\n\n\n\n\n10X\nyes\n\n\n15\n\n\n\n\n\n\n\n10X\nyes\n\n\n16\n\n\n\n\n\n\n\n10X\nyes\n\n\n17\n\n\n\n\n\n\n\n10X\nyes\n\n\n18\n\n\n\n\n\n\n\n10X\nyes\n\n\n19\n\n\n\n\n\n\n\n10X\nyes\n\n\n20\n\n\n\n\n\n\n\n10X\nyes",
    "crumbs": [
      "Home"
    ]
  },
  {
    "objectID": "index.html#schematic-data-sets-information",
    "href": "index.html#schematic-data-sets-information",
    "title": "COTAN V2.0 Datasets analysis",
    "section": "",
    "text": "Number\nData-set name\nTissue\nOrganism\nInitial cell number\nOriginal paper\nDatabase code\nCell number after cleaning\nsc Method\nLabelled/Surface proteins\n\n\n\n\n1\nE14.5 Mouse Cortex Loo 2019\nBrain\nmm\n11069\n📖\nGSE123335\n10864\nDrop-seq\nNO\n\n\n2\nE13.5 Mouse Cortex Yuzwa 2017\nBrain\nmm\n1137\n📖\nGSE107122\n1112\nDrop-seq\nNO\n\n\n3\nE17.5 Mouse Cortex Yuzwa 2017\nBrain\nmm\n880\n📖\nGSE107122\n874\nDrop-seq\nNO\n\n\n4\nE13.5 Forebrain La Manno 2021\nBrain\nmm\n5376\n📖\nPRJNA637987\n4981\n10X\nYes\n\n\n5\nE15.0 Forebrain La Manno 2021\nBrain\nmm\n8987\n📖\nPRJNA637987\n8562\n10X\nYes\n\n\n6\nE17.5 Forebrain La Manno 2021\nBrain\nmm\n2611\n📖\nPRJNA637987\n2467\n10X\nYes\n\n\n7\nCD14+\nPBMC\nH.s.\n2612\n📖\nSRP073767\n2434\n10X\nNO\n\n\n8\nPBMC1\nPBMC\nH.s.\n5 527\n\n10X website\n3610\n10X\nyes\n\n\n9\nPBMC2\nPBMC\nH.s.\n6574\n\n10X website\n5975\n10X\nyes\n\n\n10\nPBMC3\nPBMC\nH.s.\n11715\n\n10X website\n10944\n10X\nyes\n\n\n11\nPBMC4\nPBMC\nH.s.\n8258\n\n10X website\n6966\n10X\nyes\n\n\n12\n\n\n\n\n\n\n\n10X\nyes\n\n\n13\n\n\n\n\n\n\n\n10X\nyes\n\n\n14\n\n\n\n\n\n\n\n10X\nyes\n\n\n15\n\n\n\n\n\n\n\n10X\nyes\n\n\n16\n\n\n\n\n\n\n\n10X\nyes\n\n\n17\n\n\n\n\n\n\n\n10X\nyes\n\n\n18\n\n\n\n\n\n\n\n10X\nyes\n\n\n19\n\n\n\n\n\n\n\n10X\nyes\n\n\n20\n\n\n\n\n\n\n\n10X\nyes",
    "crumbs": [
      "Home"
    ]
  },
  {
    "objectID": "clustering_comparison.html",
    "href": "clustering_comparison.html",
    "title": "Clustering Comparision",
    "section": "",
    "text": "import pandas as pd\nimport numpy as np\nimport scanpy as sc\nfrom sklearn.metrics.cluster import normalized_mutual_info_score, adjusted_rand_score\nfrom sklearn.metrics import homogeneity_score, completeness_score, fowlkes_mallows_score, silhouette_score, davies_bouldin_score\nfrom sklearn.metrics.cluster import contingency_matrix\nfrom src.utils import sankey_plot\nimport kaleido\nfrom sklearn.preprocessing import StandardScaler\nimport plotly.io as pio\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n\nDIR = 'Data/'\nDATASET_NAMES = ['PBMC1', 'PBMC2', 'PBMC3','PBMC4']\nTOOLS = ['monocle', 'scanpy', 'scvi-tools', 'seurat', 'COTAN']\nPARAMS_TUNING = ['default', 'celltypist', 'antibody']\n\n\ndef compute_scores(dir, dataset, labels_df, labels_matched, ground_truth_labels):\n    scores = {}\n    scores['NMI'] = {}\n    scores['ARI'] = {}\n    scores['homogeneity'] = {}\n    scores['completeness'] = {}\n    scores['fowlkes_mallows'] = {}\n    for tool in TOOLS:\n        scores['NMI'][tool] = normalized_mutual_info_score(labels_pred=labels_df['cluster_'+tool], labels_true=labels_df[f'cluster_{ground_truth_labels}'], average_method='arithmetic')\n        scores['ARI'][tool] = adjusted_rand_score(labels_pred=labels_df['cluster_'+tool], labels_true=labels_df[f'cluster_{ground_truth_labels}'])\n        scores['homogeneity'][tool] = homogeneity_score(labels_pred=labels_df['cluster_'+tool], labels_true=labels_df[f'cluster_{ground_truth_labels}'])\n        scores['completeness'][tool] = completeness_score(labels_pred=labels_df['cluster_'+tool], labels_true=labels_df[f'cluster_{ground_truth_labels}'])\n        scores['fowlkes_mallows'][tool] = fowlkes_mallows_score(labels_pred=labels_df['cluster_'+tool], labels_true=labels_df[f'cluster_{ground_truth_labels}'])\n    scores_df = pd.DataFrame(scores)\n    scores_df.to_csv(f'{dir}{dataset}/scores_{labels_matched}_{ground_truth_labels}.csv')\n    scores_df.to_latex(f'{dir}{dataset}/scores_{labels_matched}_{ground_truth_labels}.tex')\n    display(scores_df)\n\n\ndef print_scores(dataset,tuning):\n    \n    \n    # concat tools labels\n    labels_df = pd.read_csv(f'{DIR}{dataset}/COTAN/{tuning}/clustering_labels.csv', index_col=0)\n    labels_df.rename(columns={\"cluster\": \"cluster_COTAN\"}, inplace=True)\n    #print(\"labels_df size\")\n    #print(labels_df.shape)\n    for tool in [t for t in TOOLS if t != 'COTAN']:\n        tool_labels_df = pd.read_csv(f'{DIR}{dataset}/{tool}/{tuning}/clustering_labels.csv', index_col=0)\n        labels_df = labels_df.merge(tool_labels_df, how='inner', on='cell')\n        labels_df.rename(columns={\"cluster\": f\"cluster_{tool}\"}, inplace=True)\n    #    print(\"labels_df size\"+tool)\n    #    print(labels_df.shape)\n    \n    # load and concat celltypist labels\n    celltypist_df = pd.read_csv(f'{DIR}{dataset}/celltypist/celltypist_labels.csv', index_col=0)\n    celltypist_df.index = celltypist_df.index.str[:-2]\n    celltypist_df = labels_df.merge(celltypist_df, how='inner', on='cell')\n    celltypist_df.rename(columns={\"cluster.ids\": f\"cluster_celltypist\"}, inplace=True)\n    celltypist_mapping_df = pd.read_csv(f'{DIR}{dataset}/celltypist/celltypist_mapping.csv', index_col=0)\n    #print(\"celltypist_df size\")\n    #print(celltypist_df.shape)\n    \n    # load and concat protein surface labels\n    antibody_df = pd.read_csv(f'{DIR}{dataset}/antibody_annotation/antibody_labels_postproc.csv', index_col=0)\n    antibody_df = labels_df.merge(antibody_df, how='inner', on='cell')\n    antibody_df.rename(columns={\"cluster.ids\": f\"cluster_antibody\"}, inplace=True)\n    antibody_mapping_df = pd.read_csv(f'{DIR}{dataset}/antibody_annotation/antibody_mapping.csv', index_col=1, encoding='latin1')\n    #print(\"antibody_df size\")\n    #print(antibody_df.shape)\n\n    # read dataset\n    adata = sc.read_10x_mtx(\n        f'{DIR}{dataset}/filtered/10X/',\n        var_names='gene_symbols',\n        cache=False\n    )\n    # keep only labelled cells\n    adata.var_names_make_unique()\n    subset_cells = adata.obs_names.isin(labels_df.index)\n    adata = adata[subset_cells, :]\n\n    mito_genes = adata.var_names.str.startswith('MT-')\n    # for each cell compute fraction of counts in mito genes vs. all genes\n    # the `.A1` is only necessary as X is sparse (to transform to a dense array after summing)\n    adata.obs['percent_mito'] = np.sum(adata[:, mito_genes].X, axis=1).A1 / np.sum(adata.X, axis=1).A1\n    # add the total counts per cell as observations-annotation to adata\n    adata.obs['n_counts'] = adata.X.sum(axis=1).A1\n\n    sc.pp.normalize_total(adata, target_sum=1e4)\n    sc.pp.log1p(adata)\n    sc.pp.highly_variable_genes(adata, min_mean=0.0125, max_mean=3, min_disp=0.5)\n    adata.raw = adata\n    adata = adata[:, adata.var.highly_variable]\n    sc.pp.regress_out(adata, ['n_counts', 'percent_mito'])\n    sc.pp.scale(adata, max_value=10)\n    sc.tl.pca(adata, svd_solver='arpack',n_comps=20)\n    pca_matrix = adata.obsm['X_pca']\n    scaler = StandardScaler()\n    scaled_pca_matrix = scaler.fit_transform(pca_matrix)\n\n    #Custers number\n    \n    df = {}\n    for tool in TOOLS:\n        df[tool] = labels_df[f'cluster_{tool}'].unique().shape[0]\n    df_size = pd.DataFrame(df, index=[0])\n    display(f'{dataset} - number of clusters')\n    display(df_size)\n\n    # compute silhouette score\n    silhouette = {}\n    for tool in TOOLS:\n        silhouette[tool] = silhouette_score(scaled_pca_matrix, labels_df[f'cluster_{tool}'])\n    if tuning=='celltypist':\n        silhouette['celltypist'] = silhouette_score(scaled_pca_matrix, celltypist_df[f'cluster_celltypist'])\n    elif tuning=='antibody':\n        silhouette['antibody'] = silhouette_score(scaled_pca_matrix, antibody_df[f'cluster_antibody'])\n    silhouette_df = pd.DataFrame(silhouette, index=[0])\n    silhouette_df.to_csv(f'{DIR}{dataset}/{tuning}_silhouette.csv')\n    silhouette_df.to_latex(f'{DIR}{dataset}/{tuning}_silhouette.tex')\n    display(f'{dataset} - Silhuette (higher is better)')\n    display(silhouette_df)\n\n    #From https://evafast.github.io/blog/2019/06/28/example_content/\n    davies_bouldin = {}\n    for tool in TOOLS:\n        davies_bouldin[tool] = davies_bouldin_score(adata.obsm['X_pca'], labels_df[f'cluster_{tool}'])\n    if tuning=='celltypist':\n        davies_bouldin['celltypist'] = davies_bouldin_score(adata.obsm['X_pca'], celltypist_df[f'cluster_celltypist'])\n    elif tuning=='antibody':\n        davies_bouldin['antibody'] = davies_bouldin_score(adata.obsm['X_pca'], antibody_df[f'cluster_antibody'])\n    davies_bouldin_df = pd.DataFrame(davies_bouldin, index=[0])\n    davies_bouldin_df.to_csv(f'{DIR}{dataset}/{tuning}_davies_bouldin.csv')\n    davies_bouldin_df.to_latex(f'{DIR}{dataset}/{tuning}_davies_bouldin.tex')\n    display(f'{dataset} - davies_bouldin (lower is better)')\n    display(davies_bouldin_df)\n\n    display(f'{dataset} - matching {tuning} labels' if tuning != 'default' else f'{dataset} - default labels')\n\n    # compute scores comparing each tool labels with celltypist labels\n    if tuning == 'celltypist' or tuning == 'default':\n        compute_scores(DIR, dataset, celltypist_df, tuning, 'celltypist')\n        labels = []\n        labels_titles = []\n        for tool in TOOLS:\n            labels.append(celltypist_df[f'cluster_{tool}'].to_list())\n            labels_titles.append(tool)\n        labels.append(celltypist_df[f'cluster_celltypist'].map(celltypist_mapping_df['go'].to_dict()).to_list())\n        labels_titles.append('celltypist')\n        title = f'{dataset} - matching {tuning} labels' if tuning != 'default' else f'{dataset} - default labels'\n        sankey_plot(labels=labels, labels_titles=labels_titles, title=title, path=f'{DIR}{dataset}/{tuning}_celltypist.html')\n    \n    # compute scores comparing each tool labels with protein labels\n    if tuning == 'antibody' or tuning == 'default':\n        compute_scores(DIR, dataset, antibody_df, tuning, 'antibody')\n        labels = []\n        labels_titles = []\n        for tool in TOOLS:\n            labels.append(antibody_df[f'cluster_{tool}'].to_list())\n            labels_titles.append(tool)\n        labels.append(antibody_df[f'cluster_antibody'].map(antibody_mapping_df['go'].to_dict()).to_list())\n        labels_titles.append('antibody')\n        title = f'{dataset} - matching {tuning} labels' if tuning != 'default' else f'{dataset} - default labels'\n        sankey_plot(labels=labels, labels_titles=labels_titles, title=title, path=f'{DIR}{dataset}/{tuning}_antibody.html')\n\n\ndef print_clustering_data(dataset,tuning):\n    # concat tools labels\n    labels_df = pd.read_csv(f'{DIR}{dataset}/COTAN/{tuning}/clustering_labels.csv', index_col=0)\n    labels_df.rename(columns={\"cluster\": \"cluster_COTAN\"}, inplace=True)\n    display(f'Initial COTAN cluster number:')\n    display(labels_df.cluster_COTAN.unique().shape[0])\n    #print(\"labels_df size\")\n    #print(labels_df.shape)\n    for tool in [t for t in TOOLS if t != 'COTAN']:\n        tool_labels_df = pd.read_csv(f'{DIR}{dataset}/{tool}/{tuning}/clustering_labels.csv', index_col=0)\n        display(f'Initial {tool} cluster number:')\n        display(labels_df[labels_df.columns[-1]].unique().shape[0])\n        labels_df = labels_df.merge(tool_labels_df, how='inner', on='cell')\n        labels_df.rename(columns={\"cluster\": f\"cluster_{tool}\"}, inplace=True)\n    #    print(\"labels_df size\"+tool)\n    #    print(labels_df.shape)\n    \n    if tuning == 'celltypist' or tuning == 'default':\n    # load and concat celltypist labels\n        celltypist_df = pd.read_csv(f'{DIR}{dataset}/celltypist/celltypist_labels.csv', index_col=0)\n        celltypist_df.index = celltypist_df.index.str[:-2]\n        celltypist_df = labels_df.merge(celltypist_df, how='inner', on='cell')\n        celltypist_df.rename(columns={\"cluster.ids\": f\"cluster_celltypist\"}, inplace=True)\n        celltypist_mapping_df = pd.read_csv(f'{DIR}{dataset}/celltypist/celltypist_mapping.csv', index_col=0)\n        #print(\"celltypist_df size\")\n        #print(celltypist_df.shape)\n        labels_cluster_celltypist = np.unique(celltypist_df[\"cluster_celltypist\"])\n        for tool in TOOLS:\n            labels_cluster_tool = np.unique(celltypist_df[f'cluster_{tool}'])\n            cm =contingency_matrix(celltypist_df[\"cluster_celltypist\"], celltypist_df[f'cluster_{tool}'])\n            cm = pd.DataFrame(cm,index=labels_cluster_celltypist,columns=labels_cluster_tool)\n            display(f'{dataset} - contingency_matrix (rows: cellTypist - cols: {tool})')\n            display(cm)\n\n    if tuning == 'antibody' or tuning == 'default':\n        #load and concat protein surface labels\n        antibody_df = pd.read_csv(f'{DIR}{dataset}/antibody_annotation/antibody_labels_postproc.csv', index_col=0)\n        display(\"Initial antibody cell/cluster table:\")\n        display(antibody_df[\"cluster.ids\"].value_counts())\n        antibody_df = labels_df.merge(antibody_df, how='inner', on='cell')\n        antibody_df.rename(columns={\"cluster.ids\": f\"cluster_antibody\"}, inplace=True)\n        \n        antibody_mapping_df = pd.read_csv(f'{DIR}{dataset}/antibody_annotation/antibody_mapping.csv', index_col=1, encoding='latin1')\n        labels_cluster_antybody = np.unique(antibody_df[\"cluster_antibody\"])\n        for tool in TOOLS:\n            labels_cluster_tool = np.unique(antibody_df[f'cluster_{tool}'])\n            cm =contingency_matrix(antibody_df[\"cluster_antibody\"], antibody_df[f'cluster_{tool}'])\n            cm = pd.DataFrame(cm,index=labels_cluster_antybody,columns=labels_cluster_tool)\n            display(f'{dataset} - contingency_matrix (rows: antibody - cols: {tool})')\n            display(cm)",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs clustering comparison"
    ]
  },
  {
    "objectID": "clustering_comparison.html#preamble",
    "href": "clustering_comparison.html#preamble",
    "title": "Clustering Comparision",
    "section": "",
    "text": "import pandas as pd\nimport numpy as np\nimport scanpy as sc\nfrom sklearn.metrics.cluster import normalized_mutual_info_score, adjusted_rand_score\nfrom sklearn.metrics import homogeneity_score, completeness_score, fowlkes_mallows_score, silhouette_score, davies_bouldin_score\nfrom sklearn.metrics.cluster import contingency_matrix\nfrom src.utils import sankey_plot\nimport kaleido\nfrom sklearn.preprocessing import StandardScaler\nimport plotly.io as pio\nimport matplotlib.pyplot as plt\nimport seaborn as sns\n\n\nDIR = 'Data/'\nDATASET_NAMES = ['PBMC1', 'PBMC2', 'PBMC3','PBMC4']\nTOOLS = ['monocle', 'scanpy', 'scvi-tools', 'seurat', 'COTAN']\nPARAMS_TUNING = ['default', 'celltypist', 'antibody']\n\n\ndef compute_scores(dir, dataset, labels_df, labels_matched, ground_truth_labels):\n    scores = {}\n    scores['NMI'] = {}\n    scores['ARI'] = {}\n    scores['homogeneity'] = {}\n    scores['completeness'] = {}\n    scores['fowlkes_mallows'] = {}\n    for tool in TOOLS:\n        scores['NMI'][tool] = normalized_mutual_info_score(labels_pred=labels_df['cluster_'+tool], labels_true=labels_df[f'cluster_{ground_truth_labels}'], average_method='arithmetic')\n        scores['ARI'][tool] = adjusted_rand_score(labels_pred=labels_df['cluster_'+tool], labels_true=labels_df[f'cluster_{ground_truth_labels}'])\n        scores['homogeneity'][tool] = homogeneity_score(labels_pred=labels_df['cluster_'+tool], labels_true=labels_df[f'cluster_{ground_truth_labels}'])\n        scores['completeness'][tool] = completeness_score(labels_pred=labels_df['cluster_'+tool], labels_true=labels_df[f'cluster_{ground_truth_labels}'])\n        scores['fowlkes_mallows'][tool] = fowlkes_mallows_score(labels_pred=labels_df['cluster_'+tool], labels_true=labels_df[f'cluster_{ground_truth_labels}'])\n    scores_df = pd.DataFrame(scores)\n    scores_df.to_csv(f'{dir}{dataset}/scores_{labels_matched}_{ground_truth_labels}.csv')\n    scores_df.to_latex(f'{dir}{dataset}/scores_{labels_matched}_{ground_truth_labels}.tex')\n    display(scores_df)\n\n\ndef print_scores(dataset,tuning):\n    \n    \n    # concat tools labels\n    labels_df = pd.read_csv(f'{DIR}{dataset}/COTAN/{tuning}/clustering_labels.csv', index_col=0)\n    labels_df.rename(columns={\"cluster\": \"cluster_COTAN\"}, inplace=True)\n    #print(\"labels_df size\")\n    #print(labels_df.shape)\n    for tool in [t for t in TOOLS if t != 'COTAN']:\n        tool_labels_df = pd.read_csv(f'{DIR}{dataset}/{tool}/{tuning}/clustering_labels.csv', index_col=0)\n        labels_df = labels_df.merge(tool_labels_df, how='inner', on='cell')\n        labels_df.rename(columns={\"cluster\": f\"cluster_{tool}\"}, inplace=True)\n    #    print(\"labels_df size\"+tool)\n    #    print(labels_df.shape)\n    \n    # load and concat celltypist labels\n    celltypist_df = pd.read_csv(f'{DIR}{dataset}/celltypist/celltypist_labels.csv', index_col=0)\n    celltypist_df.index = celltypist_df.index.str[:-2]\n    celltypist_df = labels_df.merge(celltypist_df, how='inner', on='cell')\n    celltypist_df.rename(columns={\"cluster.ids\": f\"cluster_celltypist\"}, inplace=True)\n    celltypist_mapping_df = pd.read_csv(f'{DIR}{dataset}/celltypist/celltypist_mapping.csv', index_col=0)\n    #print(\"celltypist_df size\")\n    #print(celltypist_df.shape)\n    \n    # load and concat protein surface labels\n    antibody_df = pd.read_csv(f'{DIR}{dataset}/antibody_annotation/antibody_labels_postproc.csv', index_col=0)\n    antibody_df = labels_df.merge(antibody_df, how='inner', on='cell')\n    antibody_df.rename(columns={\"cluster.ids\": f\"cluster_antibody\"}, inplace=True)\n    antibody_mapping_df = pd.read_csv(f'{DIR}{dataset}/antibody_annotation/antibody_mapping.csv', index_col=1, encoding='latin1')\n    #print(\"antibody_df size\")\n    #print(antibody_df.shape)\n\n    # read dataset\n    adata = sc.read_10x_mtx(\n        f'{DIR}{dataset}/filtered/10X/',\n        var_names='gene_symbols',\n        cache=False\n    )\n    # keep only labelled cells\n    adata.var_names_make_unique()\n    subset_cells = adata.obs_names.isin(labels_df.index)\n    adata = adata[subset_cells, :]\n\n    mito_genes = adata.var_names.str.startswith('MT-')\n    # for each cell compute fraction of counts in mito genes vs. all genes\n    # the `.A1` is only necessary as X is sparse (to transform to a dense array after summing)\n    adata.obs['percent_mito'] = np.sum(adata[:, mito_genes].X, axis=1).A1 / np.sum(adata.X, axis=1).A1\n    # add the total counts per cell as observations-annotation to adata\n    adata.obs['n_counts'] = adata.X.sum(axis=1).A1\n\n    sc.pp.normalize_total(adata, target_sum=1e4)\n    sc.pp.log1p(adata)\n    sc.pp.highly_variable_genes(adata, min_mean=0.0125, max_mean=3, min_disp=0.5)\n    adata.raw = adata\n    adata = adata[:, adata.var.highly_variable]\n    sc.pp.regress_out(adata, ['n_counts', 'percent_mito'])\n    sc.pp.scale(adata, max_value=10)\n    sc.tl.pca(adata, svd_solver='arpack',n_comps=20)\n    pca_matrix = adata.obsm['X_pca']\n    scaler = StandardScaler()\n    scaled_pca_matrix = scaler.fit_transform(pca_matrix)\n\n    #Custers number\n    \n    df = {}\n    for tool in TOOLS:\n        df[tool] = labels_df[f'cluster_{tool}'].unique().shape[0]\n    df_size = pd.DataFrame(df, index=[0])\n    display(f'{dataset} - number of clusters')\n    display(df_size)\n\n    # compute silhouette score\n    silhouette = {}\n    for tool in TOOLS:\n        silhouette[tool] = silhouette_score(scaled_pca_matrix, labels_df[f'cluster_{tool}'])\n    if tuning=='celltypist':\n        silhouette['celltypist'] = silhouette_score(scaled_pca_matrix, celltypist_df[f'cluster_celltypist'])\n    elif tuning=='antibody':\n        silhouette['antibody'] = silhouette_score(scaled_pca_matrix, antibody_df[f'cluster_antibody'])\n    silhouette_df = pd.DataFrame(silhouette, index=[0])\n    silhouette_df.to_csv(f'{DIR}{dataset}/{tuning}_silhouette.csv')\n    silhouette_df.to_latex(f'{DIR}{dataset}/{tuning}_silhouette.tex')\n    display(f'{dataset} - Silhuette (higher is better)')\n    display(silhouette_df)\n\n    #From https://evafast.github.io/blog/2019/06/28/example_content/\n    davies_bouldin = {}\n    for tool in TOOLS:\n        davies_bouldin[tool] = davies_bouldin_score(adata.obsm['X_pca'], labels_df[f'cluster_{tool}'])\n    if tuning=='celltypist':\n        davies_bouldin['celltypist'] = davies_bouldin_score(adata.obsm['X_pca'], celltypist_df[f'cluster_celltypist'])\n    elif tuning=='antibody':\n        davies_bouldin['antibody'] = davies_bouldin_score(adata.obsm['X_pca'], antibody_df[f'cluster_antibody'])\n    davies_bouldin_df = pd.DataFrame(davies_bouldin, index=[0])\n    davies_bouldin_df.to_csv(f'{DIR}{dataset}/{tuning}_davies_bouldin.csv')\n    davies_bouldin_df.to_latex(f'{DIR}{dataset}/{tuning}_davies_bouldin.tex')\n    display(f'{dataset} - davies_bouldin (lower is better)')\n    display(davies_bouldin_df)\n\n    display(f'{dataset} - matching {tuning} labels' if tuning != 'default' else f'{dataset} - default labels')\n\n    # compute scores comparing each tool labels with celltypist labels\n    if tuning == 'celltypist' or tuning == 'default':\n        compute_scores(DIR, dataset, celltypist_df, tuning, 'celltypist')\n        labels = []\n        labels_titles = []\n        for tool in TOOLS:\n            labels.append(celltypist_df[f'cluster_{tool}'].to_list())\n            labels_titles.append(tool)\n        labels.append(celltypist_df[f'cluster_celltypist'].map(celltypist_mapping_df['go'].to_dict()).to_list())\n        labels_titles.append('celltypist')\n        title = f'{dataset} - matching {tuning} labels' if tuning != 'default' else f'{dataset} - default labels'\n        sankey_plot(labels=labels, labels_titles=labels_titles, title=title, path=f'{DIR}{dataset}/{tuning}_celltypist.html')\n    \n    # compute scores comparing each tool labels with protein labels\n    if tuning == 'antibody' or tuning == 'default':\n        compute_scores(DIR, dataset, antibody_df, tuning, 'antibody')\n        labels = []\n        labels_titles = []\n        for tool in TOOLS:\n            labels.append(antibody_df[f'cluster_{tool}'].to_list())\n            labels_titles.append(tool)\n        labels.append(antibody_df[f'cluster_antibody'].map(antibody_mapping_df['go'].to_dict()).to_list())\n        labels_titles.append('antibody')\n        title = f'{dataset} - matching {tuning} labels' if tuning != 'default' else f'{dataset} - default labels'\n        sankey_plot(labels=labels, labels_titles=labels_titles, title=title, path=f'{DIR}{dataset}/{tuning}_antibody.html')\n\n\ndef print_clustering_data(dataset,tuning):\n    # concat tools labels\n    labels_df = pd.read_csv(f'{DIR}{dataset}/COTAN/{tuning}/clustering_labels.csv', index_col=0)\n    labels_df.rename(columns={\"cluster\": \"cluster_COTAN\"}, inplace=True)\n    display(f'Initial COTAN cluster number:')\n    display(labels_df.cluster_COTAN.unique().shape[0])\n    #print(\"labels_df size\")\n    #print(labels_df.shape)\n    for tool in [t for t in TOOLS if t != 'COTAN']:\n        tool_labels_df = pd.read_csv(f'{DIR}{dataset}/{tool}/{tuning}/clustering_labels.csv', index_col=0)\n        display(f'Initial {tool} cluster number:')\n        display(labels_df[labels_df.columns[-1]].unique().shape[0])\n        labels_df = labels_df.merge(tool_labels_df, how='inner', on='cell')\n        labels_df.rename(columns={\"cluster\": f\"cluster_{tool}\"}, inplace=True)\n    #    print(\"labels_df size\"+tool)\n    #    print(labels_df.shape)\n    \n    if tuning == 'celltypist' or tuning == 'default':\n    # load and concat celltypist labels\n        celltypist_df = pd.read_csv(f'{DIR}{dataset}/celltypist/celltypist_labels.csv', index_col=0)\n        celltypist_df.index = celltypist_df.index.str[:-2]\n        celltypist_df = labels_df.merge(celltypist_df, how='inner', on='cell')\n        celltypist_df.rename(columns={\"cluster.ids\": f\"cluster_celltypist\"}, inplace=True)\n        celltypist_mapping_df = pd.read_csv(f'{DIR}{dataset}/celltypist/celltypist_mapping.csv', index_col=0)\n        #print(\"celltypist_df size\")\n        #print(celltypist_df.shape)\n        labels_cluster_celltypist = np.unique(celltypist_df[\"cluster_celltypist\"])\n        for tool in TOOLS:\n            labels_cluster_tool = np.unique(celltypist_df[f'cluster_{tool}'])\n            cm =contingency_matrix(celltypist_df[\"cluster_celltypist\"], celltypist_df[f'cluster_{tool}'])\n            cm = pd.DataFrame(cm,index=labels_cluster_celltypist,columns=labels_cluster_tool)\n            display(f'{dataset} - contingency_matrix (rows: cellTypist - cols: {tool})')\n            display(cm)\n\n    if tuning == 'antibody' or tuning == 'default':\n        #load and concat protein surface labels\n        antibody_df = pd.read_csv(f'{DIR}{dataset}/antibody_annotation/antibody_labels_postproc.csv', index_col=0)\n        display(\"Initial antibody cell/cluster table:\")\n        display(antibody_df[\"cluster.ids\"].value_counts())\n        antibody_df = labels_df.merge(antibody_df, how='inner', on='cell')\n        antibody_df.rename(columns={\"cluster.ids\": f\"cluster_antibody\"}, inplace=True)\n        \n        antibody_mapping_df = pd.read_csv(f'{DIR}{dataset}/antibody_annotation/antibody_mapping.csv', index_col=1, encoding='latin1')\n        labels_cluster_antybody = np.unique(antibody_df[\"cluster_antibody\"])\n        for tool in TOOLS:\n            labels_cluster_tool = np.unique(antibody_df[f'cluster_{tool}'])\n            cm =contingency_matrix(antibody_df[\"cluster_antibody\"], antibody_df[f'cluster_{tool}'])\n            cm = pd.DataFrame(cm,index=labels_cluster_antybody,columns=labels_cluster_tool)\n            display(f'{dataset} - contingency_matrix (rows: antibody - cols: {tool})')\n            display(cm)",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs clustering comparison"
    ]
  },
  {
    "objectID": "clustering_comparison.html#data-summary-information",
    "href": "clustering_comparison.html#data-summary-information",
    "title": "Clustering Comparision",
    "section": "Data summary information",
    "text": "Data summary information\n\nDefault parameters\n\nprint_clustering_data(tuning = 'default',dataset=\"PBMC1\")\n\n'Initial COTAN cluster number:'\n\n\n14\n\n\n'Initial monocle cluster number:'\n\n\n14\n\n\n'Initial scanpy cluster number:'\n\n\n3\n\n\n'Initial scvi-tools cluster number:'\n\n\n18\n\n\n'Initial seurat cluster number:'\n\n\n13\n\n\n'PBMC1 - contingency_matrix (rows: cellTypist - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n\n\n\n\n1\n8\n970\n1\n\n\n2\n943\n0\n0\n\n\n3\n47\n0\n0\n\n\n4\n0\n78\n0\n\n\n5\n309\n0\n0\n\n\n6\n0\n0\n142\n\n\n7\n82\n0\n0\n\n\n8\n278\n0\n1\n\n\n9\n81\n0\n0\n\n\n10\n0\n171\n0\n\n\n11\n70\n0\n0\n\n\n12\n240\n0\n0\n\n\n13\n0\n28\n0\n\n\n14\n0\n0\n155\n\n\n15\n2\n4\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: cellTypist - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\n1\n0\n0\n246\n0\n267\n0\n263\n0\n200\n0\n1\n0\n2\n0\n0\n0\n0\n0\n\n\n2\n88\n321\n0\n281\n1\n0\n0\n241\n0\n1\n0\n1\n0\n1\n0\n8\n0\n0\n\n\n3\n45\n0\n0\n0\n0\n0\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n76\n0\n\n\n5\n250\n5\n0\n0\n0\n0\n0\n2\n0\n0\n0\n52\n0\n0\n0\n0\n0\n0\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n4\n0\n138\n0\n0\n0\n0\n0\n\n\n7\n8\n0\n0\n0\n0\n0\n0\n0\n0\n19\n0\n37\n0\n18\n0\n0\n0\n0\n\n\n8\n0\n0\n0\n0\n0\n263\n0\n0\n0\n16\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n2\n2\n0\n5\n0\n0\n0\n5\n0\n0\n0\n0\n0\n1\n0\n66\n0\n0\n\n\n10\n0\n0\n75\n0\n0\n0\n5\n0\n0\n0\n0\n0\n0\n0\n91\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n5\n0\n0\n0\n65\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n6\n0\n0\n0\n0\n0\n0\n4\n0\n82\n0\n59\n0\n86\n0\n3\n0\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n28\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n154\n0\n1\n0\n0\n0\n0\n0\n\n\n15\n3\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: cellTypist - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n\n1\n659\n0\n0\n0\n289\n0\n1\n0\n0\n30\n0\n0\n0\n\n\n2\n0\n485\n48\n402\n0\n2\n0\n0\n0\n0\n0\n6\n0\n\n\n3\n0\n1\n41\n5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n0\n0\n6\n0\n0\n0\n0\n72\n0\n0\n0\n\n\n5\n0\n5\n288\n12\n0\n4\n0\n0\n0\n0\n0\n0\n0\n\n\n6\n0\n0\n0\n0\n0\n0\n1\n2\n139\n0\n0\n0\n0\n\n\n7\n0\n0\n58\n0\n0\n23\n1\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n0\n0\n0\n0\n0\n279\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n4\n0\n2\n0\n2\n0\n0\n0\n0\n0\n73\n0\n\n\n10\n1\n0\n0\n0\n78\n0\n0\n0\n0\n0\n92\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n67\n3\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n1\n48\n1\n0\n189\n0\n0\n0\n0\n0\n1\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n28\n\n\n14\n0\n0\n0\n0\n0\n1\n0\n147\n7\n0\n0\n0\n0\n\n\n15\n0\n3\n0\n0\n0\n3\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: cellTypist - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n\n1\n0\n0\n616\n361\n1\n0\n0\n0\n1\n0\n0\n\n\n2\n798\n145\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n3\n1\n46\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n0\n4\n0\n0\n0\n0\n0\n74\n0\n\n\n5\n0\n309\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n142\n0\n0\n0\n\n\n7\n0\n55\n0\n0\n0\n27\n0\n0\n0\n0\n0\n\n\n8\n0\n0\n0\n0\n274\n5\n0\n0\n0\n0\n0\n\n\n9\n78\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n43\n0\n0\n0\n0\n128\n0\n0\n\n\n11\n0\n0\n0\n0\n5\n65\n0\n0\n0\n0\n0\n\n\n12\n7\n69\n0\n0\n0\n164\n0\n0\n0\n0\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n27\n\n\n14\n0\n0\n0\n0\n0\n0\n153\n2\n0\n0\n0\n\n\n15\n5\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: cellTypist - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n\n1\n35\n0\n11\n648\n284\n0\n0\n0\n0\n0\n1\n0\n0\n0\n\n\n2\n0\n0\n0\n0\n0\n0\n0\n0\n7\n0\n0\n0\n807\n129\n\n\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n37\n2\n8\n\n\n4\n0\n73\n2\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n308\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n142\n0\n0\n0\n0\n0\n0\n\n\n7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n25\n1\n0\n0\n56\n\n\n8\n0\n0\n0\n0\n0\n0\n0\n0\n55\n4\n220\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n0\n34\n1\n0\n0\n45\n1\n\n\n10\n0\n1\n146\n23\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n\n\n11\n0\n0\n0\n0\n0\n0\n0\n0\n2\n67\n1\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n3\n175\n0\n1\n5\n56\n\n\n13\n0\n1\n0\n0\n0\n27\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n14\n0\n0\n0\n0\n0\n0\n152\n3\n0\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n0\n2\n0\n0\n0\n4\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'Initial antibody cell/cluster table:'\n\n\ncluster.ids\n7     1338\n8      876\n3      748\n4      341\n9      331\n5      211\n1      202\n6      131\n2       62\n10      51\n12      16\nName: count, dtype: int64\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n\n\n\n\n1\n161\n0\n0\n\n\n2\n0\n43\n3\n\n\n3\n600\n0\n0\n\n\n4\n262\n1\n0\n\n\n5\n158\n0\n0\n\n\n6\n1\n86\n0\n\n\n7\n10\n1115\n0\n\n\n8\n812\n1\n1\n\n\n9\n1\n0\n294\n\n\n10\n44\n0\n0\n\n\n12\n10\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\n1\n7\n6\n0\n4\n0\n0\n0\n9\n0\n23\n0\n7\n0\n32\n0\n73\n0\n0\n\n\n2\n0\n0\n3\n0\n0\n0\n0\n0\n0\n0\n2\n0\n3\n0\n38\n0\n0\n0\n\n\n3\n366\n33\n0\n5\n0\n0\n0\n28\n0\n43\n0\n122\n0\n3\n0\n0\n0\n0\n\n\n4\n0\n0\n0\n0\n1\n249\n0\n0\n0\n13\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n5\n9\n0\n0\n0\n0\n0\n0\n2\n0\n64\n0\n15\n0\n68\n0\n0\n0\n0\n\n\n6\n1\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n56\n26\n\n\n7\n1\n0\n319\n0\n267\n0\n267\n1\n198\n0\n0\n0\n0\n0\n52\n0\n19\n1\n\n\n8\n18\n288\n0\n277\n0\n1\n0\n214\n0\n3\n1\n5\n0\n2\n0\n4\n0\n1\n\n\n9\n0\n0\n0\n0\n0\n1\n0\n0\n0\n1\n156\n0\n137\n0\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n0\n0\n7\n0\n0\n0\n36\n0\n0\n0\n1\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n10\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n\n\n\n\n1\n0\n6\n12\n5\n0\n62\n0\n0\n0\n0\n0\n76\n0\n\n\n2\n2\n0\n0\n0\n3\n0\n0\n1\n1\n0\n39\n0\n0\n\n\n3\n0\n49\n441\n66\n0\n44\n0\n0\n0\n0\n0\n0\n0\n\n\n4\n1\n0\n0\n0\n0\n0\n262\n0\n0\n0\n0\n0\n0\n\n\n5\n0\n2\n12\n1\n0\n141\n0\n0\n0\n0\n0\n2\n0\n\n\n6\n0\n1\n0\n0\n0\n3\n0\n0\n0\n56\n1\n0\n26\n\n\n7\n655\n3\n0\n0\n368\n0\n1\n0\n0\n45\n52\n0\n1\n\n\n8\n0\n438\n17\n349\n0\n4\n3\n0\n0\n0\n0\n2\n1\n\n\n9\n0\n0\n0\n0\n0\n0\n3\n148\n144\n0\n0\n0\n0\n\n\n10\n0\n0\n1\n0\n0\n37\n6\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n10\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n\n1\n93\n17\n0\n0\n0\n51\n0\n0\n0\n0\n0\n\n\n2\n0\n0\n1\n4\n0\n0\n1\n1\n39\n0\n0\n\n\n3\n23\n540\n0\n0\n0\n37\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n1\n0\n260\n2\n0\n0\n0\n0\n0\n\n\n5\n1\n28\n0\n0\n0\n129\n0\n0\n0\n0\n0\n\n\n6\n3\n1\n0\n1\n0\n0\n0\n0\n1\n56\n25\n\n\n7\n2\n1\n611\n402\n1\n0\n0\n0\n89\n18\n1\n\n\n8\n766\n41\n0\n0\n1\n4\n1\n0\n0\n0\n1\n\n\n9\n0\n0\n0\n0\n2\n0\n151\n142\n0\n0\n0\n\n\n10\n0\n0\n0\n0\n8\n36\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n8\n2\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n\n1\n0\n0\n0\n0\n0\n0\n0\n0\n36\n54\n0\n1\n59\n11\n\n\n2\n1\n1\n40\n2\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n\n\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n39\n0\n38\n33\n490\n\n\n4\n1\n0\n0\n0\n0\n0\n0\n0\n48\n1\n213\n0\n0\n0\n\n\n5\n0\n0\n0\n0\n0\n0\n0\n0\n1\n135\n0\n0\n0\n22\n\n\n6\n0\n56\n1\n1\n1\n25\n0\n0\n3\n0\n0\n0\n0\n0\n\n\n7\n33\n17\n118\n668\n284\n1\n0\n0\n0\n0\n1\n0\n2\n1\n\n\n8\n0\n0\n0\n0\n0\n1\n1\n0\n9\n4\n0\n0\n765\n34\n\n\n9\n0\n0\n0\n0\n0\n0\n150\n143\n0\n0\n2\n0\n0\n0\n\n\n10\n0\n0\n0\n0\n0\n0\n0\n0\n4\n38\n2\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n4\n1\n5\n0\n0\n0\n\n\n\n\n\n\n\n\nprint_clustering_data(tuning = 'default',dataset=\"PBMC2\")\n\n'Initial COTAN cluster number:'\n\n\n17\n\n\n'Initial monocle cluster number:'\n\n\n17\n\n\n'Initial scanpy cluster number:'\n\n\n2\n\n\n'Initial scvi-tools cluster number:'\n\n\n18\n\n\n'Initial seurat cluster number:'\n\n\n20\n\n\n'PBMC2 - contingency_matrix (rows: cellTypist - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n\n\n\n\n1\n230\n1\n\n\n2\n427\n0\n\n\n3\n2139\n3\n\n\n4\n700\n7\n\n\n5\n316\n0\n\n\n6\n0\n93\n\n\n7\n0\n567\n\n\n8\n674\n0\n\n\n9\n0\n186\n\n\n10\n52\n0\n\n\n11\n0\n228\n\n\n12\n0\n204\n\n\n13\n0\n48\n\n\n14\n0\n14\n\n\n15\n80\n0\n\n\n16\n0\n6\n\n\n\n\n\n\n\n'PBMC2 - contingency_matrix (rows: cellTypist - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\n1\n0\n0\n0\n2\n0\n0\n1\n22\n1\n2\n5\n50\n0\n148\n0\n0\n0\n0\n\n\n2\n0\n91\n0\n273\n0\n0\n0\n3\n2\n0\n56\n1\n0\n1\n0\n0\n0\n0\n\n\n3\n942\n508\n21\n183\n0\n0\n0\n21\n295\n2\n100\n42\n0\n26\n1\n0\n0\n1\n\n\n4\n0\n0\n0\n1\n0\n463\n8\n2\n0\n230\n0\n0\n0\n2\n1\n0\n0\n0\n\n\n5\n0\n0\n0\n2\n0\n0\n0\n266\n0\n0\n42\n0\n0\n6\n0\n0\n0\n0\n\n\n6\n0\n0\n0\n0\n5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n88\n0\n0\n\n\n7\n0\n0\n0\n0\n466\n0\n0\n0\n0\n0\n0\n0\n15\n0\n86\n0\n0\n0\n\n\n8\n2\n1\n558\n0\n0\n0\n0\n3\n0\n0\n0\n110\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n12\n0\n0\n0\n0\n0\n0\n0\n174\n0\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n0\n0\n0\n0\n0\n0\n50\n2\n0\n0\n0\n0\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n0\n228\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n204\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n48\n0\n\n\n14\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n13\n\n\n15\n0\n25\n0\n46\n0\n0\n0\n1\n2\n1\n2\n2\n0\n1\n0\n0\n0\n0\n\n\n16\n0\n0\n0\n1\n0\n0\n0\n0\n5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC2 - contingency_matrix (rows: cellTypist - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n\n\n1\n0\n0\n0\n0\n0\n0\n222\n1\n2\n0\n0\n4\n1\n1\n0\n0\n0\n0\n0\n0\n\n\n2\n331\n4\n1\n0\n0\n0\n7\n10\n53\n0\n0\n1\n0\n10\n4\n0\n6\n0\n0\n0\n\n\n3\n391\n733\n2\n1\n19\n1\n41\n304\n158\n185\n0\n2\n43\n90\n75\n0\n71\n0\n0\n26\n\n\n4\n1\n0\n675\n1\n0\n8\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n19\n0\n0\n\n\n5\n7\n0\n1\n0\n0\n0\n11\n9\n66\n0\n0\n151\n71\n0\n0\n0\n0\n0\n0\n0\n\n\n6\n0\n0\n0\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n78\n0\n0\n3\n0\n\n\n7\n0\n0\n0\n564\n0\n0\n0\n0\n0\n0\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n2\n0\n1\n561\n0\n103\n1\n0\n2\n0\n1\n3\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n11\n0\n0\n0\n0\n0\n0\n175\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n10\n2\n0\n4\n0\n0\n0\n0\n0\n0\n0\n0\n0\n2\n0\n0\n0\n0\n44\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n228\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n204\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n48\n0\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n15\n58\n0\n1\n0\n0\n0\n5\n5\n1\n5\n0\n0\n1\n3\n0\n0\n1\n0\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n6\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC2 - contingency_matrix (rows: cellTypist - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n\n1\n0\n4\n6\n0\n0\n0\n219\n0\n1\n0\n0\n1\n0\n0\n\n\n2\n0\n400\n23\n0\n0\n0\n1\n0\n3\n0\n0\n0\n0\n0\n\n\n3\n1151\n352\n550\n0\n2\n15\n69\n1\n0\n0\n0\n2\n0\n0\n\n\n4\n0\n0\n2\n635\n0\n0\n3\n7\n0\n0\n1\n59\n0\n0\n\n\n5\n0\n42\n0\n0\n0\n0\n7\n0\n267\n0\n0\n0\n0\n0\n\n\n6\n0\n0\n0\n0\n11\n0\n0\n0\n0\n0\n0\n0\n82\n0\n\n\n7\n0\n0\n0\n0\n567\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n8\n8\n4\n2\n0\n0\n541\n119\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n14\n0\n0\n0\n0\n172\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n3\n0\n0\n0\n0\n0\n0\n0\n49\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n0\n0\n83\n0\n0\n145\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n201\n1\n0\n2\n0\n0\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n48\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n14\n0\n0\n\n\n15\n0\n0\n77\n0\n0\n0\n2\n0\n0\n0\n0\n1\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n6\n0\n0\n\n\n\n\n\n\n\n'PBMC2 - contingency_matrix (rows: cellTypist - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n\n1\n0\n0\n0\n3\n4\n220\n3\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n2\n0\n0\n0\n416\n9\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n3\n0\n2\n1186\n847\n31\n72\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n\n\n4\n639\n56\n0\n0\n2\n3\n0\n0\n0\n0\n0\n0\n0\n0\n1\n5\n1\n\n\n5\n0\n0\n0\n39\n0\n7\n270\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n0\n0\n86\n0\n7\n0\n0\n0\n0\n0\n\n\n7\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n88\n300\n174\n0\n0\n3\n1\n\n\n8\n0\n0\n568\n9\n1\n96\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n154\n24\n0\n0\n8\n0\n0\n0\n0\n0\n\n\n10\n1\n51\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n145\n69\n14\n\n\n12\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n22\n180\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n48\n0\n0\n0\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n13\n1\n\n\n15\n0\n1\n0\n6\n72\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n16\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n1\n0\n3\n0\n0\n0\n0\n\n\n\n\n\n\n\n'Initial antibody cell/cluster table:'\n\n\ncluster.ids\n4     1510\n11    1130\n8      695\n12     570\n6      424\n13     275\n5      197\n2      150\n10     122\n3       84\n7       76\nName: count, dtype: int64\n\n\n'PBMC2 - contingency_matrix (rows: antibody - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n\n\n\n\n2\n0\n147\n\n\n3\n60\n20\n\n\n4\n1480\n13\n\n\n5\n196\n0\n\n\n6\n416\n1\n\n\n7\n68\n7\n\n\n8\n681\n5\n\n\n10\n0\n119\n\n\n11\n1115\n9\n\n\n12\n566\n4\n\n\n13\n0\n271\n\n\n\n\n\n\n\n'PBMC2 - contingency_matrix (rows: antibody - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\n2\n0\n0\n0\n0\n4\n0\n0\n0\n0\n0\n0\n0\n141\n0\n2\n0\n0\n0\n\n\n3\n0\n1\n1\n0\n0\n3\n0\n0\n0\n54\n0\n0\n18\n2\n1\n0\n0\n0\n\n\n4\n89\n588\n0\n478\n0\n0\n0\n56\n63\n0\n194\n10\n1\n3\n3\n4\n3\n1\n\n\n5\n7\n1\n14\n2\n0\n0\n0\n118\n2\n2\n4\n23\n0\n23\n0\n0\n0\n0\n\n\n6\n0\n2\n9\n13\n0\n0\n1\n128\n1\n0\n3\n124\n0\n136\n0\n0\n0\n0\n\n\n7\n1\n3\n27\n3\n0\n0\n0\n6\n1\n0\n1\n23\n0\n3\n0\n5\n2\n0\n\n\n8\n0\n0\n0\n0\n0\n459\n4\n0\n0\n220\n0\n0\n2\n0\n0\n0\n1\n0\n\n\n10\n0\n0\n0\n0\n107\n0\n0\n0\n0\n0\n0\n0\n3\n0\n3\n6\n0\n0\n\n\n11\n843\n26\n5\n5\n0\n0\n5\n4\n229\n0\n1\n2\n0\n0\n1\n2\n1\n0\n\n\n12\n2\n0\n522\n0\n0\n0\n2\n1\n1\n2\n0\n21\n0\n17\n1\n0\n1\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n263\n0\n0\n0\n0\n0\n7\n0\n0\n0\n1\n0\n\n\n\n\n\n\n\n'PBMC2 - contingency_matrix (rows: antibody - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n\n\n2\n0\n0\n0\n5\n0\n0\n0\n0\n0\n0\n142\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n3\n0\n0\n55\n0\n1\n0\n0\n1\n0\n0\n19\n0\n0\n0\n0\n0\n0\n4\n0\n0\n\n\n4\n758\n143\n0\n4\n0\n0\n30\n125\n259\n52\n0\n5\n4\n54\n26\n4\n23\n0\n3\n3\n\n\n5\n4\n8\n1\n0\n5\n0\n27\n4\n6\n0\n0\n36\n105\n0\n0\n0\n0\n0\n0\n0\n\n\n6\n4\n0\n0\n0\n17\n0\n270\n2\n9\n0\n0\n112\n3\n0\n0\n0\n0\n0\n0\n0\n\n\n7\n0\n1\n0\n1\n31\n0\n27\n2\n1\n1\n0\n5\n0\n0\n0\n4\n0\n0\n2\n0\n\n\n8\n0\n0\n622\n0\n0\n4\n0\n0\n0\n0\n2\n0\n1\n0\n0\n0\n0\n56\n1\n0\n\n\n10\n0\n0\n0\n111\n0\n0\n0\n0\n0\n0\n4\n0\n0\n0\n0\n4\n0\n0\n0\n0\n\n\n11\n14\n581\n0\n1\n5\n5\n2\n191\n5\n138\n0\n0\n1\n50\n51\n2\n54\n0\n1\n23\n\n\n12\n0\n2\n1\n1\n520\n2\n34\n1\n0\n1\n0\n0\n6\n0\n0\n0\n1\n0\n1\n0\n\n\n13\n0\n0\n0\n7\n0\n263\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n\n\n\n\n\n\n\n'PBMC2 - contingency_matrix (rows: antibody - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n\n2\n0\n0\n0\n0\n8\n0\n0\n0\n0\n139\n0\n0\n0\n0\n\n\n3\n0\n0\n1\n9\n2\n1\n1\n0\n0\n18\n0\n48\n0\n0\n\n\n4\n65\n756\n607\n0\n4\n0\n10\n0\n42\n0\n0\n2\n4\n3\n\n\n5\n6\n6\n2\n0\n0\n12\n65\n0\n104\n0\n0\n1\n0\n0\n\n\n6\n0\n22\n3\n0\n0\n7\n267\n0\n118\n0\n0\n0\n0\n0\n\n\n7\n2\n7\n5\n0\n0\n21\n30\n0\n3\n0\n0\n0\n5\n2\n\n\n8\n0\n0\n0\n627\n0\n0\n0\n3\n0\n2\n1\n52\n0\n1\n\n\n10\n0\n0\n0\n0\n113\n0\n0\n0\n0\n3\n0\n0\n3\n0\n\n\n11\n1073\n4\n35\n0\n1\n1\n1\n4\n1\n0\n1\n0\n2\n1\n\n\n12\n9\n0\n0\n0\n1\n512\n44\n1\n0\n0\n1\n1\n0\n1\n\n\n13\n0\n0\n0\n0\n7\n0\n0\n159\n1\n0\n103\n0\n0\n1\n\n\n\n\n\n\n\n'PBMC2 - contingency_matrix (rows: antibody - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n\n2\n0\n0\n0\n0\n0\n0\n0\n137\n4\n0\n2\n3\n1\n0\n0\n0\n0\n\n\n3\n8\n49\n1\n2\n0\n1\n0\n1\n17\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n76\n1235\n110\n16\n44\n0\n0\n4\n3\n0\n1\n3\n0\n1\n0\n\n\n5\n0\n0\n19\n6\n1\n65\n105\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n6\n0\n0\n11\n23\n1\n261\n120\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n7\n0\n0\n32\n16\n1\n15\n4\n0\n0\n5\n0\n0\n0\n2\n0\n0\n0\n\n\n8\n630\n50\n0\n0\n0\n0\n0\n0\n2\n0\n0\n0\n0\n1\n1\n2\n0\n\n\n10\n0\n0\n0\n0\n0\n0\n0\n4\n0\n5\n1\n76\n33\n0\n0\n0\n0\n\n\n11\n0\n0\n1082\n27\n4\n1\n1\n0\n0\n2\n1\n0\n0\n1\n1\n3\n1\n\n\n12\n0\n1\n526\n0\n0\n38\n1\n0\n0\n0\n0\n0\n0\n1\n1\n1\n1\n\n\n13\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n5\n0\n0\n1\n102\n29\n133\n\n\n\n\n\n\n\n\nprint_clustering_data(tuning = 'default',dataset=\"PBMC3\")\n\n'Initial COTAN cluster number:'\n\n\n32\n\n\n'Initial monocle cluster number:'\n\n\n32\n\n\n'Initial scanpy cluster number:'\n\n\n3\n\n\n'Initial scvi-tools cluster number:'\n\n\n22\n\n\n'Initial seurat cluster number:'\n\n\n17\n\n\n'PBMC3 - contingency_matrix (rows: cellTypist - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n\n\n\n\n1\n3021\n0\n0\n\n\n2\n1\n1471\n0\n\n\n3\n6\n1\n655\n\n\n4\n1100\n0\n0\n\n\n5\n1183\n26\n33\n\n\n6\n0\n156\n0\n\n\n7\n1112\n1\n0\n\n\n8\n484\n0\n0\n\n\n9\n0\n0\n396\n\n\n10\n0\n408\n0\n\n\n11\n430\n0\n0\n\n\n12\n0\n0\n8\n\n\n13\n233\n0\n0\n\n\n14\n111\n0\n0\n\n\n15\n4\n16\n0\n\n\n16\n0\n11\n0\n\n\n17\n0\n8\n0\n\n\n18\n0\n57\n0\n\n\n19\n0\n12\n0\n\n\n\n\n\n\n\n'PBMC3 - contingency_matrix (rows: cellTypist - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n...\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\n\n\n1\n1401\n0\n153\n0\n0\n29\n26\n534\n121\n429\n...\n1\n0\n100\n0\n0\n0\n0\n0\n28\n0\n\n\n2\n0\n0\n0\n0\n816\n0\n0\n0\n0\n0\n...\n0\n2\n0\n227\n0\n5\n0\n35\n0\n0\n\n\n3\n0\n0\n0\n543\n0\n0\n0\n0\n5\n0\n...\n0\n0\n0\n0\n111\n0\n0\n2\n0\n0\n\n\n4\n26\n0\n0\n0\n0\n806\n12\n5\n29\n6\n...\n0\n0\n155\n0\n0\n0\n0\n0\n1\n0\n\n\n5\n0\n961\n0\n0\n0\n0\n3\n0\n0\n0\n...\n216\n0\n0\n29\n33\n0\n0\n0\n0\n0\n\n\n6\n0\n0\n0\n0\n8\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n147\n0\n0\n0\n0\n\n\n7\n0\n0\n683\n0\n0\n0\n7\n128\n236\n15\n...\n0\n0\n6\n1\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n0\n0\n0\n0\n0\n423\n0\n32\n0\n...\n4\n0\n6\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n395\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n0\n90\n0\n0\n0\n0\n0\n...\n0\n311\n0\n1\n0\n1\n0\n1\n0\n0\n\n\n11\n0\n2\n0\n0\n0\n0\n281\n2\n54\n0\n...\n4\n0\n42\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n8\n0\n0\n0\n0\n0\n\n\n13\n12\n0\n116\n0\n0\n0\n1\n52\n9\n11\n...\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n14\n0\n5\n1\n0\n0\n0\n5\n0\n3\n0\n...\n97\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n20\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n11\n0\n0\n0\n0\n0\n0\n\n\n17\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n8\n0\n0\n0\n0\n\n\n18\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n57\n0\n0\n0\n\n\n19\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n12\n0\n0\n0\n0\n0\n\n\n\n\n19 rows × 22 columns\n\n\n\n'PBMC3 - contingency_matrix (rows: cellTypist - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n\n1\n740\n1603\n2\n1\n1\n40\n86\n23\n248\n1\n197\n79\n0\n0\n0\n0\n0\n\n\n2\n0\n0\n1460\n0\n1\n0\n0\n0\n0\n3\n0\n0\n8\n0\n0\n0\n0\n\n\n3\n0\n0\n4\n2\n655\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n4\n6\n11\n0\n1\n1\n912\n162\n2\n1\n0\n4\n0\n0\n0\n0\n0\n0\n\n\n5\n0\n0\n29\n1165\n31\n0\n7\n1\n0\n0\n0\n0\n0\n8\n0\n1\n0\n\n\n6\n0\n0\n10\n0\n0\n0\n0\n0\n0\n0\n0\n0\n146\n0\n0\n0\n0\n\n\n7\n883\n14\n1\n0\n0\n1\n25\n29\n80\n0\n70\n10\n0\n0\n0\n0\n0\n\n\n8\n24\n0\n0\n6\n0\n1\n5\n313\n0\n0\n0\n135\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n396\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n10\n0\n0\n97\n0\n0\n0\n0\n0\n0\n311\n0\n0\n0\n0\n0\n0\n0\n\n\n11\n10\n0\n0\n2\n0\n2\n408\n2\n0\n0\n1\n4\n0\n1\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n8\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n13\n174\n26\n0\n0\n0\n0\n3\n0\n25\n0\n5\n0\n0\n0\n0\n0\n0\n\n\n14\n0\n0\n1\n19\n0\n0\n1\n0\n0\n0\n0\n0\n0\n90\n0\n0\n0\n\n\n15\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n20\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n11\n\n\n17\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n8\n0\n0\n0\n0\n\n\n18\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n55\n0\n0\n\n\n19\n0\n0\n0\n0\n0\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC3 - contingency_matrix (rows: cellTypist - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\n1\n1740\n415\n0\n0\n681\n20\n162\n0\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n2\n0\n0\n1013\n0\n0\n0\n0\n0\n0\n0\n0\n227\n0\n229\n3\n0\n0\n0\n\n\n3\n0\n0\n0\n0\n0\n0\n2\n535\n0\n2\n0\n1\n2\n0\n0\n120\n0\n0\n\n\n4\n16\n6\n0\n0\n3\n886\n188\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n\n\n5\n0\n1\n4\n1043\n0\n0\n2\n1\n1\n0\n0\n24\n136\n0\n0\n30\n0\n0\n\n\n6\n0\n0\n7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n149\n0\n0\n0\n\n\n7\n0\n980\n0\n0\n108\n0\n18\n0\n7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n18\n0\n3\n0\n0\n8\n0\n454\n0\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n57\n0\n336\n0\n0\n0\n0\n0\n3\n0\n0\n\n\n10\n0\n0\n84\n0\n0\n0\n0\n0\n0\n0\n319\n1\n0\n4\n0\n0\n0\n0\n\n\n11\n0\n14\n0\n0\n0\n2\n411\n0\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n7\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n\n\n13\n13\n5\n0\n0\n208\n0\n7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n14\n0\n0\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n109\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n20\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n11\n\n\n17\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n8\n0\n0\n0\n\n\n18\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n5\n0\n52\n0\n\n\n19\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n12\n\n\n\n\n\n\n\n'PBMC3 - contingency_matrix (rows: cellTypist - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n...\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n\n\n\n\n1\n1\n48\n6\n205\n1790\n15\n4\n53\n199\n154\n...\n0\n0\n0\n0\n0\n0\n0\n0\n2\n0\n\n\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n1\n0\n0\n2\n0\n0\n0\n0\n0\n\n\n3\n0\n2\n0\n0\n0\n0\n0\n1\n1\n0\n...\n67\n125\n220\n131\n0\n0\n2\n0\n0\n0\n\n\n4\n0\n152\n1\n89\n18\n805\n0\n2\n7\n20\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n5\n1\n0\n0\n1\n0\n0\n1\n1\n0\n0\n...\n3\n0\n3\n0\n30\n4\n138\n1025\n0\n0\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n7\n0\n12\n9\n26\n0\n0\n4\n431\n546\n27\n...\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n\n\n8\n0\n4\n465\n0\n0\n0\n0\n1\n8\n0\n...\n0\n0\n0\n0\n0\n0\n2\n3\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n30\n15\n0\n0\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n11\n83\n272\n2\n9\n0\n1\n0\n0\n7\n8\n...\n0\n0\n0\n0\n0\n0\n14\n1\n32\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n8\n0\n\n\n13\n0\n0\n0\n4\n5\n0\n139\n3\n1\n6\n...\n0\n0\n0\n0\n0\n0\n10\n0\n0\n0\n\n\n14\n0\n0\n0\n1\n0\n0\n0\n0\n1\n0\n...\n0\n0\n0\n0\n0\n86\n17\n6\n0\n0\n\n\n15\n0\n4\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n16\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n11\n0\n\n\n17\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n18\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n52\n\n\n19\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n1\n0\n11\n0\n\n\n\n\n19 rows × 32 columns\n\n\n\n'Initial antibody cell/cluster table:'\n\n\ncluster.ids\n9     2220\n10    1635\n7     1271\n13    1067\n5     1010\n12     909\n6      744\n2      271\n4      214\n14     168\n3      149\n23     133\n22      71\nName: count, dtype: int64\n\n\n'PBMC3 - contingency_matrix (rows: antibody - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n\n\n\n\n2\n3\n265\n0\n\n\n3\n132\n13\n3\n\n\n4\n209\n2\n1\n\n\n5\n993\n14\n1\n\n\n6\n741\n0\n0\n\n\n7\n4\n1226\n0\n\n\n9\n2201\n9\n1\n\n\n10\n1616\n12\n3\n\n\n12\n905\n2\n1\n\n\n13\n2\n43\n1002\n\n\n14\n141\n23\n1\n\n\n22\n70\n1\n0\n\n\n23\n130\n0\n0\n\n\n\n\n\n\n\n'PBMC3 - contingency_matrix (rows: antibody - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n...\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\n\n\n2\n0\n1\n0\n0\n17\n0\n0\n0\n0\n0\n...\n1\n223\n0\n25\n0\n0\n1\n0\n0\n0\n\n\n3\n0\n14\n2\n0\n0\n1\n5\n0\n3\n0\n...\n106\n12\n0\n0\n4\n0\n0\n0\n0\n0\n\n\n4\n4\n0\n5\n0\n0\n50\n25\n10\n28\n15\n...\n1\n0\n57\n0\n1\n2\n0\n0\n1\n0\n\n\n5\n0\n912\n0\n0\n0\n0\n2\n0\n0\n0\n...\n80\n10\n0\n2\n1\n0\n0\n0\n0\n1\n\n\n6\n1\n0\n8\n0\n0\n9\n433\n11\n75\n1\n...\n3\n0\n151\n1\n0\n0\n0\n0\n0\n0\n\n\n7\n0\n0\n1\n0\n735\n0\n0\n1\n0\n0\n...\n0\n20\n0\n167\n0\n28\n2\n0\n0\n1\n\n\n9\n92\n0\n808\n1\n0\n1\n26\n593\n323\n196\n...\n0\n3\n19\n1\n0\n5\n0\n0\n7\n0\n\n\n10\n1252\n2\n4\n0\n0\n15\n3\n18\n4\n205\n...\n3\n1\n5\n3\n6\n4\n2\n0\n20\n2\n\n\n12\n25\n1\n0\n0\n1\n737\n34\n0\n8\n2\n...\n6\n0\n40\n1\n1\n0\n0\n0\n0\n0\n\n\n13\n0\n0\n0\n873\n1\n0\n1\n0\n1\n0\n...\n0\n6\n0\n1\n128\n2\n2\n30\n0\n0\n\n\n14\n0\n17\n0\n0\n0\n0\n4\n0\n2\n1\n...\n116\n20\n0\n1\n1\n0\n3\n0\n0\n0\n\n\n22\n10\n0\n9\n0\n0\n0\n2\n18\n6\n19\n...\n0\n0\n1\n0\n0\n0\n1\n0\n1\n0\n\n\n23\n0\n0\n90\n0\n0\n0\n0\n18\n1\n2\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n13 rows × 22 columns\n\n\n\n'PBMC3 - contingency_matrix (rows: antibody - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n\n2\n0\n0\n42\n2\n0\n0\n0\n0\n0\n223\n0\n0\n0\n0\n1\n0\n0\n\n\n3\n3\n0\n1\n48\n2\n1\n6\n1\n0\n12\n0\n0\n0\n74\n0\n0\n0\n\n\n4\n18\n8\n1\n0\n2\n76\n80\n18\n0\n0\n7\n0\n2\n0\n0\n0\n0\n\n\n5\n0\n0\n1\n979\n1\n0\n0\n0\n0\n10\n0\n0\n0\n14\n0\n2\n1\n\n\n6\n14\n1\n1\n1\n0\n23\n464\n222\n0\n0\n6\n6\n0\n3\n0\n0\n0\n\n\n7\n2\n0\n1182\n0\n0\n0\n0\n0\n0\n18\n0\n0\n26\n0\n1\n1\n0\n\n\n9\n1524\n275\n1\n0\n2\n1\n26\n47\n171\n3\n134\n22\n5\n0\n0\n0\n0\n\n\n10\n52\n1281\n1\n6\n4\n15\n4\n2\n149\n2\n101\n4\n6\n0\n2\n2\n0\n\n\n12\n0\n5\n2\n4\n1\n816\n67\n5\n2\n0\n1\n5\n0\n0\n0\n0\n0\n\n\n13\n0\n0\n31\n1\n995\n0\n1\n1\n8\n7\n0\n0\n2\n0\n1\n0\n0\n\n\n14\n0\n0\n1\n129\n1\n0\n0\n3\n0\n20\n0\n1\n0\n7\n3\n0\n0\n\n\n22\n39\n14\n0\n0\n0\n0\n0\n4\n4\n0\n6\n3\n0\n0\n1\n0\n0\n\n\n23\n111\n2\n0\n0\n0\n0\n0\n0\n13\n0\n4\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC3 - contingency_matrix (rows: antibody - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\n2\n0\n0\n18\n1\n0\n0\n0\n0\n1\n0\n226\n20\n1\n0\n0\n0\n1\n0\n\n\n3\n0\n3\n0\n25\n0\n1\n1\n0\n2\n0\n12\n0\n101\n0\n0\n2\n0\n1\n\n\n4\n11\n28\n0\n0\n12\n48\n97\n0\n12\n0\n0\n0\n1\n0\n2\n1\n0\n0\n\n\n5\n0\n0\n0\n980\n0\n0\n0\n0\n0\n0\n10\n1\n14\n0\n0\n1\n0\n2\n\n\n6\n1\n22\n0\n0\n6\n16\n468\n0\n225\n0\n0\n1\n2\n0\n0\n0\n0\n0\n\n\n7\n0\n2\n873\n0\n0\n0\n0\n0\n0\n0\n22\n139\n0\n164\n27\n0\n2\n1\n\n\n9\n129\n1302\n0\n0\n716\n0\n31\n1\n23\n0\n3\n1\n0\n0\n5\n0\n0\n0\n\n\n10\n1543\n8\n1\n2\n46\n3\n6\n0\n2\n0\n0\n3\n3\n0\n4\n4\n2\n4\n\n\n12\n6\n0\n1\n0\n3\n816\n72\n0\n4\n0\n0\n1\n4\n0\n0\n1\n0\n0\n\n\n13\n0\n0\n1\n1\n0\n0\n0\n549\n1\n327\n7\n30\n0\n1\n2\n126\n2\n0\n\n\n14\n0\n1\n0\n14\n1\n0\n0\n0\n3\n0\n20\n1\n121\n0\n0\n1\n3\n0\n\n\n22\n12\n19\n0\n0\n34\n0\n3\n0\n2\n0\n0\n0\n0\n0\n0\n0\n1\n0\n\n\n23\n0\n4\n0\n0\n126\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC3 - contingency_matrix (rows: antibody - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n...\n23\n24\n25\n26\n27\n28\n29\n30\n31\n32\n\n\n\n\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n14\n0\n1\n2\n0\n1\n\n\n3\n1\n0\n1\n3\n0\n1\n0\n0\n1\n0\n...\n1\n0\n0\n0\n0\n72\n28\n25\n1\n0\n\n\n4\n3\n29\n15\n13\n15\n50\n2\n9\n15\n44\n...\n0\n0\n0\n0\n0\n0\n2\n0\n1\n0\n\n\n5\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n...\n0\n0\n1\n0\n12\n11\n2\n968\n2\n0\n\n\n6\n62\n357\n227\n8\n1\n13\n1\n14\n11\n4\n...\n0\n0\n0\n0\n0\n1\n15\n0\n18\n0\n\n\n7\n0\n0\n0\n1\n0\n0\n0\n1\n0\n0\n...\n0\n0\n0\n0\n1\n0\n0\n0\n1\n2\n\n\n9\n1\n21\n28\n159\n158\n0\n30\n440\n716\n134\n...\n0\n0\n1\n0\n0\n0\n8\n0\n2\n0\n\n\n10\n0\n5\n3\n3\n1550\n3\n0\n6\n2\n5\n...\n0\n0\n0\n0\n0\n0\n4\n2\n2\n2\n\n\n12\n6\n47\n4\n79\n5\n739\n0\n0\n1\n3\n...\n0\n0\n0\n0\n0\n0\n5\n0\n6\n0\n\n\n13\n0\n0\n1\n0\n0\n0\n0\n0\n1\n0\n...\n65\n116\n233\n128\n1\n1\n0\n0\n8\n2\n\n\n14\n0\n0\n3\n0\n0\n0\n1\n1\n1\n0\n...\n0\n0\n0\n0\n0\n4\n116\n14\n0\n3\n\n\n22\n0\n0\n2\n2\n19\n0\n1\n8\n6\n9\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n\n\n23\n0\n0\n0\n4\n0\n0\n109\n4\n0\n1\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n13 rows × 32 columns\n\n\n\n\nprint_clustering_data(tuning = 'default',dataset=\"PBMC4\")\n\n'Initial COTAN cluster number:'\n\n\n24\n\n\n'Initial monocle cluster number:'\n\n\n24\n\n\n'Initial scanpy cluster number:'\n\n\n3\n\n\n'Initial scvi-tools cluster number:'\n\n\n22\n\n\n'Initial seurat cluster number:'\n\n\n16\n\n\n'PBMC4 - contingency_matrix (rows: cellTypist - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n\n\n\n\n1\n407\n0\n0\n\n\n2\n11\n0\n797\n\n\n3\n1330\n1\n0\n\n\n4\n108\n0\n0\n\n\n5\n9\n2178\n13\n\n\n6\n308\n0\n0\n\n\n7\n77\n0\n0\n\n\n8\n538\n0\n0\n\n\n9\n358\n1\n0\n\n\n10\n0\n307\n0\n\n\n11\n1\n1\n222\n\n\n12\n0\n28\n0\n\n\n13\n8\n3\n2\n\n\n14\n106\n0\n0\n\n\n15\n0\n92\n1\n\n\n16\n0\n59\n0\n\n\n\n\n\n\n\n'PBMC4 - contingency_matrix (rows: cellTypist - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n...\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\n\n\n1\n10\n0\n0\n0\n0\n0\n0\n384\n1\n0\n...\n0\n6\n0\n0\n0\n1\n5\n0\n0\n0\n\n\n2\n0\n673\n0\n0\n0\n0\n0\n0\n1\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n34\n\n\n3\n300\n0\n0\n0\n496\n385\n0\n1\n0\n0\n...\n136\n10\n3\n0\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n0\n0\n0\n0\n0\n6\n10\n0\n...\n0\n7\n0\n0\n0\n0\n85\n0\n0\n0\n\n\n5\n1\n0\n596\n456\n0\n0\n427\n0\n0\n281\n...\n0\n0\n0\n169\n76\n145\n0\n48\n0\n0\n\n\n6\n7\n0\n0\n0\n4\n3\n0\n0\n0\n0\n...\n8\n99\n187\n0\n0\n0\n0\n0\n0\n0\n\n\n7\n3\n0\n0\n0\n0\n0\n0\n1\n0\n0\n...\n0\n67\n0\n0\n0\n0\n6\n0\n0\n0\n\n\n8\n462\n0\n0\n0\n8\n46\n0\n1\n0\n0\n...\n19\n2\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n5\n348\n0\n...\n1\n0\n0\n0\n0\n0\n5\n0\n0\n0\n\n\n10\n0\n0\n0\n74\n0\n0\n1\n0\n0\n2\n...\n0\n0\n0\n10\n2\n1\n0\n1\n0\n0\n\n\n11\n0\n46\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n1\n0\n0\n0\n0\n5\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n28\n0\n0\n\n\n13\n7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n6\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n14\n42\n0\n0\n0\n1\n13\n0\n1\n0\n0\n...\n47\n2\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n...\n0\n0\n0\n2\n88\n2\n0\n0\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n59\n0\n\n\n\n\n16 rows × 22 columns\n\n\n\n'PBMC4 - contingency_matrix (rows: cellTypist - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n\n1\n0\n0\n4\n1\n0\n0\n1\n0\n315\n0\n0\n0\n86\n0\n0\n0\n\n\n2\n800\n0\n2\n1\n0\n0\n2\n0\n1\n0\n1\n0\n1\n0\n0\n0\n\n\n3\n0\n939\n357\n2\n0\n0\n20\n0\n1\n0\n0\n0\n0\n0\n0\n12\n\n\n4\n0\n0\n0\n0\n0\n0\n105\n2\n0\n0\n0\n0\n1\n0\n0\n0\n\n\n5\n4\n0\n1\n805\n746\n413\n0\n4\n2\n1\n167\n15\n1\n41\n0\n0\n\n\n6\n0\n8\n8\n0\n0\n0\n291\n0\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n7\n0\n0\n3\n0\n0\n0\n67\n1\n6\n0\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n31\n483\n0\n0\n0\n3\n0\n6\n0\n0\n0\n0\n0\n0\n15\n\n\n9\n0\n0\n1\n2\n0\n0\n0\n355\n0\n0\n0\n0\n1\n0\n0\n0\n\n\n10\n0\n0\n0\n14\n0\n94\n1\n0\n0\n194\n4\n0\n0\n0\n0\n0\n\n\n11\n217\n0\n0\n0\n0\n0\n0\n0\n0\n0\n7\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n28\n0\n0\n\n\n13\n0\n1\n1\n0\n0\n0\n0\n6\n0\n0\n0\n0\n0\n0\n5\n0\n\n\n14\n1\n9\n89\n0\n0\n0\n4\n0\n1\n0\n0\n0\n0\n0\n0\n2\n\n\n15\n0\n0\n0\n2\n0\n3\n0\n0\n0\n0\n1\n87\n0\n0\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n58\n0\n\n\n\n\n\n\n\n'PBMC4 - contingency_matrix (rows: cellTypist - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n\n1\n5\n0\n0\n0\n0\n0\n398\n0\n0\n4\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n2\n0\n0\n0\n0\n632\n0\n1\n0\n122\n1\n0\n0\n0\n0\n0\n0\n0\n52\n0\n\n\n3\n356\n854\n0\n0\n0\n0\n0\n0\n0\n2\n116\n0\n3\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n0\n0\n0\n0\n0\n1\n0\n107\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n5\n2\n0\n780\n723\n0\n447\n2\n0\n2\n0\n1\n1\n0\n136\n28\n35\n0\n0\n43\n\n\n6\n31\n15\n0\n0\n0\n0\n0\n0\n0\n68\n5\n0\n189\n0\n0\n0\n0\n0\n0\n\n\n7\n3\n0\n0\n0\n0\n0\n3\n0\n0\n69\n2\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n8\n525\n0\n0\n0\n0\n0\n1\n0\n0\n2\n10\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n3\n354\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n7\n0\n86\n0\n0\n0\n0\n0\n213\n0\n1\n0\n0\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n1\n0\n0\n0\n223\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n28\n0\n0\n0\n\n\n13\n10\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n1\n0\n\n\n14\n4\n0\n0\n0\n0\n0\n0\n0\n0\n1\n101\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n90\n0\n0\n0\n1\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n59\n0\n0\n\n\n\n\n\n\n\n'PBMC4 - contingency_matrix (rows: cellTypist - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n...\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n\n\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n1\n0\n402\n0\n0\n4\n\n\n2\n0\n0\n0\n0\n0\n0\n0\n0\n2\n45\n...\n0\n0\n0\n0\n1\n0\n1\n0\n1\n0\n\n\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n1\n0\n0\n0\n0\n45\n963\n322\n\n\n4\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n105\n0\n0\n0\n0\n3\n\n\n5\n40\n131\n724\n199\n332\n741\n1\n27\n0\n0\n...\n0\n0\n0\n0\n0\n0\n2\n0\n0\n1\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n4\n209\n95\n\n\n7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n3\n0\n4\n2\n0\n68\n\n\n8\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n1\n0\n7\n530\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n55\n36\n118\n147\n1\n1\n0\n1\n\n\n10\n0\n1\n6\n0\n83\n2\n215\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n0\n0\n0\n24\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n28\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n1\n0\n1\n...\n0\n0\n8\n0\n0\n0\n0\n0\n1\n1\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n93\n1\n12\n\n\n15\n1\n0\n1\n0\n1\n0\n0\n90\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n59\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n16 rows × 24 columns\n\n\n\n'Initial antibody cell/cluster table:'\n\n\ncluster.ids\n3     2280\n1     1367\n10    1018\n9      488\n2      351\n14     348\n4      242\n5      224\n24     194\n26      64\n22      43\n12      41\nName: count, dtype: int64\n\n\n'PBMC4 - contingency_matrix (rows: antibody - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n\n\n\n\n1\n1342\n5\n0\n\n\n2\n335\n5\n0\n\n\n3\n8\n2158\n0\n\n\n4\n241\n0\n0\n\n\n5\n16\n195\n1\n\n\n9\n480\n1\n0\n\n\n10\n13\n39\n931\n\n\n12\n38\n0\n0\n\n\n14\n343\n2\n0\n\n\n22\n42\n0\n0\n\n\n24\n193\n0\n0\n\n\n26\n63\n0\n0\n\n\n\n\n\n\n\n'PBMC4 - contingency_matrix (rows: antibody - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n...\n13\n14\n15\n16\n17\n18\n19\n20\n21\n22\n\n\n\n\n1\n744\n0\n0\n0\n195\n247\n0\n8\n1\n0\n...\n139\n6\n0\n0\n3\n1\n2\n0\n1\n0\n\n\n2\n10\n0\n0\n0\n0\n0\n0\n5\n317\n0\n...\n2\n0\n0\n0\n3\n0\n3\n0\n0\n0\n\n\n3\n1\n0\n573\n514\n1\n0\n405\n0\n0\n273\n...\n2\n0\n0\n178\n26\n119\n0\n42\n3\n0\n\n\n4\n3\n0\n0\n0\n3\n2\n0\n1\n2\n0\n...\n8\n30\n174\n0\n0\n0\n18\n0\n0\n0\n\n\n5\n0\n0\n1\n0\n0\n0\n1\n0\n14\n0\n...\n1\n0\n0\n0\n3\n11\n2\n1\n0\n0\n\n\n9\n12\n0\n0\n0\n1\n3\n0\n288\n0\n0\n...\n2\n130\n8\n0\n1\n0\n36\n0\n0\n0\n\n\n10\n1\n657\n1\n0\n0\n0\n1\n0\n6\n1\n...\n0\n0\n0\n0\n40\n0\n0\n3\n0\n37\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n2\n3\n0\n...\n0\n2\n0\n0\n0\n0\n31\n0\n0\n0\n\n\n14\n10\n0\n0\n0\n205\n105\n0\n0\n0\n0\n...\n23\n0\n0\n0\n1\n0\n0\n0\n1\n0\n\n\n22\n6\n0\n0\n0\n2\n2\n0\n2\n0\n0\n...\n0\n24\n6\n0\n0\n0\n0\n0\n0\n0\n\n\n24\n9\n0\n0\n0\n97\n75\n0\n0\n1\n0\n...\n9\n0\n1\n0\n0\n0\n1\n0\n0\n0\n\n\n26\n27\n0\n0\n0\n1\n12\n0\n1\n0\n0\n...\n22\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n12 rows × 22 columns\n\n\n\n'PBMC4 - contingency_matrix (rows: antibody - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n\n1\n0\n454\n839\n0\n1\n1\n8\n1\n12\n0\n0\n2\n1\n0\n1\n27\n\n\n2\n0\n1\n4\n1\n0\n0\n0\n328\n0\n0\n0\n3\n1\n0\n2\n0\n\n\n3\n0\n2\n0\n719\n730\n476\n1\n0\n2\n15\n168\n14\n1\n35\n3\n0\n\n\n4\n0\n4\n2\n0\n0\n0\n230\n3\n2\n0\n0\n0\n0\n0\n0\n0\n\n\n5\n0\n0\n0\n10\n1\n7\n0\n19\n0\n170\n0\n3\n0\n1\n1\n0\n\n\n9\n0\n2\n8\n0\n0\n0\n175\n0\n288\n0\n0\n1\n7\n0\n0\n0\n\n\n10\n921\n0\n3\n36\n4\n1\n0\n5\n0\n2\n8\n0\n1\n2\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n38\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n14\n0\n324\n17\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n1\n2\n\n\n22\n0\n3\n4\n0\n0\n0\n27\n0\n8\n0\n0\n0\n0\n0\n0\n0\n\n\n24\n0\n185\n4\n0\n0\n0\n2\n1\n0\n0\n0\n0\n1\n0\n0\n0\n\n\n26\n1\n4\n58\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC4 - contingency_matrix (rows: antibody - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n\n1\n853\n323\n0\n0\n0\n0\n9\n1\n0\n5\n151\n0\n0\n1\n3\n0\n1\n0\n0\n\n\n2\n9\n0\n0\n0\n0\n0\n2\n324\n0\n0\n0\n0\n0\n0\n4\n0\n0\n1\n0\n\n\n3\n4\n1\n750\n693\n0\n519\n1\n0\n0\n0\n1\n25\n0\n113\n26\n30\n3\n0\n0\n\n\n4\n1\n11\n0\n0\n0\n0\n1\n2\n0\n46\n2\n0\n178\n0\n0\n0\n0\n0\n0\n\n\n5\n1\n0\n1\n2\n0\n2\n1\n15\n0\n0\n0\n177\n0\n9\n3\n1\n0\n0\n0\n\n\n9\n28\n5\n0\n0\n0\n0\n292\n0\n0\n140\n9\n0\n6\n0\n1\n0\n0\n0\n0\n\n\n10\n1\n0\n3\n3\n598\n0\n0\n4\n304\n0\n0\n1\n0\n0\n0\n2\n0\n30\n37\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n1\n0\n36\n1\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n14\n10\n326\n0\n0\n0\n0\n0\n0\n0\n0\n6\n0\n1\n0\n1\n0\n1\n0\n0\n\n\n22\n12\n11\n0\n0\n0\n0\n4\n0\n0\n9\n0\n0\n6\n0\n0\n0\n0\n0\n0\n\n\n24\n3\n186\n0\n0\n0\n0\n0\n1\n0\n1\n1\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n26\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n60\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC4 - contingency_matrix (rows: antibody - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n...\n15\n16\n17\n18\n19\n20\n21\n22\n23\n24\n\n\n\n\n1\n0\n1\n0\n0\n0\n0\n0\n3\n0\n0\n...\n1\n0\n0\n0\n3\n0\n9\n75\n431\n824\n\n\n2\n0\n0\n0\n0\n0\n0\n0\n4\n0\n1\n...\n0\n0\n57\n29\n102\n142\n1\n0\n0\n4\n\n\n3\n0\n110\n687\n195\n395\n719\n26\n25\n0\n0\n...\n3\n1\n0\n0\n0\n0\n1\n0\n2\n2\n\n\n4\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n1\n0\n19\n0\n1\n1\n191\n28\n\n\n5\n0\n9\n2\n0\n1\n2\n178\n3\n0\n0\n...\n0\n0\n0\n4\n10\n1\n0\n0\n0\n1\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n...\n0\n0\n0\n0\n41\n0\n292\n6\n12\n129\n\n\n10\n33\n1\n4\n1\n2\n2\n1\n0\n24\n25\n...\n0\n0\n1\n1\n1\n2\n0\n0\n1\n1\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n36\n0\n0\n1\n0\n1\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n...\n1\n0\n0\n0\n0\n0\n0\n1\n333\n9\n\n\n22\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n6\n0\n17\n19\n\n\n24\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n1\n0\n1\n0\n187\n4\n\n\n26\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n57\n1\n5\n\n\n\n\n12 rows × 24 columns\n\n\n\n\n\nAgainst cellTypist cluster number\n\nprint_clustering_data(tuning = 'celltypist',dataset=\"PBMC1\")\n\n'Initial COTAN cluster number:'\n\n\n14\n\n\n'Initial monocle cluster number:'\n\n\n14\n\n\n'Initial scanpy cluster number:'\n\n\n18\n\n\n'Initial scvi-tools cluster number:'\n\n\n17\n\n\n'Initial seurat cluster number:'\n\n\n20\n\n\n'PBMC1 - contingency_matrix (rows: cellTypist - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\n1\n0\n1\n3\n1\n273\n0\n0\n0\n237\n227\n147\n0\n6\n6\n0\n77\n1\n0\n\n\n2\n66\n0\n0\n0\n0\n230\n228\n218\n0\n0\n0\n145\n25\n0\n31\n0\n0\n0\n\n\n3\n3\n0\n0\n0\n0\n0\n2\n0\n0\n0\n0\n0\n36\n0\n6\n0\n0\n0\n\n\n4\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n5\n0\n0\n0\n0\n0\n73\n0\n\n\n5\n200\n0\n0\n7\n0\n1\n0\n0\n0\n0\n0\n1\n65\n0\n35\n0\n0\n0\n\n\n6\n0\n142\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n7\n36\n0\n0\n40\n0\n0\n0\n0\n0\n0\n0\n0\n6\n0\n0\n0\n0\n0\n\n\n8\n0\n1\n267\n10\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n9\n2\n0\n0\n0\n0\n22\n15\n20\n0\n0\n0\n21\n0\n0\n1\n0\n0\n0\n\n\n10\n0\n0\n0\n0\n1\n0\n0\n0\n0\n2\n37\n0\n0\n131\n0\n0\n0\n0\n\n\n11\n0\n0\n21\n49\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n27\n0\n0\n179\n0\n3\n2\n1\n0\n0\n0\n4\n14\n0\n10\n0\n0\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n28\n\n\n14\n0\n155\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n2\n3\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: cellTypist - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n\n1\n0\n0\n369\n243\n292\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n74\n0\n\n\n2\n474\n89\n0\n0\n0\n258\n0\n2\n0\n0\n0\n111\n0\n8\n0\n1\n0\n\n\n3\n0\n45\n0\n0\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n76\n0\n0\n\n\n5\n2\n260\n0\n0\n0\n2\n0\n42\n0\n0\n0\n3\n0\n0\n0\n0\n0\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n0\n0\n4\n138\n0\n0\n0\n0\n0\n0\n\n\n7\n0\n8\n0\n0\n0\n0\n0\n55\n19\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n0\n0\n0\n0\n0\n263\n0\n16\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n5\n2\n0\n0\n0\n5\n0\n1\n0\n0\n0\n2\n0\n66\n0\n0\n0\n\n\n10\n0\n0\n0\n78\n2\n0\n0\n0\n0\n0\n0\n0\n91\n0\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n0\n5\n0\n65\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n11\n0\n0\n0\n6\n0\n143\n78\n0\n0\n0\n0\n2\n0\n0\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n28\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n154\n1\n0\n0\n0\n0\n0\n0\n\n\n15\n0\n6\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: cellTypist - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n\n\n1\n1\n353\n261\n1\n2\n0\n1\n183\n0\n4\n0\n152\n0\n1\n19\n1\n0\n0\n0\n0\n\n\n2\n43\n0\n0\n278\n0\n227\n187\n0\n180\n0\n0\n0\n0\n0\n0\n0\n9\n16\n0\n3\n\n\n3\n4\n0\n0\n9\n1\n0\n0\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n31\n0\n0\n\n\n4\n0\n0\n5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n73\n0\n0\n0\n0\n0\n\n\n5\n279\n0\n0\n11\n4\n9\n2\n0\n3\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n142\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n7\n55\n0\n0\n0\n26\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n0\n0\n0\n1\n0\n0\n0\n0\n152\n1\n0\n0\n125\n0\n0\n0\n0\n0\n0\n\n\n9\n1\n0\n0\n1\n1\n3\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n72\n0\n0\n2\n\n\n10\n0\n0\n86\n0\n0\n0\n0\n4\n0\n0\n0\n0\n0\n0\n0\n81\n0\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n65\n0\n0\n0\n0\n5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n45\n0\n0\n1\n173\n1\n0\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n17\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n28\n0\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n9\n0\n145\n0\n0\n0\n0\n0\n0\n1\n\n\n15\n0\n0\n0\n0\n3\n0\n0\n0\n0\n0\n0\n0\n3\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: cellTypist - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n...\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n\n1\n0\n0\n351\n267\n0\n229\n0\n0\n0\n0\n...\n0\n3\n0\n1\n88\n0\n0\n40\n0\n0\n\n\n2\n423\n119\n0\n0\n238\n0\n154\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n7\n0\n1\n0\n\n\n3\n1\n15\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n31\n0\n\n\n4\n0\n0\n0\n4\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n74\n0\n0\n0\n0\n\n\n5\n0\n258\n0\n0\n0\n0\n1\n0\n1\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n2\n0\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n142\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n7\n0\n4\n0\n0\n0\n0\n0\n0\n13\n0\n...\n0\n0\n12\n1\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n0\n0\n0\n0\n0\n0\n151\n0\n0\n...\n0\n0\n5\n123\n0\n0\n0\n0\n0\n0\n\n\n9\n10\n2\n0\n0\n11\n0\n11\n0\n1\n0\n...\n0\n0\n0\n0\n0\n0\n46\n0\n0\n0\n\n\n10\n0\n0\n0\n38\n0\n0\n0\n0\n0\n0\n...\n0\n130\n0\n0\n3\n0\n0\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n0\n0\n4\n0\n0\n...\n0\n0\n66\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n1\n3\n0\n0\n4\n0\n0\n0\n138\n0\n...\n0\n0\n44\n0\n0\n0\n2\n0\n1\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n1\n0\n0\n0\n27\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n153\n...\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n15\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n5\n0\n0\n0\n\n\n\n\n15 rows × 21 columns\n\n\n\n'PBMC1 - contingency_matrix (rows: cellTypist - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n\n\n\n\n1\n35\n0\n11\n648\n284\n0\n0\n0\n0\n0\n1\n0\n0\n0\n\n\n2\n0\n0\n0\n0\n0\n0\n0\n0\n7\n0\n0\n0\n807\n129\n\n\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n37\n2\n8\n\n\n4\n0\n73\n2\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n308\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n142\n0\n0\n0\n0\n0\n0\n\n\n7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n25\n1\n0\n0\n56\n\n\n8\n0\n0\n0\n0\n0\n0\n0\n0\n55\n4\n220\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n0\n34\n1\n0\n0\n45\n1\n\n\n10\n0\n1\n146\n23\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n\n\n11\n0\n0\n0\n0\n0\n0\n0\n0\n2\n67\n1\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n3\n175\n0\n1\n5\n56\n\n\n13\n0\n1\n0\n0\n0\n27\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n14\n0\n0\n0\n0\n0\n0\n152\n3\n0\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n0\n2\n0\n0\n0\n4\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n\nprint_clustering_data(tuning = 'celltypist',dataset=\"PBMC2\")\n\n'Initial COTAN cluster number:'\n\n\n17\n\n\n'Initial monocle cluster number:'\n\n\n17\n\n\n'Initial scanpy cluster number:'\n\n\n18\n\n\n'Initial scvi-tools cluster number:'\n\n\n20\n\n\n'Initial seurat cluster number:'\n\n\n19\n\n\n'PBMC2 - contingency_matrix (rows: cellTypist - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\n1\n1\n0\n0\n1\n0\n5\n0\n55\n0\n0\n12\n38\n6\n90\n1\n0\n0\n22\n\n\n2\n0\n0\n0\n0\n0\n279\n0\n6\n22\n0\n53\n22\n24\n1\n19\n0\n0\n1\n\n\n3\n0\n1\n332\n1\n407\n130\n338\n27\n297\n36\n202\n95\n99\n38\n132\n0\n0\n7\n\n\n4\n577\n1\n0\n6\n0\n0\n0\n2\n0\n0\n0\n2\n2\n42\n0\n0\n0\n75\n\n\n5\n1\n0\n0\n0\n0\n15\n0\n258\n0\n0\n9\n9\n2\n13\n0\n0\n0\n9\n\n\n6\n0\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n77\n0\n\n\n7\n0\n566\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n0\n142\n0\n32\n4\n69\n4\n11\n292\n24\n59\n4\n2\n31\n0\n0\n0\n\n\n9\n0\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n173\n0\n0\n\n\n10\n43\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n5\n0\n0\n0\n3\n\n\n11\n0\n0\n0\n228\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n204\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n48\n0\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n14\n0\n\n\n15\n0\n0\n0\n0\n0\n4\n0\n1\n3\n0\n0\n0\n66\n3\n3\n0\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n6\n0\n\n\n\n\n\n\n\n'PBMC2 - contingency_matrix (rows: cellTypist - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n\n\n1\n0\n0\n0\n0\n0\n1\n0\n2\n1\n0\n15\n2\n57\n5\n0\n148\n0\n0\n0\n0\n\n\n2\n0\n0\n0\n0\n0\n0\n131\n200\n35\n2\n2\n0\n1\n55\n0\n1\n0\n0\n0\n0\n\n\n3\n21\n575\n490\n0\n0\n0\n230\n107\n248\n286\n10\n2\n48\n98\n0\n26\n0\n0\n0\n1\n\n\n4\n0\n0\n0\n0\n471\n8\n0\n1\n0\n0\n2\n222\n0\n0\n0\n2\n1\n0\n0\n0\n\n\n5\n0\n0\n0\n0\n0\n0\n1\n1\n0\n0\n253\n0\n3\n52\n0\n6\n0\n0\n0\n0\n\n\n6\n0\n0\n0\n5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n88\n0\n0\n\n\n7\n0\n0\n0\n464\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n15\n0\n88\n0\n0\n0\n\n\n8\n558\n2\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n112\n1\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n174\n0\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n50\n0\n2\n0\n0\n0\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n228\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n204\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n48\n0\n\n\n14\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n13\n\n\n15\n0\n0\n0\n0\n0\n0\n10\n44\n17\n1\n1\n1\n2\n3\n0\n1\n0\n0\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n1\n5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC2 - contingency_matrix (rows: cellTypist - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n\n1\n0\n0\n0\n0\n1\n0\n217\n0\n0\n0\n7\n0\n3\n0\n3\n0\n0\n0\n0\n\n\n2\n348\n2\n0\n0\n0\n4\n7\n0\n2\n3\n60\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n3\n469\n4\n1\n15\n1\n412\n69\n356\n324\n322\n165\n0\n4\n0\n0\n0\n0\n0\n0\n\n\n4\n1\n667\n1\n0\n8\n0\n6\n0\n0\n0\n0\n0\n0\n0\n1\n23\n0\n0\n0\n\n\n5\n10\n2\n0\n0\n0\n0\n7\n0\n1\n0\n65\n0\n159\n0\n72\n0\n0\n0\n0\n\n\n6\n0\n0\n9\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n80\n0\n0\n4\n0\n0\n\n\n7\n0\n0\n556\n0\n0\n0\n0\n0\n0\n0\n0\n2\n0\n0\n0\n0\n0\n0\n9\n\n\n8\n1\n0\n1\n561\n0\n2\n99\n1\n2\n2\n5\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n13\n0\n0\n0\n0\n0\n0\n0\n0\n173\n0\n0\n0\n0\n0\n0\n0\n\n\n10\n0\n5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n47\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n228\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n204\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n48\n0\n0\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n14\n0\n\n\n15\n61\n0\n0\n0\n0\n3\n2\n1\n1\n3\n9\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n6\n0\n\n\n\n\n\n\n\n'PBMC2 - contingency_matrix (rows: cellTypist - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n\n\n1\n2\n0\n0\n0\n0\n0\n0\n0\n7\n1\n0\n1\n41\n178\n0\n0\n1\n0\n0\n0\n\n\n2\n389\n0\n0\n0\n0\n0\n0\n1\n10\n3\n0\n23\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n3\n259\n0\n578\n568\n15\n0\n1\n290\n188\n0\n2\n169\n62\n8\n0\n0\n2\n0\n0\n0\n\n\n4\n0\n635\n0\n0\n0\n0\n7\n0\n2\n0\n0\n0\n0\n3\n0\n1\n59\n0\n0\n0\n\n\n5\n8\n0\n0\n0\n0\n0\n0\n0\n1\n268\n0\n32\n1\n6\n0\n0\n0\n0\n0\n0\n\n\n6\n0\n0\n0\n0\n0\n11\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n82\n0\n0\n\n\n7\n0\n0\n0\n0\n0\n305\n0\n0\n0\n0\n262\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n8\n1\n0\n8\n0\n541\n0\n0\n0\n1\n0\n0\n3\n119\n1\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n8\n0\n0\n0\n0\n6\n0\n0\n0\n172\n0\n0\n0\n0\n0\n\n\n10\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n50\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n0\n83\n0\n0\n0\n0\n0\n0\n0\n0\n145\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n201\n0\n0\n1\n0\n0\n0\n0\n0\n2\n0\n0\n0\n0\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n48\n0\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n14\n\n\n15\n1\n0\n0\n0\n0\n0\n0\n0\n76\n0\n0\n0\n0\n2\n0\n0\n1\n0\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n6\n\n\n\n\n\n\n\n'PBMC2 - contingency_matrix (rows: cellTypist - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n\n1\n0\n0\n0\n3\n4\n220\n3\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n2\n0\n0\n0\n416\n9\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n3\n0\n2\n1186\n847\n31\n72\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n\n\n4\n639\n56\n0\n0\n2\n3\n0\n0\n0\n0\n0\n0\n0\n0\n1\n5\n1\n\n\n5\n0\n0\n0\n39\n0\n7\n270\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n0\n0\n86\n0\n7\n0\n0\n0\n0\n0\n\n\n7\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n88\n300\n174\n0\n0\n3\n1\n\n\n8\n0\n0\n568\n9\n1\n96\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n154\n24\n0\n0\n8\n0\n0\n0\n0\n0\n\n\n10\n1\n51\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n145\n69\n14\n\n\n12\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n22\n180\n\n\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n48\n0\n0\n0\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n13\n1\n\n\n15\n0\n1\n0\n6\n72\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n16\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n1\n0\n3\n0\n0\n0\n0\n\n\n\n\n\n\n\n\nprint_clustering_data(tuning = 'celltypist',dataset=\"PBMC3\")\n\n'Initial COTAN cluster number:'\n\n\n21\n\n\n'Initial monocle cluster number:'\n\n\n21\n\n\n'Initial scanpy cluster number:'\n\n\n17\n\n\n'Initial scvi-tools cluster number:'\n\n\n18\n\n\n'Initial seurat cluster number:'\n\n\n20\n\n\n'PBMC3 - contingency_matrix (rows: cellTypist - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n\n\n\n\n1\n860\n0\n0\n0\n38\n559\n313\n338\n231\n324\n158\n0\n195\n0\n0\n5\n0\n\n\n2\n0\n1041\n0\n0\n0\n0\n1\n0\n0\n0\n0\n390\n0\n2\n7\n0\n31\n\n\n3\n0\n0\n0\n654\n0\n0\n2\n2\n1\n0\n0\n0\n1\n0\n0\n0\n2\n\n\n4\n400\n0\n0\n0\n12\n309\n29\n47\n12\n157\n78\n0\n56\n0\n0\n0\n0\n\n\n5\n0\n22\n1036\n33\n22\n0\n0\n0\n0\n0\n3\n2\n1\n0\n2\n121\n0\n\n\n6\n0\n11\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n144\n0\n0\n\n\n7\n0\n0\n0\n0\n134\n1\n247\n305\n248\n0\n135\n1\n42\n0\n0\n0\n0\n\n\n8\n0\n0\n3\n0\n435\n0\n3\n7\n0\n0\n12\n0\n20\n0\n0\n4\n0\n\n\n9\n0\n0\n0\n396\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n10\n0\n73\n0\n0\n0\n0\n0\n0\n0\n0\n0\n4\n0\n328\n2\n0\n1\n\n\n11\n0\n0\n8\n0\n277\n2\n21\n26\n1\n0\n47\n0\n46\n0\n0\n2\n0\n\n\n12\n0\n0\n0\n8\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n13\n11\n0\n0\n0\n0\n8\n157\n9\n19\n1\n7\n0\n21\n0\n0\n0\n0\n\n\n14\n0\n0\n79\n0\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n19\n0\n\n\n15\n1\n0\n0\n0\n0\n0\n0\n3\n0\n0\n0\n0\n0\n0\n16\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n11\n0\n0\n0\n0\n0\n\n\n17\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n8\n0\n0\n\n\n18\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n57\n0\n0\n\n\n19\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n12\n0\n0\n\n\n\n\n\n\n\n'PBMC3 - contingency_matrix (rows: cellTypist - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\n1\n1670\n0\n0\n212\n0\n32\n234\n621\n23\n228\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n2\n0\n1228\n0\n0\n0\n0\n0\n0\n0\n0\n2\n202\n0\n0\n5\n0\n35\n0\n\n\n3\n0\n0\n0\n0\n543\n0\n5\n0\n0\n1\n0\n0\n0\n111\n0\n0\n2\n0\n\n\n4\n29\n0\n0\n0\n0\n811\n192\n5\n4\n59\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n5\n0\n0\n1028\n0\n0\n0\n0\n0\n7\n0\n0\n29\n145\n33\n0\n0\n0\n0\n\n\n6\n0\n7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n149\n0\n0\n0\n\n\n7\n1\n0\n0\n702\n0\n0\n230\n99\n7\n73\n0\n1\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n0\n3\n0\n0\n0\n47\n0\n433\n0\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n395\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n\n\n10\n0\n94\n0\n0\n0\n0\n0\n0\n0\n0\n311\n1\n0\n0\n1\n0\n1\n0\n\n\n11\n0\n0\n2\n0\n0\n0\n116\n0\n290\n21\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n8\n0\n0\n0\n0\n\n\n13\n16\n0\n0\n44\n0\n0\n10\n55\n1\n107\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n14\n0\n0\n11\n0\n0\n0\n4\n0\n5\n1\n0\n0\n90\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n20\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n11\n0\n0\n0\n0\n0\n0\n\n\n17\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n8\n0\n0\n0\n\n\n18\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n57\n0\n0\n\n\n19\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n12\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC3 - contingency_matrix (rows: cellTypist - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n20\n\n\n\n\n1\n2\n657\n1415\n2\n2\n43\n614\n91\n5\n0\n64\n0\n14\n49\n0\n0\n32\n31\n0\n0\n\n\n2\n1463\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n8\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n3\n4\n0\n1\n0\n654\n0\n2\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n6\n13\n1\n0\n856\n4\n168\n0\n0\n0\n0\n0\n52\n0\n0\n0\n0\n0\n0\n\n\n5\n29\n0\n0\n1172\n32\n0\n0\n2\n0\n0\n1\n0\n0\n0\n5\n0\n0\n0\n1\n0\n\n\n6\n9\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n147\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n7\n1\n827\n5\n0\n0\n1\n187\n35\n22\n0\n0\n0\n24\n8\n0\n0\n1\n2\n0\n0\n\n\n8\n0\n30\n0\n2\n0\n1\n3\n12\n305\n0\n131\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n396\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n10\n83\n0\n0\n0\n0\n0\n0\n0\n0\n324\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n11\n0\n15\n0\n2\n1\n3\n1\n399\n3\n0\n5\n0\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n8\n\n\n13\n0\n49\n21\n0\n0\n0\n22\n6\n0\n0\n0\n0\n131\n2\n0\n0\n2\n0\n0\n0\n\n\n14\n0\n0\n0\n31\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n80\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n20\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n11\n0\n0\n0\n0\n\n\n17\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n8\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n18\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n5\n0\n0\n0\n52\n0\n0\n0\n0\n\n\n19\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC3 - contingency_matrix (rows: cellTypist - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\n1\n1744\n412\n0\n0\n681\n20\n161\n0\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n2\n0\n0\n1011\n0\n0\n0\n0\n0\n0\n0\n0\n227\n0\n231\n3\n0\n0\n0\n\n\n3\n0\n0\n0\n0\n0\n0\n2\n535\n0\n2\n0\n1\n2\n0\n0\n120\n0\n0\n\n\n4\n16\n6\n0\n0\n3\n886\n188\n0\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n\n\n5\n0\n1\n4\n1043\n0\n0\n2\n1\n1\n0\n0\n24\n136\n0\n0\n30\n0\n0\n\n\n6\n0\n0\n7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n149\n0\n0\n0\n\n\n7\n0\n995\n0\n0\n93\n0\n18\n0\n7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n18\n0\n3\n0\n0\n8\n0\n454\n0\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n57\n0\n336\n0\n0\n0\n0\n0\n3\n0\n0\n\n\n10\n0\n0\n89\n0\n0\n0\n0\n0\n0\n0\n314\n1\n0\n4\n0\n0\n0\n0\n\n\n11\n0\n14\n0\n0\n0\n2\n411\n0\n3\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n7\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n\n\n13\n13\n8\n0\n0\n205\n0\n7\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n14\n0\n0\n0\n2\n0\n0\n0\n0\n0\n0\n0\n0\n109\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n20\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n11\n\n\n17\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n8\n0\n0\n0\n\n\n18\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n5\n0\n52\n0\n\n\n19\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n12\n\n\n\n\n\n\n\n'PBMC3 - contingency_matrix (rows: cellTypist - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n...\n12\n13\n14\n15\n16\n17\n18\n19\n20\n21\n\n\n\n\n1\n205\n1805\n252\n548\n154\n55\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n2\n0\n\n\n2\n0\n0\n0\n0\n0\n0\n0\n0\n2\n3\n...\n177\n274\n220\n795\n0\n0\n0\n1\n0\n0\n\n\n3\n0\n0\n2\n0\n0\n2\n0\n2\n0\n0\n...\n0\n0\n0\n1\n67\n107\n225\n256\n0\n0\n\n\n4\n89\n823\n9\n6\n20\n153\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n5\n1\n0\n1\n1\n0\n1\n1029\n138\n30\n0\n...\n2\n1\n1\n5\n3\n26\n3\n0\n0\n0\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n0\n0\n146\n...\n0\n0\n8\n2\n0\n0\n0\n0\n0\n0\n\n\n7\n26\n0\n977\n61\n27\n21\n0\n1\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n0\n9\n1\n0\n469\n3\n2\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n2\n379\n15\n0\n0\n\n\n10\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n40\n5\n119\n27\n0\n0\n0\n0\n0\n0\n\n\n11\n9\n1\n7\n1\n8\n357\n1\n14\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n32\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n8\n0\n\n\n13\n4\n5\n4\n204\n6\n0\n0\n10\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n14\n1\n0\n1\n0\n0\n0\n92\n17\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n0\n0\n4\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n16\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n11\n0\n\n\n17\n0\n0\n0\n0\n0\n0\n0\n0\n0\n8\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n18\n0\n0\n0\n0\n0\n0\n0\n0\n0\n5\n...\n0\n0\n0\n0\n0\n0\n0\n0\n0\n52\n\n\n19\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n...\n0\n0\n0\n0\n0\n0\n0\n0\n11\n0\n\n\n\n\n19 rows × 21 columns\n\n\n\n\nprint_clustering_data(tuning = 'celltypist',dataset=\"PBMC4\")\n\n'Initial COTAN cluster number:'\n\n\n19\n\n\n'Initial monocle cluster number:'\n\n\n21\n\n\n'Initial scanpy cluster number:'\n\n\n16\n\n\n'Initial scvi-tools cluster number:'\n\n\n18\n\n\n'Initial seurat cluster number:'\n\n\n18\n\n\n'PBMC4 - contingency_matrix (rows: cellTypist - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n\n\n\n\n1\n0\n0\n9\n0\n0\n0\n0\n12\n0\n385\n1\n0\n0\n0\n0\n0\n\n\n2\n756\n2\n1\n0\n0\n0\n0\n2\n0\n3\n3\n0\n0\n0\n0\n41\n\n\n3\n0\n707\n149\n0\n0\n0\n379\n0\n3\n0\n93\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n1\n0\n0\n0\n0\n98\n0\n8\n1\n0\n0\n0\n0\n0\n\n\n5\n5\n2\n2\n648\n642\n406\n0\n1\n422\n3\n2\n3\n35\n0\n29\n0\n\n\n6\n0\n196\n83\n0\n0\n0\n19\n1\n0\n0\n9\n0\n0\n0\n0\n0\n\n\n7\n0\n0\n51\n0\n0\n0\n0\n9\n0\n15\n2\n0\n0\n0\n0\n0\n\n\n8\n0\n2\n417\n0\n0\n0\n77\n0\n0\n5\n37\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n351\n1\n3\n4\n0\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n2\n3\n76\n0\n0\n5\n0\n0\n219\n2\n0\n0\n0\n\n\n11\n220\n0\n0\n0\n0\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n2\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n28\n0\n\n\n13\n1\n2\n2\n0\n0\n0\n0\n0\n0\n4\n0\n0\n0\n4\n0\n0\n\n\n14\n0\n4\n4\n0\n0\n0\n1\n0\n0\n0\n97\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n11\n5\n0\n0\n0\n1\n0\n0\n1\n72\n3\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n59\n0\n0\n\n\n\n\n\n\n\n'PBMC4 - contingency_matrix (rows: cellTypist - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\n1\n0\n10\n0\n0\n0\n0\n385\n5\n1\n0\n0\n0\n0\n1\n5\n0\n0\n0\n\n\n2\n0\n0\n0\n673\n0\n0\n0\n0\n1\n134\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n3\n0\n346\n0\n0\n509\n387\n1\n10\n0\n0\n0\n0\n0\n0\n0\n78\n0\n0\n\n\n4\n0\n0\n0\n0\n0\n0\n6\n7\n10\n0\n0\n0\n0\n0\n85\n0\n0\n0\n\n\n5\n928\n1\n822\n0\n0\n0\n0\n0\n0\n0\n1\n181\n78\n142\n0\n0\n47\n0\n\n\n6\n0\n7\n0\n0\n5\n2\n0\n286\n0\n0\n0\n0\n0\n0\n0\n8\n0\n0\n\n\n7\n0\n3\n0\n0\n0\n0\n1\n67\n0\n0\n0\n0\n0\n0\n6\n0\n0\n0\n\n\n8\n0\n483\n0\n0\n8\n43\n1\n2\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n\n\n9\n0\n1\n0\n0\n0\n0\n5\n0\n348\n0\n0\n0\n0\n0\n5\n0\n0\n0\n\n\n10\n74\n0\n2\n0\n0\n0\n0\n0\n0\n0\n216\n10\n2\n2\n0\n0\n1\n0\n\n\n11\n0\n0\n0\n46\n0\n0\n0\n0\n0\n177\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n28\n0\n\n\n13\n0\n13\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n14\n0\n68\n0\n0\n1\n22\n1\n2\n0\n0\n0\n0\n0\n0\n0\n12\n0\n0\n\n\n15\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n2\n89\n2\n0\n0\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n59\n\n\n\n\n\n\n\n'PBMC4 - contingency_matrix (rows: cellTypist - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n\n\n\n\n1\n3\n0\n0\n0\n0\n0\n0\n0\n313\n0\n0\n1\n0\n0\n88\n2\n0\n0\n\n\n2\n1\n1\n0\n0\n687\n0\n1\n1\n10\n0\n104\n2\n0\n0\n0\n1\n0\n0\n\n\n3\n439\n840\n1\n0\n0\n0\n0\n21\n0\n0\n0\n0\n30\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n0\n0\n0\n0\n7\n1\n0\n0\n0\n100\n0\n0\n0\n0\n0\n0\n\n\n5\n1\n1\n776\n699\n2\n508\n15\n0\n0\n65\n2\n1\n0\n24\n2\n84\n0\n20\n\n\n6\n10\n8\n0\n0\n0\n0\n0\n287\n1\n0\n0\n1\n1\n0\n0\n0\n0\n0\n\n\n7\n5\n0\n0\n0\n0\n0\n0\n33\n5\n0\n0\n34\n0\n0\n0\n0\n0\n0\n\n\n8\n507\n15\n0\n0\n0\n0\n1\n3\n2\n0\n0\n0\n10\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n358\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n\n\n10\n0\n0\n13\n1\n0\n27\n0\n0\n0\n265\n0\n0\n0\n0\n0\n1\n0\n0\n\n\n11\n0\n0\n0\n0\n5\n0\n0\n0\n0\n0\n219\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n28\n\n\n13\n6\n0\n0\n0\n0\n0\n0\n6\n1\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n14\n16\n5\n0\n0\n0\n0\n0\n0\n0\n0\n0\n4\n81\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n2\n0\n0\n1\n1\n0\n0\n0\n0\n0\n0\n89\n0\n0\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n57\n0\n\n\n\n\n\n\n\n'PBMC4 - contingency_matrix (rows: cellTypist - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n\n1\n5\n0\n0\n0\n0\n0\n398\n0\n0\n4\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n2\n0\n0\n0\n0\n632\n0\n1\n0\n122\n1\n0\n0\n0\n0\n0\n0\n0\n52\n0\n\n\n3\n361\n843\n0\n0\n0\n0\n0\n0\n0\n2\n122\n0\n3\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n0\n0\n0\n0\n0\n1\n0\n107\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n5\n2\n0\n771\n732\n0\n447\n2\n0\n2\n0\n1\n1\n0\n136\n28\n35\n0\n0\n43\n\n\n6\n31\n15\n0\n0\n0\n0\n0\n0\n0\n68\n5\n0\n189\n0\n0\n0\n0\n0\n0\n\n\n7\n3\n0\n0\n0\n0\n0\n3\n0\n0\n69\n2\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n8\n525\n0\n0\n0\n0\n0\n1\n0\n0\n2\n10\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n3\n354\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n7\n0\n86\n0\n0\n0\n0\n0\n213\n0\n1\n0\n0\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n1\n0\n0\n0\n223\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n28\n0\n0\n0\n\n\n13\n10\n0\n0\n0\n0\n0\n0\n1\n0\n0\n0\n0\n0\n0\n1\n0\n0\n1\n0\n\n\n14\n4\n0\n0\n0\n0\n0\n0\n0\n0\n1\n101\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n15\n0\n0\n0\n1\n0\n1\n0\n0\n0\n0\n0\n0\n0\n0\n90\n0\n0\n0\n1\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n59\n0\n0\n\n\n\n\n\n\n\n'PBMC4 - contingency_matrix (rows: cellTypist - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n12\n13\n14\n15\n16\n17\n18\n19\n\n\n\n\n1\n0\n0\n0\n0\n0\n0\n0\n0\n1\n402\n4\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n2\n0\n0\n0\n0\n0\n0\n0\n0\n1\n1\n0\n1\n45\n2\n24\n320\n414\n0\n0\n\n\n3\n0\n0\n0\n0\n0\n0\n0\n1\n0\n0\n367\n963\n0\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n0\n0\n0\n0\n0\n0\n105\n0\n3\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n5\n40\n131\n724\n531\n741\n1\n27\n0\n0\n2\n1\n0\n0\n0\n0\n1\n1\n0\n0\n\n\n6\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n99\n209\n0\n0\n0\n0\n0\n0\n0\n\n\n7\n0\n0\n0\n0\n0\n0\n0\n0\n3\n4\n70\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n8\n0\n0\n0\n0\n0\n0\n0\n0\n0\n1\n530\n7\n0\n0\n0\n0\n0\n0\n0\n\n\n9\n0\n0\n0\n0\n0\n0\n0\n91\n265\n1\n2\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n10\n0\n1\n6\n83\n2\n215\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n11\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n24\n141\n58\n1\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n28\n\n\n13\n0\n0\n0\n0\n0\n0\n1\n8\n0\n0\n1\n1\n1\n0\n1\n0\n0\n0\n0\n\n\n14\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n105\n1\n0\n0\n0\n0\n0\n0\n0\n\n\n15\n1\n0\n1\n1\n0\n0\n90\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n\n\n16\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n0\n59\n0\n\n\n\n\n\n\n\n\n\nAgainst antibody cluster number\n\nprint_clustering_data(tuning = 'antibody',dataset=\"PBMC1\")\n\n'Initial COTAN cluster number:'\n\n\n11\n\n\n'Initial monocle cluster number:'\n\n\n11\n\n\n'Initial scanpy cluster number:'\n\n\n9\n\n\n'Initial scvi-tools cluster number:'\n\n\n11\n\n\n'Initial seurat cluster number:'\n\n\n10\n\n\n'Initial antibody cell/cluster table:'\n\n\ncluster.ids\n7     1338\n8      876\n3      748\n4      341\n9      331\n5      211\n1      202\n6      131\n2       62\n10      51\n12      16\nName: count, dtype: int64\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n\n1\n94\n0\n17\n50\n0\n0\n0\n0\n0\n\n\n2\n0\n4\n0\n0\n3\n0\n38\n1\n0\n\n\n3\n35\n0\n500\n65\n0\n0\n0\n0\n0\n\n\n4\n0\n1\n0\n262\n0\n0\n0\n0\n0\n\n\n5\n2\n0\n29\n127\n0\n0\n0\n0\n0\n\n\n6\n0\n1\n0\n0\n0\n1\n1\n58\n26\n\n\n7\n2\n731\n0\n4\n0\n275\n95\n17\n1\n\n\n8\n776\n0\n30\n6\n1\n0\n0\n0\n1\n\n\n9\n0\n0\n0\n1\n294\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n44\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n10\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n\n1\n22\n0\n7\n60\n0\n0\n0\n0\n0\n0\n72\n\n\n2\n0\n0\n0\n0\n5\n0\n2\n1\n0\n38\n0\n\n\n3\n67\n0\n408\n125\n0\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n1\n0\n13\n0\n249\n0\n0\n0\n0\n0\n\n\n5\n2\n0\n10\n146\n0\n0\n0\n0\n0\n0\n0\n\n\n6\n3\n0\n1\n0\n0\n0\n0\n0\n82\n1\n0\n\n\n7\n2\n702\n1\n0\n348\n0\n0\n0\n20\n52\n0\n\n\n8\n780\n0\n21\n6\n0\n1\n1\n0\n1\n0\n4\n\n\n9\n0\n0\n0\n1\n0\n1\n156\n137\n0\n0\n0\n\n\n10\n0\n0\n0\n37\n0\n7\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n10\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n\n1\n28\n0\n0\n22\n0\n1\n36\n0\n74\n0\n\n\n2\n0\n3\n42\n0\n1\n0\n0\n0\n0\n0\n\n\n3\n123\n0\n0\n434\n0\n0\n43\n0\n0\n0\n\n\n4\n0\n1\n0\n0\n0\n259\n3\n0\n0\n0\n\n\n5\n0\n0\n0\n17\n0\n0\n138\n0\n3\n0\n\n\n6\n0\n1\n1\n0\n0\n0\n0\n56\n3\n26\n\n\n7\n1\n644\n451\n0\n0\n1\n0\n27\n0\n1\n\n\n8\n786\n0\n0\n19\n1\n2\n3\n0\n2\n1\n\n\n9\n0\n0\n0\n0\n294\n1\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n1\n0\n9\n34\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n10\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n\n1\n93\n14\n0\n0\n0\n54\n0\n0\n0\n0\n0\n\n\n2\n0\n0\n1\n4\n0\n0\n1\n1\n39\n0\n0\n\n\n3\n22\n536\n0\n0\n0\n42\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n1\n0\n261\n1\n0\n0\n0\n0\n0\n\n\n5\n1\n18\n0\n0\n0\n139\n0\n0\n0\n0\n0\n\n\n6\n3\n1\n0\n1\n0\n0\n0\n0\n1\n56\n25\n\n\n7\n2\n1\n524\n488\n2\n0\n0\n0\n89\n18\n1\n\n\n8\n766\n40\n0\n0\n1\n5\n1\n0\n0\n0\n1\n\n\n9\n0\n0\n0\n0\n2\n0\n151\n142\n0\n0\n0\n\n\n10\n0\n0\n0\n0\n8\n36\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n8\n2\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n\n1\n0\n0\n0\n0\n0\n0\n0\n36\n54\n12\n59\n\n\n2\n1\n1\n40\n2\n0\n0\n2\n0\n0\n0\n0\n\n\n3\n0\n0\n0\n0\n0\n0\n0\n0\n39\n528\n33\n\n\n4\n1\n0\n0\n0\n0\n0\n0\n48\n214\n0\n0\n\n\n5\n0\n0\n0\n0\n0\n0\n0\n1\n135\n22\n0\n\n\n6\n0\n56\n1\n1\n1\n25\n0\n3\n0\n0\n0\n\n\n7\n33\n17\n118\n668\n284\n1\n0\n0\n1\n1\n2\n\n\n8\n0\n0\n0\n0\n0\n1\n1\n9\n4\n34\n765\n\n\n9\n0\n0\n0\n0\n0\n0\n293\n0\n2\n0\n0\n\n\n10\n0\n0\n0\n0\n0\n0\n0\n4\n40\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n4\n6\n0\n0\n\n\n\n\n\n\n\n\nprint_clustering_data(tuning = 'antibody',dataset=\"PBMC1\")\n\n'Initial COTAN cluster number:'\n\n\n11\n\n\n'Initial monocle cluster number:'\n\n\n11\n\n\n'Initial scanpy cluster number:'\n\n\n9\n\n\n'Initial scvi-tools cluster number:'\n\n\n11\n\n\n'Initial seurat cluster number:'\n\n\n10\n\n\n'Initial antibody cell/cluster table:'\n\n\ncluster.ids\n7     1338\n8      876\n3      748\n4      341\n9      331\n5      211\n1      202\n6      131\n2       62\n10      51\n12      16\nName: count, dtype: int64\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n\n1\n94\n0\n17\n50\n0\n0\n0\n0\n0\n\n\n2\n0\n4\n0\n0\n3\n0\n38\n1\n0\n\n\n3\n35\n0\n500\n65\n0\n0\n0\n0\n0\n\n\n4\n0\n1\n0\n262\n0\n0\n0\n0\n0\n\n\n5\n2\n0\n29\n127\n0\n0\n0\n0\n0\n\n\n6\n0\n1\n0\n0\n0\n1\n1\n58\n26\n\n\n7\n2\n731\n0\n4\n0\n275\n95\n17\n1\n\n\n8\n776\n0\n30\n6\n1\n0\n0\n0\n1\n\n\n9\n0\n0\n0\n1\n294\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n44\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n10\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n\n1\n22\n0\n7\n60\n0\n0\n0\n0\n0\n0\n72\n\n\n2\n0\n0\n0\n0\n5\n0\n2\n1\n0\n38\n0\n\n\n3\n67\n0\n408\n125\n0\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n1\n0\n13\n0\n249\n0\n0\n0\n0\n0\n\n\n5\n2\n0\n10\n146\n0\n0\n0\n0\n0\n0\n0\n\n\n6\n3\n0\n1\n0\n0\n0\n0\n0\n82\n1\n0\n\n\n7\n2\n702\n1\n0\n348\n0\n0\n0\n20\n52\n0\n\n\n8\n780\n0\n21\n6\n0\n1\n1\n0\n1\n0\n4\n\n\n9\n0\n0\n0\n1\n0\n1\n156\n137\n0\n0\n0\n\n\n10\n0\n0\n0\n37\n0\n7\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n10\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n\n1\n28\n0\n0\n22\n0\n1\n36\n0\n74\n0\n\n\n2\n0\n3\n42\n0\n1\n0\n0\n0\n0\n0\n\n\n3\n123\n0\n0\n434\n0\n0\n43\n0\n0\n0\n\n\n4\n0\n1\n0\n0\n0\n259\n3\n0\n0\n0\n\n\n5\n0\n0\n0\n17\n0\n0\n138\n0\n3\n0\n\n\n6\n0\n1\n1\n0\n0\n0\n0\n56\n3\n26\n\n\n7\n1\n644\n451\n0\n0\n1\n0\n27\n0\n1\n\n\n8\n786\n0\n0\n19\n1\n2\n3\n0\n2\n1\n\n\n9\n0\n0\n0\n0\n294\n1\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n1\n0\n9\n34\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n10\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n\n1\n93\n14\n0\n0\n0\n54\n0\n0\n0\n0\n0\n\n\n2\n0\n0\n1\n4\n0\n0\n1\n1\n39\n0\n0\n\n\n3\n22\n536\n0\n0\n0\n42\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n1\n0\n261\n1\n0\n0\n0\n0\n0\n\n\n5\n1\n18\n0\n0\n0\n139\n0\n0\n0\n0\n0\n\n\n6\n3\n1\n0\n1\n0\n0\n0\n0\n1\n56\n25\n\n\n7\n2\n1\n524\n488\n2\n0\n0\n0\n89\n18\n1\n\n\n8\n766\n40\n0\n0\n1\n5\n1\n0\n0\n0\n1\n\n\n9\n0\n0\n0\n0\n2\n0\n151\n142\n0\n0\n0\n\n\n10\n0\n0\n0\n0\n8\n36\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n8\n2\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n\n1\n0\n0\n0\n0\n0\n0\n0\n36\n54\n12\n59\n\n\n2\n1\n1\n40\n2\n0\n0\n2\n0\n0\n0\n0\n\n\n3\n0\n0\n0\n0\n0\n0\n0\n0\n39\n528\n33\n\n\n4\n1\n0\n0\n0\n0\n0\n0\n48\n214\n0\n0\n\n\n5\n0\n0\n0\n0\n0\n0\n0\n1\n135\n22\n0\n\n\n6\n0\n56\n1\n1\n1\n25\n0\n3\n0\n0\n0\n\n\n7\n33\n17\n118\n668\n284\n1\n0\n0\n1\n1\n2\n\n\n8\n0\n0\n0\n0\n0\n1\n1\n9\n4\n34\n765\n\n\n9\n0\n0\n0\n0\n0\n0\n293\n0\n2\n0\n0\n\n\n10\n0\n0\n0\n0\n0\n0\n0\n4\n40\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n4\n6\n0\n0\n\n\n\n\n\n\n\n\nprint_clustering_data(tuning = 'antibody',dataset=\"PBMC1\")\n\n'Initial COTAN cluster number:'\n\n\n11\n\n\n'Initial monocle cluster number:'\n\n\n11\n\n\n'Initial scanpy cluster number:'\n\n\n9\n\n\n'Initial scvi-tools cluster number:'\n\n\n11\n\n\n'Initial seurat cluster number:'\n\n\n10\n\n\n'Initial antibody cell/cluster table:'\n\n\ncluster.ids\n7     1338\n8      876\n3      748\n4      341\n9      331\n5      211\n1      202\n6      131\n2       62\n10      51\n12      16\nName: count, dtype: int64\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: monocle)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n\n\n\n\n1\n94\n0\n17\n50\n0\n0\n0\n0\n0\n\n\n2\n0\n4\n0\n0\n3\n0\n38\n1\n0\n\n\n3\n35\n0\n500\n65\n0\n0\n0\n0\n0\n\n\n4\n0\n1\n0\n262\n0\n0\n0\n0\n0\n\n\n5\n2\n0\n29\n127\n0\n0\n0\n0\n0\n\n\n6\n0\n1\n0\n0\n0\n1\n1\n58\n26\n\n\n7\n2\n731\n0\n4\n0\n275\n95\n17\n1\n\n\n8\n776\n0\n30\n6\n1\n0\n0\n0\n1\n\n\n9\n0\n0\n0\n1\n294\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n44\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n10\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: scanpy)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n\n1\n22\n0\n7\n60\n0\n0\n0\n0\n0\n0\n72\n\n\n2\n0\n0\n0\n0\n5\n0\n2\n1\n0\n38\n0\n\n\n3\n67\n0\n408\n125\n0\n0\n0\n0\n0\n0\n0\n\n\n4\n0\n1\n0\n13\n0\n249\n0\n0\n0\n0\n0\n\n\n5\n2\n0\n10\n146\n0\n0\n0\n0\n0\n0\n0\n\n\n6\n3\n0\n1\n0\n0\n0\n0\n0\n82\n1\n0\n\n\n7\n2\n702\n1\n0\n348\n0\n0\n0\n20\n52\n0\n\n\n8\n780\n0\n21\n6\n0\n1\n1\n0\n1\n0\n4\n\n\n9\n0\n0\n0\n1\n0\n1\n156\n137\n0\n0\n0\n\n\n10\n0\n0\n0\n37\n0\n7\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n10\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: scvi-tools)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n\n\n\n\n1\n28\n0\n0\n22\n0\n1\n36\n0\n74\n0\n\n\n2\n0\n3\n42\n0\n1\n0\n0\n0\n0\n0\n\n\n3\n123\n0\n0\n434\n0\n0\n43\n0\n0\n0\n\n\n4\n0\n1\n0\n0\n0\n259\n3\n0\n0\n0\n\n\n5\n0\n0\n0\n17\n0\n0\n138\n0\n3\n0\n\n\n6\n0\n1\n1\n0\n0\n0\n0\n56\n3\n26\n\n\n7\n1\n644\n451\n0\n0\n1\n0\n27\n0\n1\n\n\n8\n786\n0\n0\n19\n1\n2\n3\n0\n2\n1\n\n\n9\n0\n0\n0\n0\n294\n1\n0\n0\n0\n0\n\n\n10\n0\n0\n0\n1\n0\n9\n34\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n10\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: seurat)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n\n1\n93\n14\n0\n0\n0\n54\n0\n0\n0\n0\n0\n\n\n2\n0\n0\n1\n4\n0\n0\n1\n1\n39\n0\n0\n\n\n3\n22\n536\n0\n0\n0\n42\n0\n0\n0\n0\n0\n\n\n4\n0\n0\n1\n0\n261\n1\n0\n0\n0\n0\n0\n\n\n5\n1\n18\n0\n0\n0\n139\n0\n0\n0\n0\n0\n\n\n6\n3\n1\n0\n1\n0\n0\n0\n0\n1\n56\n25\n\n\n7\n2\n1\n524\n488\n2\n0\n0\n0\n89\n18\n1\n\n\n8\n766\n40\n0\n0\n1\n5\n1\n0\n0\n0\n1\n\n\n9\n0\n0\n0\n0\n2\n0\n151\n142\n0\n0\n0\n\n\n10\n0\n0\n0\n0\n8\n36\n0\n0\n0\n0\n0\n\n\n12\n0\n0\n0\n0\n8\n2\n0\n0\n0\n0\n0\n\n\n\n\n\n\n\n'PBMC1 - contingency_matrix (rows: antibody - cols: COTAN)'\n\n\n\n\n\n\n\n\n\n1\n2\n3\n4\n5\n6\n7\n8\n9\n10\n11\n\n\n\n\n1\n0\n0\n0\n0\n0\n0\n0\n36\n54\n12\n59\n\n\n2\n1\n1\n40\n2\n0\n0\n2\n0\n0\n0\n0\n\n\n3\n0\n0\n0\n0\n0\n0\n0\n0\n39\n528\n33\n\n\n4\n1\n0\n0\n0\n0\n0\n0\n48\n214\n0\n0\n\n\n5\n0\n0\n0\n0\n0\n0\n0\n1\n135\n22\n0\n\n\n6\n0\n56\n1\n1\n1\n25\n0\n3\n0\n0\n0\n\n\n7\n33\n17\n118\n668\n284\n1\n0\n0\n1\n1\n2\n\n\n8\n0\n0\n0\n0\n0\n1\n1\n9\n4\n34\n765\n\n\n9\n0\n0\n0\n0\n0\n0\n293\n0\n2\n0\n0\n\n\n10\n0\n0\n0\n0\n0\n0\n0\n4\n40\n0\n0\n\n\n12\n0\n0\n0\n0\n0\n0\n0\n4\n6\n0\n0",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs clustering comparison"
    ]
  },
  {
    "objectID": "clustering_comparison.html#default-parameters-1",
    "href": "clustering_comparison.html#default-parameters-1",
    "title": "Clustering Comparision",
    "section": "Default parameters",
    "text": "Default parameters\n\nprint_scores(tuning = 'default',dataset=\"PBMC1\")\n\n'PBMC1 - number of clusters'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n3\n18\n13\n11\n14\n\n\n\n\n\n\n\n'PBMC1 - Silhuette (higher is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n0.100032\n0.043761\n0.065534\n0.148254\n0.13383\n\n\n\n\n\n\n\n'PBMC1 - davies_bouldin (lower is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n0.893661\n2.47358\n2.574291\n1.392309\n1.728304\n\n\n\n\n\n\n\n'PBMC1 - default labels'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.578257\n0.384609\n0.410140\n0.979930\n0.602512\n\n\nscanpy\n0.721042\n0.404607\n0.824980\n0.640363\n0.508176\n\n\nscvi-tools\n0.776232\n0.599664\n0.809790\n0.745344\n0.666244\n\n\nseurat\n0.793630\n0.649593\n0.784165\n0.803327\n0.705921\n\n\nCOTAN\n0.787289\n0.670392\n0.803876\n0.771373\n0.723485\n\n\n\n\n\n\n\n                                                \n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.622344\n0.439255\n0.458549\n0.968180\n0.645589\n\n\nscanpy\n0.662480\n0.389320\n0.814398\n0.558329\n0.511739\n\n\nscvi-tools\n0.718265\n0.557951\n0.800919\n0.651075\n0.643426\n\n\nseurat\n0.747924\n0.647338\n0.787235\n0.712353\n0.712527\n\n\nCOTAN\n0.727398\n0.637277\n0.792854\n0.671926\n0.705427\n\n\n\n\n\n\n\n                                                \n\n\n\nprint_scores(tuning = 'default',dataset=\"PBMC2\")\n\n'PBMC2 - number of clusters'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n2\n18\n20\n14\n17\n\n\n\n\n\n\n\n'PBMC2 - Silhuette (higher is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n0.224441\n0.059225\n0.000832\n0.111509\n0.12581\n\n\n\n\n\n\n\n'PBMC2 - davies_bouldin (lower is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n1.866736\n2.073818\n3.935702\n1.630557\n1.855098\n\n\n\n\n\n\n\n'PBMC2 - default labels'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.393166\n0.207180\n0.245998\n0.978626\n0.521364\n\n\nscanpy\n0.718820\n0.457213\n0.804000\n0.649960\n0.556684\n\n\nscvi-tools\n0.699788\n0.424696\n0.785920\n0.630670\n0.525031\n\n\nseurat\n0.775988\n0.562430\n0.819560\n0.736815\n0.640108\n\n\nCOTAN\n0.729355\n0.472800\n0.745550\n0.713848\n0.562480\n\n\n\n\n\n\n\n                                                \n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.261544\n0.093122\n0.154169\n0.861687\n0.457589\n\n\nscanpy\n0.685644\n0.523244\n0.773965\n0.615415\n0.607208\n\n\nscvi-tools\n0.654391\n0.485789\n0.750936\n0.579842\n0.573975\n\n\nseurat\n0.748480\n0.679377\n0.793713\n0.708124\n0.734394\n\n\nCOTAN\n0.703575\n0.633882\n0.697485\n0.709773\n0.704954\n\n\n\n\n\n\n\n                                                \n\n\n\nprint_scores(tuning = 'default',dataset=\"PBMC3\")\n\n'PBMC3 - number of clusters'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n3\n22\n17\n18\n32\n\n\n\n\n\n\n\n'PBMC3 - Silhuette (higher is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n0.171584\n0.007616\n0.055559\n0.111834\n0.092445\n\n\n\n\n\n\n\n'PBMC3 - davies_bouldin (lower is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n0.999779\n2.376915\n2.058343\n1.698551\n2.281481\n\n\n\n\n\n\n\n'PBMC3 - default labels'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.500696\n0.233560\n0.338609\n0.960446\n0.500077\n\n\nscanpy\n0.685919\n0.462762\n0.763719\n0.622505\n0.541286\n\n\nscvi-tools\n0.738418\n0.579677\n0.757237\n0.720511\n0.635237\n\n\nseurat\n0.770512\n0.585110\n0.821173\n0.725738\n0.644073\n\n\nCOTAN\n0.723833\n0.527470\n0.849029\n0.630815\n0.609217\n\n\n\n\n\n\n\n                                                \n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.469679\n0.196545\n0.316293\n0.911906\n0.473204\n\n\nscanpy\n0.675464\n0.545251\n0.756553\n0.610075\n0.612243\n\n\nscvi-tools\n0.721883\n0.667226\n0.738229\n0.706244\n0.710211\n\n\nseurat\n0.749240\n0.667468\n0.798924\n0.705374\n0.712865\n\n\nCOTAN\n0.677769\n0.535850\n0.798894\n0.588538\n0.606241\n\n\n\n\n\n\n\n                                                \n\n\n\nprint_scores(tuning = 'default',dataset=\"PBMC4\")\n\n'PBMC4 - number of clusters'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n3\n22\n16\n19\n24\n\n\n\n\n\n\n\n'PBMC4 - Silhuette (higher is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n0.081765\n0.050853\n0.061618\n0.112255\n0.103418\n\n\n\n\n\n\n\n'PBMC4 - davies_bouldin (lower is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n0.954689\n2.100956\n2.087707\n1.442075\n1.823095\n\n\n\n\n\n\n\n'PBMC4 - default labels'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.617025\n0.470070\n0.453383\n0.965513\n0.647279\n\n\nscanpy\n0.701228\n0.380357\n0.819943\n0.612541\n0.487560\n\n\nscvi-tools\n0.739299\n0.504966\n0.788229\n0.696088\n0.584900\n\n\nseurat\n0.760207\n0.494746\n0.847372\n0.689301\n0.583823\n\n\nCOTAN\n0.716555\n0.435917\n0.808134\n0.643618\n0.526063\n\n\n\n\n\n\n\n                                                \n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.636102\n0.525318\n0.482349\n0.933740\n0.689338\n\n\nscanpy\n0.642165\n0.368291\n0.789153\n0.541335\n0.491476\n\n\nscvi-tools\n0.698167\n0.482058\n0.770861\n0.638003\n0.577373\n\n\nseurat\n0.691539\n0.444871\n0.803112\n0.607186\n0.550863\n\n\nCOTAN\n0.625477\n0.351843\n0.733504\n0.545185\n0.461853",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs clustering comparison"
    ]
  },
  {
    "objectID": "clustering_comparison.html#matching-celltypist-clusters-number",
    "href": "clustering_comparison.html#matching-celltypist-clusters-number",
    "title": "Clustering Comparision",
    "section": "Matching cellTypist clusters number",
    "text": "Matching cellTypist clusters number\n\nprint_scores(tuning = 'celltypist',dataset=\"PBMC1\")\n\n'PBMC1 - number of clusters'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n18\n17\n20\n21\n14\n\n\n\n\n\n\n\n'PBMC1 - Silhuette (higher is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\ncelltypist\n\n\n\n\n0\n0.005501\n0.050843\n0.063871\n0.088209\n0.13383\n0.090989\n\n\n\n\n\n\n\n'PBMC1 - davies_bouldin (lower is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\ncelltypist\n\n\n\n\n0\n2.83457\n2.286672\n2.797123\n1.984746\n1.728304\n1.491801\n\n\n\n\n\n\n\n'PBMC1 - matching celltypist labels'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.658065\n0.341945\n0.757164\n0.581903\n0.448601\n\n\nscanpy\n0.735830\n0.459735\n0.822412\n0.665742\n0.553086\n\n\nscvi-tools\n0.699950\n0.375082\n0.808964\n0.616828\n0.479652\n\n\nseurat\n0.730468\n0.423069\n0.849278\n0.640820\n0.527386\n\n\nCOTAN\n0.787289\n0.670392\n0.803876\n0.771373\n0.723485\n\n\n\n\n\n\n\n                                                \n\n\n\nprint_scores(tuning = 'celltypist',dataset=\"PBMC2\")\n\n'PBMC2 - number of clusters'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n18\n20\n19\n20\n17\n\n\n\n\n\n\n\n'PBMC2 - Silhuette (higher is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\ncelltypist\n\n\n\n\n0\n-0.03374\n0.025173\n0.030773\n0.060901\n0.12581\n0.131097\n\n\n\n\n\n\n\n'PBMC2 - davies_bouldin (lower is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\ncelltypist\n\n\n\n\n0\n3.167255\n2.376025\n3.431314\n2.147939\n1.855098\n1.231923\n\n\n\n\n\n\n\n'PBMC2 - matching celltypist labels'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.605942\n0.312112\n0.699644\n0.534375\n0.425421\n\n\nscanpy\n0.697287\n0.377675\n0.809335\n0.612491\n0.492889\n\n\nscvi-tools\n0.709450\n0.398779\n0.791930\n0.642531\n0.500807\n\n\nseurat\n0.738307\n0.418942\n0.850535\n0.652244\n0.529176\n\n\nCOTAN\n0.729355\n0.472800\n0.745550\n0.713848\n0.562480\n\n\n\n\n\n\n\n                                                \n\n\n\nprint_scores(tuning = 'celltypist',dataset=\"PBMC3\")\n\n'PBMC3 - number of clusters'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n17\n18\n20\n18\n21\n\n\n\n\n\n\n\n'PBMC3 - Silhuette (higher is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\ncelltypist\n\n\n\n\n0\n-0.039293\n0.040964\n0.003634\n0.112264\n0.047585\n0.130032\n\n\n\n\n\n\n\n'PBMC3 - davies_bouldin (lower is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\ncelltypist\n\n\n\n\n0\n3.778924\n1.889045\n2.221019\n1.698481\n2.344713\n1.140713\n\n\n\n\n\n\n\n'PBMC3 - matching celltypist labels'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.593459\n0.350206\n0.643738\n0.550465\n0.432058\n\n\nscanpy\n0.712344\n0.545918\n0.758076\n0.671816\n0.609354\n\n\nscvi-tools\n0.735127\n0.565025\n0.767444\n0.705423\n0.623277\n\n\nseurat\n0.771047\n0.586941\n0.821567\n0.726381\n0.645653\n\n\nCOTAN\n0.677393\n0.470051\n0.717462\n0.641563\n0.538494\n\n\n\n\n\n\n\n                                                \n\n\n\nprint_scores(tuning = 'celltypist',dataset=\"PBMC4\")\n\n'PBMC4 - number of clusters'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n16\n18\n18\n19\n19\n\n\n\n\n\n\n\n'PBMC4 - Silhuette (higher is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\ncelltypist\n\n\n\n\n0\n0.022385\n0.048061\n0.107921\n0.111704\n0.098387\n0.081772\n\n\n\n\n\n\n\n'PBMC4 - davies_bouldin (lower is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\ncelltypist\n\n\n\n\n0\n2.007518\n1.898663\n1.612564\n1.442525\n1.969481\n1.194603\n\n\n\n\n\n\n\n'PBMC4 - matching celltypist labels'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.686019\n0.421166\n0.747399\n0.633956\n0.512728\n\n\nscanpy\n0.730100\n0.473433\n0.810168\n0.664434\n0.562407\n\n\nscvi-tools\n0.752718\n0.500477\n0.831022\n0.687899\n0.587099\n\n\nseurat\n0.759495\n0.492528\n0.846776\n0.688525\n0.581840\n\n\nCOTAN\n0.724052\n0.447103\n0.782942\n0.673402\n0.532939",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs clustering comparison"
    ]
  },
  {
    "objectID": "clustering_comparison.html#matching-antibody-clusters-number",
    "href": "clustering_comparison.html#matching-antibody-clusters-number",
    "title": "Clustering Comparision",
    "section": "Matching antibody clusters number",
    "text": "Matching antibody clusters number\n\nprint_scores(tuning = 'antibody',dataset=\"PBMC1\")\n\n'PBMC1 - number of clusters'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n9\n11\n10\n11\n11\n\n\n\n\n\n\n\n'PBMC1 - Silhuette (higher is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\nantibody\n\n\n\n\n0\n0.099643\n0.073115\n0.069687\n0.150193\n0.090531\n0.047275\n\n\n\n\n\n\n\n'PBMC1 - davies_bouldin (lower is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\nantibody\n\n\n\n\n0\n1.498221\n1.689467\n1.560514\n1.392406\n2.067883\n1.794015\n\n\n\n\n\n\n\n'PBMC1 - matching antibody labels'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.724319\n0.641765\n0.727281\n0.721381\n0.707943\n\n\nscanpy\n0.746106\n0.652841\n0.792721\n0.704669\n0.717629\n\n\nscvi-tools\n0.757587\n0.658079\n0.782127\n0.734540\n0.721084\n\n\nseurat\n0.749425\n0.642110\n0.790860\n0.712116\n0.708375\n\n\nCOTAN\n0.716421\n0.637108\n0.744518\n0.690367\n0.703698\n\n\n\n\n\n\n\n                                                \n\n\n\nprint_scores(tuning = 'antibody',dataset=\"PBMC2\")\n\n'PBMC2 - number of clusters'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n11\n10\n12\n12\n12\n\n\n\n\n\n\n\n'PBMC2 - Silhuette (higher is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\nantibody\n\n\n\n\n0\n-0.041184\n0.037491\n-0.021431\n0.091472\n0.074925\n0.042144\n\n\n\n\n\n\n\n'PBMC2 - davies_bouldin (lower is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\nantibody\n\n\n\n\n0\n3.22287\n1.702317\n4.327977\n1.463008\n2.077179\n2.2928\n\n\n\n\n\n\n\n'PBMC2 - matching antibody labels'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.590346\n0.458018\n0.610332\n0.571627\n0.544156\n\n\nscanpy\n0.746517\n0.649454\n0.756633\n0.736667\n0.707302\n\n\nscvi-tools\n0.672359\n0.576869\n0.708154\n0.640009\n0.646073\n\n\nseurat\n0.759142\n0.760752\n0.776572\n0.742477\n0.800906\n\n\nCOTAN\n0.735282\n0.673070\n0.687591\n0.790082\n0.743686\n\n\n\n\n\n\n\n                                                \n\n\n\nprint_scores(tuning = 'antibody',dataset=\"PBMC3\")\n\n'PBMC3 - number of clusters'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n12\n14\n13\n14\n12\n\n\n\n\n\n\n\n'PBMC3 - Silhuette (higher is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\nantibody\n\n\n\n\n0\n-0.048747\n0.024448\n-0.007328\n0.063501\n0.05861\n0.028552\n\n\n\n\n\n\n\n'PBMC3 - davies_bouldin (lower is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\nantibody\n\n\n\n\n0\n3.082757\n2.048357\n2.967632\n1.617082\n1.813171\n2.265731\n\n\n\n\n\n\n\n'PBMC3 - matching antibody labels'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.644484\n0.537094\n0.639574\n0.649469\n0.598577\n\n\nscanpy\n0.729603\n0.683244\n0.752370\n0.708173\n0.724410\n\n\nscvi-tools\n0.726492\n0.670063\n0.728625\n0.724372\n0.713239\n\n\nseurat\n0.764843\n0.698339\n0.799673\n0.732920\n0.738860\n\n\nCOTAN\n0.691237\n0.607331\n0.643954\n0.746015\n0.676860\n\n\n\n\n\n\n\n                                                \n\n\n\nprint_scores(tuning = 'antibody',dataset=\"PBMC4\")\n\n'PBMC4 - number of clusters'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\n\n\n\n\n0\n13\n11\n11\n13\n12\n\n\n\n\n\n\n\n'PBMC4 - Silhuette (higher is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\nantibody\n\n\n\n\n0\n-0.009349\n0.036425\n0.038929\n0.059369\n0.03044\n-0.044213\n\n\n\n\n\n\n\n'PBMC4 - davies_bouldin (lower is better)'\n\n\n\n\n\n\n\n\n\nmonocle\nscanpy\nscvi-tools\nseurat\nCOTAN\nantibody\n\n\n\n\n0\n2.412446\n1.784603\n1.670777\n1.621226\n1.822676\n4.131438\n\n\n\n\n\n\n\n'PBMC4 - matching antibody labels'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nhomogeneity\ncompleteness\nfowlkes_mallows\n\n\n\n\nmonocle\n0.642736\n0.462311\n0.694650\n0.598042\n0.558509\n\n\nscanpy\n0.718317\n0.585612\n0.758534\n0.682150\n0.662578\n\n\nscvi-tools\n0.730060\n0.588797\n0.763135\n0.699732\n0.665395\n\n\nseurat\n0.722468\n0.570140\n0.785446\n0.668840\n0.651248\n\n\nCOTAN\n0.675609\n0.518293\n0.678118\n0.673118\n0.606106",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs clustering comparison"
    ]
  },
  {
    "objectID": "clustering_comparison.html#check-celltypist-vs-antibody",
    "href": "clustering_comparison.html#check-celltypist-vs-antibody",
    "title": "Clustering Comparision",
    "section": "Check cellTypist vs Antibody",
    "text": "Check cellTypist vs Antibody\n\ndef compute_clustering_scores(output_dir, dataset):#celltypist_df, antibody_df,\n    # Merge the dataframes on the common 'cell' column\n    #cotan_df = pd.read_csv(f'{DIR}{dataset}/COTAN/antibody/clustering_labels.csv', index_col=0)\n    #display(\"Cotan clusters objetc dimension \",cotan_df.shape)\n    #display(\"----------------------------------------\")\n\n    celltypist_df = pd.read_csv(f'{DIR}{dataset}/celltypist/celltypist_labels.csv', index_col=0)\n    celltypist_df.index = celltypist_df.index.str[:-2]\n    antibody_df = pd.read_csv(f'{DIR}{dataset}/antibody_annotation/antibody_labels_postproc.csv', index_col=0)\n    #antibody_df = labels_df.merge(antibody_df, how='inner', on='cell')\n    #all_in_antibody = celltypist_df.index.isin(antibody_df.index).all()\n    #all_in_celltypist = antibody_df.index.isin(celltypist_df.index).all()\n\n    #display(\"All celltypist indices in antibody: \",all_in_antibody, celltypist_df.index.isin(antibody_df.index).sum(),celltypist_df.shape)\n    #display(\"All antibody indices in cellTypist:\", all_in_celltypist)\n\n    #display(\"----------------------------------------\")\n    \n    merged_df = celltypist_df.merge(antibody_df, how='inner',left_index=True, right_index=True)# on='cell')\n\n    merged_df.columns = ['cluster_celltypist','cluster_antibody']\n    \n    # Initialize scores dictionary\n    scores = {\n        'NMI': normalized_mutual_info_score(merged_df['cluster_celltypist'], merged_df['cluster_antibody'], average_method='arithmetic'),\n        'ARI': adjusted_rand_score(merged_df['cluster_celltypist'], merged_df['cluster_antibody']),\n        'Homogeneity': homogeneity_score(merged_df['cluster_celltypist'], merged_df['cluster_antibody']),\n        'Completeness': completeness_score(merged_df['cluster_celltypist'], merged_df['cluster_antibody']),\n        'Fowlkes_Mallows': fowlkes_mallows_score(merged_df['cluster_celltypist'], merged_df['cluster_antibody'])\n    }\n    \n    # Convert scores to DataFrame\n    scores_df = pd.DataFrame([scores])\n    \n    # Save scores to CSV and LaTeX\n    #scores_df.to_csv(f'{output_dir}{dataset}/clustering_comparison_scores.csv')\n    #scores_df.to_latex(f'{output_dir}{dataset}/clustering_comparison_scores.tex')\n    \n    # Display scores DataFrame\n    display(scores_df)\n\n\n\nfor dataset in DATASET_NAMES:\n    #display('------------------------------')\n    display(f'{dataset} - Clustering Comparison between CellTypist and Antibody')\n\n    # Assuming celltypist_df and antibody_df are defined elsewhere and available here\n    compute_clustering_scores(DIR, dataset)\n\n'PBMC1 - Clustering Comparison between CellTypist and Antibody'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nHomogeneity\nCompleteness\nFowlkes_Mallows\n\n\n\n\n0\n0.752326\n0.731095\n0.708308\n0.802178\n0.78126\n\n\n\n\n\n\n\n'PBMC2 - Clustering Comparison between CellTypist and Antibody'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nHomogeneity\nCompleteness\nFowlkes_Mallows\n\n\n\n\n0\n0.659259\n0.481537\n0.667725\n0.651004\n0.585734\n\n\n\n\n\n\n\n'PBMC3 - Clustering Comparison between CellTypist and Antibody'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nHomogeneity\nCompleteness\nFowlkes_Mallows\n\n\n\n\n0\n0.693433\n0.555502\n0.693429\n0.693436\n0.618105\n\n\n\n\n\n\n\n'PBMC4 - Clustering Comparison between CellTypist and Antibody'\n\n\n\n\n\n\n\n\n\nNMI\nARI\nHomogeneity\nCompleteness\nFowlkes_Mallows\n\n\n\n\n0\n0.751294\n0.7252\n0.728817\n0.775201\n0.776972",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs clustering comparison"
    ]
  },
  {
    "objectID": "clustering_comparison.html#summary",
    "href": "clustering_comparison.html#summary",
    "title": "Clustering Comparision",
    "section": "Summary",
    "text": "Summary\n\nExternal measures\n\ndef load_scores(tuning, dataset):\n    scores = pd.read_csv(f'{DIR}{dataset}/scores_{tuning}.csv')\n    scores = scores.rename(columns={\"Unnamed: 0\": \"tool\"})\n    scores['tuning'] = tuning\n    return scores\n\n\ndatasets = ['PBMC1', 'PBMC2', 'PBMC3', 'PBMC4']\ntunings = ['default_celltypist', 'default_antibody', 'celltypist_celltypist', 'antibody_antibody']\n\nscores_list = []\n\n# Concatenate all scores into one DataFrame\nfor dataset in datasets:\n    for tuning in tunings:\n        scores = load_scores(tuning, dataset)\n        scores['dataset'] = dataset\n        scores_list.append(scores)\n\nall_scores = pd.concat(scores_list)\n\n# Prepare data for plotting\nall_scores_melted = all_scores.melt(id_vars=['tool', 'tuning', 'dataset'], var_name='score', value_name='value')\n\nsns.set_context(\"talk\") \n# Define custom colors\ncustom_palette = { \n    \"seurat\": \"#4575B4\",\n    \"monocle\": \"#DAABE9\",\n    \"scanpy\": \"#7F9B5C\",\n    \"COTAN\": \"#F73604\",\n    \"scvi-tools\": \"#B6A18F\"\n}\n\ng = sns.FacetGrid(all_scores_melted, row='score', col='tuning', sharey=False, height=4, aspect=1.3)\ng.map(sns.pointplot, 'tool', 'value', palette=custom_palette,capsize=0.2, errwidth=2)\n\n# Set titles and labels\ng.set_titles(col_template=\"{col_name}\", row_template=\"{row_name}\")\ng.set_axis_labels(\"Tool\", \"Score Value\")\nplt.subplots_adjust(top=1.4)\n#g.fig.suptitle('Comparison of Clustering Tools by Various Scores and Conditions')\n# Rotate x-axis labels\nfor ax in g.axes.flatten():\n    plt.setp(ax.get_xticklabels(), rotation=45)\n\ng.savefig(\"ClusteringToolsComparison.pdf\")\nplt.show()\n\n\n\n\n\n\n\n\n\n\nInternal measures\n\n# Load your data (assuming you have CSV files for the scores)\ndef load_scores(tuning, dataset, score_type):\n    file_path = f'{DIR}{dataset}/{tuning}_{score_type}.csv'\n    print(f\"Loading {file_path}\")\n    scores = pd.read_csv(file_path, header=0)  # Read the CSV file without an index column\n    scores_melted = scores.melt(var_name='tool', value_name='value')\n    scores_melted['tuning'] = tuning\n    scores_melted['dataset'] = dataset\n    scores_melted['score_type'] = score_type\n    return scores_melted\n\n\n\ndatasets = ['PBMC1', 'PBMC2', 'PBMC3', 'PBMC4']\ntunings = ['default', 'celltypist', 'antibody']\nscore_types = ['silhouette', 'davies_bouldin']\nscores_list = []\n\n# Concatenate all scores into one DataFrame\nfor dataset in datasets:\n    for tuning in tunings:\n        for score_type in score_types:\n            scores = load_scores(tuning, dataset, score_type)\n            scores_list.append(scores)\n\nall_scores = pd.concat(scores_list)\n\n# Debug: Check the loaded data\nprint(all_scores.head())\n\n# Define custom colors\ncustom_palette = {\n    \"seurat\": \"#4575B4\",\n    \"monocle\": \"#DAABE9\",\n    \"scanpy\": \"#7F9B5C\",\n    \"COTAN\": \"#F73604\",\n    \"scvi-tools\": \"#B6A18F\"\n}\n\n# Filter for silhouette and davies_bouldin scores\nsilhouette_scores = all_scores[all_scores['score_type'] == 'silhouette']\ndavies_bouldin_scores = all_scores[all_scores['score_type'] == 'davies_bouldin']\n\n# Plot Silhouette scores\ng1 = sns.FacetGrid(silhouette_scores, col='tuning', sharey=False, height=4, aspect=1.8)\ng1.map(sns.pointplot, 'tool', 'value', palette=custom_palette, order=[ \"monocle\", \"scanpy\", \"scvi-tools\",\"seurat\",\"COTAN\"],capsize=0.2, errwidth=2)\ng1.set_titles(col_template=\"{col_name}\")\ng1.set_axis_labels(\"Tool\", \"Silhouette Score\")\ng1.fig.suptitle('Silhouette Scores by Tool and Tuning Condition', y=1.25)\nplt.subplots_adjust(top=0.85)\n# Rotate x-axis labels\nfor ax in g1.axes.flatten():\n    plt.setp(ax.get_xticklabels(), rotation=45)\n\n# Plot Davies-Bouldin scores\ng2 = sns.FacetGrid(davies_bouldin_scores, col='tuning', sharey=False, height=4, aspect=1.8)\ng2.map(sns.pointplot, 'tool', 'value', palette=custom_palette, order=[\"monocle\", \"scanpy\",  \"scvi-tools\",\"seurat\",\"COTAN\"],capsize=0.2, errwidth=2)\ng2.set_titles(col_template=\"{col_name}\")\ng2.set_axis_labels(\"Tool\", \"Davies-Bouldin Score\")\ng2.fig.suptitle('Davies-Bouldin Scores by Tool and Tuning Condition', y=1.85)\nplt.subplots_adjust(top=1.5)\n# Rotate x-axis labels\nfor ax in g2.axes.flatten():\n    plt.setp(ax.get_xticklabels(), rotation=45)\n\ng1.savefig(\"ClusteringToolsSilhouette.png\")\ng2.savefig(\"ClusteringToolsDaviesBouldin.png\")\n\nplt.show()\n\nLoading Data/PBMC1/default_silhouette.csv\nLoading Data/PBMC1/default_davies_bouldin.csv\nLoading Data/PBMC1/celltypist_silhouette.csv\nLoading Data/PBMC1/celltypist_davies_bouldin.csv\nLoading Data/PBMC1/antibody_silhouette.csv\nLoading Data/PBMC1/antibody_davies_bouldin.csv\nLoading Data/PBMC2/default_silhouette.csv\nLoading Data/PBMC2/default_davies_bouldin.csv\nLoading Data/PBMC2/celltypist_silhouette.csv\nLoading Data/PBMC2/celltypist_davies_bouldin.csv\nLoading Data/PBMC2/antibody_silhouette.csv\nLoading Data/PBMC2/antibody_davies_bouldin.csv\nLoading Data/PBMC3/default_silhouette.csv\nLoading Data/PBMC3/default_davies_bouldin.csv\nLoading Data/PBMC3/celltypist_silhouette.csv\nLoading Data/PBMC3/celltypist_davies_bouldin.csv\nLoading Data/PBMC3/antibody_silhouette.csv\nLoading Data/PBMC3/antibody_davies_bouldin.csv\nLoading Data/PBMC4/default_silhouette.csv\nLoading Data/PBMC4/default_davies_bouldin.csv\nLoading Data/PBMC4/celltypist_silhouette.csv\nLoading Data/PBMC4/celltypist_davies_bouldin.csv\nLoading Data/PBMC4/antibody_silhouette.csv\nLoading Data/PBMC4/antibody_davies_bouldin.csv\n         tool     value   tuning dataset  score_type\n0  Unnamed: 0  0.000000  default   PBMC1  silhouette\n1     monocle  0.100032  default   PBMC1  silhouette\n2      scanpy  0.043761  default   PBMC1  silhouette\n3  scvi-tools  0.065534  default   PBMC1  silhouette\n4      seurat  0.148254  default   PBMC1  silhouette",
    "crumbs": [
      "Cluster evaluation",
      "PBMCs clustering comparison"
    ]
  },
  {
    "objectID": "DEA_Type1Er.html",
    "href": "DEA_Type1Er.html",
    "title": "Differential expression analisys: type I error",
    "section": "",
    "text": "library(COTAN)\noptions(parallelly.fork.enable = TRUE)\nlibrary(Seurat)\nlibrary(monocle3)\nlibrary(reticulate)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(viridis)\n\n\ndirOut &lt;- \"Results/TypeIError/\"\ndataSetDir &lt;- \"Data/MouseCortexFromLoom/SingleClusterRawData/\"\n\n\nAutomatic functions\n\nCOTAN.DEA &lt;- function(dataSet,clusters.list, GEO.code, sequencingMethod,sampleCondition, clName,dirOut,percentage){\n  obj &lt;- automaticCOTANObjectCreation(raw = dataSet,\n                                      calcCoex = F,\n                                      cores = 10,\n                                      saveObj = F,\n                                      GEO = GEO.code,\n                                      sequencingMethod = sequencingMethod,\n                                      sampleCondition = sampleCondition)\n  obj &lt;- addClusterization(obj,clName = clName,clusters = clusters.list)\n  \n  DF.DEA &lt;- DEAOnClusters(obj,clName = clName )\n  pval.DEA &lt;- pValueFromDEA(DF.DEA,numCells = getNumCells(obj))\n  adj.pval.DEA &lt;- pval.DEA\n  for (col in colnames(pval.DEA)) {\n    adj.pval.DEA[,col] &lt;- p.adjust(adj.pval.DEA[,col],method = \"bonferroni\")\n  }\n  n.genes.DEA &lt;- sum(adj.pval.DEA &lt; 0.05)\n  res &lt;- list(\"n.genes.DEA\"=n.genes.DEA,\"DF.DEA\"=DF.DEA,\"adj.pval.DEA\" = adj.pval.DEA)\n  \n  write.csv(res$adj.pval.DEA, file = paste0(dirOut,clName,\"_de_genes_COTAN_\",percentage,\".csv\"))\n  \n  return(res)\n\n}\n\nSeurat.DEA &lt;- function(dataSet,clusters.list, project, dirOut,percentage){\n  pbmc &lt;- CreateSeuratObject(counts = dataSet, project = project, min.cells = 3, min.features = 20)\n  \n  stopifnot(length(clusters.list)==length(pbmc$orig.ident))\n  \n  \n  pbmc &lt;- NormalizeData(pbmc, normalization.method = \"LogNormalize\", scale.factor = 10000)\n  pbmc &lt;- FindVariableFeatures(pbmc, selection.method = \"vst\", nfeatures = 2000)\n  all.genes &lt;- rownames(pbmc)\n  pbmc &lt;- ScaleData(pbmc, features = all.genes)\n  \n  pbmc &lt;- RunPCA(pbmc)\n  pbmc &lt;- RunUMAP(pbmc, dims = 1:20)\n  \n  pbmc@meta.data$TestCl &lt;- NA\n  pbmc@meta.data[names(clusters.list),]$TestCl &lt;- factor(clusters.list)\n  \n  pbmc &lt;- SetIdent(pbmc,value = \"TestCl\")\n  \n  pbmc.markers &lt;- FindAllMarkers(pbmc, only.pos = TRUE)\n  \n  \n  \n  n.genes.DEA &lt;- sum(pbmc.markers$p_val_adj &lt; 0.05)\n  \n  print(n.genes.DEA)\n  \n  write.csv(pbmc.markers, file = paste0(dirOut,project,\"_de_genes_Seurat_\",percentage,\".csv\"))\n  \n  return(list(\"n.genes.DEA\"=n.genes.DEA,\"markers\"= pbmc.markers))\n  }\n\nMonocle.DEA &lt;- function(dataSet,clusters.list,project, dirOut,percentage){\n  \n  cell_metadata = as.data.frame(clusters.list[colnames(dataSet)])\n  colnames(cell_metadata) &lt;- \"Clusters\"\n  cds &lt;- new_cell_data_set(dataSet[rowSums(dataSet) &gt; 3,],\n                         cell_metadata = cell_metadata\n                         )\n  colData(cds)$cluster &lt;- clusters.list[rownames(colData(cds))]\n\n  #cds &lt;- preprocess_cds(cds, num_dim = 100)\n  #cds &lt;- reduce_dimension(cds)\n  #cds &lt;- cluster_cells(cds, resolution=1e-5)\n\n  marker_test_res &lt;- top_markers(cds, \n                                 group_cells_by=\"Clusters\", \n                                 genes_to_test_per_group = dim(cds)[1],\n                                  cores=10)\n  \n  # de_results &lt;- fit_models(cds,model_formula_str = \" ~ cluster\",cores = 10,verbose = T)\n  # fit_coefs &lt;- coefficient_table(de_results)\n  # \n  # fit_coefs &lt;- fit_coefs %&gt;% filter(term == \"cluster\")\n  \n  write.csv(marker_test_res, file = paste0(dirOut,project,\"_de_genes_Monocle_\",percentage,\".csv\"))\n  \n  # return(list(\"n.genes.DEA\"=sum(fit_coefs$q_value &lt; 0.05, na.rm = T),\n  #             \"fit_coefs\"= fit_coefs,\n  #             \"de_results\"=de_results))\n  return(list(\"n.genes.DEA\"=sum(marker_test_res$marker_test_q_value &lt; 0.05, na.rm = T),\n              \"marker_test_res\"= marker_test_res\n              ))\n}\n\n\nScanPy.DEA &lt;- function(dataSet,\n                       clusters.list, \n                       project, \n                       dirOut,\n                       percentage){\n  pbmc &lt;- CreateSeuratObject(counts = dataSet, project = project, min.cells = 3, min.features = 20)\n  \n  \n  pbmc@meta.data$TestCl &lt;- NA\n  pbmc@meta.data[names(clusters.list),]$TestCl &lt;- clusters.list\n  \n  exprs &lt;- pbmc@assays$RNA$counts\n  \n  meta &lt;- pbmc[[]]\n  #feature_meta &lt;- GetAssay(pbmc)[[]]\n  tmp &lt;- as.data.frame(matrix(data = NA, \n                              ncol = 1, \n                              nrow = nrow(pbmc@assays$RNA$counts)))\n  rownames(tmp) &lt;- rownames(pbmc@assays$RNA$counts)\n  \n  feature_meta &lt;- tmp\n  #embedding &lt;- Embeddings(pbmc, \"umap\")\n  \n  Sys.setenv(RETICULATE_PYTHON = \"../../../bin/python3\")\n  py &lt;- import(\"sys\")\n  \n  source_python(\"src/scanpyTypeIError.py\")\n  scanpyTypeIError(exprs, \n                   meta, \n                   feature_meta, \n                   \"mt\", \n                   dirOut, \n                   percentage,project)\n\n  out &lt;- read.csv(file = paste0(dirOut,\n                                project,\n                                \"_Scanpy_de_genes_\",\n                                percentage,\n                                \".csv\"),\n                  header = T, \n                  row.names = 1)\n  \n  gc()\n\n  return(out)\n}\n\nWe would evaluate the Type I error and to do so, we consider some transcriptionally uniform clusters from the Loom dataset. We splitted these cluster in two partitions (with three different dimensions: 1/2, 1/3 and 1/4) one containing the cells with higher library size and the other with the lower library size. On these two clusters we than tested the four different software.\n\nfor (perc in c(0.75)) { #0.5, 0.33, 0.25,0.67, \n  outPutMatrix &lt;- as.data.frame(matrix(nrow = 1,ncol = 4))\n  colnames(outPutMatrix) &lt;- c(\"COTAN\",\"Seurat\", \"Monocle\", \"Scanpy\")\n\n  for (dataSet in list.files(dataSetDir)) {\n  \n    cluster.name &lt;- str_split(dataSet,pattern = \"_\", simplify = T)[1]\n    \n    print(cluster.name)\n    outTemp &lt;- NA\n     \n    dataSet &lt;- readRDS(paste0(dataSetDir,dataSet))\n    \n\n    cl1 &lt;- colnames(dataSet)[order(colSums(dataSet),decreasing = T)[1:round(ncol(dataSet)*perc,digits = 0)]]\n    \n    clusters.list &lt;- list(\"cl1\"=cl1,\n                          \"cl2\"=colnames(dataSet)[!colnames(dataSet) %in% cl1])\n  \n    clusters.list &lt;- setNames(rep(1,ncol(dataSet)),\n                              colnames(dataSet))\n    clusters.list[colnames(dataSet)[!colnames(dataSet) %in% cl1]] &lt;- 2 \n  \n    cotan.dea.out &lt;- COTAN.DEA(dataSet = dataSet,\n                               clusters.list = clusters.list,\n                               GEO.code = \"\",\n                               sequencingMethod = \"10x\",\n                               sampleCondition = \"Temp\",\n                               clName =  cluster.name,\n                               dirOut, percentage = perc)\n  \n    outTemp &lt;- c(outTemp,cotan.dea.out$n.genes.DEA)\n    \n    rm(cotan.dea.out)\n    gc()\n  \n    seurat.dea.out &lt;- Seurat.DEA(dataSet = dataSet,\n                               clusters.list = clusters.list,\n                               project = cluster.name,\n                               dirOut, percentage = perc)\n  \n    outTemp &lt;- c(outTemp,seurat.dea.out$n.genes.DEA)\n    \n    rm(seurat.dea.out)\n    gc()\n  \n  \n    monocle.dea.out &lt;- Monocle.DEA(dataSet = dataSet,\n                                   clusters.list = clusters.list,\n                                   project = cluster.name,\n                                   dirOut = dirOut, percentage = perc)\n  \n    outTemp &lt;- c(outTemp,monocle.dea.out$n.genes.DEA)\n    rm(monocle.dea.out)\n    gc()\n  \n    ScanPy.dea.out &lt;- ScanPy.DEA(dataSet = dataSet, \n                                 clusters.list = clusters.list, \n                                 project = cluster.name, \n                                 dirOut = dirOut, percentage = perc\n                                  )\n    \n  \n    ScanPy.dea.out.filterd &lt;- ScanPy.dea.out[ScanPy.dea.out$pval_adj &lt; 0.05\n                                             & ScanPy.dea.out$clusters == \"cl1.0\",]\n    \n    outTemp &lt;- c(outTemp,dim(ScanPy.dea.out.filterd)[1])\n    rm(ScanPy.dea.out.filterd)\n    gc()\n    \n    outTemp &lt;- outTemp[2:length(outTemp)]\n    \n    outPutMatrix &lt;- rbind(outPutMatrix,outTemp)\n    rownames(outPutMatrix)[nrow(outPutMatrix)] &lt;- cluster.name\n    \n    write.csv(outPutMatrix,paste0(dirOut,\"Complete_outPut_\",perc,\".csv\"))\n  }\n  \n  outPutMatrix &lt;-   outPutMatrix[2:nrow(outPutMatrix),]\n  write.csv(outPutMatrix,paste0(dirOut,\"Complete_outPut_\",perc,\".csv\"))\n\n}\n\n\n\nSummarize the output\n\nmethods.color &lt;- c(\"COTAN\"=\"#F73604\",\"Seurat\"=\"#ABD9E9\",\"Seurat_scTr\"=\"#74ADD1\",\"Seurat_Bimod\"=\"#4575B4\", \"Monocle\"=\"#DAABE9\", \"Scanpy\"=\"#7F9B5C\" )\ndf_plot &lt;- NA\nfor (perc in c(0.5, 0.33, 0.25,0.67, 0.75)) {\n  outPutMatrix &lt;- read.csv(paste0(dirOut,\"Complete_outPut_\",perc,\".csv\"))\n  \n  outPutMatrix$Division &lt;- perc\n  \n  df_plot &lt;- rbind(df_plot,outPutMatrix)\n  \n}\ndf_plot &lt;- df_plot[2:nrow(df_plot),]\n\ndf_plot &lt;- as.data.frame(pivot_longer(df_plot,cols = c(2:5),values_to = \"N.Genes\",names_to = \"Method\"))\n\ndf_plot[df_plot$Method == \"Cotan\",]$Method &lt;- \"COTAN\"\ndf_plot[df_plot$Method == \"ScanPy\",]$Method &lt;- \"Scanpy\"\n\n\ntypeIerrorPlot &lt;- ggplot(df_plot,aes(x = Method, y=N.Genes,fill=Method))+geom_boxplot(outliers = F)+\nscale_fill_manual(\n    values = methods.color)+ facet_wrap(~Division,scales = \"free\",nrow = 1)+\n    geom_jitter(color=\"black\",  alpha=0.5,width = 0.2) +\n    theme_light()+\n    theme(axis.text.x=element_blank(),axis.title.x=element_blank(),\n      legend.position=\"bottom\",\n      plot.title = element_text(size=11)\n    )\n\npdf(paste0(dirOut,\"Type1ErrorPlot.pdf\"),height = 3,width = 15)\n\nplot(typeIerrorPlot)\ndev.off()\n\npng \n  2 \n\nplot(typeIerrorPlot)\n\n\n\n\n\n\n\n\n\nsessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 22.04.5 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] viridis_0.6.5               viridisLite_0.4.2          \n [3] ggplot2_3.5.2               tidyr_1.3.1                \n [5] dplyr_1.1.4                 stringr_1.5.1              \n [7] reticulate_1.42.0           monocle3_1.3.7             \n [9] SingleCellExperiment_1.30.0 SummarizedExperiment_1.38.1\n[11] GenomicRanges_1.60.0        GenomeInfoDb_1.44.0        \n[13] IRanges_2.42.0              S4Vectors_0.46.0           \n[15] MatrixGenerics_1.20.0       matrixStats_1.5.0          \n[17] Biobase_2.68.0              BiocGenerics_0.54.0        \n[19] generics_0.1.3              Seurat_5.2.1               \n[21] SeuratObject_5.1.0          sp_2.2-0                   \n[23] COTAN_2.9.4                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.22        splines_4.5.2           later_1.4.2            \n  [4] tibble_3.3.0            polyclip_1.10-7         fastDummies_1.7.5      \n  [7] lifecycle_1.0.4         Rdpack_2.6.4            doParallel_1.0.17      \n [10] globals_0.18.0          lattice_0.22-7          MASS_7.3-65            \n [13] dendextend_1.19.0       magrittr_2.0.3          plotly_4.11.0          \n [16] rmarkdown_2.29          yaml_2.3.10             httpuv_1.6.16          \n [19] sctransform_0.4.2       spam_2.11-1             spatstat.sparse_3.1-0  \n [22] cowplot_1.1.3           pbapply_1.7-2           minqa_1.2.8            \n [25] RColorBrewer_1.1-3      abind_1.4-8             Rtsne_0.17             \n [28] purrr_1.0.4             circlize_0.4.16         GenomeInfoDbData_1.2.14\n [31] ggrepel_0.9.6           irlba_2.3.5.1           listenv_0.9.1          \n [34] spatstat.utils_3.1-4    goftest_1.2-3           RSpectra_0.16-2        \n [37] spatstat.random_3.4-1   fitdistrplus_1.2-2      parallelly_1.45.0      \n [40] codetools_0.2-20        DelayedArray_0.34.1     tidyselect_1.2.1       \n [43] shape_1.4.6.1           UCSC.utils_1.4.0        farver_2.1.2           \n [46] lme4_1.1-37             ScaledMatrix_1.16.0     spatstat.explore_3.4-2 \n [49] jsonlite_2.0.0          GetoptLong_1.0.5        gghalves_0.1.4         \n [52] progressr_0.15.1        ggridges_0.5.6          survival_3.8-3         \n [55] iterators_1.0.14        foreach_1.5.2           tools_4.5.2            \n [58] ica_1.0-3               Rcpp_1.0.14             glue_1.8.0             \n [61] gridExtra_2.3           SparseArray_1.8.0       xfun_0.52              \n [64] ggthemes_5.1.0          withr_3.0.2             fastmap_1.2.0          \n [67] boot_1.3-32             digest_0.6.37           rsvd_1.0.5             \n [70] parallelDist_0.2.6      R6_2.6.1                mime_0.13              \n [73] colorspace_2.1-1        scattermore_1.2         tensor_1.5             \n [76] spatstat.data_3.1-6     data.table_1.17.0       httr_1.4.7             \n [79] htmlwidgets_1.6.4       S4Arrays_1.8.0          uwot_0.2.3             \n [82] pkgconfig_2.0.3         gtable_0.3.6            ComplexHeatmap_2.24.0  \n [85] lmtest_0.9-40           XVector_0.48.0          htmltools_0.5.8.1      \n [88] dotCall64_1.2           zigg_0.0.2              clue_0.3-66            \n [91] scales_1.4.0            png_0.1-8               reformulas_0.4.1       \n [94] spatstat.univar_3.1-3   knitr_1.50              reshape2_1.4.4         \n [97] rjson_0.2.23            nloptr_2.2.1            nlme_3.1-168           \n[100] proxy_0.4-27            zoo_1.8-14              GlobalOptions_0.1.2    \n[103] KernSmooth_2.23-26      parallel_4.5.2          miniUI_0.1.2           \n[106] pillar_1.10.2           grid_4.5.2              vctrs_0.6.5            \n[109] RANN_2.6.2              promises_1.3.2          BiocSingular_1.24.0    \n[112] beachmat_2.24.0         xtable_1.8-4            cluster_2.1.8.1        \n[115] evaluate_1.0.3          zeallot_0.2.0           cli_3.6.5              \n[118] compiler_4.5.2          rlang_1.1.6             crayon_1.5.3           \n[121] future.apply_1.20.0     labeling_0.4.3          plyr_1.8.9             \n[124] stringi_1.8.7           deldir_2.0-4            BiocParallel_1.42.0    \n[127] assertthat_0.2.1        lazyeval_0.2.2          spatstat.geom_3.4-1    \n[130] Matrix_1.7-4            RcppHNSW_0.6.0          patchwork_1.3.0        \n[133] future_1.58.0           shiny_1.11.0            rbibutils_2.3          \n[136] ROCR_1.0-11             Rfast_2.1.5.1           igraph_2.1.4           \n[139] RcppParallel_5.1.10",
    "crumbs": [
      "DEA evaluation",
      "Type I error"
    ]
  },
  {
    "objectID": "geneExpressionAnalysisUniformClusters.html",
    "href": "geneExpressionAnalysisUniformClusters.html",
    "title": "Explorative analysis of gene expression",
    "section": "",
    "text": "#library(COTAN)\n#options(parallelly.fork.enable = TRUE)\n#library(Seurat)\n#library(monocle3)\n#library(reticulate)\nlibrary(ggplot2)\nlibrary(stringr)\nlibrary(dplyr)\n\ndirOut &lt;- \"Results/GeneExpressionExploration/\"\nif (!exists(dirOut)) {\n  dir.create(dirOut)\n}\ndataSetDir &lt;- \"Data/MouseCortexFromLoom/SingleClusterRawData/\"\n\n\ndf &lt;- NA\nfor (dataSetName in list.files(dataSetDir)) {\n  print(dataSetName)\n  name &lt;- str_split(dataSetName,pattern = \"_\", simplify = T)[1]\n  cluster.name &lt;- str_split(name,pattern = \"e\", simplify = T)[1]\n  time.point &lt;- paste0(\"E\",str_split(name,pattern = \"e\", simplify = T)[2])\n  dataSet &lt;- readRDS(paste0(dataSetDir,dataSetName))\n  print(dim(dataSet))\n  message(dim(dataSet))\n  df.temp &lt;- as.data.frame(list(\"RowSums\"=rowSums(dataSet)))\n  df.temp$N.cells &lt;- dim(dataSet)[2]\n  df.temp$genes &lt;- rownames(df.temp)\n  df.temp$log10_exp &lt;- log10((df.temp$RowSums+1)/df.temp$N.cells)\n  df.temp$cluster &lt;- cluster.name\n  df.temp$time.point &lt;- time.point\n  \n  df &lt;- rbind(df,df.temp)\n  \n}\n\n[1] \"Cl184e13.5_ForebrainDorsalRawData.RDS\"\nNULL\n[1] \"Cl187e13.5_ForebrainDorsalRawData.RDS\"\n[1] 13972   334\n[1] \"Cl428e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   318\n[1] \"Cl432e13.5_ForebrainDorsalRawData.RDS\"\n[1] 13972   536\n[1] \"Cl432e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   586\n[1] \"Cl434e13.5_ForebrainDorsalRawData.RDS\"\n[1] 13972   326\n[1] \"Cl434e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   273\n[1] \"Cl437e13.5_ForebrainDorsalRawData.RDS\"\n[1] 13972   259\n[1] \"Cl437e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   258\n[1] \"Cl505e17.5_ForebrainDorsalRawData.RDS\"\n[1] 13971   203\n[1] \"Cl508e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   397\n[1] \"Cl509e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   402\n[1] \"Cl510e13.5_ForebrainDorsalRawData.RDS\"\n[1] 13972   248\n[1] \"Cl510e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   402\n[1] \"Cl516e17.5_ForebrainDorsalRawData.RDS\"\n[1] 13971   297\n\n df &lt;- df[2:nrow(df),]\n\ndf$cl_time &lt;- paste0(df$cluster,\"_\",df$time.point)\n\n\nd_bg &lt;- df[,-5] \n\nggplot(df[df$time.point == \"E13.5\",], \n       aes(x = log10_exp, fill = cluster)) +\n  geom_histogram(data = d_bg, \n                 fill = \"grey\", alpha = .8,binwidth = 0.1/6) +\n  geom_histogram(colour = \"black\",binwidth = 0.1) +\n  facet_wrap(~ cluster) + ylim(0,2500)+\n  guides(fill = FALSE) +  # to remove the legend\n  theme_bw()  \n\n\n\n\n\n\n\n\n\nggplot(df[df$time.point == \"E15.0\",], \n       aes(x = log10_exp, fill = cluster)) +\n  geom_histogram(data = d_bg, \n                 fill = \"grey\", alpha = .8,binwidth = 0.1/6) +\n  geom_histogram(colour = \"black\",binwidth = 0.1) +\n  facet_wrap(~ cluster) + ylim(0,2500)+\n  guides(fill = FALSE) +  # to remove the legend\n  theme_bw()  \n\n\n\n\n\n\n\n\n\nggplot(df[df$time.point == \"E17.5\",], \n       aes(x = log10_exp, fill = cluster)) +\n  geom_histogram(data = d_bg, \n                 fill = \"grey\", alpha = .8,binwidth = 0.1/6) +\n  geom_histogram(colour = \"black\") +\n  facet_wrap(~ cluster) +ylim(0,2500)+\n  guides(fill = FALSE) +  # to remove the legend\n  theme_bw()  \n\n\n\n\n\n\n\n\n\nvenn &lt;- list(\"Cl184\" = df[df$log10_exp &gt; -1 & df$time.point == \"E13.5\" & df$cluster == \"Cl184\",]$genes,\n             \"Cl187\" = df[df$log10_exp &gt; -1 & df$time.point == \"E13.5\" & df$cluster == \"Cl187\",]$genes,\n             \"Cl432\" = df[df$log10_exp &gt; -1 & df$time.point == \"E13.5\" & df$cluster == \"Cl432\",]$genes,\n             \"Cl434\" = df[df$log10_exp &gt; -1 & df$time.point == \"E13.5\" & df$cluster == \"Cl434\",]$genes,\n             \"Cl437\" = df[df$log10_exp &gt; -1 & df$time.point == \"E13.5\" & df$cluster == \"Cl437\",]$genes,\n             \"Cl510\" = df[df$log10_exp &gt; -1 & df$time.point == \"E13.5\" & df$cluster == \"Cl510\",]$genes)\nlibrary(ggVennDiagram)\n\nggVennDiagram(\n  venn,\n  #fill_color = c(\"#0073C2FF\", \"#EFC000FF\", \"#868686FF\",\"#009E73\",\"#993E83\",\"#007310FF\"),\n  stroke_size = 0.5, set_name_size = 4\n  )+ scale_fill_distiller(palette = \"RdBu\")\n\n\n\n\n\n\n\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] ggVennDiagram_1.5.0 Matrix_1.6-3        dplyr_1.1.2        \n[4] stringr_1.5.0       ggplot2_3.4.2      \n\nloaded via a namespace (and not attached):\n [1] vctrs_0.6.3        cli_3.6.1          knitr_1.43         rlang_1.1.1       \n [5] xfun_0.39          stringi_1.8.1      generics_0.1.3     jsonlite_1.8.7    \n [9] labeling_0.4.2     glue_1.6.2         colorspace_2.1-0   htmltools_0.5.7   \n[13] scales_1.3.0       fansi_1.0.4        rmarkdown_2.24     grid_4.3.2        \n[17] evaluate_0.21      munsell_0.5.0      tibble_3.2.1       fastmap_1.1.1     \n[21] yaml_2.3.7         lifecycle_1.0.3    compiler_4.3.2     RColorBrewer_1.1-3\n[25] htmlwidgets_1.6.2  pkgconfig_2.0.3    rstudioapi_0.15.0  farver_2.1.1      \n[29] lattice_0.22-5     digest_0.6.33      R6_2.5.1           tidyselect_1.2.0  \n[33] utf8_1.2.3         pillar_1.9.0       magrittr_2.0.3     withr_2.5.0       \n[37] tools_4.3.2        gtable_0.3.3",
    "crumbs": [
      "DEA evaluation",
      "Explorative analysis of gene expression"
    ]
  },
  {
    "objectID": "OriginalClustersDistanceEvaluation.html",
    "href": "OriginalClustersDistanceEvaluation.html",
    "title": "Original Clusters Distance Evaluation",
    "section": "",
    "text": "library(COTAN)\nlibrary(stringr)\nlibrary(tidyverse)",
    "crumbs": [
      "GDI sensitivity",
      "Clusters Distance Evaluation"
    ]
  },
  {
    "objectID": "OriginalClustersDistanceEvaluation.html#extract-the-row-matrix-for-each-cluster",
    "href": "OriginalClustersDistanceEvaluation.html#extract-the-row-matrix-for-each-cluster",
    "title": "Original Clusters Distance Evaluation",
    "section": "Extract the row matrix for each cluster",
    "text": "Extract the row matrix for each cluster\nThis is done on the La Manno Mouse Brain dataset (2021)\n\nE13.5\n\nE13.5Clusters.code &lt;- c(432,187,434,184,437,510)\n\nfb135Obj &lt;- readRDS(file = file.path(\"Data/MouseCortexFromLoom/\", \"e13.5_ForebrainDorsal.cotan.RDS\"))\n\nsampleCondition &lt;- getMetadataElement(fb135Obj, datasetTags()[[\"cond\"]])\n\nfor (cl in E13.5Clusters.code) {\n  cells &lt;- names(getClusters(fb135Obj, \n      clName = \"original.clusters\")[getClusters(fb135Obj, \n                          clName = \"original.clusters\") == cl])\n\nCLRawData &lt;- getRawData(fb135Obj)[,cells]\n\nsaveRDS(CLRawData,file = paste0(\"Data/MouseCortexFromLoom/SingleClusterRawData/Cl\",cl,sampleCondition,\"RawData.RDS\"))  \n}\n\n\n\nE15.0\n\nE15.0Clusters.code &lt;- c(432,509,510,508,428,434,437)\n\nfb150Obj &lt;- readRDS(file = file.path(\"Data/MouseCortexFromLoom/\", \"e15.0_ForebrainDorsal.cotan.RDS\"))\n\nsampleCondition &lt;- getMetadataElement(fb150Obj, datasetTags()[[\"cond\"]])\n\nfor (cl in E15.0Clusters.code) {\n  cells &lt;- names(getClusters(fb150Obj, \n      clName = \"original.clusters\")[getClusters(fb150Obj, \n                          clName = \"original.clusters\") == cl])\n\nCLRawData &lt;- getRawData(fb150Obj)[,cells]\n\nsaveRDS(CLRawData,file = paste0(\"Data/MouseCortexFromLoom/SingleClusterRawData/Cl\",cl,sampleCondition,\"RawData.RDS\"))  \n}\n\n\n\nE17.5\n\nE17.5Clusters.code &lt;- c(516,505)\n\nfb175Obj &lt;- readRDS(file = file.path(\"Data/MouseCortexFromLoom/\", \"E17.5_ForebrainDorsal.cotan.RDS\"))\n\nsampleCondition &lt;- getMetadataElement(fb175Obj, datasetTags()[[\"cond\"]])\n\nfor (cl in E17.5Clusters.code) {\n  cells &lt;- names(getClusters(fb175Obj, \n      clName = \"original.clusters\")[getClusters(fb175Obj, \n                          clName = \"original.clusters\") == cl])\n\nCLRawData &lt;- getRawData(fb175Obj)[,cells]\n\nsaveRDS(CLRawData,file = paste0(\"Data/MouseCortexFromLoom/SingleClusterRawData/Cl\",cl,sampleCondition,\"RawData.RDS\"))  \n}",
    "crumbs": [
      "GDI sensitivity",
      "Clusters Distance Evaluation"
    ]
  },
  {
    "objectID": "OriginalClustersDistanceEvaluation.html#defining-the-two-distances",
    "href": "OriginalClustersDistanceEvaluation.html#defining-the-two-distances",
    "title": "Original Clusters Distance Evaluation",
    "section": "Defining the two distances",
    "text": "Defining the two distances\nTo roughly determine the cluster distances we decided to test two simple Euclidean distances:\n\nover the mean of the 0/1 raw matrix\nover the \\(1-e^{-\\lambda}\\) where \\(\\lambda\\) is the average expression for the genes.\n\n\nClFiles &lt;- list.files(\"Data/MouseCortexFromLoom/SingleClusterRawData/\")\n\ntot.Df.ZeroOne &lt;- NA\ntot.Df.Lambda &lt;- NA\nfor(Fl in ClFiles) {\n  print(Fl)\n  cl &lt;- str_split(Fl,pattern = \"_\",simplify = T)[1]\n  data &lt;- readRDS(paste0(\"Data/MouseCortexFromLoom/SingleClusterRawData/\",\n                         Fl))\n  \n  obj &lt;- COTAN(data)\n  \n  ZeroOne &lt;- rowMeans(as.matrix(getZeroOneProj(obj)))\n  tot.Df.ZeroOne &lt;- merge(tot.Df.ZeroOne,ZeroOne,by = 0,all = T)\n  tot.Df.ZeroOne[is.na(tot.Df.ZeroOne)] &lt;- 0\n  colnames(tot.Df.ZeroOne)[ncol(tot.Df.ZeroOne)] &lt;- cl\n  tot.Df.ZeroOne &lt;- column_to_rownames(tot.Df.ZeroOne,var = \"Row.names\")\n  \n  obj &lt;- estimateLambdaLinear(obj)\n  Lambda &lt;- getLambda(obj)\n  tot.Df.Lambda &lt;- merge(tot.Df.Lambda,1-exp(-Lambda),by = 0, all = T)\n  tot.Df.Lambda[is.na(tot.Df.Lambda)] &lt;- 0\n  colnames(tot.Df.Lambda)[ncol(tot.Df.Lambda)] &lt;- cl\n  tot.Df.Lambda &lt;- column_to_rownames(tot.Df.Lambda,var = \"Row.names\")\n  \n}\ntot.Df.Lambda &lt;- tot.Df.Lambda[,2:ncol(tot.Df.Lambda)]\ntot.Df.ZeroOne &lt;- tot.Df.ZeroOne[,2:ncol(tot.Df.ZeroOne)]\n\ntot.Df.Lambda &lt;- tot.Df.Lambda[2:nrow(tot.Df.Lambda),]\ntot.Df.ZeroOne &lt;- tot.Df.ZeroOne[2:nrow(tot.Df.Lambda),]\n\n\nhead(tot.Df.Lambda)\nhead(tot.Df.ZeroOne)\n\n\nsaveRDS(tot.Df.Lambda, \"Data/MouseCortexFromLoom/ClustersDistances/Tot.Df.Lambda.RDS\")\nsaveRDS(tot.Df.ZeroOne, \"Data/MouseCortexFromLoom/ClustersDistances/Tot.Df.ZeroOne.RDS\")\n\n\nlibrary(ComplexHeatmap)\ndistance.df.Lambda &lt;- as.matrix(dist(t(tot.Df.Lambda),diag = T,upper = T))\n\nHeatmapLambda &lt;-  Heatmap(distance.df.Lambda,\n        name = \"Lambda\\ndistance\", \n        cell_fun = function(j, i, x, y, width, height, fill) \n        {\n          grid.text(sprintf(\"%.1f\", distance.df.Lambda[i, j]), x, y, gp = gpar(fontsize = 10))\n        },\n        show_row_dend = F, \n        show_row_names = F)\n\npdf(\"Results/ClustersDistances/HeatmapLambda.pdf\",width = 6,height = 5)\nplot(HeatmapLambda)\ndev.off()\n\npng \n  2 \n\nplot(HeatmapLambda)\n\n\n\n\n\n\n\n\n\ndistance.df.ZeroOne &lt;- as.matrix(dist(t(tot.Df.ZeroOne),diag = T,upper = T))\n\nHeatmapZeorOne &lt;- Heatmap(distance.df.ZeroOne,\n        name = \"ZeroOne\\ndistance\", \n        cell_fun = function(j, i, x, y, width, height, fill) \n        {\n          grid.text(sprintf(\"%.1f\", distance.df.ZeroOne[i, j]), x, y, gp = gpar(fontsize = 10))\n        },\n        show_row_dend = F, \n        show_row_names = F)\n\npdf(\"Results/ClustersDistances/HeatmapZeorOne.pdf\",width = 6,height = 5)\nplot(HeatmapZeorOne)\ndev.off()\n\npng \n  2 \n\nplot(HeatmapZeorOne)\n\n\n\n\n\n\n\n\nThe distances are very similar with the Zero One a little lower as values…\n\ndistance.df.Lambda.Plot &lt;- rownames_to_column(as.data.frame(distance.df.Lambda),\n                                              var = \"Cl.1\")\ndistance.df.Lambda.Plot &lt;-pivot_longer(distance.df.Lambda.Plot,\n                                       cols = !Cl.1,\n                                       names_to = \"Cl.2\", \n                                       values_to = \"Lambda.Dist\")\n\ndistance.df.ZeroOne.Plot &lt;- rownames_to_column(as.data.frame(distance.df.ZeroOne),\n                                              var = \"Cl.1\")\ndistance.df.ZeroOne.Plot &lt;-pivot_longer(distance.df.ZeroOne.Plot,\n                                       cols = !Cl.1,\n                                       names_to = \"Cl.2\", \n                                       values_to = \"ZeroOne.Dist\")\n\ndistance.df.Tot &lt;- merge(distance.df.ZeroOne.Plot,distance.df.Lambda.Plot,by= c(\"Cl.1\",\"Cl.2\"),all=T)\n\nggplot(as.data.frame(distance.df.Tot),aes(x=ZeroOne.Dist, y=Lambda.Dist))+geom_point()\n\n\n\n\n\n\n\n\nSo for what we are using it is the same.\nThe key information is that we can define couple of, in one case, triplets of very near clusters:\n\nCl510e13.5 and Cl510e15.0\nCl516e17.5 and Cl505e17.5\nCl509e15.0 and Cl508e15.0 which are also similar to Cl432e13.5 and Cl432e15.0\nCl432e13.5 and Cl432e15.0\nCl437e13.5 and Cl437e15.0\nCl428e15.0, Cl434e15.0 and Cl434e13.5\n\nBased on these distances we can consider three thresholds (with number of cluster pair):\n\nless than 7 (first quartile)\n\nsum(distance.df.ZeroOne &lt; 7.1 & distance.df.ZeroOne &gt; 0)/2\n\n[1] 19\n\n\nbetween 9 and 11 (around median)\n\nsum(distance.df.ZeroOne &gt; 9 & distance.df.ZeroOne &lt; 11)/2\n\n[1] 20\n\n\nmore than 13 (3rd quartile)\n\nsum(distance.df.ZeroOne &gt; 13)/2\n\n[1] 32\n\n\n\n\n\nsessionInfo()\n\nR version 4.4.0 (2024-04-24)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] grid      stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] ComplexHeatmap_2.20.0 lubridate_1.9.3       forcats_1.0.0        \n [4] dplyr_1.1.4           purrr_1.0.2           readr_2.1.5          \n [7] tidyr_1.3.1           tibble_3.2.1          ggplot2_3.5.1        \n[10] tidyverse_2.0.0       stringr_1.5.1         COTAN_2.5.2          \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.22          splines_4.4.0            \n  [3] later_1.3.2               polyclip_1.10-6          \n  [5] fastDummies_1.7.3         lifecycle_1.0.4          \n  [7] doParallel_1.0.17         globals_0.16.3           \n  [9] lattice_0.22-6            MASS_7.3-60.2            \n [11] dendextend_1.17.1         magrittr_2.0.3           \n [13] plotly_4.10.4             rmarkdown_2.27           \n [15] yaml_2.3.8                httpuv_1.6.15            \n [17] Seurat_5.1.0              sctransform_0.4.1        \n [19] spam_2.10-0               askpass_1.2.0            \n [21] sp_2.1-4                  spatstat.sparse_3.0-3    \n [23] reticulate_1.37.0         cowplot_1.1.3            \n [25] pbapply_1.7-2             RColorBrewer_1.1-3       \n [27] abind_1.4-5               zlibbioc_1.50.0          \n [29] Rtsne_0.17                BiocGenerics_0.50.0      \n [31] circlize_0.4.16           IRanges_2.38.0           \n [33] S4Vectors_0.42.0          ggrepel_0.9.5            \n [35] irlba_2.3.5.1             listenv_0.9.1            \n [37] spatstat.utils_3.0-4      umap_0.2.10.0            \n [39] goftest_1.2-3             RSpectra_0.16-1          \n [41] spatstat.random_3.2-3     dqrng_0.4.0              \n [43] fitdistrplus_1.1-11       parallelly_1.37.1        \n [45] DelayedMatrixStats_1.26.0 leiden_0.4.3.1           \n [47] codetools_0.2-20          DelayedArray_0.30.1      \n [49] tidyselect_1.2.1          shape_1.4.6.1            \n [51] farver_2.1.2              ScaledMatrix_1.12.0      \n [53] viridis_0.6.5             matrixStats_1.3.0        \n [55] stats4_4.4.0              spatstat.explore_3.2-7   \n [57] jsonlite_1.8.8            GetoptLong_1.0.5         \n [59] progressr_0.14.0          ggridges_0.5.6           \n [61] survival_3.6-4            iterators_1.0.14         \n [63] foreach_1.5.2             tools_4.4.0              \n [65] ica_1.0-3                 Rcpp_1.0.12              \n [67] glue_1.7.0                gridExtra_2.3            \n [69] SparseArray_1.4.5         xfun_0.44                \n [71] MatrixGenerics_1.16.0     ggthemes_5.1.0           \n [73] withr_3.0.0               fastmap_1.2.0            \n [75] fansi_1.0.6               openssl_2.2.0            \n [77] digest_0.6.35             rsvd_1.0.5               \n [79] timechange_0.3.0          parallelDist_0.2.6       \n [81] R6_2.5.1                  mime_0.12                \n [83] colorspace_2.1-0          Cairo_1.6-2              \n [85] scattermore_1.2           tensor_1.5               \n [87] spatstat.data_3.0-4       utf8_1.2.4               \n [89] generics_0.1.3            data.table_1.15.4        \n [91] httr_1.4.7                htmlwidgets_1.6.4        \n [93] S4Arrays_1.4.1            uwot_0.2.2               \n [95] pkgconfig_2.0.3           gtable_0.3.5             \n [97] lmtest_0.9-40             XVector_0.44.0           \n [99] htmltools_0.5.8.1         dotCall64_1.1-1          \n[101] clue_0.3-65               SeuratObject_5.0.2       \n[103] scales_1.3.0              png_0.1-8                \n[105] knitr_1.46                rstudioapi_0.16.0        \n[107] tzdb_0.4.0                reshape2_1.4.4           \n[109] rjson_0.2.21              nlme_3.1-164             \n[111] zoo_1.8-12                GlobalOptions_0.1.2      \n[113] KernSmooth_2.23-24        parallel_4.4.0           \n[115] miniUI_0.1.1.1            RcppZiggurat_0.1.6       \n[117] pillar_1.9.0              vctrs_0.6.5              \n[119] RANN_2.6.1                promises_1.3.0           \n[121] BiocSingular_1.20.0       beachmat_2.20.0          \n[123] xtable_1.8-4              cluster_2.1.6            \n[125] evaluate_0.23             zeallot_0.1.0            \n[127] cli_3.6.2                 compiler_4.4.0           \n[129] rlang_1.1.3               crayon_1.5.2             \n[131] future.apply_1.11.2       labeling_0.4.3           \n[133] plyr_1.8.9                stringi_1.8.4            \n[135] viridisLite_0.4.2         deldir_2.0-4             \n[137] BiocParallel_1.38.0       assertthat_0.2.1         \n[139] munsell_0.5.1             lazyeval_0.2.2           \n[141] spatstat.geom_3.2-9       PCAtools_2.16.0          \n[143] Matrix_1.7-0              RcppHNSW_0.6.0           \n[145] hms_1.1.3                 patchwork_1.2.0          \n[147] sparseMatrixStats_1.16.0  future_1.33.2            \n[149] shiny_1.8.1.1             ROCR_1.0-11              \n[151] Rfast_2.1.0               igraph_2.0.3             \n[153] RcppParallel_5.1.7",
    "crumbs": [
      "GDI sensitivity",
      "Clusters Distance Evaluation"
    ]
  },
  {
    "objectID": "cd14_clusterizations_comparisons.html",
    "href": "cd14_clusterizations_comparisons.html",
    "title": "CD14+ clusterizations comparisons with CellTypist",
    "section": "",
    "text": "#library(SingleCellExperiment)\n#library(DuoClustering2018)\n#library(tidyr)\nlibrary(rlang)\nlibrary(ggplot2)\nlibrary(ggsankey) # remotes::install_github(\"davidsjoberg/ggsankey\")\nlibrary(tibble)\nlibrary(zeallot)\nlibrary(assertthat)\nlibrary(COTAN)\nlibrary(caret)\ntheme_set(theme_bw())\nlibrary(stringr)\nlibrary(nnet)\n#devtools::load_all(\"~/dev/COTAN/COTAN/\")\n\noptions(parallelly.fork.enable = TRUE)\n\noutDir &lt;- \"Results/Clusterization/\"\n\nsetLoggingLevel(2)\nsetLoggingFile(file.path(outDir, \"CD14_Monocytes_ClusterizationsComparisons.log\"))\n\n\ncd14Obj &lt;- readRDS(file = file.path(\"Data/CD14Cleaned/\", \"CD14_Monocytes.cotan.RDS\"))\n\nsampleCondition &lt;- getMetadataElement(cd14Obj, datasetTags()[[\"cond\"]])\n\nsampleCondition\n\n[1] \"CD14_Monocytes\"\n\ngetClusterizations(cd14Obj)\n\n[1] \"split\"           \"merge\"           \"majority-voting\"\n\nmetaC &lt;- getMetadataCells(cd14Obj)\n\n\nsplitClusters &lt;- getClusters(cd14Obj, \"split\")\nmergedClusters &lt;- getClusters(cd14Obj, \"merge\")\n\n\nlabelsDF &lt;- read.csv(file.path(\"Data/CD14Cleaned/\", \"CD14Cleaned_Immune_All_Low_predicted_labels.csv\"), header = TRUE)\nlabelsDF &lt;- column_to_rownames(labelsDF, var = \"X\")\nrownames(labelsDF) &lt;- gsub(\"[.]\", \"-\", rownames(labelsDF))\n\ncells_to_keep &lt;- rownames(labelsDF)[rownames(labelsDF) %in% getCells(cd14Obj)]\nassert_that(identical(cells_to_keep, getCells(cd14Obj)))\n\nmajorityVotingClusters &lt;- labelsDF[cells_to_keep, \"majority_voting\"]\nnames(majorityVotingClusters) &lt;- cells_to_keep\n\nmajorityVotingCoexDF &lt;- DEAOnClusters(cd14Obj,clName =\"majority-voting\",clusters =   majorityVotingClusters)\n\ncd14Obj &lt;- addClusterization(cd14Obj, clName = \"majority-voting\",\n                             clusters = majorityVotingClusters,\n                             coexDF = majorityVotingCoexDF)\n\nSave the COTAN object\n\nsaveRDS(cd14Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\nnlevels(splitClusters)\nhead(sort(table(splitClusters), decreasing = TRUE), 10L)\n\nnlevels(mergedClusters)\nhead(sort(table(mergedClusters), decreasing = TRUE), 10L)\n\nnlevels(majorityVotingClusters)\nhead(sort(table(majorityVotingClusters), decreasing = TRUE), 10L)\n\n\nsplitClustersDF &lt;- as.data.frame(splitClusters)\nsplitClustersDF[[\"cell\"]] &lt;- rownames(splitClustersDF)\ncolnames(splitClustersDF)[[1]] &lt;- \"COTAN.split.cluster\"\nsplitClustersDF &lt;- splitClustersDF[order(splitClustersDF[[\"COTAN.split.cluster\"]]), ]\n\nmergedClustersDF &lt;- as.data.frame(mergedClusters)\nmergedClustersDF[[\"cell\"]] &lt;- rownames(mergedClustersDF)\ncolnames(mergedClustersDF)[[1]] &lt;- \"COTAN.merged.cluster\"\nmergedClustersDF &lt;- mergedClustersDF[order(mergedClustersDF[[\"COTAN.merged.cluster\"]]), ]\n\nmajorityVotingClustersDF &lt;- as.data.frame(majorityVotingClusters)\nmajorityVotingClustersDF[[\"cell\"]] &lt;- rownames(majorityVotingClustersDF)\ncolnames(majorityVotingClustersDF)[[1]] &lt;- \"majority.voting.cluster\"\nmajorityVotingClustersDF &lt;- majorityVotingClustersDF[order(majorityVotingClustersDF[[\"majority.voting.cluster\"]]), ]\n\n\nmjvt_split.table &lt;- merge.data.frame(x = majorityVotingClustersDF, y = splitClustersDF,\n                                         by = \"cell\", all.x = TRUE, all.y = TRUE)\n\ntable(mjvt_split.table[,c(2L, 3L)])\n\n                       COTAN.split.cluster\nmajority.voting.cluster   1   2   3   4   5\n    Classical monocytes 877   3 637 837  48\n    NK cells              1  25   0   0   0\n    pDC                   0  10   0   0   0\n\n\n\nmjvt_split.table2 &lt;- mjvt_split.table %&gt;% make_long(majority.voting.cluster, COTAN.split.cluster)\n\nggplot(mjvt_split.table2,\n       aes(x = x,\n           next_x = next_x,\n           node = node,\n           next_node = next_node,\n           fill = factor(node),\n           label = node)) +\n  geom_sankey(flow.alpha = 0.75, node.color = 1) +\n  geom_sankey_label(size = 3.5, color = 1, fill = \"white\") +\n  scale_fill_viridis_d(option = \"A\", alpha = 0.95) +\n  theme_sankey(base_size = 16) +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n\nmjvt_merged.table &lt;- merge.data.frame(x = majorityVotingClustersDF, y = mergedClustersDF,\n                                         by = \"cell\", all.x = TRUE, all.y = TRUE)\n\ntable(mjvt_merged.table[,c(2L, 3L)])\n\n                       COTAN.merged.cluster\nmajority.voting.cluster    1    2    3\n    Classical monocytes 1522  877    3\n    NK cells               0    1   25\n    pDC                    0    0   10\n\n\n\nmjvt_merged.table2 &lt;- mjvt_merged.table %&gt;% make_long(majority.voting.cluster, COTAN.merged.cluster)\n\nggplot(mjvt_merged.table2,\n       aes(x = x,\n           next_x = next_x,\n           node = node,\n           next_node = next_node,\n           fill = factor(node),\n           label = node)) +\n  geom_sankey(flow.alpha = 0.75, node.color = 1) +\n  geom_sankey_label(size = 3.5, color = 1, fill = \"white\") +\n  scale_fill_viridis_d(option = \"A\", alpha = 0.95) +\n  theme_sankey(base_size = 16) +\n  theme(legend.position = \"none\")\n\n\n\n\n\n\n\n\n\nmarkersCD14 &lt;- findClustersMarkers(cd14Obj,n = 100,clName = \"merge\",method = \"BH\")\nwrite.csv(markersCD14,file = \"Data/CD14Cleaned/ClusterMarkerGenes.csv\")\nhead(markersCD14)\n\n  CL     Gene      Score      adjPVal         DEA IsMarker  logFoldCh\n1  1 HLA-DQA1 -0.3398915 2.603676e-59 -0.15274999        0 -0.5470222\n2  1 HLA-DQA2 -0.2899185 7.002901e-43 -0.12223685        0 -0.4804835\n3  1 HLA-DPA1 -0.2808830 2.589504e-40 -0.13090249        0 -0.4370669\n4  1  HLA-DRA -0.2499997 1.042557e-31 -0.10296185        0 -0.3654458\n5  1 HLA-DPB1 -0.2225778 5.652934e-25 -0.09887797        0 -0.3375752\n6  1     YBX1 -0.2095002 5.042102e-22 -0.08080263        0 -0.3784618\n\n\n\ncd14GDI &lt;- calculateGDI(cd14Obj)\n\nsubsetGDI &lt;- cd14GDI[cd14GDI$sum.raw.norm &gt; 7,]\ntop.GDI.genes &lt;- rownames(subsetGDI[order(subsetGDI$GDI,decreasing = T),])[1:50]\n\nGDIPlot(cd14Obj,genes = \"\",GDIIn = cd14GDI)\n\n\n\n\n\n\n\n\n\ndata &lt;- getNormalizedData(cd14Obj)\n\ndata &lt;- data[!rowSums(as.matrix(data)) &lt; 1,]\ndata &lt;- log(data*10000+1)\n\nrow_stdev &lt;- apply(data, 1, sd, na.rm=TRUE)\nrow_stdev &lt;- row_stdev[order(row_stdev,decreasing = T)]\n\ngenes.to.keep &lt;- c(names(row_stdev[1:100]),top.GDI.genes)\n\ndata.small &lt;- data[rownames(data) %in% genes.to.keep,]\n\n#data &lt;- t(as.matrix(data))\ndata.small &lt;- t(as.matrix(data.small))\n\n\nCOTAN_Cl.code &lt;- getClusterizationData(cd14Obj,clName = \"merge\")[[1]]\n#COTAN_Cl.code[COTAN_Cl.code == \"A549\"] &lt;- 0\n#COTAN_Cl.code[COTAN_Cl.code == \"CCL-185-IG\"] &lt;- 1\n\nCOTAN_Cl.code &lt;- as.numeric(COTAN_Cl.code)\n\ndata.small &lt;- cbind(data.small,COTAN_Cl.code)\ndata.small &lt;- as.data.frame(data.small)\n\n# Split the data into training and test set\nset.seed(123)\ntraining.samples &lt;- data.small[,\"COTAN_Cl.code\"] %&gt;% \n  createDataPartition(p = 0.8, list = FALSE)\ntrain.data  &lt;- data.small[training.samples, ]\ntest.data &lt;- data.small[-training.samples, ]\nhead(train.data)\n\n                    RPL22   LAPTM5 ATP6V0B      RPL5      MCL1      CTSS\nAAACATACCACTAG-1 9.485384 9.485384       0  0.000000  0.000000  0.000000\nAAACATACGTTCAG-1 0.000000 0.000000       0  0.000000 10.114628  0.000000\nAAACATTGCTTCGC-1 0.000000 0.000000       0  0.000000  0.000000  0.000000\nAAACATTGGGCAAG-1 9.322304 0.000000       0  8.629246  9.727739  0.000000\nAAACGGCTACGGAG-1 0.000000 0.000000       0 10.582413  9.483852 10.870089\nAAACGGCTAGTCAC-1 0.000000 9.124915       0  9.124915  0.000000  9.818008\n                   S100A10   S100A11    S100A9    S100A8    S100A6   S100A4\nAAACATACCACTAG-1  9.485384  0.000000  9.485384  9.485384  9.485384 11.56476\nAAACATACGTTCAG-1  0.000000 10.114628 11.906354 11.367363 10.807755 11.36736\nAAACATTGCTTCGC-1  9.414354 10.512912 11.493724 11.812175 11.206045 11.71687\nAAACATTGGGCAAG-1 10.238541  9.322304 10.826311 11.519449 10.420856 11.33713\nAAACGGCTACGGAG-1 10.176961  0.000000 12.191831 11.881678 10.176961 11.56323\nAAACGGCTAGTCAC-1  0.000000 10.511128 12.120544 11.763871 10.916584 11.20426\n                     VAMP8     COX5B   NBEAL1 EEF1B2     ARPC2     RPL15\nAAACATACCACTAG-1 10.583946  0.000000 9.485384      0 10.178493 11.094761\nAAACATACGTTCAG-1 10.114628  0.000000 0.000000      0  0.000000  9.421522\nAAACATTGCTTCGC-1  9.414354  0.000000 9.414354      0  9.414354  9.414354\nAAACATTGGGCAAG-1  9.727739  8.629246 9.322304      0  8.629246 11.113989\nAAACGGCTACGGAG-1 10.176961 10.176961 0.000000      0  9.483852 10.582413\nAAACGGCTAGTCAC-1  9.818008  9.818008 9.124915      0  9.818008 10.916584\n                      RPSA      GPX1     RPL29    SERP1      BTF3      CD14\nAAACATACCACTAG-1  0.000000  9.485384  0.000000 0.000000  0.000000 10.178493\nAAACATACGTTCAG-1  9.421522  9.421522  0.000000 0.000000 10.114628 10.520080\nAAACATTGCTTCGC-1  0.000000  9.414354 10.512912 0.000000  0.000000  0.000000\nAAACATTGGGCAAG-1 10.931670 10.420856 10.015406 9.322304  0.000000  0.000000\nAAACGGCTACGGAG-1  0.000000 11.429697  9.483852 0.000000  0.000000  9.483852\nAAACGGCTAGTCAC-1  0.000000 10.223455  9.124915 9.124915  9.124915  0.000000\n                    DUSP1   HIGD2A  PRELID1     HLA-E      AIF1    CLIC1\nAAACATACCACTAG-1 0.000000 9.485384 0.000000  0.000000  9.485384 10.58395\nAAACATACGTTCAG-1 9.421522 0.000000 0.000000  0.000000  9.421522  0.00000\nAAACATTGCTTCGC-1 9.414354 9.414354 0.000000  0.000000 11.206045  0.00000\nAAACATTGGGCAAG-1 9.322304 9.322304 9.727739  8.629246  9.727739  0.00000\nAAACGGCTACGGAG-1 0.000000 0.000000 0.000000  0.000000  0.000000  0.00000\nAAACGGCTAGTCAC-1 9.124915 0.000000 9.124915 10.511128  9.818008  0.00000\n                   HLA-DRA  HLA-DRB5  HLA-DRB1 HLA-DQA1  HLA-DQB1  HLA-DMA\nAAACATACCACTAG-1 10.583946 10.871621 11.883210        0 10.178493 0.000000\nAAACATACGTTCAG-1  9.421522  0.000000  9.421522        0  0.000000 0.000000\nAAACATTGCTTCGC-1  0.000000 10.107460 10.512912        0  0.000000 9.414354\nAAACATTGGGCAAG-1 10.575003 10.015406 10.575003        0  9.727739 0.000000\nAAACGGCTACGGAG-1  0.000000  9.483852  9.483852        0  0.000000 0.000000\nAAACGGCTAGTCAC-1 10.223455  0.000000  9.818008        0  9.124915 0.000000\n                 HLA-DPA1  HLA-DPB1    RPS10    SF3B5  RNASET2      RAC1\nAAACATACCACTAG-1 9.485384  9.485384 0.000000 0.000000 0.000000 10.178493\nAAACATACGTTCAG-1 0.000000  0.000000 9.421522 0.000000 0.000000  0.000000\nAAACATTGCTTCGC-1 0.000000  9.414354 0.000000 0.000000 0.000000  9.414354\nAAACATTGGGCAAG-1 0.000000 11.113989 9.727739 9.727739 8.629246  0.000000\nAAACGGCTACGGAG-1 0.000000  0.000000 0.000000 0.000000 9.483852  0.000000\nAAACGGCTAGTCAC-1 0.000000  0.000000 9.124915 0.000000 0.000000  9.124915\n                     TOMM7     PPIA CHCHD2    ARPC1B TMEM176B   SLC25A6 TIMP1\nAAACATACCACTAG-1  9.485384 0.000000      0  9.485384 0.000000 10.178493     0\nAAACATACGTTCAG-1 10.114628 9.421522      0 10.114628 0.000000 10.114628     0\nAAACATTGCTTCGC-1 10.107460 0.000000      0  0.000000 9.414354 10.512912     0\nAAACATTGGGCAAG-1  8.629246 0.000000      0  8.629246 0.000000  8.629246     0\nAAACGGCTACGGAG-1  0.000000 0.000000      0 10.176961 9.483852  0.000000     0\nAAACGGCTAGTCAC-1  0.000000 0.000000      0  9.818008 9.124915  9.124915     0\n                      CFP     CEBPD   PABPC1     EDF1      KLF6       VIM\nAAACATACCACTAG-1  0.00000  0.000000 0.000000 9.485384 10.178493 10.178493\nAAACATACGTTCAG-1 10.11463  0.000000 0.000000 0.000000 10.114628  9.421522\nAAACATTGCTTCGC-1  0.00000  9.414354 0.000000 0.000000  9.414354  0.000000\nAAACATTGGGCAAG-1 10.70853  8.629246 0.000000 9.322304 10.015406  9.727739\nAAACGGCTACGGAG-1  0.00000 11.093229 0.000000 0.000000 10.176961  0.000000\nAAACGGCTAGTCAC-1  0.00000 10.223455 9.818008 0.000000  0.000000  9.818008\n                     SRGN   TALDO1     LSP1   MS4A6A    NEAT1    ATP5L     TPI1\nAAACATACCACTAG-1 9.485384 0.000000 9.485384 9.485384 0.000000 0.000000 0.000000\nAAACATACGTTCAG-1 0.000000 9.421522 0.000000 0.000000 9.421522 0.000000 0.000000\nAAACATTGCTTCGC-1 0.000000 0.000000 0.000000 0.000000 9.414354 9.414354 0.000000\nAAACATTGGGCAAG-1 8.629246 0.000000 9.727739 0.000000 9.322304 0.000000 8.629246\nAAACGGCTACGGAG-1 9.483852 0.000000 0.000000 0.000000 0.000000 0.000000 0.000000\nAAACGGCTAGTCAC-1 9.124915 9.124915 0.000000 9.818008 0.000000 0.000000 0.000000\n                  ARHGDIB     CD63      NACA LINC00936     ARPC3   ATP5EP2\nAAACATACCACTAG-1 0.000000 0.000000  0.000000  0.000000 10.178493  0.000000\nAAACATACGTTCAG-1 0.000000 9.421522  9.421522 10.114628  0.000000  9.421522\nAAACATTGCTTCGC-1 9.414354 0.000000  0.000000  0.000000  9.414354 10.512912\nAAACATTGGGCAAG-1 8.629246 8.629246  9.727739  8.629246  0.000000  8.629246\nAAACGGCTACGGAG-1 0.000000 0.000000 10.176961  9.483852  9.483852  0.000000\nAAACGGCTAGTCAC-1 9.124915 9.124915  0.000000  0.000000  9.818008  9.124915\n                     TPT1    PSME1     PSME2   NFKBIA   RPL36AL     NPC2\nAAACATACCACTAG-1 0.000000 0.000000 10.178493 0.000000  0.000000 9.485384\nAAACATACGTTCAG-1 9.421522 9.421522  0.000000 0.000000  9.421522 0.000000\nAAACATTGCTTCGC-1 9.414354 0.000000  0.000000 0.000000  0.000000 0.000000\nAAACATTGGGCAAG-1 0.000000 8.629246  9.322304 9.322304  9.322304 0.000000\nAAACGGCTACGGAG-1 0.000000 0.000000  9.483852 0.000000 10.176961 0.000000\nAAACGGCTAGTCAC-1 9.818008 0.000000  9.818008 9.124915  9.124915 9.818008\n                    CRIP1    ANXA2     RPL4    TCEB2   CORO1A    PYCARD\nAAACATACCACTAG-1  0.00000 0.000000 10.58395 0.000000 9.485384 10.871621\nAAACATACGTTCAG-1  0.00000 9.421522 10.11463 9.421522 0.000000  0.000000\nAAACATTGCTTCGC-1  0.00000 0.000000  0.00000 0.000000 9.414354  9.414354\nAAACATTGGGCAAG-1 10.42086 9.322304  0.00000 0.000000 8.629246  9.727739\nAAACGGCTACGGAG-1  0.00000 9.483852  0.00000 0.000000 0.000000 10.176961\nAAACGGCTAGTCAC-1  0.00000 0.000000  0.00000 0.000000 9.124915  9.818008\n                    COTL1     APRT   GABARAP    EIF4A1 UBB     RPL23 GRN\nAAACATACCACTAG-1 0.000000 0.000000  9.485384  0.000000   0  0.000000   0\nAAACATACGTTCAG-1 0.000000 0.000000  9.421522  0.000000   0  9.421522   0\nAAACATTGCTTCGC-1 0.000000 0.000000  0.000000 10.107460   0  9.414354   0\nAAACATTGGGCAAG-1 0.000000 8.629246  8.629246  9.322304   0 10.015406   0\nAAACGGCTACGGAG-1 0.000000 0.000000 10.176961  0.000000   0  0.000000   0\nAAACGGCTAGTCAC-1 9.124915 0.000000  9.124915  0.000000   0  0.000000   0\n                     RPL38    ACTG1    SCAND1    PSMA7     RPS21       CFD\nAAACATACCACTAG-1  0.000000 0.000000  9.485384  0.00000  0.000000  9.485384\nAAACATACGTTCAG-1 10.114628 0.000000  0.000000  0.00000  9.421522  0.000000\nAAACATTGCTTCGC-1  0.000000 0.000000  0.000000 10.51291 10.107460 10.512912\nAAACATTGGGCAAG-1  8.629246 9.322304  0.000000 10.01541  8.629246  0.000000\nAAACGGCTACGGAG-1  0.000000 0.000000 10.176961  0.00000  9.483852  0.000000\nAAACGGCTAGTCAC-1  0.000000 9.124915  9.818008 10.22345  9.818008  9.124915\n                     GPX4     ATP5D  UQCR11.1  NDUFA11 C19orf43     JUNB\nAAACATACCACTAG-1 11.88321  0.000000  0.000000 0.000000 9.485384 0.000000\nAAACATACGTTCAG-1  0.00000  0.000000 10.114628 9.421522 0.000000 0.000000\nAAACATTGCTTCGC-1  0.00000  0.000000  0.000000 0.000000 0.000000 9.414354\nAAACATTGGGCAAG-1  0.00000  8.629246  9.727739 9.322304 8.629246 0.000000\nAAACGGCTACGGAG-1  0.00000 10.176961  0.000000 9.483852 0.000000 0.000000\nAAACGGCTAGTCAC-1  0.00000  0.000000  0.000000 9.818008 0.000000 0.000000\n                      IER2     PGLS      JUND   NDUFA13     FXYD5   COX6B1\nAAACATACCACTAG-1  0.000000 0.000000  9.485384  0.000000  0.000000 9.485384\nAAACATACGTTCAG-1 11.030895 0.000000  0.000000 10.114628  0.000000 9.421522\nAAACATTGCTTCGC-1  9.414354 0.000000  9.414354 10.107460 10.107460 0.000000\nAAACATTGGGCAAG-1  0.000000 8.629246  8.629246  0.000000  9.322304 8.629246\nAAACGGCTACGGAG-1  0.000000 0.000000 10.176961  9.483852  0.000000 9.483852\nAAACGGCTAGTCAC-1 11.427402 0.000000  9.124915  9.124915  0.000000 9.818008\n                     HCST    TYROBP      GMFG    ZFP36    BLVRB     FOSB\nAAACATACCACTAG-1 0.000000 10.178493  0.000000 0.000000 0.000000 0.000000\nAAACATACGTTCAG-1 0.000000 10.807755 10.114628 0.000000 0.000000 9.421522\nAAACATTGCTTCGC-1 0.000000 10.800587  9.414354 0.000000 0.000000 9.414354\nAAACATTGGGCAAG-1 8.629246 10.575003  9.322304 0.000000 9.322304 0.000000\nAAACGGCTACGGAG-1 0.000000  9.483852  0.000000 0.000000 9.483852 0.000000\nAAACGGCTAGTCAC-1 0.000000 11.522711  9.124915 9.818008 9.124915 9.818008\n                     AP2S1   GLTSCR2      EMP3     FCGRT      RPS5    LGALS2\nAAACATACCACTAG-1  0.000000  9.485384  9.485384  0.000000  9.485384 10.178493\nAAACATACGTTCAG-1  0.000000  9.421522  0.000000  0.000000  0.000000  0.000000\nAAACATTGCTTCGC-1  0.000000  0.000000  9.414354  0.000000 10.107460  0.000000\nAAACATTGGGCAAG-1  8.629246  0.000000 10.826311  0.000000 10.015406  9.727739\nAAACGGCTACGGAG-1 10.176961  0.000000 10.870089 10.176961 10.176961  0.000000\nAAACGGCTAGTCAC-1  0.000000 10.223455  0.000000  9.124915  0.000000  0.000000\n                   MT-ND2  MT-ATP6   MT-ND4   MT-CYB COTAN_Cl.code\nAAACATACCACTAG-1 0.000000 0.000000 9.485384 0.000000             1\nAAACATACGTTCAG-1 0.000000 9.421522 0.000000 9.421522             1\nAAACATTGCTTCGC-1 0.000000 9.414354 0.000000 9.414354             1\nAAACATTGGGCAAG-1 8.629246 9.727739 0.000000 8.629246             2\nAAACGGCTACGGAG-1 0.000000 0.000000 0.000000 9.483852             1\nAAACGGCTAGTCAC-1 9.124915 9.124915 0.000000 0.000000             1\n\n\n\ntrain.data$COTAN_Cl.code &lt;- as.factor(train.data$COTAN_Cl.code)\ntest.data$COTAN_Cl.code &lt;- as.factor(test.data$COTAN_Cl.code)\n# Fit the model\n#model &lt;- glm( COTAN_Cl.code ~., data = train.data, family = binomial,control = list(maxit = 75))\nmodel &lt;- multinom(COTAN_Cl.code ~ ., data = train.data, maxit = 500)\n\n# weights:  369 (244 variable)\ninitial  value 2143.392575 \niter  10 value 761.340646\niter  20 value 746.268326\niter  30 value 720.679315\niter  40 value 579.207155\niter  50 value 545.792232\niter  60 value 539.711792\niter  70 value 526.902032\niter  80 value 506.380523\niter  90 value 485.108188\niter 100 value 480.679083\niter 110 value 476.395523\niter 120 value 462.778421\niter 130 value 457.035815\niter 140 value 455.285417\niter 150 value 449.873877\niter 160 value 446.861152\niter 170 value 444.452737\niter 180 value 439.972413\niter 190 value 437.990151\niter 200 value 437.057149\niter 210 value 436.908590\niter 220 value 436.792687\niter 230 value 436.667356\niter 240 value 436.372853\niter 250 value 435.784259\niter 260 value 435.132550\niter 270 value 434.964836\niter 280 value 434.951070\niter 290 value 434.949618\niter 300 value 434.949374\nfinal  value 434.949335 \nconverged\n\nprobabilities &lt;- predict(model, newdata = test.data, type = \"probs\")\n\n# Find the class with the highest probability for each case\npredicted.classes &lt;- apply(probabilities, 1, which.max)\n\n# Adjust predicted classes to match your factor levels\nlevels &lt;- levels(train.data$COTAN_Cl.code)\npredicted.classes &lt;- levels[predicted.classes]\n\n# Calculate model accuracy\naccuracy &lt;- mean(predicted.classes == test.data$COTAN_Cl.code)\n#result.df[nrow(result.df),\"Accuracy\"] &lt;- accuracy\nprint(accuracy)\n\n[1] 0.8521561\n\n\nSo the logistic regression accuracy for COTAN three clusters is quite good.\n\n\n\nCluster 1 top enriched genes. In red enriched Reactome Pathways innate immune system genes.\n\n\n\n\n\ncluster 2 - 100 top enriched genes. In red Antigen processing and presentation of exogenous peptide antigen via MHC class II genes, in violet Regulation of leukocyte cell-cell adhesion (GO Biological Process) and in green Adaptive Immune System\n\n\n\n\n\nCluster 3 - 100 top enriched genes. In violet Cytokine Signaling in Immune system and in red Immunoregulatory interactions between a Lymphoid and a non-Lymphoid cell enriched genes for Reatome Pathways.\n\n\nThe cells in cluster 1 seem to be classical CD14 monocytes since they express CD14 while depleted in MHC class II proteins complex which is enriched in cell cluster 2 that seems intermediate monocytes.\nCluster 3 does not seem to be a monocyte cluster. Using enrichr website it is enriched in Plasmacytoid Dendritic cell marker genes.\n\nsessionInfo()\n\nR version 4.4.0 (2024-04-24)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] nnet_7.3-19        stringr_1.5.1      caret_6.0-94       lattice_0.22-6    \n [5] COTAN_2.5.2        assertthat_0.2.1   zeallot_0.1.0      tibble_3.2.1      \n [9] ggsankey_0.0.99999 ggplot2_3.5.1      rlang_1.1.3       \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.22          splines_4.4.0            \n  [3] later_1.3.2               polyclip_1.10-6          \n  [5] hardhat_1.3.1             pROC_1.18.5              \n  [7] rpart_4.1.23              fastDummies_1.7.3        \n  [9] lifecycle_1.0.4           doParallel_1.0.17        \n [11] globals_0.16.3            MASS_7.3-60.2            \n [13] dendextend_1.17.1         magrittr_2.0.3           \n [15] plotly_4.10.4             rmarkdown_2.27           \n [17] yaml_2.3.8                httpuv_1.6.15            \n [19] Seurat_5.1.0              sctransform_0.4.1        \n [21] spam_2.10-0               askpass_1.2.0            \n [23] sp_2.1-4                  spatstat.sparse_3.0-3    \n [25] reticulate_1.37.0         cowplot_1.1.3            \n [27] pbapply_1.7-2             RColorBrewer_1.1-3       \n [29] lubridate_1.9.3           abind_1.4-5              \n [31] zlibbioc_1.50.0           Rtsne_0.17               \n [33] purrr_1.0.2               BiocGenerics_0.50.0      \n [35] ipred_0.9-14              lava_1.8.0               \n [37] circlize_0.4.16           IRanges_2.38.0           \n [39] S4Vectors_0.42.0          ggrepel_0.9.5            \n [41] irlba_2.3.5.1             listenv_0.9.1            \n [43] spatstat.utils_3.0-4      umap_0.2.10.0            \n [45] goftest_1.2-3             RSpectra_0.16-1          \n [47] spatstat.random_3.2-3     dqrng_0.4.0              \n [49] fitdistrplus_1.1-11       parallelly_1.37.1        \n [51] DelayedMatrixStats_1.26.0 leiden_0.4.3.1           \n [53] codetools_0.2-20          DelayedArray_0.30.1      \n [55] tidyselect_1.2.1          shape_1.4.6.1            \n [57] farver_2.1.2              ScaledMatrix_1.12.0      \n [59] viridis_0.6.5             matrixStats_1.3.0        \n [61] stats4_4.4.0              spatstat.explore_3.2-7   \n [63] jsonlite_1.8.8            GetoptLong_1.0.5         \n [65] progressr_0.14.0          ggridges_0.5.6           \n [67] survival_3.6-4            iterators_1.0.14         \n [69] foreach_1.5.2             tools_4.4.0              \n [71] ica_1.0-3                 Rcpp_1.0.12              \n [73] glue_1.7.0                prodlim_2023.08.28       \n [75] gridExtra_2.3             SparseArray_1.4.5        \n [77] xfun_0.44                 MatrixGenerics_1.16.0    \n [79] ggthemes_5.1.0            dplyr_1.1.4              \n [81] withr_3.0.0               fastmap_1.2.0            \n [83] fansi_1.0.6               openssl_2.2.0            \n [85] digest_0.6.35             rsvd_1.0.5               \n [87] timechange_0.3.0          parallelDist_0.2.6       \n [89] R6_2.5.1                  mime_0.12                \n [91] colorspace_2.1-0          scattermore_1.2          \n [93] tensor_1.5                spatstat.data_3.0-4      \n [95] utf8_1.2.4                tidyr_1.3.1              \n [97] generics_0.1.3            data.table_1.15.4        \n [99] recipes_1.0.10            class_7.3-22             \n[101] httr_1.4.7                htmlwidgets_1.6.4        \n[103] S4Arrays_1.4.1            ModelMetrics_1.2.2.2     \n[105] uwot_0.2.2                pkgconfig_2.0.3          \n[107] gtable_0.3.5              timeDate_4032.109        \n[109] ComplexHeatmap_2.20.0     lmtest_0.9-40            \n[111] XVector_0.44.0            htmltools_0.5.8.1        \n[113] dotCall64_1.1-1           clue_0.3-65              \n[115] SeuratObject_5.0.2        scales_1.3.0             \n[117] png_0.1-8                 gower_1.0.1              \n[119] knitr_1.46                rstudioapi_0.16.0        \n[121] reshape2_1.4.4            rjson_0.2.21             \n[123] nlme_3.1-164              zoo_1.8-12               \n[125] GlobalOptions_0.1.2       KernSmooth_2.23-24       \n[127] parallel_4.4.0            miniUI_0.1.1.1           \n[129] RcppZiggurat_0.1.6        pillar_1.9.0             \n[131] grid_4.4.0                vctrs_0.6.5              \n[133] RANN_2.6.1                promises_1.3.0           \n[135] BiocSingular_1.20.0       beachmat_2.20.0          \n[137] xtable_1.8-4              cluster_2.1.6            \n[139] evaluate_0.23             cli_3.6.2                \n[141] compiler_4.4.0            crayon_1.5.2             \n[143] future.apply_1.11.2       labeling_0.4.3           \n[145] plyr_1.8.9                stringi_1.8.4            \n[147] viridisLite_0.4.2         deldir_2.0-4             \n[149] BiocParallel_1.38.0       munsell_0.5.1            \n[151] lazyeval_0.2.2            spatstat.geom_3.2-9      \n[153] PCAtools_2.16.0           Matrix_1.7-0             \n[155] RcppHNSW_0.6.0            patchwork_1.2.0          \n[157] sparseMatrixStats_1.16.0  future_1.33.2            \n[159] shiny_1.8.1.1             ROCR_1.0-11              \n[161] Rfast_2.1.0               igraph_2.0.3             \n[163] RcppParallel_5.1.7",
    "crumbs": [
      "Cluster evaluation",
      "CD14+ clusterizations"
    ]
  },
  {
    "objectID": "ForebrainDorsal_E135-analysis.html",
    "href": "ForebrainDorsal_E135-analysis.html",
    "title": "Forebrain Dorsal E13.5 Data-set Anaysis",
    "section": "",
    "text": "library(ggplot2)\nlibrary(tibble)\nlibrary(zeallot)\nlibrary(COTAN)\n\noptions(parallelly.fork.enable = TRUE)\n\noutDir &lt;- \"Data/MouseCortexFromLoom/\"\n\nsetLoggingLevel(1)\nsetLoggingFile(file.path(outDir, \"ForebrainDorsal_E135-analysis.log\"))\n\nRead the already created COTAN object\n\nfb135Obj &lt;- readRDS(\"Data/MouseCortexFromLoom/SourceData/e13.5_ForebrainDorsal.cotan.RDS\")\nsampleCondition &lt;- getMetadataElement(fb135Obj, datasetTags()[[\"cond\"]])\n\nsampleCondition\n\n[1] \"e13.5_ForebrainDorsal\"\n\n\nInspect cells’ sizes\n\ncellSizePlot(fb135Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nDrop cells with too many ritz reads as they are probably duplets\n\ncellsSizeThr &lt;- 10000\nfb135Obj &lt;- addElementToMetaDataset(fb135Obj, \"Cells size threshold\", cellsSizeThr)\n\ncells_to_rem &lt;- getCells(fb135Obj)[getCellsSize(fb135Obj) &gt; cellsSizeThr]\nfb135Obj &lt;- dropGenesCells(fb135Obj, cells = cells_to_rem)\n\ncellSizePlot(fb135Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nInspect the number of expressed genes per cell\n\ngenesSizePlot(fb135Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nDrop cells with too low genes expession as they are probably dead\n\ngenesSizeLowThr &lt;- 700\nfb135Obj &lt;- addElementToMetaDataset(fb135Obj, \"Num genes low threshold\", genesSizeLowThr)\n\nnumExprGenes &lt;- getNumGenes(fb135Obj)\ncells_to_rem &lt;- names(numExprGenes)[numExprGenes &lt; genesSizeLowThr]\nfb135Obj &lt;- dropGenesCells(fb135Obj, cells = cells_to_rem)\n\ngenesSizePlot(fb135Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nCheck number of mitocondrial genes expressed in each cell\n\nmitGenesPattern &lt;- \"^mt.\"\ngetGenes(fb135Obj)[grep(mitGenesPattern, getGenes(fb135Obj))]\n\n[1] \"mt.Co1\"  \"mt.Co3\"  \"mt.Nd4\"  \"mt.Nd5\"  \"mt.Nd1\"  \"mt.Nd2\"  \"mt.Atp6\"\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(fb135Obj, genePrefix = mitGenesPattern,\n                              splitPattern = \":\", numCol = 1)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCells with a too high percentage of mitocondrial genes are likely dead (or at the last problematic) cells. So we drop them!\n\nmitPercThr &lt;- 1.0\nfb135Obj &lt;- addElementToMetaDataset(fb135Obj, \"Mitoc. perc. threshold\", mitPercThr)\n\ncells_to_rem &lt;- rownames(mitSizes)[mitSizes[[\"mit.percentage\"]] &gt; mitPercThr]\n\nfb135Obj &lt;- dropGenesCells(fb135Obj, cells = cells_to_rem)\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(fb135Obj, genePrefix = mitGenesPattern,\n                              splitPattern = \":\", numCol = 1)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCheck no further outliers after all the culling\n\ncellSizePlot(fb135Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\ngenesSizePlot(fb135Obj, splitPattern = \":\", numCol = 1)\n\n\n\n\n\n\n\n\nClean: round 1\n\nfb135Obj &lt;- clean(fb135Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot) %&lt;-% cleanPlots(fb135Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nfb135Obj &lt;- addElementToMetaDataset(fb135Obj, \"Num drop B group\", 0)\n\nB group contains high number of hemoglobin genes: so they are not interesting\n\ncells_to_rem &lt;- rownames(pcaCellsData)[pcaCellsData[[\"groups\"]] == \"B\"]\n\nfb135Obj &lt;- dropGenesCells(fb135Obj, cells = cells_to_rem)\n\nClean: round 2\n\nfb135Obj &lt;- clean(fb135Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot) %&lt;-% cleanPlots(fb135Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nfb135Obj &lt;- addElementToMetaDataset(fb135Obj, \"Num drop B group\", 1)\n\nB group contains high number of hemoglobin genes: so they are not interesting\n\ncells_to_rem &lt;- rownames(pcaCellsData)[pcaCellsData[[\"groups\"]] == \"B\"]\n\nfb135Obj &lt;- dropGenesCells(fb135Obj, cells = cells_to_rem)\n\nClean: round 3\n\nfb135Obj &lt;- clean(fb135Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot) %&lt;-% cleanPlots(fb135Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nfb135Obj &lt;- addElementToMetaDataset(fb135Obj, \"Num drop B group\", 2)\n\nVisualize if all is ok:\n\nplot(UDEPlot)\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\nlowUDEThr &lt;- 0.3 # the threshold to remove low UDE cells\n\nnuDf &lt;- data.frame(\"nu\" = sort(getNu(fb135Obj)), \"n\" = seq_along(getNu(fb135Obj)))\nUDEPlot_zoomed &lt;- ggplot(nuDf, aes(x = n, y = nu)) +\n            geom_point(colour = \"#8491B4B2\", size = 1.0) +\n            xlim(0L, 400L) +\n            ylim(0.0, 1.0) +\n            geom_hline(yintercept = lowUDEThr, linetype = \"dashed\",\n                       color = \"darkred\") +\n            annotate(geom = \"text\", x = 200L, y = 0.25,\n                     label = paste0(\"to remove cells with nu &lt; \", lowUDEThr),\n                     color = \"darkred\", size = 4.5)\n\nplot(UDEPlot_zoomed)\n\n\n\n\n\n\n\n\nFinal cleaning to check all is OK\n\nfb135Obj &lt;- clean(fb135Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot) %&lt;-% cleanPlots(fb135Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\nplot(cellSizePlot(fb135Obj, splitPattern = \":\", numCol = 1))\n\n\n\n\n\n\n\nplot(genesSizePlot(fb135Obj, splitPattern = \":\", numCol = 1))\n\n\n\n\n\n\n\n\nCalculate genes’ COEX\n\nfb135Obj &lt;- proceedToCoex(fb135Obj, calcCoex = TRUE, cores = 12,\n                          saveObj = TRUE, outDir = outDir)\n\ngdiData &lt;- calculateGDI(fb135Obj)\n\ngenesToLabel &lt;- head(rownames(gdiData[order(gdiData[[\"GDI\"]],\n                                            decreasing = TRUE), ]), n = 10L)\n\ngenesToLabel\n\n [1] \"Myt1l\"   \"Ccser1\"  \"Hes1\"    \"Neurod2\" \"Neurod6\" \"Aldoc\"   \"Hes5\"   \n [8] \"Nsg2\"    \"Rab3a\"   \"Rbfox1\" \n\ngdiPlot &lt;- GDIPlot(fb135Obj, GDIIn = gdiData, GDIThreshold = 1.4,\n                   genes = list(\"Top 10 GDI genes\" = genesToLabel))\n\nplot(gdiPlot)\n\n\n\n\n\n\n\n\nSave the COTAN object\n\nsaveRDS(fb135Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\nfb135Obj &lt;- readRDS(file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\nsplitClusters &lt;- cellsUniformClustering(fb135Obj, GDIThreshold = 1.4, cores = 13,\n                                        saveObj = TRUE, outDir = outDir)\n\nc(splitCoexDF, splitPValueDF) %&lt;-% DEAOnClusters(fb135Obj, clusters = splitClusters)\n\nfb135Obj &lt;- addClusterization(fb135Obj, clName = \"split\",\n                              clusters = splitClusters,\n                              coexDF = splitCoexDF, override = TRUE)\n\ntable(splitClusters)\n\n\nsaveRDS(fb135Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\nc(mergedClusters, mergedCoexDF, mergedPValueDF) %&lt;-%\n  mergeUniformCellsClusters(fb135Obj, clusters = splitClusters,\n                            GDIThreshold = 1.4, cores = 13,\n                            saveObj = TRUE, outDir = outDir)\n\nfb135Obj &lt;- addClusterization(fb135Obj, clName = \"merge\",\n                              clusters = mergedClusters,\n                              coexDF = mergedCoexDF,\n                              override = TRUE)\n\ntable(mergedClusters)\n\n\nsaveRDS(fb135Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\nsessionInfo()\n\nR version 4.3.0 (2023-04-21)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Berlin\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] COTAN_2.1.5   zeallot_0.1.0 tibble_3.2.1  ggplot2_3.4.2\n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3     rstudioapi_0.14        jsonlite_1.8.4        \n  [4] shape_1.4.6            umap_0.2.10.0          magrittr_2.0.3        \n  [7] spatstat.utils_3.0-3   farver_2.1.1           rmarkdown_2.21        \n [10] GlobalOptions_0.1.2    vctrs_0.6.1            ROCR_1.0-11           \n [13] spatstat.explore_3.2-1 askpass_1.1            htmltools_0.5.5       \n [16] sctransform_0.3.5      parallelly_1.36.0      KernSmooth_2.23-20    \n [19] htmlwidgets_1.6.2      ica_1.0-3              plyr_1.8.8            \n [22] plotly_4.10.1          zoo_1.8-12             igraph_1.4.2          \n [25] mime_0.12              lifecycle_1.0.3        iterators_1.0.14      \n [28] pkgconfig_2.0.3        Matrix_1.5-4.1         R6_2.5.1              \n [31] fastmap_1.1.1          fitdistrplus_1.1-8     future_1.32.0         \n [34] shiny_1.7.4            clue_0.3-64            digest_0.6.31         \n [37] colorspace_2.1-0       patchwork_1.1.2        S4Vectors_0.38.0      \n [40] Seurat_4.3.0           tensor_1.5             RSpectra_0.16-1       \n [43] irlba_2.3.5.1          labeling_0.4.2         progressr_0.13.0      \n [46] RcppZiggurat_0.1.6     fansi_1.0.4            spatstat.sparse_3.0-1 \n [49] httr_1.4.5             polyclip_1.10-4        abind_1.4-5           \n [52] compiler_4.3.0         withr_2.5.0            doParallel_1.0.17     \n [55] viridis_0.6.2          dendextend_1.17.1      MASS_7.3-59           \n [58] openssl_2.0.6          rjson_0.2.21           tools_4.3.0           \n [61] lmtest_0.9-40          httpuv_1.6.9           future.apply_1.11.0   \n [64] goftest_1.2-3          glue_1.6.2             nlme_3.1-162          \n [67] promises_1.2.0.1       grid_4.3.0             Rtsne_0.16            \n [70] cluster_2.1.4          reshape2_1.4.4         generics_0.1.3        \n [73] gtable_0.3.3           spatstat.data_3.0-1    tidyr_1.3.0           \n [76] data.table_1.14.8      sp_1.6-0               utf8_1.2.3            \n [79] BiocGenerics_0.46.0    spatstat.geom_3.2-1    RcppAnnoy_0.0.20      \n [82] ggrepel_0.9.3          RANN_2.6.1             foreach_1.5.2         \n [85] pillar_1.9.0           stringr_1.5.0          later_1.3.0           \n [88] circlize_0.4.15        splines_4.3.0          dplyr_1.1.2           \n [91] lattice_0.21-8         survival_3.5-5         deldir_1.0-6          \n [94] tidyselect_1.2.0       ComplexHeatmap_2.16.0  miniUI_0.1.1.1        \n [97] pbapply_1.7-0          knitr_1.42             gridExtra_2.3         \n[100] IRanges_2.34.0         scattermore_1.1        stats4_4.3.0          \n[103] xfun_0.39              factoextra_1.0.7       matrixStats_1.0.0     \n[106] stringi_1.7.12         lazyeval_0.2.2         yaml_2.3.7            \n[109] evaluate_0.20          codetools_0.2-19       cli_3.6.1             \n[112] RcppParallel_5.1.7     uwot_0.1.14            xtable_1.8-4          \n[115] reticulate_1.28        munsell_0.5.0          Rcpp_1.0.10           \n[118] globals_0.16.2         spatstat.random_3.1-4  png_0.1-8             \n[121] parallel_4.3.0         Rfast_2.0.7            ellipsis_0.3.2        \n[124] assertthat_0.2.1       parallelDist_0.2.6     listenv_0.9.0         \n[127] ggthemes_4.2.4         viridisLite_0.4.1      scales_1.2.1          \n[130] ggridges_0.5.4         SeuratObject_4.1.3     leiden_0.4.3          \n[133] purrr_1.0.1            crayon_1.5.2           GetoptLong_1.0.5      \n[136] rlang_1.1.0            cowplot_1.1.1",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "E13.5 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE13.5MouseBrain.html",
    "href": "geneCoexAnalysisE13.5MouseBrain.html",
    "title": "Gene Correlation Analysis E13.5 Mouse Brain",
    "section": "",
    "text": "library(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(Hmisc)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(Rfast)\nlibrary(parallel)\nlibrary(doParallel)\nlibrary(HiClimR)\nlibrary(stringr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\ndataSetFile &lt;- \"Data/MouseCortexFromLoom/e13.5_ForebrainDorsal.cotan.RDS\"\n\nname &lt;- str_split(dataSetFile,pattern = \"/\",simplify = T)[3]\nname &lt;- str_remove(name,pattern = \".RDS\")\n\nproject = \"E13.5\"\n\n\nsetLoggingLevel(1)\noutDir &lt;- \"CoexData/\"\nsetLoggingFile(paste0(outDir, \"Logs/\",name,\".log\"))\n\nobj &lt;- readRDS(dataSetFile)\nfile_code = getMetadataElement(obj, datasetTags()[[\"cond\"]])\n\n\nsource(\"src/Functions.R\")\n\nTo compare the ability of COTAN to asses the real correlation between genes we define some pools of genes:\n\nConstitutive genes\nNeural progenitor genes\nPan neuronal genes\nSome layer marker genes\n\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = \n    c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E13.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE13.5MouseBrain.html#prologue",
    "href": "geneCoexAnalysisE13.5MouseBrain.html#prologue",
    "title": "Gene Correlation Analysis E13.5 Mouse Brain",
    "section": "",
    "text": "library(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(Hmisc)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(Rfast)\nlibrary(parallel)\nlibrary(doParallel)\nlibrary(HiClimR)\nlibrary(stringr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\ndataSetFile &lt;- \"Data/MouseCortexFromLoom/e13.5_ForebrainDorsal.cotan.RDS\"\n\nname &lt;- str_split(dataSetFile,pattern = \"/\",simplify = T)[3]\nname &lt;- str_remove(name,pattern = \".RDS\")\n\nproject = \"E13.5\"\n\n\nsetLoggingLevel(1)\noutDir &lt;- \"CoexData/\"\nsetLoggingFile(paste0(outDir, \"Logs/\",name,\".log\"))\n\nobj &lt;- readRDS(dataSetFile)\nfile_code = getMetadataElement(obj, datasetTags()[[\"cond\"]])\n\n\nsource(\"src/Functions.R\")\n\nTo compare the ability of COTAN to asses the real correlation between genes we define some pools of genes:\n\nConstitutive genes\nNeural progenitor genes\nPan neuronal genes\nSome layer marker genes\n\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = \n    c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E13.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE13.5MouseBrain.html#cotan",
    "href": "geneCoexAnalysisE13.5MouseBrain.html#cotan",
    "title": "Gene Correlation Analysis E13.5 Mouse Brain",
    "section": "COTAN",
    "text": "COTAN\n\nint.genes &lt;-getGenes(obj)\n\n\ncoexMat.big &lt;- getGenesCoex(obj)#[int.genes,int.genes]\n\ncoexMat &lt;- getGenesCoex(obj)[c(genesList$NPGs,genesList$hk,genesList$PNGs),c(genesList$NPGs,genesList$hk,genesList$PNGs)]\n\nf1 = colorRamp2(seq(-0.5,0.5, length = 3), c(\"#DC0000B2\", \"white\",\"#3C5488B2\" ))\n\nsplit.genes &lt;- factor(c(rep(\"NPGs\",length(genesList[[\"NPGs\"]])),\n                         rep(\"HK\",length(genesList[[\"hk\"]])),\n                         rep(\"PNGs\",length(genesList[[\"PNGs\"]]))\n                        ),\n                         levels = c(\"NPGs\",\"HK\",\"PNGs\"))\n\nlgd = Legend(col_fun = f1, title = \"COTAN coex\")\n\nhtmp &lt;- Heatmap(as.matrix(coexMat),\n        #width = ncol(coexMat)*unit(2.5, \"mm\"), \n        height = nrow(coexMat)*unit(3, \"mm\"),\n        cluster_rows = FALSE,\n        cluster_columns = FALSE,\n        col = f1,\n        row_names_side = \"left\",\n        row_names_gp = gpar(fontsize = 11),\n        column_names_gp  = gpar(fontsize = 11),\n        column_split = split.genes,\n        row_split = split.genes,\n        cluster_row_slices = FALSE, \n    cluster_column_slices = FALSE,\n    heatmap_legend_param = list(\n        title = \"COTAN coex\", at = c(-0.5, 0, 0.5),direction = \"horizontal\",\n        labels = c(\"-0.5\", \"0\", \"0.5\")\n    )\n   )\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\nGDI_DF &lt;- calculateGDI(obj)\nGDI_DF$geneType &lt;- NA\nfor (cat in names(genesList)) {\n  GDI_DF[rownames(GDI_DF) %in% genesList[[cat]],]$geneType &lt;- cat\n}\n\nGDI_DF$GDI_centered &lt;- scale(GDI_DF$GDI,center = T,scale = T)\n\nwrite.csv(GDI_DF,paste0(\"CoexData/\",\"Variance_GDI_genes\",file_code,\".csv\"))\n\n\nGDI_DF[unlist(genesList),]\n\n         sum.raw.norm      GDI  exp.cells geneType GDI_centered\nNes          7.581052 4.192489 25.4165830     NPGs   3.04415531\nVim          9.971694 3.984104 76.6512748     NPGs   2.75607580\nSox2         7.082317 3.999433 18.5304156     NPGs   2.77726729\nSox1         5.715170 2.983572  5.6615138     NPGs   1.37290505\nNotch1       7.227078 3.984877 20.6384260     NPGs   2.75714514\nHes1         8.449033 4.822367 31.8409958     NPGs   3.91492097\nHes5         9.585092 4.784038 42.6018872     NPGs   3.86193346\nPax6         8.481894 4.385577 44.5492873     NPGs   3.31108627\nMap2         9.355155 3.931909 70.5681590     PNGs   2.68391910\nTubb3       10.986131 4.374838 76.9524192     PNGs   3.29624084\nNeurod1      5.123468 2.046275  2.8508332     PNGs   0.07715236\nNefm         5.862676 3.085697  5.9024292     PNGs   1.51408601\nNefl         4.741106 2.586671  1.8871713     PNGs   0.82421512\nDcx          8.357463 4.539183 39.6707488     PNGs   3.52343659\nTbr1         7.759295 4.237369 26.0991769     PNGs   3.10619909\nCalm1       10.447080 1.385779 97.8919896       hk  -0.83594052\nCox6b1       9.981533 1.441202 96.6673359       hk  -0.75932183\nPpia        10.196964 2.609030 86.8901827       hk   0.85512419\nRpl18       10.790428 1.335148 99.6386268       hk  -0.90593539\nCox7c       10.031070 1.518121 97.1893194       hk  -0.65298677\nErh          9.280735 2.711007 67.8377836       hk   0.99610081\nH3f3a       10.665312 1.380775 99.6587031       hk  -0.84285899\nTaf1         6.937213 2.168233 17.1049990       hk   0.24575162\nTaf2         6.537627 1.310694 12.1863080       hk  -0.93974092\nGapdh        9.979987 2.531673 92.7323831       hk   0.74818409\nActb        11.323008 1.382499 99.4980928       hk  -0.84047559\nGolph3       6.990454 1.648246 19.0724754       hk  -0.47309720\nZfr          8.192974 2.212476 47.4001205       hk   0.30691375\nSub1         9.735618 2.343091 92.1903232       hk   0.48748156\nTars         6.946500 1.753805 17.9682795       hk  -0.32716939\nAmacr        5.143626 1.632567  3.4932744       hk  -0.49477252\nReln         7.550123 3.069353  8.3718129   layers   1.49149142\nLhx5         4.850935 2.291750  1.5057217   layers   0.41650600\nCux1         8.229655 3.634065 43.1840996   layers   2.27216946\nSatb2        7.683171 3.401215 21.5418591   layers   1.95026951\nTle1         7.461375 2.108275 25.6976511   layers   0.16286267\nMef2c        7.773242 3.876656 19.5543064   layers   2.60753655\nRorb         6.274757 1.635946  7.5486850   layers  -0.49010169\nSox5         9.709193 3.707954 64.7460349   layers   2.37431668\nBcl11b       8.848123 4.654283 43.7060831   layers   3.68255551\nFezf2        8.690887 2.925436 54.6878137   layers   1.29253570\nFoxp2        7.803267 2.713967 28.2674162   layers   1.00019356\nNtf3         5.006960 2.463725  2.2485445   layers   0.65424957\nNA                 NA       NA         NA     &lt;NA&gt;           NA\nNA.1               NA       NA         NA     &lt;NA&gt;           NA\nCux2         6.681962 2.670967  9.2551696   layers   0.94074878\nSlc17a6      7.136129 3.316106 14.1337081   layers   1.83261146\nSema3c       6.576389 2.740901  8.7733387   layers   1.03742781\nThsd7a       4.705115 1.784039  1.3451114   layers  -0.28537229\nSulf2        5.293881 2.461288  3.2523590   layers   0.65088105\nKcnk2        7.401683 1.957314 21.6422405   layers  -0.04583116\nGrik3        5.864890 3.353295  5.0793013   layers   1.88402330\nEtv1         5.600431 2.460104  4.1758683   layers   0.64924346\nTle4         6.694944 1.811217 12.5276049   layers  -0.24780084\nTmem200a     4.701951 2.381286  1.8068661   layers   0.54028368\nGlra2        6.044741 3.654254  5.6414375   layers   2.30007960\nEtv1.1       5.600431 2.460104  4.1758683   layers   0.64924346\nNA.2               NA       NA         NA     &lt;NA&gt;           NA\nSulf1        4.529211 2.076179  0.9235093   layers   0.11849227\nNA.3               NA       NA         NA     &lt;NA&gt;           NA\nSyt6         5.144411 2.559922  2.6902228   layers   0.78723640\n\n\n\nGDIPlot(obj,GDIIn = GDI_DF, genes = genesList,GDIThreshold = 1.4)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E13.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE13.5MouseBrain.html#seurat-correlation",
    "href": "geneCoexAnalysisE13.5MouseBrain.html#seurat-correlation",
    "title": "Gene Correlation Analysis E13.5 Mouse Brain",
    "section": "Seurat correlation",
    "text": "Seurat correlation\n\nsrat&lt;- CreateSeuratObject(counts = getRawData(obj), \n                          project = project, \n                          min.cells = 3, \n                          min.features = 200)\nsrat[[\"percent.mt\"]] &lt;- PercentageFeatureSet(srat, pattern = \"^mt-\")\nsrat &lt;- NormalizeData(srat)\nsrat &lt;- FindVariableFeatures(srat, selection.method = \"vst\", nfeatures = 2000)\n\n# plot variable features with and without labels\nplot1 &lt;- VariableFeaturePlot(srat)\n\nplot1$data$centered_variance &lt;- scale(plot1$data$variance.standardized,\n                                      center = T,scale = F)\n\nwrite.csv(plot1$data,paste0(\"CoexData/\",\n                            \"Variance_Seurat_genes\",\n                            getMetadataElement(obj, \n                                               datasetTags()[[\"cond\"]]),\".csv\"))\n\nLabelPoints(plot = plot1, points = c(genesList$NPGs,genesList$PNGs,genesList$layers), repel = TRUE)\n\n\n\n\n\n\n\n\n\nLabelPoints(plot = plot1, points = c(genesList$hk), repel = TRUE)\n\n\n\n\n\n\n\n\n\nall.genes &lt;- rownames(srat)\nsrat &lt;- ScaleData(srat, features = all.genes)\nseurat.data = GetAssayData(srat[[\"RNA\"]],layer = \"data\")\n\n\ncorr.pval.list &lt;- correlation_pvalues(data = seurat.data,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nseurat.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(seurat.data.cor.big, \n                         genesList, title=\"Seurat corr\")\n\n\np_values.fromSeurat &lt;- corr.pval.list$p_values\nseurat.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   7130858  380.9   11454895   611.8   11454895   611.8\nVcells 840516207 6412.7 1342169060 10240.0 1342169060 10240.0\n\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\nSeurat SC Transform\n\nsrat &lt;-  SCTransform(srat, \n                     method = \"glmGamPoi\", \n                     vars.to.regress = \"percent.mt\", \n                     verbose = FALSE)\n\nseurat.data &lt;- GetAssayData(srat[[\"SCT\"]],layer = \"data\")\n\n#Remove genes with all zeros\nseurat.data &lt;-seurat.data[rowSums(seurat.data) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(seurat.data,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nseurat.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(seurat.data.cor.big, \n                         genesList, title=\"Seurat corr SCT\")\n\n\n\np_values.fromSeurat &lt;- corr.pval.list$p_values\nseurat.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   8859943  473.2   16748832   894.5   12021442   642.1\nVcells 861708025 6574.4 1932899446 14746.9 1610675510 12288.5\n\ndraw(htmp, heatmap_legend_side=\"right\")",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E13.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE13.5MouseBrain.html#monocle",
    "href": "geneCoexAnalysisE13.5MouseBrain.html#monocle",
    "title": "Gene Correlation Analysis E13.5 Mouse Brain",
    "section": "Monocle",
    "text": "Monocle\n\nlibrary(monocle3)\n\n\ncds &lt;- new_cell_data_set(getRawData(obj),\n                         cell_metadata = getMetadataCells(obj),\n                         gene_metadata = getMetadataGenes(obj)\n                         )\ncds &lt;- preprocess_cds(cds, num_dim = 100)\n\nnormalized_counts &lt;- normalized_counts(cds)\n\n\n#Remove genes with all zeros\nnormalized_counts &lt;- normalized_counts[rowSums(normalized_counts) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(normalized_counts,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nrm(normalized_counts)\n\nmonocle.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(data.cor.big = monocle.data.cor.big,\n                         genesList,\n                         title = \"Monocle corr\")\n\n\np_values.from.monocle &lt;- corr.pval.list$p_values\nmonocle.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   9971655  532.6   16748832   894.5   16748832   894.5\nVcells 896560359 6840.3 2062053399 15732.3 2062053399 15732.3\n\ndraw(htmp, heatmap_legend_side=\"right\")",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E13.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE13.5MouseBrain.html#scanpy",
    "href": "geneCoexAnalysisE13.5MouseBrain.html#scanpy",
    "title": "Gene Correlation Analysis E13.5 Mouse Brain",
    "section": "ScanPy",
    "text": "ScanPy\n\nlibrary(reticulate)\n\ndirOutScP &lt;- paste0(\"CoexData/ScanPy/\")\nif (!dir.exists(dirOutScP)) {\n  dir.create(dirOutScP)\n}\n\nSys.setenv(RETICULATE_PYTHON = \"../../../bin/python3\")\n  py &lt;- import(\"sys\")\n  \n  source_python(\"src/scanpyGenesExpression.py\")\n  scanpyFDR(getRawData(obj), \n                  getMetadataCells(obj), \n                  getMetadataGenes(obj), \n                   \"mt\", \n                   dirOutScP, \n                   file_code,\n            int.genes)\n\nnormalized_counts &lt;- read.csv(paste0(dirOutScP,\n                                     file_code,\"_Scampy_expression_all_genes.gz\"),header = T,row.names = 1)\n\nnormalized_counts &lt;- t(normalized_counts)\n\n\n#Remove genes with all zeros\nnormalized_counts &lt;-normalized_counts[rowSums(normalized_counts) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(normalized_counts,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nScanPy.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\n\nhtmp &lt;- correlation_plot(data.cor.big = ScanPy.data.cor.big,\n                         genesList,\n                         title = \"ScanPy corr\")\n\np_values.from.ScanPy &lt;- corr.pval.list$p_values\nScanPy.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   9994943  533.8   16748832   894.5   16748832   894.5\nVcells 966228182 7371.8 2062053399 15732.3 2062053399 15732.3\n\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\n\nSys.time()\n\n[1] \"2024-05-06 11:52:16 CEST\"\n\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3;  LAPACK version 3.9.0\n\nlocale:\n[1] C.UTF-8\n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n [1] stats4    parallel  grid      stats     graphics  grDevices utils    \n [8] datasets  methods   base     \n\nother attached packages:\n [1] reticulate_1.36.1           monocle3_1.3.4             \n [3] SingleCellExperiment_1.22.0 SummarizedExperiment_1.30.2\n [5] GenomicRanges_1.52.0        GenomeInfoDb_1.36.1        \n [7] IRanges_2.34.1              S4Vectors_0.38.1           \n [9] MatrixGenerics_1.12.3       matrixStats_1.2.0          \n[11] Biobase_2.60.0              BiocGenerics_0.46.0        \n[13] fstcore_0.9.18              fst_0.9.8                  \n[15] stringr_1.5.0               HiClimR_2.2.1              \n[17] doParallel_1.0.17           iterators_1.0.14           \n[19] foreach_1.5.2               Rfast_2.1.0                \n[21] RcppParallel_5.1.7          RcppZiggurat_0.1.6         \n[23] Rcpp_1.0.11                 patchwork_1.2.0            \n[25] Seurat_5.0.0                SeuratObject_5.0.0         \n[27] sp_2.1-1                    Hmisc_5.1-0                \n[29] dplyr_1.1.2                 circlize_0.4.15            \n[31] ComplexHeatmap_2.16.0       COTAN_2.5.0                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               bitops_1.0-7             \n  [5] tibble_3.2.1              polyclip_1.10-4          \n  [7] rpart_4.1.23              fastDummies_1.7.3        \n  [9] lifecycle_1.0.3           globals_0.16.2           \n [11] lattice_0.22-5            MASS_7.3-60              \n [13] backports_1.4.1           dendextend_1.17.1        \n [15] magrittr_2.0.3            plotly_4.10.2            \n [17] rmarkdown_2.24            yaml_2.3.7               \n [19] httpuv_1.6.11             glmGamPoi_1.12.2         \n [21] sctransform_0.4.1         spam_2.10-0              \n [23] askpass_1.2.0             spatstat.sparse_3.0-2    \n [25] minqa_1.2.5               cowplot_1.1.1            \n [27] pbapply_1.7-2             RColorBrewer_1.1-3       \n [29] zlibbioc_1.46.0           abind_1.4-5              \n [31] Rtsne_0.17                purrr_1.0.1              \n [33] RCurl_1.98-1.12           nnet_7.3-19              \n [35] GenomeInfoDbData_1.2.10   ggrepel_0.9.5            \n [37] irlba_2.3.5.1             listenv_0.9.0            \n [39] spatstat.utils_3.0-3      terra_1.7-39             \n [41] umap_0.2.10.0             goftest_1.2-3            \n [43] RSpectra_0.16-1           spatstat.random_3.2-1    \n [45] dqrng_0.3.0               fitdistrplus_1.1-11      \n [47] parallelly_1.37.1         DelayedMatrixStats_1.22.5\n [49] ncdf4_1.22                leiden_0.4.3             \n [51] codetools_0.2-19          DelayedArray_0.26.7      \n [53] tidyselect_1.2.0          shape_1.4.6              \n [55] farver_2.1.1              lme4_1.1-34              \n [57] ScaledMatrix_1.8.1        viridis_0.6.4            \n [59] base64enc_0.1-3           spatstat.explore_3.2-1   \n [61] jsonlite_1.8.7            GetoptLong_1.0.5         \n [63] ellipsis_0.3.2            progressr_0.14.0         \n [65] Formula_1.2-5             ggridges_0.5.4           \n [67] survival_3.5-8            tools_4.3.2              \n [69] ica_1.0-3                 glue_1.7.0               \n [71] gridExtra_2.3             xfun_0.39                \n [73] ggthemes_5.1.0            withr_3.0.0              \n [75] fastmap_1.1.1             boot_1.3-28              \n [77] fansi_1.0.4               openssl_2.1.0            \n [79] digest_0.6.33             rsvd_1.0.5               \n [81] parallelDist_0.2.6        R6_2.5.1                 \n [83] mime_0.12                 colorspace_2.1-0         \n [85] Cairo_1.6-1               scattermore_1.2          \n [87] tensor_1.5                spatstat.data_3.0-1      \n [89] utf8_1.2.3                tidyr_1.3.0              \n [91] generics_0.1.3            data.table_1.15.0        \n [93] httr_1.4.6                htmlwidgets_1.6.2        \n [95] S4Arrays_1.2.0            uwot_0.1.16              \n [97] pkgconfig_2.0.3           gtable_0.3.3             \n [99] lmtest_0.9-40             XVector_0.40.0           \n[101] htmltools_0.5.8           dotCall64_1.1-0          \n[103] clue_0.3-64               scales_1.3.0             \n[105] png_0.1-8                 knitr_1.43               \n[107] rstudioapi_0.15.0         reshape2_1.4.4           \n[109] rjson_0.2.21              nloptr_2.0.3             \n[111] checkmate_2.3.0           nlme_3.1-163             \n[113] zoo_1.8-12                GlobalOptions_0.1.2      \n[115] KernSmooth_2.23-22        miniUI_0.1.1.1           \n[117] foreign_0.8-86            pillar_1.9.0             \n[119] vctrs_0.6.3               RANN_2.6.1               \n[121] promises_1.2.0.1          BiocSingular_1.16.0      \n[123] beachmat_2.16.0           xtable_1.8-4             \n[125] cluster_2.1.6             htmlTable_2.4.1          \n[127] evaluate_0.21             zeallot_0.1.0            \n[129] cli_3.6.1                 compiler_4.3.2           \n[131] rlang_1.1.1               crayon_1.5.2             \n[133] future.apply_1.11.0       labeling_0.4.2           \n[135] plyr_1.8.8                stringi_1.8.1            \n[137] viridisLite_0.4.2         deldir_2.0-2             \n[139] BiocParallel_1.34.2       assertthat_0.2.1         \n[141] munsell_0.5.0             lazyeval_0.2.2           \n[143] spatstat.geom_3.2-4       PCAtools_2.14.0          \n[145] Matrix_1.6-3              RcppHNSW_0.6.0           \n[147] sparseMatrixStats_1.12.2  future_1.33.0            \n[149] ggplot2_3.5.0             shiny_1.8.0              \n[151] ROCR_1.0-11               igraph_2.0.3",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E13.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE15.0MouseBrain.html",
    "href": "geneCoexAnalysisE15.0MouseBrain.html",
    "title": "Gene Correlation Analysis E15.0 Mouse Brain",
    "section": "",
    "text": "library(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(Hmisc)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(Rfast)\nlibrary(parallel)\nlibrary(doParallel)\nlibrary(HiClimR)\nlibrary(stringr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\ndataSetFile &lt;- \"Data/MouseCortexFromLoom/e15.0_ForebrainDorsal.cotan.RDS\"\nname &lt;- str_split(dataSetFile,pattern = \"/\",simplify = T)[3]\nname &lt;- str_remove(name,pattern = \".RDS\")\n\nproject = \"E15.0\"\n\n\nsetLoggingLevel(1)\noutDir &lt;- \"CoexData/\"\nsetLoggingFile(paste0(outDir, \"Logs/\",name,\".log\"))\n\nobj &lt;- readRDS(dataSetFile)\nfile_code = getMetadataElement(obj, datasetTags()[[\"cond\"]])\n\n\nsource(\"src/Functions.R\")\n\nTo compare the ability of COTAN to asses the real correlation between genes we define some pools of genes:\n\nConstitutive genes\nNeural progenitor genes\nPan neuronal genes\nSome layer marker genes\n\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = \n    c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E15.0"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE15.0MouseBrain.html#prologue",
    "href": "geneCoexAnalysisE15.0MouseBrain.html#prologue",
    "title": "Gene Correlation Analysis E15.0 Mouse Brain",
    "section": "",
    "text": "library(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(Hmisc)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(Rfast)\nlibrary(parallel)\nlibrary(doParallel)\nlibrary(HiClimR)\nlibrary(stringr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\ndataSetFile &lt;- \"Data/MouseCortexFromLoom/e15.0_ForebrainDorsal.cotan.RDS\"\nname &lt;- str_split(dataSetFile,pattern = \"/\",simplify = T)[3]\nname &lt;- str_remove(name,pattern = \".RDS\")\n\nproject = \"E15.0\"\n\n\nsetLoggingLevel(1)\noutDir &lt;- \"CoexData/\"\nsetLoggingFile(paste0(outDir, \"Logs/\",name,\".log\"))\n\nobj &lt;- readRDS(dataSetFile)\nfile_code = getMetadataElement(obj, datasetTags()[[\"cond\"]])\n\n\nsource(\"src/Functions.R\")\n\nTo compare the ability of COTAN to asses the real correlation between genes we define some pools of genes:\n\nConstitutive genes\nNeural progenitor genes\nPan neuronal genes\nSome layer marker genes\n\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = \n    c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E15.0"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE15.0MouseBrain.html#cotan",
    "href": "geneCoexAnalysisE15.0MouseBrain.html#cotan",
    "title": "Gene Correlation Analysis E15.0 Mouse Brain",
    "section": "COTAN",
    "text": "COTAN\n\nint.genes &lt;-getGenes(obj)\n\n\ncoexMat.big &lt;- getGenesCoex(obj)#[int.genes,int.genes]\n\ncoexMat &lt;- getGenesCoex(obj)[c(genesList$NPGs,genesList$hk,genesList$PNGs),c(genesList$NPGs,genesList$hk,genesList$PNGs)]\n\nf1 = colorRamp2(seq(-0.5,0.5, length = 3), c(\"#DC0000B2\", \"white\",\"#3C5488B2\" ))\n\nsplit.genes &lt;- factor(c(rep(\"NPGs\",length(genesList[[\"NPGs\"]])),\n                         rep(\"HK\",length(genesList[[\"hk\"]])),\n                         rep(\"PNGs\",length(genesList[[\"PNGs\"]]))\n                        ),\n                         levels = c(\"NPGs\",\"HK\",\"PNGs\"))\n\nlgd = Legend(col_fun = f1, title = \"COTAN coex\")\n\nhtmp &lt;- Heatmap(as.matrix(coexMat),\n        #width = ncol(coexMat)*unit(2.5, \"mm\"), \n        height = nrow(coexMat)*unit(3, \"mm\"),\n        cluster_rows = FALSE,\n        cluster_columns = FALSE,\n        col = f1,\n        row_names_side = \"left\",\n        row_names_gp = gpar(fontsize = 11),\n        column_names_gp  = gpar(fontsize = 11),\n        column_split = split.genes,\n        row_split = split.genes,\n        cluster_row_slices = FALSE, \n    cluster_column_slices = FALSE,\n    heatmap_legend_param = list(\n        title = \"COTAN coex\", at = c(-0.5, 0, 0.5),direction = \"horizontal\",\n        labels = c(\"-0.5\", \"0\", \"0.5\")\n    )\n   )\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\nGDI_DF &lt;- calculateGDI(obj)\nGDI_DF$geneType &lt;- NA\nfor (cat in names(genesList)) {\n  GDI_DF[rownames(GDI_DF) %in% genesList[[cat]],]$geneType &lt;- cat\n}\n\nGDI_DF$GDI_centered &lt;- scale(GDI_DF$GDI,center = T,scale = T)\n\nwrite.csv(GDI_DF,paste0(\"CoexData/\",\"Variance_GDI_genes\",file_code,\".csv\"))\n\n\nGDI_DF[unlist(genesList),]\n\n         sum.raw.norm      GDI  exp.cells geneType GDI_centered\nNes          7.036617 4.395412 10.3013315     NPGs  2.844118518\nVim          9.750744 4.622956 44.6274235     NPGs  3.141716247\nSox2         6.748800 4.388553  7.8019154     NPGs  2.835147083\nSox1         5.573231 2.954812  2.4760570     NPGs  0.959999758\nNotch1       6.804377 4.507208  8.3158141     NPGs  2.990333393\nHes1         7.293684 5.025427  8.7362766     NPGs  3.668097091\nHes5         7.762615 4.779269 10.1845363     NPGs  3.346154337\nPax6         7.996731 4.881428 18.3368372     NPGs  3.479764633\nMap2        10.179711 4.599886 82.3872927     PNGs  3.111544365\nTubb3       11.940548 5.083784 90.3527213     PNGs  3.744420459\nNeurod1      5.831083 2.015123  3.2936230     PNGs -0.268991989\nNefm         6.753599 3.152181  7.2996963     PNGs  1.218132436\nNefl         6.160391 2.932141  2.9081990     PNGs  0.930349401\nDcx          9.308480 4.495594 58.9581873     PNGs  2.975143901\nTbr1         8.629160 3.877197 34.4662462     PNGs  2.166359967\nCalm1       11.069821 2.194787 97.4421864       hk -0.034015260\nCox6b1      10.240794 2.951945 90.9950946       hk  0.956249628\nPpia        10.343824 2.955456 89.4183602       hk  0.960842148\nRpl18       10.858263 2.901626 96.6596590       hk  0.890439277\nCox7c       10.245556 3.030177 90.4578370       hk  1.058567954\nErh          9.288155 2.659736 65.1016118       hk  0.574079159\nH3f3a       11.042683 2.850307 97.6991357       hk  0.823321315\nTaf1         7.373313 1.751203 15.6855875       hk -0.614165195\nTaf2         7.069134 1.415716 11.9247839       hk -1.052939358\nGapdh       10.083151 3.161859 85.3422098       hk  1.230790542\nActb        11.906861 1.608850 99.5912170       hk -0.800344008\nGolph3       7.440459 1.866369 17.4842327       hk -0.463542657\nZfr          8.645382 2.219651 44.1485634       hk -0.001496122\nSub1         9.822502 3.217085 80.7171222       hk  1.303018400\nTars         7.476170 1.988439 17.9981313       hk -0.303891645\nAmacr        5.810916 1.827868  3.9710348       hk -0.513897792\nReln         8.349205 2.819876  8.3625321   layers  0.783521463\nLhx5         5.830435 3.139114  1.8220042   layers  1.201042642\nCux1         8.606685 3.850086 34.5713618   layers  2.130902087\nSatb2        9.146209 3.735391 31.3361364   layers  1.980896809\nTle1         8.069147 2.752489 25.8000467   layers  0.695387361\nMef2c        9.310240 4.395042 37.2226115   layers  2.843634817\nRorb         7.450810 2.392823 10.9437047   layers  0.224990367\nSox5        10.622002 4.093212 73.5926185   layers  2.448880218\nBcl11b       9.575893 4.600605 54.8937164   layers  3.112483916\nFezf2        9.378784 3.369265 51.6935295   layers  1.502050523\nFoxp2        8.380413 3.553319 23.5342210   layers  1.742770215\nNtf3         5.324482 2.116601  1.8920813   layers -0.136271617\nNA                 NA       NA         NA     &lt;NA&gt;           NA\nNA.1               NA       NA         NA     &lt;NA&gt;           NA\nCux2         7.592847 3.129196 12.2401308   layers  1.188071005\nSlc17a6      7.647733 3.418696 13.7351086   layers  1.566700439\nSema3c       7.661987 2.896666 13.8752628   layers  0.883952732\nThsd7a       6.173797 2.313999  3.1067508   layers  0.121899301\nSulf2        5.738452 2.925339  2.7914039   layers  0.921453194\nKcnk2        8.245680 2.304727 27.1548704   layers  0.109773149\nGrik3        7.243325 3.637511 10.5349217   layers  1.852881971\nEtv1         6.019894 2.984098  3.2235459   layers  0.998302023\nTle4         7.432453 2.929052 13.0343378   layers  0.926308788\nTmem200a     6.201199 2.658151  4.7886008   layers  0.572005411\nGlra2        7.633574 3.878564 13.7467881   layers  2.168147973\nEtv1.1       6.019894 2.984098  3.2235459   layers  0.998302023\nHtr1f        4.884079 2.283998  1.0394768   layers  0.082662331\nSulf1        4.901491 2.120374  0.7241299   layers -0.131337122\nNA.2               NA       NA         NA     &lt;NA&gt;           NA\nSyt6         6.394410 2.800827  4.5082925   layers  0.758607816\n\n\n\nGDIPlot(obj,GDIIn = GDI_DF, genes = genesList,GDIThreshold = 1.4)",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E15.0"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE15.0MouseBrain.html#seurat-correlation",
    "href": "geneCoexAnalysisE15.0MouseBrain.html#seurat-correlation",
    "title": "Gene Correlation Analysis E15.0 Mouse Brain",
    "section": "Seurat correlation",
    "text": "Seurat correlation\n\nsrat&lt;- CreateSeuratObject(counts = getRawData(obj), \n                          project = project, \n                          min.cells = 3, \n                          min.features = 200)\nsrat[[\"percent.mt\"]] &lt;- PercentageFeatureSet(srat, pattern = \"^mt-\")\nsrat &lt;- NormalizeData(srat)\nsrat &lt;- FindVariableFeatures(srat, selection.method = \"vst\", nfeatures = 2000)\n\n# plot variable features with and without labels\nplot1 &lt;- VariableFeaturePlot(srat)\n\nplot1$data$centered_variance &lt;- scale(plot1$data$variance.standardized,\n                                      center = T,scale = F)\n\nwrite.csv(plot1$data,paste0(\"CoexData/\",\n                            \"Variance_Seurat_genes\",\n                            getMetadataElement(obj, \n                                               datasetTags()[[\"cond\"]]),\".csv\"))\n\nLabelPoints(plot = plot1, points = c(genesList$NPGs,genesList$PNGs,genesList$layers), repel = TRUE)\n\n\n\n\n\n\n\n\n\nLabelPoints(plot = plot1, points = c(genesList$hk), repel = TRUE)\n\n\n\n\n\n\n\n\n\nall.genes &lt;- rownames(srat)\nsrat &lt;- ScaleData(srat, features = all.genes)\nseurat.data = GetAssayData(srat[[\"RNA\"]],layer = \"data\")\n\n\ncorr.pval.list &lt;- correlation_pvalues(data = seurat.data,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nseurat.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(seurat.data.cor.big, \n                         genesList, title=\"Seurat corr\")\n\n\np_values.fromSeurat &lt;- corr.pval.list$p_values\nseurat.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   7142014  381.5   11454574   611.8   11454574   611.8\nVcells 924825723 7055.9 1760848247 13434.3 1760848247 13434.3\n\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\nSeurat SC Transform\n\nsrat &lt;-  SCTransform(srat, \n                     method = \"glmGamPoi\", \n                     vars.to.regress = \"percent.mt\", \n                     verbose = FALSE)\n\nseurat.data &lt;- GetAssayData(srat[[\"SCT\"]],layer = \"data\")\n\n#Remove genes with all zeros\nseurat.data &lt;-seurat.data[rowSums(seurat.data) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(seurat.data,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nseurat.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(seurat.data.cor.big, \n                         genesList, title=\"Seurat corr SCT\")\n\n\n\np_values.fromSeurat &lt;- corr.pval.list$p_values\nseurat.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   8876782  474.1   16780957   896.2   12523735   668.9\nVcells 981924984 7491.5 2113097896 16121.7 2010387494 15338.1\n\ndraw(htmp, heatmap_legend_side=\"right\")",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E15.0"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE15.0MouseBrain.html#monocle",
    "href": "geneCoexAnalysisE15.0MouseBrain.html#monocle",
    "title": "Gene Correlation Analysis E15.0 Mouse Brain",
    "section": "Monocle",
    "text": "Monocle\n\nlibrary(monocle3)\n\n\ncds &lt;- new_cell_data_set(getRawData(obj),\n                         cell_metadata = getMetadataCells(obj),\n                         gene_metadata = getMetadataGenes(obj)\n                         )\ncds &lt;- preprocess_cds(cds, num_dim = 100)\n\nnormalized_counts &lt;- normalized_counts(cds)\n\n\n#Remove genes with all zeros\nnormalized_counts &lt;- normalized_counts[rowSums(normalized_counts) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(normalized_counts,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nrm(normalized_counts)\n\nmonocle.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(data.cor.big = monocle.data.cor.big,\n                         genesList,\n                         title = \"Monocle corr\")\n\n\np_values.from.monocle &lt;- corr.pval.list$p_values\nmonocle.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   9988466  533.5   16780957   896.2   16780957   896.2\nVcells 985703858 7520.4 2113097896 16121.7 2113090291 16121.6\n\ndraw(htmp, heatmap_legend_side=\"right\")",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E15.0"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE15.0MouseBrain.html#scanpy",
    "href": "geneCoexAnalysisE15.0MouseBrain.html#scanpy",
    "title": "Gene Correlation Analysis E15.0 Mouse Brain",
    "section": "ScanPy",
    "text": "ScanPy\n\nlibrary(reticulate)\n\ndirOutScP &lt;- paste0(\"CoexData/ScanPy/\")\nif (!dir.exists(dirOutScP)) {\n  dir.create(dirOutScP)\n}\n\nSys.setenv(RETICULATE_PYTHON = \"../../../bin/python3\")\n  py &lt;- import(\"sys\")\n  \n  source_python(\"src/scanpyGenesExpression.py\")\n  scanpyFDR(getRawData(obj), \n                  getMetadataCells(obj), \n                  getMetadataGenes(obj), \n                   \"mt\", \n                   dirOutScP, \n                   file_code,\n            int.genes)\n\nnormalized_counts &lt;- read.csv(paste0(dirOutScP,\n                                     file_code,\"_Scampy_expression_all_genes.gz\"),header = T,row.names = 1)\n\nnormalized_counts &lt;- t(normalized_counts)\n\n\n#Remove genes with all zeros\nnormalized_counts &lt;-normalized_counts[rowSums(normalized_counts) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(normalized_counts,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nScanPy.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\n\nhtmp &lt;- correlation_plot(data.cor.big = ScanPy.data.cor.big,\n                         genesList,\n                         title = \"ScanPy corr\")\n\np_values.from.ScanPy &lt;- corr.pval.list$p_values\nScanPy.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n             used   (Mb) gc trigger    (Mb)   max used    (Mb)\nNcells   10011754  534.7   16780957   896.2   16780957   896.2\nVcells 1104424249 8426.1 2535797475 19346.6 2113094869 16121.7\n\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\n\nSys.time()\n\n[1] \"2024-05-06 12:53:42 CEST\"\n\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3;  LAPACK version 3.9.0\n\nlocale:\n[1] C.UTF-8\n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n [1] stats4    parallel  grid      stats     graphics  grDevices utils    \n [8] datasets  methods   base     \n\nother attached packages:\n [1] reticulate_1.36.1           monocle3_1.3.4             \n [3] SingleCellExperiment_1.22.0 SummarizedExperiment_1.30.2\n [5] GenomicRanges_1.52.0        GenomeInfoDb_1.36.1        \n [7] IRanges_2.34.1              S4Vectors_0.38.1           \n [9] MatrixGenerics_1.12.3       matrixStats_1.2.0          \n[11] Biobase_2.60.0              BiocGenerics_0.46.0        \n[13] fstcore_0.9.18              fst_0.9.8                  \n[15] stringr_1.5.0               HiClimR_2.2.1              \n[17] doParallel_1.0.17           iterators_1.0.14           \n[19] foreach_1.5.2               Rfast_2.1.0                \n[21] RcppParallel_5.1.7          RcppZiggurat_0.1.6         \n[23] Rcpp_1.0.11                 patchwork_1.2.0            \n[25] Seurat_5.0.0                SeuratObject_5.0.0         \n[27] sp_2.1-1                    Hmisc_5.1-0                \n[29] dplyr_1.1.2                 circlize_0.4.15            \n[31] ComplexHeatmap_2.16.0       COTAN_2.5.0                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               bitops_1.0-7             \n  [5] tibble_3.2.1              polyclip_1.10-4          \n  [7] rpart_4.1.23              fastDummies_1.7.3        \n  [9] lifecycle_1.0.3           globals_0.16.2           \n [11] lattice_0.22-5            MASS_7.3-60              \n [13] backports_1.4.1           dendextend_1.17.1        \n [15] magrittr_2.0.3            plotly_4.10.2            \n [17] rmarkdown_2.24            yaml_2.3.7               \n [19] httpuv_1.6.11             glmGamPoi_1.12.2         \n [21] sctransform_0.4.1         spam_2.10-0              \n [23] askpass_1.2.0             spatstat.sparse_3.0-2    \n [25] minqa_1.2.5               cowplot_1.1.1            \n [27] pbapply_1.7-2             RColorBrewer_1.1-3       \n [29] zlibbioc_1.46.0           abind_1.4-5              \n [31] Rtsne_0.17                purrr_1.0.1              \n [33] RCurl_1.98-1.12           nnet_7.3-19              \n [35] GenomeInfoDbData_1.2.10   ggrepel_0.9.5            \n [37] irlba_2.3.5.1             listenv_0.9.0            \n [39] spatstat.utils_3.0-3      terra_1.7-39             \n [41] umap_0.2.10.0             goftest_1.2-3            \n [43] RSpectra_0.16-1           spatstat.random_3.2-1    \n [45] dqrng_0.3.0               fitdistrplus_1.1-11      \n [47] parallelly_1.37.1         DelayedMatrixStats_1.22.5\n [49] ncdf4_1.22                leiden_0.4.3             \n [51] codetools_0.2-19          DelayedArray_0.26.7      \n [53] tidyselect_1.2.0          shape_1.4.6              \n [55] farver_2.1.1              lme4_1.1-34              \n [57] ScaledMatrix_1.8.1        viridis_0.6.4            \n [59] base64enc_0.1-3           spatstat.explore_3.2-1   \n [61] jsonlite_1.8.7            GetoptLong_1.0.5         \n [63] ellipsis_0.3.2            progressr_0.14.0         \n [65] Formula_1.2-5             ggridges_0.5.4           \n [67] survival_3.5-8            tools_4.3.2              \n [69] ica_1.0-3                 glue_1.7.0               \n [71] gridExtra_2.3             xfun_0.39                \n [73] ggthemes_5.1.0            withr_3.0.0              \n [75] fastmap_1.1.1             boot_1.3-28              \n [77] fansi_1.0.4               openssl_2.1.0            \n [79] digest_0.6.33             rsvd_1.0.5               \n [81] parallelDist_0.2.6        R6_2.5.1                 \n [83] mime_0.12                 colorspace_2.1-0         \n [85] Cairo_1.6-1               scattermore_1.2          \n [87] tensor_1.5                spatstat.data_3.0-1      \n [89] utf8_1.2.3                tidyr_1.3.0              \n [91] generics_0.1.3            data.table_1.15.0        \n [93] httr_1.4.6                htmlwidgets_1.6.2        \n [95] S4Arrays_1.2.0            uwot_0.1.16              \n [97] pkgconfig_2.0.3           gtable_0.3.3             \n [99] lmtest_0.9-40             XVector_0.40.0           \n[101] htmltools_0.5.8           dotCall64_1.1-0          \n[103] clue_0.3-64               scales_1.3.0             \n[105] png_0.1-8                 knitr_1.43               \n[107] rstudioapi_0.15.0         reshape2_1.4.4           \n[109] rjson_0.2.21              nloptr_2.0.3             \n[111] checkmate_2.3.0           nlme_3.1-163             \n[113] zoo_1.8-12                GlobalOptions_0.1.2      \n[115] KernSmooth_2.23-22        miniUI_0.1.1.1           \n[117] foreign_0.8-86            pillar_1.9.0             \n[119] vctrs_0.6.3               RANN_2.6.1               \n[121] promises_1.2.0.1          BiocSingular_1.16.0      \n[123] beachmat_2.16.0           xtable_1.8-4             \n[125] cluster_2.1.6             htmlTable_2.4.1          \n[127] evaluate_0.21             zeallot_0.1.0            \n[129] cli_3.6.1                 compiler_4.3.2           \n[131] rlang_1.1.1               crayon_1.5.2             \n[133] future.apply_1.11.0       labeling_0.4.2           \n[135] plyr_1.8.8                stringi_1.8.1            \n[137] viridisLite_0.4.2         deldir_2.0-2             \n[139] BiocParallel_1.34.2       assertthat_0.2.1         \n[141] munsell_0.5.0             lazyeval_0.2.2           \n[143] spatstat.geom_3.2-4       PCAtools_2.14.0          \n[145] Matrix_1.6-3              RcppHNSW_0.6.0           \n[147] sparseMatrixStats_1.12.2  future_1.33.0            \n[149] ggplot2_3.5.0             shiny_1.8.0              \n[151] ROCR_1.0-11               igraph_2.0.3",
    "crumbs": [
      "Datasets",
      "Mouse Brain LaManno 2021",
      "Correlation analysis for E15.0"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE17.5Yuzwa.html",
    "href": "geneCoexAnalysisE17.5Yuzwa.html",
    "title": "Gene Correlation Analysis E17.5",
    "section": "",
    "text": "library(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(Hmisc)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(Rfast)\nlibrary(parallel)\nlibrary(doParallel)\nlibrary(HiClimR)\nlibrary(stringr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\ndataSetFile &lt;- (\"Data/Yuzwa_MouseCortex/CorticalCells_GSM2861514_E175.cotan.RDS\")\n\nname &lt;- str_split(dataSetFile,pattern = \"/\",simplify = T)[3]\nname &lt;- str_remove(name,pattern = \".RDS\")\n\nproject = \"E17.5\"\n\n\nsetLoggingLevel(1)\noutDir &lt;- \"CoexData/\"\nsetLoggingFile(paste0(outDir, \"Logs/\",name,\".log\"))\n\n\nobj &lt;- readRDS(dataSetFile)\nfile_code = getMetadataElement(obj, datasetTags()[[\"cond\"]])\n\n\nsource(\"src/Functions.R\")\n\nTo compare the ability of COTAN to asses the real correlation between genes we define some pools of genes:\n\nConstitutive genes\nNeural progenitor genes\nPan neuronal genes\nSome layer marker genes\n\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = \n    c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "Correlation analysis for E17.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE17.5Yuzwa.html#prologue",
    "href": "geneCoexAnalysisE17.5Yuzwa.html#prologue",
    "title": "Gene Correlation Analysis E17.5",
    "section": "",
    "text": "library(COTAN)\nlibrary(ComplexHeatmap)\nlibrary(circlize)\nlibrary(dplyr)\nlibrary(Hmisc)\nlibrary(Seurat)\nlibrary(patchwork)\nlibrary(Rfast)\nlibrary(parallel)\nlibrary(doParallel)\nlibrary(HiClimR)\nlibrary(stringr)\nlibrary(fst)\n\noptions(parallelly.fork.enable = TRUE)\n\ndataSetFile &lt;- (\"Data/Yuzwa_MouseCortex/CorticalCells_GSM2861514_E175.cotan.RDS\")\n\nname &lt;- str_split(dataSetFile,pattern = \"/\",simplify = T)[3]\nname &lt;- str_remove(name,pattern = \".RDS\")\n\nproject = \"E17.5\"\n\n\nsetLoggingLevel(1)\noutDir &lt;- \"CoexData/\"\nsetLoggingFile(paste0(outDir, \"Logs/\",name,\".log\"))\n\n\nobj &lt;- readRDS(dataSetFile)\nfile_code = getMetadataElement(obj, datasetTags()[[\"cond\"]])\n\n\nsource(\"src/Functions.R\")\n\nTo compare the ability of COTAN to asses the real correlation between genes we define some pools of genes:\n\nConstitutive genes\nNeural progenitor genes\nPan neuronal genes\nSome layer marker genes\n\n\ngenesList &lt;- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"= \n    c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n      \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\"),\n  \"layers\" = \n    c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "Correlation analysis for E17.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE17.5Yuzwa.html#cotan",
    "href": "geneCoexAnalysisE17.5Yuzwa.html#cotan",
    "title": "Gene Correlation Analysis E17.5",
    "section": "COTAN",
    "text": "COTAN\n\nint.genes &lt;-getGenes(obj)\n\n\ncoexMat.big &lt;- getGenesCoex(obj)#[int.genes,int.genes]\n\ncoexMat &lt;- getGenesCoex(obj)[c(genesList$NPGs,genesList$hk,genesList$PNGs),c(genesList$NPGs,genesList$hk,genesList$PNGs)]\n\nf1 = colorRamp2(seq(-0.5,0.5, length = 3), c(\"#DC0000B2\", \"white\",\"#3C5488B2\" ))\n\nsplit.genes &lt;- factor(c(rep(\"NPGs\",length(genesList[[\"NPGs\"]])),\n                         rep(\"HK\",length(genesList[[\"hk\"]])),\n                         rep(\"PNGs\",length(genesList[[\"PNGs\"]]))\n                        ),\n                         levels = c(\"NPGs\",\"HK\",\"PNGs\"))\n\nlgd = Legend(col_fun = f1, title = \"COTAN coex\")\n\nhtmp &lt;- Heatmap(as.matrix(coexMat),\n        #width = ncol(coexMat)*unit(2.5, \"mm\"), \n        height = nrow(coexMat)*unit(3, \"mm\"),\n        cluster_rows = FALSE,\n        cluster_columns = FALSE,\n        col = f1,\n        row_names_side = \"left\",\n        row_names_gp = gpar(fontsize = 11),\n        column_names_gp  = gpar(fontsize = 11),\n        column_split = split.genes,\n        row_split = split.genes,\n        cluster_row_slices = FALSE, \n    cluster_column_slices = FALSE,\n    heatmap_legend_param = list(\n        title = \"COTAN coex\", at = c(-0.5, 0, 0.5),direction = \"horizontal\",\n        labels = c(\"-0.5\", \"0\", \"0.5\")\n    )\n   )\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\nGDI_DF &lt;- calculateGDI(obj)\nGDI_DF$geneType &lt;- NA\nfor (cat in names(genesList)) {\n  GDI_DF[rownames(GDI_DF) %in% genesList[[cat]],]$geneType &lt;- cat\n}\n\nGDI_DF$GDI_centered &lt;- scale(GDI_DF$GDI,center = T,scale = T)\n\nwrite.csv(GDI_DF,paste0(\"CoexData/\",\"Variance_GDI_genes\",file_code,\".csv\"))\n\n\nGDI_DF[unlist(genesList),]\n\n         sum.raw.norm       GDI  exp.cells geneType GDI_centered\nNes          5.220644 1.9759151 13.9588101     NPGs   3.88073248\nVim          5.707954 2.4316257 13.3867277     NPGs   6.38025751\nSox2         5.049686 2.4580921  9.2677346     NPGs   6.52542286\nSox1         2.596456 1.5372902  1.7162471     NPGs   1.47492018\nNotch1       2.548442 1.2912127  1.2585812     NPGs   0.12521118\nHes1         3.815307 2.0026215  3.0892449     NPGs   4.02721428\nHes5         5.005001 2.3956230  6.5217391     NPGs   6.18278634\nPax6         3.925807 1.7927127  4.0045767     NPGs   2.87588602\nMap2         7.165812 1.5519874 65.3318078     PNGs   1.55553290\nTubb3        8.735578 2.3871787 90.9610984     PNGs   6.13647007\nNeurod1      5.979697 1.4115723 20.8237986     PNGs   0.78537104\nNefm         5.247537 1.8040041 11.4416476     PNGs   2.93781860\nNefl         4.397731 1.6537969  5.2631579     PNGs   2.11394740\nDcx          7.063133 1.6738575 63.1578947     PNGs   2.22397771\nTbr1         5.930953 1.5543822 26.6590389     PNGs   1.56866816\nCalm1        8.420630 1.9599507 89.4736842       hk   3.79316931\nCox6b1       7.396777 1.6401134 75.9725400       hk   2.03889511\nPpia         4.938416 1.5230935 15.4462243       hk   1.39705306\nRpl18        6.336462 1.4146625 44.1647597       hk   0.80232041\nCox7c        6.144064 1.3937240 39.0160183       hk   0.68747482\nErh          5.116709 1.2996389 17.9633867       hk   0.17142798\nH3f3a        6.883043 1.5810893 61.7848970       hk   1.71515374\nTaf1         5.356496 1.3000061 16.4759725       hk   0.17344183\nTaf2         4.784093 1.3661691 11.5560641       hk   0.53633887\nGapdh        2.027649 1.0309864  0.9153318       hk  -1.30210301\nActb         9.168400 1.2795919 98.3981693       hk   0.06147194\nGolph3       4.401339 1.2584072  8.6956522       hk  -0.05472380\nZfr          6.134988 1.4748224 35.0114416       hk   1.13229093\nSub1         6.778528 1.6575142 56.9794050       hk   2.13433668\nTars         4.622981 1.3112605 10.4118993       hk   0.23517106\nAmacr        3.001914 1.0595608  1.7162471       hk  -1.14537537\nReln         4.630042 1.3624092  4.1189931   layers   0.51571626\nLhx5         3.288483 1.4261767  1.4874142   layers   0.86547473\nCux1         6.104752 1.4098312 32.6086957   layers   0.77582115\nSatb2        6.545260 1.7564615 38.9016018   layers   2.67705206\nTle1         4.942203 1.2576091 12.4713959   layers  -0.05910126\nMef2c        7.176654 2.0319404 50.2288330   layers   4.18802527\nRorb         4.038835 1.4237173  5.0343249   layers   0.85198472\nSox5         5.686965 1.4932040 18.0778032   layers   1.23311226\nBcl11b       5.827814 1.3788500 22.6544622   layers   0.60589249\nFezf2        5.060242 1.8449393 10.0686499   layers   3.16234383\nFoxp2        3.715673 1.2017254  2.6315789   layers  -0.36561756\nNtf3         3.517345 1.3707172  2.5171625   layers   0.56128503\nNA                 NA        NA         NA     &lt;NA&gt;           NA\nPvrl3        4.638048 1.4248249  8.6956522   layers   0.85805972\nCux2         5.235976 1.3303178 14.6453089   layers   0.33969841\nSlc17a6      4.833627 1.3393122  9.9542334   layers   0.38903165\nSema3c       5.091768 1.3767920 11.8993135   layers   0.59460463\nThsd7a       4.340644 1.2252121  4.9199085   layers  -0.23679530\nSulf2        3.014381 1.2499911  1.7162471   layers  -0.10088493\nKcnk2        5.256674 1.3228860 19.1075515   layers   0.29893593\nGrik3        3.920478 1.3638079  2.8604119   layers   0.52338795\nEtv1         3.994692 1.5185054  4.1189931   layers   1.37188765\nTle4         4.873726 1.4669420  8.4668192   layers   1.08906769\nTmem200a     2.962816 1.1818921  2.0594966   layers  -0.47440110\nGlra2        4.613463 1.3419476  9.7254005   layers   0.40348636\nEtv1.1       3.994692 1.5185054  4.1189931   layers   1.37188765\nHtr1f        2.004839 0.9689532  0.6864989   layers  -1.64234848\nNA.1               NA        NA         NA     &lt;NA&gt;           NA\nNA.2               NA        NA         NA     &lt;NA&gt;           NA\nSyt6         3.750383 1.3359728  3.6613272   layers   0.37071545\n\n\n\nGDIPlot(obj,GDIIn = GDI_DF, genes = genesList,GDIThreshold = 1.4)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "Correlation analysis for E17.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE17.5Yuzwa.html#seurat-correlation",
    "href": "geneCoexAnalysisE17.5Yuzwa.html#seurat-correlation",
    "title": "Gene Correlation Analysis E17.5",
    "section": "Seurat correlation",
    "text": "Seurat correlation\n\nsrat&lt;- CreateSeuratObject(counts = getRawData(obj), \n                          project = project, \n                          min.cells = 3, \n                          min.features = 200)\nsrat[[\"percent.mt\"]] &lt;- PercentageFeatureSet(srat, pattern = \"^mt-\")\nsrat &lt;- NormalizeData(srat)\nsrat &lt;- FindVariableFeatures(srat, selection.method = \"vst\", nfeatures = 2000)\n\n# plot variable features with and without labels\nplot1 &lt;- VariableFeaturePlot(srat)\n\nplot1$data$centered_variance &lt;- scale(plot1$data$variance.standardized,\n                                      center = T,scale = F)\n\nwrite.csv(plot1$data,paste0(\"CoexData/\",\n                            \"Variance_Seurat_genes\",\n                            getMetadataElement(obj, \n                                               datasetTags()[[\"cond\"]]),\".csv\"))\n\nLabelPoints(plot = plot1, points = c(genesList$NPGs,genesList$PNGs,genesList$layers), repel = TRUE)\n\n\n\n\n\n\n\n\n\nLabelPoints(plot = plot1, points = c(genesList$hk), repel = TRUE)\n\n\n\n\n\n\n\n\n\nall.genes &lt;- rownames(srat)\nsrat &lt;- ScaleData(srat, features = all.genes)\nseurat.data = GetAssayData(srat[[\"RNA\"]],layer = \"data\")\n\n\ncorr.pval.list &lt;- correlation_pvalues(data = seurat.data,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nseurat.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(seurat.data.cor.big, \n                         genesList, title=\"Seurat corr\")\n\n\np_values.fromSeurat &lt;- corr.pval.list$p_values\nseurat.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger   (Mb)  max used   (Mb)\nNcells   7108398  379.7   11454412  611.8  11454412  611.8\nVcells 564771015 4308.9  902333175 6884.3 902333175 6884.3\n\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\nSeurat SC Transform\n\nsrat &lt;-  SCTransform(srat, \n                     method = \"glmGamPoi\", \n                     vars.to.regress = \"percent.mt\", \n                     verbose = FALSE)\n\nseurat.data &lt;- GetAssayData(srat[[\"SCT\"]],layer = \"data\")\n\n#Remove genes with all zeros\nseurat.data &lt;-seurat.data[rowSums(seurat.data) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(seurat.data,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nseurat.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(seurat.data.cor.big, \n                         genesList, title=\"Seurat corr SCT\")\n\n\n\np_values.fromSeurat &lt;- corr.pval.list$p_values\nseurat.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger   (Mb)   max used   (Mb)\nNcells   8837356  472.0   16666662  890.1   13556438  724.0\nVcells 485068772 3700.8 1039644617 7931.9 1082876197 8261.7\n\ndraw(htmp, heatmap_legend_side=\"right\")",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "Correlation analysis for E17.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE17.5Yuzwa.html#monocle",
    "href": "geneCoexAnalysisE17.5Yuzwa.html#monocle",
    "title": "Gene Correlation Analysis E17.5",
    "section": "Monocle",
    "text": "Monocle\n\nlibrary(monocle3)\n\n\ncds &lt;- new_cell_data_set(getRawData(obj),\n                         cell_metadata = getMetadataCells(obj),\n                         gene_metadata = getMetadataGenes(obj)\n                         )\ncds &lt;- preprocess_cds(cds, num_dim = 100)\n\nnormalized_counts &lt;- normalized_counts(cds)\n\n\n#Remove genes with all zeros\nnormalized_counts &lt;- normalized_counts[rowSums(normalized_counts) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(normalized_counts,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nrm(normalized_counts)\n\nmonocle.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\nhtmp &lt;- correlation_plot(data.cor.big = monocle.data.cor.big,\n                         genesList,\n                         title = \"Monocle corr\")\n\n\np_values.from.monocle &lt;- corr.pval.list$p_values\nmonocle.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger   (Mb)   max used   (Mb)\nNcells   9949073  531.4   16666662  890.1   16666662  890.1\nVcells 577016889 4402.3 1197846598 9138.9 1170159130 8927.7\n\ndraw(htmp, heatmap_legend_side=\"right\")",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "Correlation analysis for E17.5"
    ]
  },
  {
    "objectID": "geneCoexAnalysisE17.5Yuzwa.html#scanpy",
    "href": "geneCoexAnalysisE17.5Yuzwa.html#scanpy",
    "title": "Gene Correlation Analysis E17.5",
    "section": "ScanPy",
    "text": "ScanPy\n\nlibrary(reticulate)\n\ndirOutScP &lt;- paste0(\"CoexData/ScanPy/\")\nif (!dir.exists(dirOutScP)) {\n  dir.create(dirOutScP)\n}\n\nSys.setenv(RETICULATE_PYTHON = \"../../../bin/python3\")\n  py &lt;- import(\"sys\")\n  \n  source_python(\"src/scanpyGenesExpression.py\")\n  scanpyFDR(getRawData(obj), \n                  getMetadataCells(obj), \n                  getMetadataGenes(obj), \n                   \"mt\", \n                   dirOutScP, \n                   file_code,\n            int.genes)\n\nnormalized_counts &lt;- read.csv(paste0(dirOutScP,\n                                     file_code,\"_Scampy_expression_all_genes.gz\"),header = T,row.names = 1)\n\nnormalized_counts &lt;- t(normalized_counts)\n\n\n#Remove genes with all zeros\nnormalized_counts &lt;-normalized_counts[rowSums(normalized_counts) &gt; 0,]\n\n\ncorr.pval.list &lt;- correlation_pvalues(normalized_counts,\n                                      int.genes,\n                                      n.cells = getNumCells(obj))\n\nScanPy.data.cor.big &lt;- as.matrix(Matrix::forceSymmetric(corr.pval.list$data.cor, uplo = \"U\"))\n\n\nhtmp &lt;- correlation_plot(data.cor.big = ScanPy.data.cor.big,\n                         genesList,\n                         title = \"ScanPy corr\")\n\np_values.from.ScanPy &lt;- corr.pval.list$p_values\nScanPy.data.cor.big &lt;- corr.pval.list$data.cor\n\nrm(corr.pval.list)\ngc()\n\n            used   (Mb) gc trigger   (Mb)   max used   (Mb)\nNcells   9972882  532.7   16666662  890.1   16666662  890.1\nVcells 549865083 4195.2 1197846598 9138.9 1197843725 9138.9\n\ndraw(htmp, heatmap_legend_side=\"right\")\n\n\n\n\n\n\n\n\n\n\nSys.time()\n\n[1] \"2024-05-06 12:30:26 CEST\"\n\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3;  LAPACK version 3.9.0\n\nlocale:\n[1] C.UTF-8\n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n [1] stats4    parallel  grid      stats     graphics  grDevices utils    \n [8] datasets  methods   base     \n\nother attached packages:\n [1] reticulate_1.36.1           monocle3_1.3.4             \n [3] SingleCellExperiment_1.22.0 SummarizedExperiment_1.30.2\n [5] GenomicRanges_1.52.0        GenomeInfoDb_1.36.1        \n [7] IRanges_2.34.1              S4Vectors_0.38.1           \n [9] MatrixGenerics_1.12.3       matrixStats_1.2.0          \n[11] Biobase_2.60.0              BiocGenerics_0.46.0        \n[13] fstcore_0.9.18              fst_0.9.8                  \n[15] stringr_1.5.0               HiClimR_2.2.1              \n[17] doParallel_1.0.17           iterators_1.0.14           \n[19] foreach_1.5.2               Rfast_2.1.0                \n[21] RcppParallel_5.1.7          RcppZiggurat_0.1.6         \n[23] Rcpp_1.0.11                 patchwork_1.2.0            \n[25] Seurat_5.0.0                SeuratObject_5.0.0         \n[27] sp_2.1-1                    Hmisc_5.1-0                \n[29] dplyr_1.1.2                 circlize_0.4.15            \n[31] ComplexHeatmap_2.16.0       COTAN_2.5.0                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               bitops_1.0-7             \n  [5] tibble_3.2.1              polyclip_1.10-4          \n  [7] rpart_4.1.23              fastDummies_1.7.3        \n  [9] lifecycle_1.0.3           globals_0.16.2           \n [11] lattice_0.22-5            MASS_7.3-60              \n [13] backports_1.4.1           dendextend_1.17.1        \n [15] magrittr_2.0.3            plotly_4.10.2            \n [17] rmarkdown_2.24            yaml_2.3.7               \n [19] httpuv_1.6.11             glmGamPoi_1.12.2         \n [21] sctransform_0.4.1         spam_2.10-0              \n [23] askpass_1.2.0             spatstat.sparse_3.0-2    \n [25] minqa_1.2.5               cowplot_1.1.1            \n [27] pbapply_1.7-2             RColorBrewer_1.1-3       \n [29] zlibbioc_1.46.0           abind_1.4-5              \n [31] Rtsne_0.17                purrr_1.0.1              \n [33] RCurl_1.98-1.12           nnet_7.3-19              \n [35] GenomeInfoDbData_1.2.10   ggrepel_0.9.5            \n [37] irlba_2.3.5.1             listenv_0.9.0            \n [39] spatstat.utils_3.0-3      terra_1.7-39             \n [41] umap_0.2.10.0             goftest_1.2-3            \n [43] RSpectra_0.16-1           spatstat.random_3.2-1    \n [45] dqrng_0.3.0               fitdistrplus_1.1-11      \n [47] parallelly_1.37.1         DelayedMatrixStats_1.22.5\n [49] ncdf4_1.22                leiden_0.4.3             \n [51] codetools_0.2-19          DelayedArray_0.26.7      \n [53] tidyselect_1.2.0          shape_1.4.6              \n [55] farver_2.1.1              lme4_1.1-34              \n [57] ScaledMatrix_1.8.1        viridis_0.6.4            \n [59] base64enc_0.1-3           spatstat.explore_3.2-1   \n [61] jsonlite_1.8.7            GetoptLong_1.0.5         \n [63] ellipsis_0.3.2            progressr_0.14.0         \n [65] Formula_1.2-5             ggridges_0.5.4           \n [67] survival_3.5-8            tools_4.3.2              \n [69] ica_1.0-3                 glue_1.7.0               \n [71] gridExtra_2.3             xfun_0.39                \n [73] ggthemes_5.1.0            withr_3.0.0              \n [75] fastmap_1.1.1             boot_1.3-28              \n [77] fansi_1.0.4               openssl_2.1.0            \n [79] digest_0.6.33             rsvd_1.0.5               \n [81] parallelDist_0.2.6        R6_2.5.1                 \n [83] mime_0.12                 colorspace_2.1-0         \n [85] Cairo_1.6-1               scattermore_1.2          \n [87] tensor_1.5                spatstat.data_3.0-1      \n [89] utf8_1.2.3                tidyr_1.3.0              \n [91] generics_0.1.3            data.table_1.15.0        \n [93] httr_1.4.6                htmlwidgets_1.6.2        \n [95] S4Arrays_1.2.0            uwot_0.1.16              \n [97] pkgconfig_2.0.3           gtable_0.3.3             \n [99] lmtest_0.9-40             XVector_0.40.0           \n[101] htmltools_0.5.8           dotCall64_1.1-0          \n[103] clue_0.3-64               scales_1.3.0             \n[105] png_0.1-8                 knitr_1.43               \n[107] rstudioapi_0.15.0         reshape2_1.4.4           \n[109] rjson_0.2.21              nloptr_2.0.3             \n[111] checkmate_2.3.0           nlme_3.1-163             \n[113] zoo_1.8-12                GlobalOptions_0.1.2      \n[115] KernSmooth_2.23-22        miniUI_0.1.1.1           \n[117] foreign_0.8-86            pillar_1.9.0             \n[119] vctrs_0.6.3               RANN_2.6.1               \n[121] promises_1.2.0.1          BiocSingular_1.16.0      \n[123] beachmat_2.16.0           xtable_1.8-4             \n[125] cluster_2.1.6             htmlTable_2.4.1          \n[127] evaluate_0.21             zeallot_0.1.0            \n[129] cli_3.6.1                 compiler_4.3.2           \n[131] rlang_1.1.1               crayon_1.5.2             \n[133] future.apply_1.11.0       labeling_0.4.2           \n[135] plyr_1.8.8                stringi_1.8.1            \n[137] viridisLite_0.4.2         deldir_2.0-2             \n[139] BiocParallel_1.34.2       assertthat_0.2.1         \n[141] munsell_0.5.0             lazyeval_0.2.2           \n[143] spatstat.geom_3.2-4       PCAtools_2.14.0          \n[145] Matrix_1.6-3              RcppHNSW_0.6.0           \n[147] sparseMatrixStats_1.12.2  future_1.33.0            \n[149] ggplot2_3.5.0             shiny_1.8.0              \n[151] ROCR_1.0-11               igraph_2.0.3",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "Correlation analysis for E17.5"
    ]
  },
  {
    "objectID": "CorticalCells_GSM2861514_E175-analysis.html",
    "href": "CorticalCells_GSM2861514_E175-analysis.html",
    "title": "Cortical cells DGE E17.5 Data-set Anaysis",
    "section": "",
    "text": "library(ggplot2)\nlibrary(tibble)\nlibrary(zeallot)\nlibrary(COTAN)\n\noptions(parallelly.fork.enable = TRUE)\n\noutDir &lt;- \"Data/Yuzwa_MouseCortex/\"\n\nsetLoggingLevel(1)\nsetLoggingFile(file.path(outDir, \"CorticalCells_GSM2861514_E175-analysis.log\"))\nRead the dataset from file\ndataset &lt;- read.csv(file.path(outDir &lt;- \"Data/Yuzwa_MouseCortex/\"\n, \"GSM2861514_E175_Only_Cortical_Cells_DGE.txt\"),\n       header = TRUE, sep = \"\\t\", strip.white = TRUE,row.names = 1)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "E17.5 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "CorticalCells_GSM2861514_E175-analysis.html#cleaning",
    "href": "CorticalCells_GSM2861514_E175-analysis.html#cleaning",
    "title": "Cortical cells DGE E17.5 Data-set Anaysis",
    "section": "Cleaning",
    "text": "Cleaning\nCrate the COTAN object\n\nsampleCondition &lt;- \"CorticalCells_GSM2861514_E175\"\ncc175Obj &lt;- COTAN(raw = dataset)\ncc175Obj &lt;- initializeMetaDataset(cc175Obj,\n                                  GEO = \"GSM2861511_E135\",\n                                  sequencingMethod = \"DropSeq\",\n                                  sampleCondition = sampleCondition)\n\nInspect cells’ sizes\n\ncellSizePlot(cc175Obj)\n\n\n\n\n\n\n\n\nDrop cells with too many ritz reads as they are probably duplets\n\ncellsSizeThr &lt;- 6500\ncc175Obj &lt;- addElementToMetaDataset(cc175Obj, \"Cells size threshold\", cellsSizeThr)\n\ncells_to_rem &lt;- getCells(cc175Obj)[getCellsSize(cc175Obj) &gt; cellsSizeThr]\ncc175Obj &lt;- dropGenesCells(cc175Obj, cells = cells_to_rem)\n\ncellSizePlot(cc175Obj)\n\n\n\n\n\n\n\n\nInspect the number of expressed genes per cell\n\ngenesSizePlot(cc175Obj)\n\n\n\n\n\n\n\n\nDrop cells with too high genes expession as they are probably duplets\n\ngenesSizeThr &lt;- 3000\ncc175Obj &lt;- addElementToMetaDataset(cc175Obj, \"Num genes threshold\", genesSizeThr)\n\nnumExprGenes &lt;- getNumExpressedGenes(cc175Obj)\ncells_to_rem &lt;- names(numExprGenes)[numExprGenes &gt; genesSizeThr]\ncc175Obj &lt;- dropGenesCells(cc175Obj, cells = cells_to_rem)\n\ngenesSizePlot(cc175Obj)\n\n\n\n\n\n\n\n\nCheck number of mitocondrial genes expressed in each cell\n\nmitGenesPattern &lt;- \"^mt-\"\ngetGenes(cc175Obj)[grep(mitGenesPattern, getGenes(cc175Obj))]\n\n [1] \"mt-Co1\"  \"mt-Co2\"  \"mt-Co3\"  \"mt-Cytb\" \"mt-Nd1\"  \"mt-Nd2\"  \"mt-Nd4\" \n [8] \"mt-Nd5\"  \"mt-Nd6\"  \"mt-Rnr1\" \"mt-Rnr2\" \"mt-Ta\"   \"mt-Tc\"   \"mt-Te\"  \n[15] \"mt-Tf\"   \"mt-Ti\"   \"mt-Tl1\"  \"mt-Tl2\"  \"mt-Tm\"   \"mt-Tp\"   \"mt-Tq\"  \n[22] \"mt-Ts2\"  \"mt-Tt\"   \"mt-Tv\"   \"mt-Tw\"   \"mt-Ty\"  \n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(cc175Obj, genePrefix = mitGenesPattern)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCells with a too high percentage of mitocondrial genes are likely dead (or at the last problematic) cells. So we drop them!\n\nmitPercThr &lt;- 5.0\ncc175Obj &lt;- addElementToMetaDataset(cc175Obj, \"Mitoc. perc. threshold\", mitPercThr)\n\ncells_to_rem &lt;- rownames(mitSizes)[mitSizes[[\"mit.percentage\"]] &gt; mitPercThr]\n\ncc175Obj &lt;- dropGenesCells(cc175Obj, cells = cells_to_rem)\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(cc175Obj, genePrefix = mitGenesPattern)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCheck no further outliers after all the culling\n\ncellSizePlot(cc175Obj)\n\n\n\n\n\n\n\ngenesSizePlot(cc175Obj)\n\n\n\n\n\n\n\n\n\nClean: round 1\n\ncc175Obj &lt;- clean(cc175Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot,\n  UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(cc175Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\ncc175Obj &lt;- addElementToMetaDataset(cc175Obj, \"Num drop B group\", 0)\n\nB group contains high number of hemoglobin genes: so they are not interesting\n\ncells_to_rem &lt;- rownames(pcaCellsData)[pcaCellsData[[\"groups\"]] == \"B\"]\n\ncc175Obj &lt;- dropGenesCells(cc175Obj, cells = cells_to_rem)\n\n\n\nClean: round 2\n\ncc175Obj &lt;- clean(cc175Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot,\n  UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(cc175Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\ncc175Obj &lt;- addElementToMetaDataset(cc175Obj, \"Num drop B group\", 1)\n\nVisualize if all is ok:\n\nplot(pcaCellsData)\n\n\n\n\n\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\nplot(zoomedNuPlot)\n\n\n\n\n\n\n\n\nDrop very low UDE cells as they are likely outliers\n\nlowUDEThr &lt;- 0.2\ncc175Obj &lt;- addElementToMetaDataset(cc175Obj, \"Low UDE threshold\", lowUDEThr)\n\nnuDf &lt;- data.frame(\"nu\" = sort(getNu(cc175Obj)), \"n\" = seq_along(getNu(cc175Obj)))\n\ncells_to_rem &lt;- rownames(nuDf)[nuDf[[\"nu\"]] &lt; lowUDEThr]\ncc175Obj &lt;- dropGenesCells(cc175Obj, cells = cells_to_rem)\n\nFinal cleaning to check all is OK\n\ncc175Obj &lt;- clean(cc175Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot,\n  UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(cc175Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\nplot(cellSizePlot(cc175Obj))\n\n\n\n\n\n\n\nplot(genesSizePlot(cc175Obj))\n\n\n\n\n\n\n\n\nCalculate genes’ COEX\n\ncc175Obj &lt;- proceedToCoex(cc175Obj, calcCoex = TRUE, cores = 12,\n                          saveObj = TRUE, outDir = outDir)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "E17.5 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "CorticalCells_GSM2861514_E175-analysis.html#gdi",
    "href": "CorticalCells_GSM2861514_E175-analysis.html#gdi",
    "title": "Cortical cells DGE E17.5 Data-set Anaysis",
    "section": "GDI",
    "text": "GDI\n\ngdiData &lt;- calculateGDI(cc175Obj)\n\ngenesToLabel &lt;- head(rownames(gdiData[order(gdiData[[\"GDI\"]],\n                                            decreasing = TRUE), ]), n = 10L)\n\ngenesToLabel\n\n [1] \"Ednrb\"   \"Mfge8\"   \"Aldoc\"   \"Sox2\"    \"Vim\"     \"Hes5\"    \"Neurod6\"\n [8] \"Tubb3\"   \"Ddah1\"   \"Atp1a2\" \n\ngdiPlot &lt;- GDIPlot(cc175Obj, GDIIn = gdiData, GDIThreshold = 1.4,\n                   genes = list(\"Top 10 GDI genes\" = genesToLabel))\n\nplot(gdiPlot)\n\n\n\n\n\n\n\n\nSave the COTAN object\n\nsaveRDS(cc175Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "E17.5 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "CorticalCells_GSM2861514_E175-analysis.html#consistent-transcript-cohorts-clustering",
    "href": "CorticalCells_GSM2861514_E175-analysis.html#consistent-transcript-cohorts-clustering",
    "title": "Cortical cells DGE E17.5 Data-set Anaysis",
    "section": "Consistent Transcript Cohorts (clustering)",
    "text": "Consistent Transcript Cohorts (clustering)\n\nc(splitClusters, splitCoexDF) %&lt;-%\n  cellsUniformClustering(cc175Obj, GDIThreshold = 1.4, cores = 13,\n                         saveObj = TRUE, outDir = outDir)\n\n\ncc175Obj &lt;- addClusterization(cc175Obj, clName = \"split\",\n                              clusters = splitClusters,\n                              coexDF = splitCoexDF, override = TRUE)\n\ntable(splitClusters)\n\n\nsaveRDS(cc175Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\nc(mergedClusters, mergedCoexDF) %&lt;-%\n  mergeUniformCellsClusters(cc175Obj, clusters = splitClusters,\n                            GDIThreshold = 1.4, cores = 13,\n                            saveObj = TRUE, outDir = outDir)\n\ncc175Obj &lt;- addClusterization(cc175Obj, clName = \"merge\",\n                              clusters = mergedClusters,\n                              coexDF = mergedCoexDF,\n                              override = TRUE)\n\ntable(mergedClusters)\n\n\nsaveRDS(cc175Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\n\nSys.time()\n\n[1] \"2023-08-22 19:46:59 CEST\"\n\n\n\nsessionInfo()\n\nR version 4.3.1 (2023-06-16)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] COTAN_2.1.7   zeallot_0.1.0 tibble_3.2.1  ggplot2_3.4.2\n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3     rstudioapi_0.15.0      jsonlite_1.8.7        \n  [4] shape_1.4.6            umap_0.2.10.0          magrittr_2.0.3        \n  [7] spatstat.utils_3.0-3   farver_2.1.1           rmarkdown_2.24        \n [10] GlobalOptions_0.1.2    vctrs_0.6.3            ROCR_1.0-11           \n [13] spatstat.explore_3.2-1 askpass_1.1            htmltools_0.5.5       \n [16] sctransform_0.3.5      parallelly_1.36.0      KernSmooth_2.23-22    \n [19] htmlwidgets_1.6.2      ica_1.0-3              plyr_1.8.8            \n [22] plotly_4.10.2          zoo_1.8-12             igraph_1.5.1          \n [25] mime_0.12              lifecycle_1.0.3        iterators_1.0.14      \n [28] pkgconfig_2.0.3        Matrix_1.6-0           R6_2.5.1              \n [31] fastmap_1.1.1          fitdistrplus_1.1-11    future_1.33.0         \n [34] shiny_1.7.5            clue_0.3-64            digest_0.6.33         \n [37] colorspace_2.1-0       patchwork_1.1.2        S4Vectors_0.38.1      \n [40] Seurat_4.3.0.1         tensor_1.5             RSpectra_0.16-1       \n [43] irlba_2.3.5.1          labeling_0.4.2         progressr_0.14.0      \n [46] RcppZiggurat_0.1.6     fansi_1.0.4            spatstat.sparse_3.0-2 \n [49] httr_1.4.6             polyclip_1.10-4        abind_1.4-5           \n [52] compiler_4.3.1         withr_2.5.0            doParallel_1.0.17     \n [55] viridis_0.6.4          dendextend_1.17.1      MASS_7.3-60           \n [58] openssl_2.1.0          rjson_0.2.21           tools_4.3.1           \n [61] lmtest_0.9-40          httpuv_1.6.11          future.apply_1.11.0   \n [64] goftest_1.2-3          glue_1.6.2             nlme_3.1-162          \n [67] promises_1.2.0.1       grid_4.3.1             Rtsne_0.16            \n [70] cluster_2.1.4          reshape2_1.4.4         generics_0.1.3        \n [73] gtable_0.3.3           spatstat.data_3.0-1    tidyr_1.3.0           \n [76] data.table_1.14.8      sp_2.0-0               utf8_1.2.3            \n [79] BiocGenerics_0.46.0    spatstat.geom_3.2-4    RcppAnnoy_0.0.21      \n [82] ggrepel_0.9.3          RANN_2.6.1             foreach_1.5.2         \n [85] pillar_1.9.0           stringr_1.5.0          later_1.3.1           \n [88] circlize_0.4.15        splines_4.3.1          dplyr_1.1.2           \n [91] lattice_0.21-8         survival_3.5-5         deldir_1.0-9          \n [94] tidyselect_1.2.0       ComplexHeatmap_2.16.0  miniUI_0.1.1.1        \n [97] pbapply_1.7-2          knitr_1.43             gridExtra_2.3         \n[100] IRanges_2.34.1         scattermore_1.2        stats4_4.3.1          \n[103] xfun_0.39              factoextra_1.0.7       matrixStats_1.0.0     \n[106] stringi_1.7.12         lazyeval_0.2.2         yaml_2.3.7            \n[109] evaluate_0.21          codetools_0.2-19       cli_3.6.1             \n[112] RcppParallel_5.1.7     uwot_0.1.16            xtable_1.8-4          \n[115] reticulate_1.30        munsell_0.5.0          Rcpp_1.0.11           \n[118] globals_0.16.2         spatstat.random_3.1-5  png_0.1-8             \n[121] parallel_4.3.1         Rfast_2.0.8            ellipsis_0.3.2        \n[124] assertthat_0.2.1       parallelDist_0.2.6     listenv_0.9.0         \n[127] ggthemes_4.2.4         viridisLite_0.4.2      scales_1.2.1          \n[130] ggridges_0.5.4         SeuratObject_4.1.3     leiden_0.4.3          \n[133] purrr_1.0.1            crayon_1.5.2           GetoptLong_1.0.5      \n[136] rlang_1.1.1            cowplot_1.1.1",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Yuzwa 2017",
      "E17.5 Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "cd14_analysis.html",
    "href": "cd14_analysis.html",
    "title": "CD14 Data-set Anaysis with cleaning",
    "section": "",
    "text": "#library(SingleCellExperiment)\n#library(DuoClustering2018)\n#library(tidyr)\nlibrary(ggplot2)\n#library(ggsankey) # remotes::install_github(\"davidsjoberg/ggsankey\")\nlibrary(tibble)\nlibrary(zeallot)\nlibrary(COTAN)\noptions(parallelly.fork.enable = TRUE)\n\noutDir &lt;- \"Data/CD14Cleaned/\"\n\nsetLoggingLevel(2)\nsetLoggingFile(file.path(outDir, \"cd14_analysis.log\"))\n\n\nlibrary(Seurat)\ndataset &lt;- Read10X(file.path(outDir, \"/OrigialDatahg19\"))\n\n\nsampleCondition &lt;- \"CD14_Monocytes\"\ncd14Obj &lt;- COTAN(raw = dataset)\ncd14Obj &lt;- initializeMetaDataset(cd14Obj,\n                                 GEO = \"10X CD14+ Monocytes\",\n                                 sequencingMethod = \"10X\",\n                                 sampleCondition = sampleCondition)\n\nsampleCondition\n\n[1] \"CD14_Monocytes\"\n\n\nInspect cells’ sizes\n\ncellSizePlot(cd14Obj, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nDrop cells with too many reads as they are probably doublets\n\ncellsSizeThr &lt;- 2500\ncd14Obj &lt;- addElementToMetaDataset(cd14Obj, \"Cells size threshold\", cellsSizeThr)\n\ncells_to_rem &lt;- getCells(cd14Obj)[getCellsSize(cd14Obj) &gt; cellsSizeThr]\ncd14Obj &lt;- dropGenesCells(cd14Obj, cells = cells_to_rem)\n\ncellSizePlot(cd14Obj, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nInspect the number of expressed genes per cell\n\ngenesSizePlot(cd14Obj, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nDrop cells with too high genes expression as they are probably doublets\n\ngenesSizeThr &lt;- 800\ncd14Obj &lt;- addElementToMetaDataset(cd14Obj, \"Num genes threshold\", genesSizeThr)\n\nnumExprGenes &lt;- getNumExpressedGenes(cd14Obj)\ncells_to_rem &lt;- names(numExprGenes)[numExprGenes &gt; genesSizeThr]\ncd14Obj &lt;- dropGenesCells(cd14Obj, cells = cells_to_rem)\n\ngenesSizePlot(cd14Obj, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nCheck number of mitochondrial genes expressed in each cell\n\nmitGenesPattern &lt;- \"^[Mm][Tt]-\"\ngetGenes(cd14Obj)[grep(mitGenesPattern, getGenes(cd14Obj))]\n\n [1] \"MT-ND1\"  \"MT-ND2\"  \"MT-CO1\"  \"MT-CO2\"  \"MT-ATP8\" \"MT-ATP6\" \"MT-CO3\" \n [8] \"MT-ND3\"  \"MT-ND4L\" \"MT-ND4\"  \"MT-ND5\"  \"MT-ND6\"  \"MT-CYB\" \n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(cd14Obj, genePrefix = mitGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCells with a too high percentage of mitochondrial genes are likely dead (or at the last problematic) cells. So we drop them!\n\nmitPercThr &lt;- 7\ncd14Obj &lt;- addElementToMetaDataset(cd14Obj, \"Mitoc. perc. threshold\", mitPercThr)\n\ncells_to_rem &lt;- rownames(mitSizes)[mitSizes[[\"mit.percentage\"]] &gt; mitPercThr]\n\ncd14Obj &lt;- dropGenesCells(cd14Obj, cells = cells_to_rem)\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(cd14Obj, genePrefix = mitGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCheck the number of ribosomal genes expressed in each cell\n\nribGenesPattern &lt;- \"^RP[SL]\\\\d+\"\ngetGenes(cd14Obj)[grep(ribGenesPattern, getGenes(cd14Obj))]\n\n  [1] \"RPL22\"          \"RPL11\"          \"RPS6KA1\"        \"RPS8\"          \n  [5] \"RPL5\"           \"RPS27\"          \"RPS10P7\"        \"RPS6KC1\"       \n  [9] \"RPS7\"           \"RPS27A\"         \"RPL31\"          \"RPL37A\"        \n [13] \"RPL32\"          \"RPL15\"          \"RPL14\"          \"RPL29\"         \n [17] \"RPL24\"          \"RPL22L1\"        \"RPL39L\"         \"RPL35A\"        \n [21] \"RPL9\"           \"RPL34-AS1\"      \"RPL34\"          \"RPS3A\"         \n [25] \"RPL37\"          \"RPS23\"          \"RPS14\"          \"RPL26L1\"       \n [29] \"RPS18\"          \"RPS10-NUDT3\"    \"RPS10\"          \"RPL10A\"        \n [33] \"RPL7L1\"         \"RPS12\"          \"RPS6KA2\"        \"RPS6KA2-AS1\"   \n [37] \"RPS6KA3\"        \"RPS4X\"          \"RPS6KA6\"        \"RPL36A\"        \n [41] \"RPL36A-HNRNPH2\" \"RPL39\"          \"RPL10\"          \"RPS20\"         \n [45] \"RPL7\"           \"RPL30\"          \"RPL8\"           \"RPS6\"          \n [49] \"RPL35\"          \"RPL12\"          \"RPL7A\"          \"RPS24\"         \n [53] \"RPL27A\"         \"RPS13\"          \"RPS6KA4\"        \"RPS6KB2\"       \n [57] \"RPS3\"           \"RPS25\"          \"RPS26\"          \"RPL41\"         \n [61] \"RPL6\"           \"RPL21\"          \"RPL10L\"         \"RPS29\"         \n [65] \"RPL36AL\"        \"RPS6KL1\"        \"RPS6KA5\"        \"RPS27L\"        \n [69] \"RPL4\"           \"RPS17\"          \"RPS17L\"         \"RPL3L\"         \n [73] \"RPS2\"           \"RPS15A\"         \"RPL13\"          \"RPL26\"         \n [77] \"RPL23A\"         \"RPL23\"          \"RPL19\"          \"RPL27\"         \n [81] \"RPS6KB1\"        \"RPL38\"          \"RPL17-C18orf32\" \"RPL17\"         \n [85] \"RPS21\"          \"RPS15\"          \"RPL36\"          \"RPS28\"         \n [89] \"RPL18A\"         \"RPS16\"          \"RPS19\"          \"RPL18\"         \n [93] \"RPL13A\"         \"RPS11\"          \"RPS9\"           \"RPL28\"         \n [97] \"RPS5\"           \"RPS4Y1\"         \"RPS4Y2\"         \"RPL3\"          \n[101] \"RPS19BP1\"      \n\nc(ribPlot, ribSizes) %&lt;-%\n  mitochondrialPercentagePlot(cd14Obj, genePrefix = mitGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(ribPlot)\n\n\n\n\n\n\n\n\nCheck no further outliers after all the culling\n\ncellSizePlot(cd14Obj, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\ngenesSizePlot(cd14Obj, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nClean: round 1\n\ncd14Obj &lt;- clean(cd14Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(cd14Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\ncd14Obj &lt;- addElementToMetaDataset(cd14Obj, \"Num drop B group\", 0)\n\nVisualize if all is ok:\n\nplot(UDEPlot)\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\nplot(zoomedNuPlot)\n\n\n\n\n\n\n\n\nFinal cleaning to check all is OK\n\ncd14Obj &lt;- clean(cd14Obj)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(cd14Obj)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\nplot(pcaCellsData)\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\nplot(zoomedNuPlot)\n\n\n\n\n\n\n\nplot(cellSizePlot(cd14Obj, splitPattern = \"-\", numCol = 2))\n\n\n\n\n\n\n\nplot(genesSizePlot(cd14Obj, splitPattern = \"-\", numCol = 2))\n\n\n\n\n\n\n\n\nCalculate genes’ COEX\n\nSys.time()\n\ncd14Obj &lt;- proceedToCoex(cd14Obj, calcCoex = TRUE, cores = 12,\n                         saveObj = TRUE, outDir = outDir)\n\n\ncd14Obj &lt;- readRDS(file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\ngdiData &lt;- calculateGDI(cd14Obj)\n\ngenesToLabel &lt;- head(rownames(gdiData[order(gdiData[[\"GDI\"]],\n                                            decreasing = TRUE), ]), n = 50L)\n\nsort(genesToLabel)\n\n [1] \"ABI3\"      \"ARHGDIB\"   \"ATP5A1\"    \"ATP6V1G1\"  \"CALM2\"     \"CD53\"     \n [7] \"CD7\"       \"CLEC10A\"   \"CPVL\"      \"CTSW\"      \"FCER1A\"    \"FKBP1A\"   \n[13] \"H2AFY\"     \"HLA-DMB\"   \"HLA-DPA1\"  \"HLA-DPB1\"  \"HLA-DQA1\"  \"HLA-DQA2\" \n[19] \"HLA-DQB1\"  \"HLA-DRA\"   \"HMGN1\"     \"HNRNPA0\"   \"HNRNPA1\"   \"HNRNPA2B1\"\n[25] \"IFITM1\"    \"IL2RG\"     \"IL32\"      \"LDHA\"      \"LDHB\"      \"MYL12A\"   \n[31] \"NPM1\"      \"PARK7\"     \"PDIA6\"     \"PGK1\"      \"PTPRCAP\"   \"RAB7A\"    \n[37] \"RBM3\"      \"RHOA\"      \"RHOC\"      \"RPL5\"      \"S100A6\"    \"S100A8\"   \n[43] \"S100A9\"    \"SELL\"      \"SLC25A5\"   \"TMEM230\"   \"TMEM66\"    \"TUBA1B\"   \n[49] \"TYROBP\"    \"YBX1\"     \n\ngdiData[genesToLabel[[50L]], \"GDI\"]\n\n[1] 1.606624\n\ngdiPlot &lt;- GDIPlot(cd14Obj, GDIIn = gdiData, GDIThreshold = 1.4,\n                   genes = list(\"Top 10 GDI genes\" = genesToLabel[1L:10L]))\n\nplot(gdiPlot)\n\n\n\n\n\n\n\nSys.time()\n\n[1] \"2024-05-10 19:18:01 CEST\"\n\n\nSave the COTAN object\n\nsaveRDS(cd14Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\ncd14Obj &lt;- readRDS(file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\nc(splitClusters, splitCoexDF) %&lt;-%\n  cellsUniformClustering(cd14Obj, GDIThreshold = 1.43, cores = 13,\n                         saveObj = TRUE, outDir = outDir)\n\ncd14Obj &lt;- addClusterization(cd14Obj, clName = \"split\",\n                             clusters = splitClusters,\n                             coexDF = splitCoexDF, override = TRUE)\n\n\nsplitClusters &lt;- getClusterizationData(cd14Obj, clName = \"split\")[[1]]\n\ntable(splitClusters)\n\nsplitClusters\n  1   2   3   4   5 \n878  38 637 837  48 \n\n\n\nsaveRDS(cd14Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\nc(mergedClusters, mergedCoexDF) %&lt;-%\n  mergeUniformCellsClusters(cd14Obj, clusters = splitClusters,\n                            GDIThreshold = 1.43, cores = 13,\n                            saveObj = TRUE, outDir = outDir)\n\ncd14Obj &lt;- addClusterization(cd14Obj, clName = \"merge\",\n                             clusters = mergedClusters,\n                             coexDF = mergedCoexDF,\n                             override = TRUE)\n\n\nmergedClusters &lt;- getClusterizationData(cd14Obj, clName = \"merge\")[[1]]\n\ntable(mergedClusters)\n\nmergedClusters\n   1    2    3 \n1522  878   38 \n\n\n\nsaveRDS(cd14Obj, file = file.path(outDir, paste0(sampleCondition, \".cotan.RDS\")))\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] Seurat_5.0.0       SeuratObject_5.0.0 sp_2.1-1           COTAN_2.5.0       \n[5] zeallot_0.1.0      tibble_3.2.1       ggplot2_3.5.0     \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               R.oo_1.26.0              \n  [5] polyclip_1.10-4           fastDummies_1.7.3        \n  [7] lifecycle_1.0.3           doParallel_1.0.17        \n  [9] globals_0.16.2            lattice_0.22-5           \n [11] MASS_7.3-60               dendextend_1.17.1        \n [13] magrittr_2.0.3            plotly_4.10.2            \n [15] rmarkdown_2.24            yaml_2.3.7               \n [17] httpuv_1.6.11             sctransform_0.4.1        \n [19] spam_2.10-0               askpass_1.2.0            \n [21] spatstat.sparse_3.0-2     reticulate_1.36.1        \n [23] cowplot_1.1.1             pbapply_1.7-2            \n [25] RColorBrewer_1.1-3        abind_1.4-5              \n [27] Rtsne_0.17                purrr_1.0.1              \n [29] R.utils_2.12.2            BiocGenerics_0.46.0      \n [31] circlize_0.4.15           IRanges_2.34.1           \n [33] S4Vectors_0.38.1          ggrepel_0.9.5            \n [35] irlba_2.3.5.1             listenv_0.9.0            \n [37] spatstat.utils_3.0-3      umap_0.2.10.0            \n [39] goftest_1.2-3             RSpectra_0.16-1          \n [41] spatstat.random_3.2-1     dqrng_0.3.0              \n [43] fitdistrplus_1.1-11       parallelly_1.37.1        \n [45] DelayedMatrixStats_1.22.5 leiden_0.4.3             \n [47] codetools_0.2-19          DelayedArray_0.26.7      \n [49] tidyselect_1.2.0          shape_1.4.6              \n [51] farver_2.1.1              ScaledMatrix_1.8.1       \n [53] viridis_0.6.4             matrixStats_1.2.0        \n [55] stats4_4.3.2              spatstat.explore_3.2-1   \n [57] jsonlite_1.8.7            GetoptLong_1.0.5         \n [59] ellipsis_0.3.2            progressr_0.14.0         \n [61] ggridges_0.5.4            survival_3.5-8           \n [63] iterators_1.0.14          foreach_1.5.2            \n [65] tools_4.3.2               ica_1.0-3                \n [67] Rcpp_1.0.11               glue_1.7.0               \n [69] gridExtra_2.3             xfun_0.39                \n [71] MatrixGenerics_1.12.3     ggthemes_5.1.0           \n [73] dplyr_1.1.2               withr_3.0.0              \n [75] fastmap_1.1.1             fansi_1.0.4              \n [77] openssl_2.1.0             digest_0.6.33            \n [79] rsvd_1.0.5                parallelDist_0.2.6       \n [81] R6_2.5.1                  mime_0.12                \n [83] colorspace_2.1-0          scattermore_1.2          \n [85] tensor_1.5                spatstat.data_3.0-1      \n [87] R.methodsS3_1.8.2         utf8_1.2.3               \n [89] tidyr_1.3.0               generics_0.1.3           \n [91] data.table_1.15.0         httr_1.4.6               \n [93] htmlwidgets_1.6.2         S4Arrays_1.2.0           \n [95] uwot_0.1.16               pkgconfig_2.0.3          \n [97] gtable_0.3.3              ComplexHeatmap_2.16.0    \n [99] lmtest_0.9-40             htmltools_0.5.8          \n[101] dotCall64_1.1-0           clue_0.3-64              \n[103] scales_1.3.0              png_0.1-8                \n[105] knitr_1.43                rstudioapi_0.15.0        \n[107] reshape2_1.4.4            rjson_0.2.21             \n[109] nlme_3.1-163              zoo_1.8-12               \n[111] GlobalOptions_0.1.2       stringr_1.5.0            \n[113] KernSmooth_2.23-22        parallel_4.3.2           \n[115] miniUI_0.1.1.1            RcppZiggurat_0.1.6       \n[117] pillar_1.9.0              grid_4.3.2               \n[119] vctrs_0.6.3               RANN_2.6.1               \n[121] promises_1.2.0.1          BiocSingular_1.16.0      \n[123] beachmat_2.16.0           xtable_1.8-4             \n[125] cluster_2.1.6             evaluate_0.21            \n[127] cli_3.6.1                 compiler_4.3.2           \n[129] rlang_1.1.1               crayon_1.5.2             \n[131] future.apply_1.11.0       labeling_0.4.2           \n[133] plyr_1.8.8                stringi_1.8.1            \n[135] viridisLite_0.4.2         deldir_2.0-2             \n[137] BiocParallel_1.34.2       assertthat_0.2.1         \n[139] munsell_0.5.0             lazyeval_0.2.2           \n[141] spatstat.geom_3.2-4       PCAtools_2.14.0          \n[143] Matrix_1.6-3              RcppHNSW_0.6.0           \n[145] patchwork_1.2.0           sparseMatrixStats_1.12.2 \n[147] future_1.33.0             shiny_1.8.0              \n[149] ROCR_1.0-11               Rfast_2.1.0              \n[151] igraph_2.0.3              RcppParallel_5.1.7",
    "crumbs": [
      "Datasets",
      "CD14+",
      "CD14+ Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "Mouse_Cortex_E14.5.html",
    "href": "Mouse_Cortex_E14.5.html",
    "title": "E14.5 Mouse Cortex Loo 2019",
    "section": "",
    "text": "options(parallelly.fork.enable = TRUE)\nlibrary(COTAN)\nlibrary(zeallot)\nlibrary(data.table)\nlibrary(factoextra)\nlibrary(Rtsne)\nlibrary(qpdf)\nlibrary(stringr)\ne14_dge = read.table(\"Data/MouseCortex/OriginalData/E14_combined_matrix.txt.gz\",header=T,sep=\"\\t\",row.names=1)\n\nprint(dim(e14_dge))\n\n[1] 21313 11069\noutDir &lt;- \"Data/MouseCortex/\"\nsetLoggingLevel(1)\nsetLoggingFile(file.path(outDir, \"Dataset.log\"))\ncond &lt;- \"MouseCortex_E14.5\"\nobj &lt;- COTAN(raw = e14_dge)\nobj &lt;- initializeMetaDataset(obj,\n                             GEO = \"GSE123335\",\n                             sequencingMethod = \"Drop_seq\",\n                             sampleCondition = cond)\n\nCellCond &lt;- str_split(getCells(obj),pattern = \"_\",simplify = T)[,1]\nnames(CellCond) &lt;- getCells(obj)\nobj &lt;- addCondition(obj,\"CellCond\",CellCond)\n\nrm(e14_dge)\nECDPlot(obj, yCut = 400L)\ncellSizePlot(obj,condName = \"CellCond\")\ngenesSizePlot(obj,condName = \"CellCond\")\nmit &lt;- mitochondrialPercentagePlot(obj, genePrefix = \"^mt-\",condName = \"CellCond\")\nmit[[\"plot\"]]\nTo drop cells by cell library size:\ncells_to_rem &lt;- getCells(obj)[getCellsSize(obj) &gt; 15000]\nobj &lt;- dropGenesCells(obj, cells = cells_to_rem)\ncellSizePlot(obj,condName = \"CellCond\")\ngenesSizePlot(obj,condName = \"CellCond\")\nTo drop cells by mitochondrial percentage:\nto_rem &lt;- mit[[\"sizes\"]][[\"mit.percentage\"]] &gt; 7.5\ncells_to_rem &lt;- rownames(mit[[\"sizes\"]])[to_rem]\nobj &lt;- dropGenesCells(obj, cells = cells_to_rem)\n\nmit &lt;- mitochondrialPercentagePlot(obj, genePrefix = \"^mt-\",condName = \"CellCond\")\n\nmit[[\"plot\"]]\ncellSizePlot(obj,condName = \"CellCond\")\nobj &lt;- clean(obj)\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoom) %&lt;-% cleanPlots(obj)\n\npcaCellsPlot\ngenesPlot\ncells_to_rem &lt;- rownames(pcaCellsData)[pcaCellsData[[\"groups\"]] == \"B\"]\nobj &lt;- dropGenesCells(obj, cells = cells_to_rem)\nobj &lt;- clean(obj)\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoom) %&lt;-% cleanPlots(obj)\n\npcaCellsPlot\ngenesPlot\nplot(nuPlot)\nnuDf &lt;- data.frame(\"nu\" = sort(getNu(obj)), \"n\" = seq_along(getNu(obj)))\nyset &lt;- 0.18 # the threshold to remove low UDE cells\nplot.ude &lt;- ggplot(nuDf, aes(x = n, y = nu)) +\n            geom_point(colour = \"#8491B4B2\", size = 1.0) +\n            xlim(0L, 3000) +\n            ylim(0.0, 1.0) +\n            geom_hline(yintercept = yset, linetype = \"dashed\",\n                       color = \"darkred\") +\n            annotate(geom = \"text\", x = 1000L, y = 0.25,\n                     label = paste0(\"to remove cells with nu &lt; \", yset),\n                     color = \"darkred\", size = 4.5)\n\nplot.ude\nobj &lt;- addElementToMetaDataset(obj, \"Threshold low UDE cells:\", yset)\n\ncells_to_rem &lt;- rownames(nuDf)[nuDf[[\"nu\"]] &lt; yset]\nobj &lt;- dropGenesCells(obj, cells = cells_to_rem)\nobj &lt;- clean(obj)\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoom) %&lt;-% cleanPlots(obj)\n\npcaCellsPlot\ngenesPlot\nUDEPlot\nnuPlot\nUDEPlot$data$Sample &lt;- str_split(rownames(UDEPlot$data),pattern = \"_\",simplify = T)[,1]\n\nggplot(UDEPlot$data, aes(PC1,PC2,color = Sample)) + geom_point(size = 0.5, alpha=0.7)\nggplot(UDEPlot$data, aes(PC2,PC3,color = Sample)) + geom_point(size = 0.5, alpha=0.7)\nggplot(UDEPlot$data, aes(PC2,PC5,color = Sample)) + geom_point(size = 0.5, alpha=0.7)\nggplot(UDEPlot$data, aes(PC2,PC5,color = groups)) + geom_point(size = 0.5, alpha=0.7)",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Loo 2019",
      "Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "Mouse_Cortex_E14.5.html#cotan-analysis",
    "href": "Mouse_Cortex_E14.5.html#cotan-analysis",
    "title": "E14.5 Mouse Cortex Loo 2019",
    "section": "COTAN analysis",
    "text": "COTAN analysis\nIn this part, all the contingency tables are computed and used to get the statistics.\n\nobj &lt;- estimateLambdaLinear(obj)\nobj &lt;- estimateDispersionBisection(obj, cores = 15L)\n\nCOEX evaluation and storing\n\nobj &lt;- calculateCoex(obj)\n\n\n# saving the structure\nsaveRDS(obj, file = file.path(outDir, paste0(cond, \".cotan.RDS\")))\n\n\nobjTemp &lt;- obj\nobj &lt;- readRDS(file = file.path(outDir, paste0(cond, \".cotan.RDS\")))\n\n(Next code… just check that the already stored data is identical to the re-calculated)\n\nidentical(getRawData(obj),getRawData(objTemp))\n\n[1] TRUE\n\n\n\nsessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 22.04.5 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] stringr_1.5.1     qpdf_1.3.5        Rtsne_0.17        factoextra_1.0.7 \n[5] ggplot2_4.0.1     data.table_1.17.0 zeallot_0.2.0     COTAN_2.9.4      \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.22            splines_4.5.2              \n  [3] later_1.4.2                 tibble_3.3.0               \n  [5] polyclip_1.10-7             fastDummies_1.7.5          \n  [7] lifecycle_1.0.4             doParallel_1.0.17          \n  [9] globals_0.18.0              lattice_0.22-7             \n [11] MASS_7.3-65                 dendextend_1.19.0          \n [13] magrittr_2.0.4              plotly_4.11.0              \n [15] rmarkdown_2.29              yaml_2.3.10                \n [17] httpuv_1.6.16               Seurat_5.2.1               \n [19] sctransform_0.4.2           askpass_1.2.1              \n [21] spam_2.11-1                 sp_2.2-0                   \n [23] spatstat.sparse_3.1-0       reticulate_1.42.0          \n [25] cowplot_1.1.3               pbapply_1.7-2              \n [27] RColorBrewer_1.1-3          abind_1.4-8                \n [29] GenomicRanges_1.60.0        purrr_1.2.0                \n [31] BiocGenerics_0.54.0         circlize_0.4.16            \n [33] GenomeInfoDbData_1.2.14     IRanges_2.42.0             \n [35] S4Vectors_0.46.0            ggrepel_0.9.6              \n [37] irlba_2.3.5.1               listenv_0.9.1              \n [39] spatstat.utils_3.1-4        goftest_1.2-3              \n [41] RSpectra_0.16-2             spatstat.random_3.4-1      \n [43] fitdistrplus_1.2-2          parallelly_1.45.0          \n [45] codetools_0.2-20            DelayedArray_0.34.1        \n [47] tidyselect_1.2.1            shape_1.4.6.1              \n [49] UCSC.utils_1.4.0            farver_2.1.2               \n [51] ScaledMatrix_1.16.0         viridis_0.6.5              \n [53] matrixStats_1.5.0           stats4_4.5.2               \n [55] spatstat.explore_3.4-2      jsonlite_2.0.0             \n [57] GetoptLong_1.0.5            gghalves_0.1.4             \n [59] progressr_0.15.1            ggridges_0.5.6             \n [61] survival_3.8-3              iterators_1.0.14           \n [63] foreach_1.5.2               tools_4.5.2                \n [65] ica_1.0-3                   Rcpp_1.0.14                \n [67] glue_1.8.0                  gridExtra_2.3              \n [69] SparseArray_1.8.0           xfun_0.52                  \n [71] MatrixGenerics_1.20.0       ggthemes_5.1.0             \n [73] GenomeInfoDb_1.44.0         dplyr_1.1.4                \n [75] withr_3.0.2                 fastmap_1.2.0              \n [77] digest_0.6.37               rsvd_1.0.5                 \n [79] parallelDist_0.2.6          R6_2.6.1                   \n [81] mime_0.13                   colorspace_2.1-1           \n [83] scattermore_1.2             tensor_1.5                 \n [85] spatstat.data_3.1-6         tidyr_1.3.1                \n [87] generics_0.1.3              httr_1.4.7                 \n [89] htmlwidgets_1.6.4           S4Arrays_1.8.0             \n [91] uwot_0.2.3                  pkgconfig_2.0.3            \n [93] gtable_0.3.6                ComplexHeatmap_2.24.0      \n [95] lmtest_0.9-40               S7_0.2.1                   \n [97] SingleCellExperiment_1.30.0 XVector_0.48.0             \n [99] htmltools_0.5.8.1           dotCall64_1.2              \n[101] zigg_0.0.2                  clue_0.3-66                \n[103] SeuratObject_5.1.0          scales_1.4.0               \n[105] Biobase_2.68.0              png_0.1-8                  \n[107] spatstat.univar_3.1-3       knitr_1.50                 \n[109] reshape2_1.4.4              rjson_0.2.23               \n[111] nlme_3.1-168                proxy_0.4-27               \n[113] zoo_1.8-14                  GlobalOptions_0.1.2        \n[115] KernSmooth_2.23-26          parallel_4.5.2             \n[117] miniUI_0.1.2                pillar_1.10.2              \n[119] grid_4.5.2                  vctrs_0.6.5                \n[121] RANN_2.6.2                  promises_1.3.2             \n[123] BiocSingular_1.24.0         beachmat_2.24.0            \n[125] xtable_1.8-4                cluster_2.1.8.1            \n[127] evaluate_1.0.3              cli_3.6.5                  \n[129] compiler_4.5.2              rlang_1.1.6                \n[131] crayon_1.5.3                future.apply_1.20.0        \n[133] labeling_0.4.3              plyr_1.8.9                 \n[135] stringi_1.8.7               viridisLite_0.4.2          \n[137] deldir_2.0-4                BiocParallel_1.42.0        \n[139] assertthat_0.2.1            lazyeval_0.2.2             \n[141] spatstat.geom_3.4-1         Matrix_1.7-4               \n[143] RcppHNSW_0.6.0              patchwork_1.3.2            \n[145] future_1.58.0               shiny_1.11.0               \n[147] SummarizedExperiment_1.38.1 ROCR_1.0-11                \n[149] Rfast_2.1.5.1               igraph_2.1.4               \n[151] RcppParallel_5.1.10",
    "crumbs": [
      "Datasets",
      "Mouse Cortex Loo 2019",
      "Cleaning and cell clustering"
    ]
  },
  {
    "objectID": "PBMC2_filtering.html",
    "href": "PBMC2_filtering.html",
    "title": "Filtering of PBMC2 using COTAN",
    "section": "",
    "text": "Library import\n\nlibrary(dplyr)\nlibrary(COTAN)\nlibrary(Seurat)\nlibrary(tibble)\nlibrary(ggplot2)\nlibrary(zeallot)\nlibrary(DropletUtils)\n\nSettings\n\ndatasetName = 'PBMC2'\ndatasetFolder = './Data/'\n\ninDir  = paste(datasetFolder, datasetName, '/raw/10X/', sep='')\noutDir = paste(datasetFolder, datasetName, '/filtered/', sep='')\ndir10X = paste(outDir, '10X/', sep='')\n\nif (!dir.exists(outDir)) {\n  dir.create(outDir, recursive = TRUE, showWarnings = FALSE)\n}\n\nsetLoggingLevel(2)\nsetLoggingFile(paste(outDir, \"logfile.log\", sep=\"\"))\noptions(parallelly.fork.enable = TRUE)\n\nData loading\n\ndataset = Read10X(data.dir = inDir, strip.suffix = TRUE)\ndataset = dataset[[1]]\nsampleCond &lt;- datasetName\nPBMC2 &lt;- COTAN(raw = dataset)\nPBMC2 &lt;- initializeMetaDataset(\n  PBMC2,\n  GEO = paste(\"10X \", datasetName, sep=\"\"),\n  sequencingMethod = \"10X\",\n  sampleCond = sampleCond\n)\n\nInspect cells’ sizes\n\ncellSizePlot(PBMC2)\n\n\n\n\n\n\n\n\nDrop cells with too many reads as they are probably doublets\n\ncellsSizeThr &lt;- 20000\nPBMC2 &lt;- addElementToMetaDataset(PBMC2, \"Cells size threshold\", cellsSizeThr)\n\ncellsToRem &lt;- getCells(PBMC2)[getCellsSize(PBMC2) &gt; cellsSizeThr]\nPBMC2 &lt;- dropGenesCells(PBMC2, cells = cellsToRem)\n\ncellSizePlot(PBMC2, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nInspect the number of expressed genes per cell\n\ngenesSizePlot(PBMC2, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nDrop cells with too high genes expression as they are probably doublets\n\ngeneSizeThr &lt;- 3500\nPBMC2 &lt;- addElementToMetaDataset(PBMC2, \"Num genes threshold\", geneSizeThr)\n\nnumExprGenes &lt;- getNumExpressedGenes(PBMC2)\ncellsToRem &lt;- names(numExprGenes)[numExprGenes &gt; geneSizeThr]\nPBMC2 &lt;- dropGenesCells(PBMC2, cells = cellsToRem)\n\ngenesSizePlot(PBMC2, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nCheck number of mithocondrial genes expressed in each cell\n\nmitGenesPattern &lt;- \"^[Mm][Tt]-\"\ngetGenes(PBMC2)[grep(mitGenesPattern, getGenes(PBMC2))]\n\n [1] \"MT-ND1\"  \"MT-ND2\"  \"MT-CO1\"  \"MT-CO2\"  \"MT-ATP8\" \"MT-ATP6\" \"MT-CO3\" \n [8] \"MT-ND3\"  \"MT-ND4L\" \"MT-ND4\"  \"MT-ND5\"  \"MT-ND6\"  \"MT-CYB\" \n\n\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(PBMC2, genePrefix = mitGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nWe drop cells with a too high percentage of mitocondrial genes (are likely dead)\n\nmitPercThr &lt;- 10\nPBMC2 &lt;- addElementToMetaDataset(PBMC2, \"Mitoc. perc. threshold\", mitPercThr)\n\ncellsToRem &lt;- rownames(mitSizes)[mitSizes[[\"mit.percentage\"]] &gt; mitPercThr]\n\nPBMC2 &lt;- dropGenesCells(PBMC2, cells = cellsToRem)\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(PBMC2, genePrefix = mitGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCheck number of ribosomial genes expressed in each cell\n\nribGenesPattern &lt;- \"^RP[SL]\\\\d+\"\ngetGenes(PBMC2)[grep(ribGenesPattern, getGenes(PBMC2))]\n\n [1] \"RPL22\"       \"RPL11\"       \"RPS6KA1\"     \"RPS8\"        \"RPL5\"       \n [6] \"RPS27\"       \"RPS6KC1\"     \"RPS7\"        \"RPS27A\"      \"RPL31\"      \n[11] \"RPL37A\"      \"RPL32\"       \"RPL15\"       \"RPL14\"       \"RPL29\"      \n[16] \"RPL24\"       \"RPL22L1\"     \"RPL39L\"      \"RPL35A\"      \"RPL9\"       \n[21] \"RPL34-AS1\"   \"RPL34\"       \"RPS3A\"       \"RPL37\"       \"RPS23\"      \n[26] \"RPS14\"       \"RPL26L1\"     \"RPS18\"       \"RPS10-NUDT3\" \"RPS10\"      \n[31] \"RPL10A\"      \"RPL7L1\"      \"RPS12\"       \"RPS6KA2\"     \"RPS6KA2-IT1\"\n[36] \"RPS6KA2-AS1\" \"RPS20\"       \"RPL7\"        \"RPL30\"       \"RPL8\"       \n[41] \"RPS6\"        \"RPL35\"       \"RPL12\"       \"RPL7A\"       \"RPS24\"      \n[46] \"RPL27A\"      \"RPS13\"       \"RPS6KA4\"     \"RPS6KB2\"     \"RPS6KB2-AS1\"\n[51] \"RPS3\"        \"RPS25\"       \"RPS26\"       \"RPL41\"       \"RPL6\"       \n[56] \"RPL21\"       \"RPL10L\"      \"RPS29\"       \"RPL36AL\"     \"RPS6KL1\"    \n[61] \"RPS6KA5\"     \"RPS27L\"      \"RPL4\"        \"RPS17\"       \"RPL3L\"      \n[66] \"RPS2\"        \"RPS15A\"      \"RPL13\"       \"RPL26\"       \"RPL23A\"     \n[71] \"RPL23\"       \"RPL19\"       \"RPL27\"       \"RPS6KB1\"     \"RPL38\"      \n[76] \"RPL17\"       \"RPS15\"       \"RPL36\"       \"RPS28\"       \"RPL18A\"     \n[81] \"RPS16\"       \"RPS19\"       \"RPL18\"       \"RPL13A\"      \"RPS11\"      \n[86] \"RPS9\"        \"RPL28\"       \"RPS5\"        \"RPS21\"       \"RPL3\"       \n[91] \"RPS19BP1\"    \"RPS6KA3\"     \"RPS4X\"       \"RPS6KA6\"     \"RPL36A\"     \n[96] \"RPL39\"       \"RPL10\"       \"RPS4Y1\"      \"RPS4Y2\"     \n\n\n\nc(ribPlot, ribSizes) %&lt;-%\n  mitochondrialPercentagePlot(PBMC2, genePrefix = ribGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(ribPlot)\n\n\n\n\n\n\n\n\nCheck no further outliers after all the culling\n\ncellSizePlot(PBMC2, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\n\ngenesSizePlot(PBMC2, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nCleaning, round 1\n\nPBMC2 &lt;- clean(PBMC2)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(PBMC2)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\n\n\nPBMC2 &lt;- addElementToMetaDataset(PBMC2, \"Num drop B group\", 0)\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\n\n\nplot(zoomedNuPlot)  \n\n\n\n\n\n\n\n\n\nyset=0.16\nnuDf &lt;- data.frame(\"nu\" = sort(getNu(PBMC2)), \"n\" = seq_along(getNu(PBMC2)))\nPBMC2 &lt;- addElementToMetaDataset(PBMC2, \"Threshold low UDE cells:\", yset)\ncellsToRem &lt;-rownames(nuDf)[nuDf[[\"nu\"]] &lt; yset]\nPBMC2 &lt;- dropGenesCells(PBMC2, cells = cellsToRem)\n\nCleaning, round 2\n\nPBMC2 &lt;- clean(PBMC2)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(PBMC2)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\n\n\nplot(pcaCellsData)\n\n\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\n\n\nplot(zoomedNuPlot)\n\n\n\n\n\n\n\n\n\nplot(cellSizePlot(PBMC2, splitPattern = \"-\", numCol = 2))\n\n\n\n\n\n\n\n\n\nplot(genesSizePlot(PBMC2, splitPattern = \"-\", numCol = 2))\n\n\n\n\n\n\n\n\nSave the filtered dataset\n\nif (!dir.exists(dir10X)) {\n  write10xCounts(dir10X, getRawData(PBMC2))\n}\n\n\nsaveRDS(PBMC2, file = paste0(outDir, sampleCond, \".cotan.RDS\"))\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] DropletUtils_1.20.0         SingleCellExperiment_1.22.0\n [3] SummarizedExperiment_1.30.2 Biobase_2.60.0             \n [5] GenomicRanges_1.52.0        GenomeInfoDb_1.36.1        \n [7] IRanges_2.34.1              S4Vectors_0.38.1           \n [9] BiocGenerics_0.46.0         MatrixGenerics_1.12.3      \n[11] matrixStats_1.2.0           zeallot_0.1.0              \n[13] ggplot2_3.4.2               tibble_3.2.1               \n[15] Seurat_5.0.0                SeuratObject_5.0.0         \n[17] sp_2.1-1                    COTAN_2.3.0                \n[19] dplyr_1.1.2                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               bitops_1.0-7             \n  [5] R.oo_1.25.0               polyclip_1.10-4          \n  [7] fastDummies_1.7.3         lifecycle_1.0.3          \n  [9] edgeR_3.42.4              doParallel_1.0.17        \n [11] globals_0.16.2            lattice_0.22-5           \n [13] MASS_7.3-60               dendextend_1.17.1        \n [15] magrittr_2.0.3            limma_3.56.2             \n [17] plotly_4.10.2             rmarkdown_2.24           \n [19] yaml_2.3.7                httpuv_1.6.11            \n [21] sctransform_0.4.1         spam_2.10-0              \n [23] askpass_1.2.0             spatstat.sparse_3.0-2    \n [25] reticulate_1.34.0         cowplot_1.1.1            \n [27] pbapply_1.7-2             RColorBrewer_1.1-3       \n [29] zlibbioc_1.46.0           abind_1.4-5              \n [31] Rtsne_0.16                R.utils_2.12.2           \n [33] purrr_1.0.1               RCurl_1.98-1.12          \n [35] circlize_0.4.15           GenomeInfoDbData_1.2.10  \n [37] ggrepel_0.9.3             irlba_2.3.5.1            \n [39] listenv_0.9.0             spatstat.utils_3.0-3     \n [41] umap_0.2.10.0             goftest_1.2-3            \n [43] RSpectra_0.16-1           spatstat.random_3.2-1    \n [45] dqrng_0.3.0               fitdistrplus_1.1-11      \n [47] parallelly_1.36.0         DelayedMatrixStats_1.22.5\n [49] leiden_0.4.3              codetools_0.2-19         \n [51] DelayedArray_0.26.7       scuttle_1.10.2           \n [53] tidyselect_1.2.0          shape_1.4.6              \n [55] farver_2.1.1              ScaledMatrix_1.8.1       \n [57] viridis_0.6.4             spatstat.explore_3.2-1   \n [59] jsonlite_1.8.7            GetoptLong_1.0.5         \n [61] ellipsis_0.3.2            progressr_0.14.0         \n [63] ggridges_0.5.4            survival_3.5-7           \n [65] iterators_1.0.14          foreach_1.5.2            \n [67] tools_4.3.2               ica_1.0-3                \n [69] Rcpp_1.0.11               glue_1.6.2               \n [71] gridExtra_2.3             xfun_0.39                \n [73] ggthemes_5.0.0            HDF5Array_1.28.1         \n [75] withr_2.5.0               fastmap_1.1.1            \n [77] rhdf5filters_1.12.1       fansi_1.0.4              \n [79] openssl_2.1.0             digest_0.6.33            \n [81] rsvd_1.0.5                parallelDist_0.2.6       \n [83] R6_2.5.1                  mime_0.12                \n [85] colorspace_2.1-0          scattermore_1.2          \n [87] tensor_1.5                spatstat.data_3.0-1      \n [89] R.methodsS3_1.8.2         utf8_1.2.3               \n [91] tidyr_1.3.0               generics_0.1.3           \n [93] data.table_1.14.8         httr_1.4.6               \n [95] htmlwidgets_1.6.2         S4Arrays_1.2.0           \n [97] uwot_0.1.16               pkgconfig_2.0.3          \n [99] gtable_0.3.3              ComplexHeatmap_2.16.0    \n[101] lmtest_0.9-40             XVector_0.40.0           \n[103] htmltools_0.5.7           dotCall64_1.1-0          \n[105] clue_0.3-64               scales_1.3.0             \n[107] png_0.1-8                 knitr_1.43               \n[109] rstudioapi_0.15.0         reshape2_1.4.4           \n[111] rjson_0.2.21              nlme_3.1-163             \n[113] rhdf5_2.44.0              zoo_1.8-12               \n[115] GlobalOptions_0.1.2       stringr_1.5.0            \n[117] KernSmooth_2.23-22        parallel_4.3.2           \n[119] miniUI_0.1.1.1            RcppZiggurat_0.1.6       \n[121] pillar_1.9.0              grid_4.3.2               \n[123] vctrs_0.6.3               RANN_2.6.1               \n[125] promises_1.2.0.1          BiocSingular_1.16.0      \n[127] beachmat_2.16.0           xtable_1.8-4             \n[129] cluster_2.1.6             evaluate_0.21            \n[131] locfit_1.5-9.8            cli_3.6.1                \n[133] compiler_4.3.2            rlang_1.1.1              \n[135] crayon_1.5.2              future.apply_1.11.0      \n[137] labeling_0.4.2            plyr_1.8.8               \n[139] stringi_1.8.1             viridisLite_0.4.2        \n[141] deldir_2.0-2              BiocParallel_1.34.2      \n[143] assertthat_0.2.1          munsell_0.5.0            \n[145] lazyeval_0.2.2            spatstat.geom_3.2-4      \n[147] PCAtools_2.14.0           Matrix_1.6-3             \n[149] RcppHNSW_0.5.0            patchwork_1.1.2          \n[151] sparseMatrixStats_1.12.2  future_1.33.0            \n[153] Rhdf5lib_1.22.0           shiny_1.8.0              \n[155] ROCR_1.0-11               Rfast_2.1.0              \n[157] igraph_1.6.0              RcppParallel_5.1.7",
    "crumbs": [
      "Datasets",
      "PBMC form 10X site",
      "Cleaning PBMC2"
    ]
  },
  {
    "objectID": "PBMC4_filtering.html",
    "href": "PBMC4_filtering.html",
    "title": "Filtering of PBMC4 using COTAN",
    "section": "",
    "text": "Library import\n\nlibrary(dplyr)\nlibrary(COTAN)\nlibrary(Seurat)\nlibrary(tibble)\nlibrary(ggplot2)\nlibrary(zeallot)\nlibrary(DropletUtils)\n\nSettings\n\ndatasetName = 'PBMC4'\ndatasetFolder = './Data/'\n\ninDir  = paste(datasetFolder, datasetName, '/raw/10X/', sep='')\noutDir = paste(datasetFolder, datasetName, '/filtered/', sep='')\ndir10X = paste(outDir, '10X/', sep='')\n\nif (!dir.exists(outDir)) {\n  dir.create(outDir, recursive = TRUE, showWarnings = FALSE)\n}\n\nsetLoggingLevel(2)\nsetLoggingFile(paste(outDir, \"logfile.log\", sep=\"\"))\noptions(parallelly.fork.enable = TRUE)\n\nData loading\n\ndataset = Read10X(data.dir = inDir, strip.suffix = TRUE)\ndataset = dataset[[1]]\nsampleCond &lt;- datasetName\nPBMC4 &lt;- COTAN(raw = dataset)\nPBMC4 &lt;- initializeMetaDataset(\n  PBMC4,\n  GEO = paste(\"10X \", datasetName, sep=\"\"),\n  sequencingMethod = \"10X\",\n  sampleCond = sampleCond\n)\n\nInspect cells’ sizes\n\ncellSizePlot(PBMC4)\n\n\n\n\n\n\n\n\nDrop cells with too many reads as they are probably doublets\n\ncellsSizeThr &lt;- 20000\nPBMC4 &lt;- addElementToMetaDataset(PBMC4, \"Cells size threshold\", cellsSizeThr)\n\ncellsToRem &lt;- getCells(PBMC4)[getCellsSize(PBMC4) &gt; cellsSizeThr]\nPBMC4 &lt;- dropGenesCells(PBMC4, cells = cellsToRem)\n\ncellSizePlot(PBMC4, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nInspect the number of expressed genes per cell\n\ngenesSizePlot(PBMC4, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nDrop cells with too high genes expression as they are probably doublets\n\ngeneSizeThr &lt;- 3500\nPBMC4 &lt;- addElementToMetaDataset(PBMC4, \"Num genes threshold\", geneSizeThr)\n\nnumExprGenes &lt;- getNumExpressedGenes(PBMC4)\ncellsToRem &lt;- names(numExprGenes)[numExprGenes &gt; geneSizeThr]\nPBMC4 &lt;- dropGenesCells(PBMC4, cells = cellsToRem)\n\ngenesSizePlot(PBMC4, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nCheck number of mithocondrial genes expressed in each cell\n\nmitGenesPattern &lt;- \"^[Mm][Tt]-\"\ngetGenes(PBMC4)[grep(mitGenesPattern, getGenes(PBMC4))]\n\n [1] \"MT-ND1\"  \"MT-ND2\"  \"MT-CO1\"  \"MT-CO2\"  \"MT-ATP8\" \"MT-ATP6\" \"MT-CO3\" \n [8] \"MT-ND3\"  \"MT-ND4L\" \"MT-ND4\"  \"MT-ND5\"  \"MT-ND6\"  \"MT-CYB\" \n\n\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(PBMC4, genePrefix = mitGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nWe drop cells with a too high percentage of mitocondrial genes (are likely dead)\n\nmitPercThr &lt;- 10\nPBMC4 &lt;- addElementToMetaDataset(PBMC4, \"Mitoc. perc. threshold\", mitPercThr)\n\ncellsToRem &lt;- rownames(mitSizes)[mitSizes[[\"mit.percentage\"]] &gt; mitPercThr]\n\nPBMC4 &lt;- dropGenesCells(PBMC4, cells = cellsToRem)\n\nc(mitPlot, mitSizes) %&lt;-%\n  mitochondrialPercentagePlot(PBMC4, genePrefix = mitGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(mitPlot)\n\n\n\n\n\n\n\n\nCheck number of ribosomial genes expressed in each cell\n\nribGenesPattern &lt;- \"^RP[SL]\\\\d+\"\ngetGenes(PBMC4)[grep(ribGenesPattern, getGenes(PBMC4))]\n\n  [1] \"RPL22\"          \"RPL11\"          \"RPS6KA1\"        \"RPS8\"          \n  [5] \"RPL5\"           \"RPS27\"          \"RPS6KC1\"        \"RPS7\"          \n  [9] \"RPS27A\"         \"RPL31\"          \"RPL37A\"         \"RPL32\"         \n [13] \"RPL15\"          \"RPL14\"          \"RPL29\"          \"RPL24\"         \n [17] \"RPL22L1\"        \"RPL39L\"         \"RPL35A\"         \"RPL9\"          \n [21] \"RPL34-AS1\"      \"RPL34\"          \"RPS3A\"          \"RPL37\"         \n [25] \"RPS23\"          \"RPS14\"          \"RPL26L1\"        \"RPS18\"         \n [29] \"RPS10-NUDT3\"    \"RPS10\"          \"RPL10A\"         \"RPL7L1\"        \n [33] \"RPS12\"          \"RPS6KA2\"        \"RPS6KA2-AS1\"    \"RPS6KA3\"       \n [37] \"RPS4X\"          \"RPS6KA6\"        \"RPL36A\"         \"RPL36A-HNRNPH2\"\n [41] \"RPL39\"          \"RPL10\"          \"RPS20\"          \"RPL7\"          \n [45] \"RPL30\"          \"RPL8\"           \"RPS6\"           \"RPL35\"         \n [49] \"RPL12\"          \"RPL7A\"          \"RPL27A\"         \"RPS13\"         \n [53] \"RPS6KA4\"        \"RPS6KB2\"        \"RPS6KB2-AS1\"    \"RPS3\"          \n [57] \"RPS25\"          \"RPS24\"          \"RPS26\"          \"RPL41\"         \n [61] \"RPL6\"           \"RPL21\"          \"RPL10L\"         \"RPS29\"         \n [65] \"RPL36AL\"        \"RPS6KL1\"        \"RPS6KA5\"        \"RPS27L\"        \n [69] \"RPL4\"           \"RPS17\"          \"RPL3L\"          \"RPS2\"          \n [73] \"RPS15A\"         \"RPL13\"          \"RPL26\"          \"RPL23A\"        \n [77] \"RPL23\"          \"RPL19\"          \"RPL27\"          \"RPS6KB1\"       \n [81] \"RPL38\"          \"RPL17-C18orf32\" \"RPL17\"          \"RPS21\"         \n [85] \"RPS15\"          \"RPL36\"          \"RPS28\"          \"RPL18A\"        \n [89] \"RPS16\"          \"RPS19\"          \"RPL18\"          \"RPL13A\"        \n [93] \"RPS11\"          \"RPS9\"           \"RPL28\"          \"RPS5\"          \n [97] \"RPS4Y1\"         \"RPS4Y2\"         \"RPL3\"           \"RPS19BP1\"      \n\n\n\nc(ribPlot, ribSizes) %&lt;-%\n  mitochondrialPercentagePlot(PBMC4, genePrefix = ribGenesPattern,\n                              splitPattern = \"-\", numCol = 2)\n\nplot(ribPlot)\n\n\n\n\n\n\n\n\nCheck no further outliers after all the culling\n\ncellSizePlot(PBMC4, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\n\ngenesSizePlot(PBMC4, splitPattern = \"-\", numCol = 2)\n\n\n\n\n\n\n\n\nCleaning, round 1\n\nPBMC4 &lt;- clean(PBMC4)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(PBMC4)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\n\n\nPBMC4 &lt;- addElementToMetaDataset(PBMC4, \"Num drop B group\", 0)\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\n\n\nplot(zoomedNuPlot)  \n\n\n\n\n\n\n\n\n\nyset=0.16\nnuDf &lt;- data.frame(\"nu\" = sort(getNu(PBMC4)), \"n\" = seq_along(getNu(PBMC4)))\nPBMC4 &lt;- addElementToMetaDataset(PBMC4, \"Threshold low UDE cells:\", yset)\ncellsToRem &lt;-rownames(nuDf)[nuDf[[\"nu\"]] &lt; yset]\nPBMC4 &lt;- dropGenesCells(PBMC4, cells = cellsToRem)\n\nCleaning, round 2\n\nPBMC4 &lt;- clean(PBMC4)\n\nc(pcaCellsPlot, pcaCellsData, genesPlot, UDEPlot, nuPlot, zoomedNuPlot) %&lt;-% cleanPlots(PBMC4)\n\nplot(pcaCellsPlot)\n\n\n\n\n\n\n\n\n\nplot(pcaCellsData)\n\n\n\n\n\n\n\n\n\nplot(genesPlot)\n\n\n\n\n\n\n\n\n\nplot(UDEPlot)\n\n\n\n\n\n\n\n\n\nplot(nuPlot)\n\n\n\n\n\n\n\n\n\nplot(zoomedNuPlot)\n\n\n\n\n\n\n\n\n\nplot(cellSizePlot(PBMC4, splitPattern = \"-\", numCol = 2))\n\n\n\n\n\n\n\n\n\nplot(genesSizePlot(PBMC4, splitPattern = \"-\", numCol = 2))\n\n\n\n\n\n\n\n\nSave the filtered dataset\n\nif (!dir.exists(dir10X)) {\n  write10xCounts(dir10X, getRawData(PBMC4))\n}\n\n\nsaveRDS(PBMC4, file = paste0(outDir, sampleCond, \".cotan.RDS\"))\n\n\nsessionInfo()\n\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] DropletUtils_1.20.0         SingleCellExperiment_1.22.0\n [3] SummarizedExperiment_1.30.2 Biobase_2.60.0             \n [5] GenomicRanges_1.52.0        GenomeInfoDb_1.36.1        \n [7] IRanges_2.34.1              S4Vectors_0.38.1           \n [9] BiocGenerics_0.46.0         MatrixGenerics_1.12.3      \n[11] matrixStats_1.2.0           zeallot_0.1.0              \n[13] ggplot2_3.4.2               tibble_3.2.1               \n[15] Seurat_5.0.0                SeuratObject_5.0.0         \n[17] sp_2.1-1                    COTAN_2.3.0                \n[19] dplyr_1.1.2                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.21          splines_4.3.2            \n  [3] later_1.3.1               bitops_1.0-7             \n  [5] R.oo_1.25.0               polyclip_1.10-4          \n  [7] fastDummies_1.7.3         lifecycle_1.0.3          \n  [9] edgeR_3.42.4              doParallel_1.0.17        \n [11] globals_0.16.2            lattice_0.22-5           \n [13] MASS_7.3-60               dendextend_1.17.1        \n [15] magrittr_2.0.3            limma_3.56.2             \n [17] plotly_4.10.2             rmarkdown_2.24           \n [19] yaml_2.3.7                httpuv_1.6.11            \n [21] sctransform_0.4.1         spam_2.10-0              \n [23] askpass_1.2.0             spatstat.sparse_3.0-2    \n [25] reticulate_1.34.0         cowplot_1.1.1            \n [27] pbapply_1.7-2             RColorBrewer_1.1-3       \n [29] zlibbioc_1.46.0           abind_1.4-5              \n [31] Rtsne_0.16                R.utils_2.12.2           \n [33] purrr_1.0.1               RCurl_1.98-1.12          \n [35] circlize_0.4.15           GenomeInfoDbData_1.2.10  \n [37] ggrepel_0.9.3             irlba_2.3.5.1            \n [39] listenv_0.9.0             spatstat.utils_3.0-3     \n [41] umap_0.2.10.0             goftest_1.2-3            \n [43] RSpectra_0.16-1           spatstat.random_3.2-1    \n [45] dqrng_0.3.0               fitdistrplus_1.1-11      \n [47] parallelly_1.36.0         DelayedMatrixStats_1.22.5\n [49] leiden_0.4.3              codetools_0.2-19         \n [51] DelayedArray_0.26.7       scuttle_1.10.2           \n [53] tidyselect_1.2.0          shape_1.4.6              \n [55] farver_2.1.1              ScaledMatrix_1.8.1       \n [57] viridis_0.6.4             spatstat.explore_3.2-1   \n [59] jsonlite_1.8.7            GetoptLong_1.0.5         \n [61] ellipsis_0.3.2            progressr_0.14.0         \n [63] ggridges_0.5.4            survival_3.5-7           \n [65] iterators_1.0.14          foreach_1.5.2            \n [67] tools_4.3.2               ica_1.0-3                \n [69] Rcpp_1.0.11               glue_1.6.2               \n [71] gridExtra_2.3             xfun_0.39                \n [73] ggthemes_5.0.0            HDF5Array_1.28.1         \n [75] withr_2.5.0               fastmap_1.1.1            \n [77] rhdf5filters_1.12.1       fansi_1.0.4              \n [79] openssl_2.1.0             digest_0.6.33            \n [81] rsvd_1.0.5                parallelDist_0.2.6       \n [83] R6_2.5.1                  mime_0.12                \n [85] colorspace_2.1-0          scattermore_1.2          \n [87] tensor_1.5                spatstat.data_3.0-1      \n [89] R.methodsS3_1.8.2         utf8_1.2.3               \n [91] tidyr_1.3.0               generics_0.1.3           \n [93] data.table_1.14.8         httr_1.4.6               \n [95] htmlwidgets_1.6.2         S4Arrays_1.2.0           \n [97] uwot_0.1.16               pkgconfig_2.0.3          \n [99] gtable_0.3.3              ComplexHeatmap_2.16.0    \n[101] lmtest_0.9-40             XVector_0.40.0           \n[103] htmltools_0.5.7           dotCall64_1.1-0          \n[105] clue_0.3-64               scales_1.3.0             \n[107] png_0.1-8                 knitr_1.43               \n[109] rstudioapi_0.15.0         reshape2_1.4.4           \n[111] rjson_0.2.21              nlme_3.1-163             \n[113] rhdf5_2.44.0              zoo_1.8-12               \n[115] GlobalOptions_0.1.2       stringr_1.5.0            \n[117] KernSmooth_2.23-22        parallel_4.3.2           \n[119] miniUI_0.1.1.1            RcppZiggurat_0.1.6       \n[121] pillar_1.9.0              grid_4.3.2               \n[123] vctrs_0.6.3               RANN_2.6.1               \n[125] promises_1.2.0.1          BiocSingular_1.16.0      \n[127] beachmat_2.16.0           xtable_1.8-4             \n[129] cluster_2.1.6             evaluate_0.21            \n[131] locfit_1.5-9.8            cli_3.6.1                \n[133] compiler_4.3.2            rlang_1.1.1              \n[135] crayon_1.5.2              future.apply_1.11.0      \n[137] labeling_0.4.2            plyr_1.8.8               \n[139] stringi_1.8.1             viridisLite_0.4.2        \n[141] deldir_2.0-2              BiocParallel_1.34.2      \n[143] assertthat_0.2.1          munsell_0.5.0            \n[145] lazyeval_0.2.2            spatstat.geom_3.2-4      \n[147] PCAtools_2.14.0           Matrix_1.6-3             \n[149] RcppHNSW_0.5.0            patchwork_1.1.2          \n[151] sparseMatrixStats_1.12.2  future_1.33.0            \n[153] Rhdf5lib_1.22.0           shiny_1.8.0              \n[155] ROCR_1.0-11               Rfast_2.1.0              \n[157] igraph_1.6.0              RcppParallel_5.1.7",
    "crumbs": [
      "Datasets",
      "PBMC form 10X site",
      "Cleaning PBMC4"
    ]
  },
  {
    "objectID": "FindUniformOrigCluster.html",
    "href": "FindUniformOrigCluster.html",
    "title": "Find uniform given cluster in Forebrain Dorsal E15.0",
    "section": "",
    "text": "library(ggplot2)\nlibrary(tibble)\nlibrary(zeallot)\nlibrary(COTAN)\n\noptions(parallelly.fork.enable = TRUE)\n\noutDir &lt;- \"./e15.0_FD_CheckClustersUniformity\"\n\nsetLoggingLevel(1)\nsetLoggingFile(file.path(outDir, \"FindUniformGivenClustersInForebrainDorsal_E150.log\"))\n\nRelevant genes lists\n\ngenesList &lt;- list(\n  \"NPGs\"   = c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"   = c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"     = c(\"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\",\n               \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n               \"Tars\", \"Amacr\"),\n  \"layers\" = c(\"Reln\", \"Lhx5\", \"Cux1\", \"Satb2\", \"Tle1\", \"Mef2c\", \"Rorb\",\n               \"Sox5\", \"Bcl11b\", \"Fezf2\", \"Foxp2\")\n)\n\nThis is a version of the function checkClusterUniformity() adapted to be used in this markdown document\n\nclusterIsUniform &lt;- function(objCOTAN, cluster, cells, GDIThreshold = 1.4) {\n\n  cores &lt;- 14L\n  \n  cellsToDrop &lt;- getCells(objCOTAN)[!getCells(objCOTAN) %in% cells]\n\n  objCOTAN &lt;- dropGenesCells(objCOTAN, cells = cellsToDrop)\n\n  objCOTAN &lt;- proceedToCoex(objCOTAN, cores = cores, saveObj = FALSE)\n  gc()\n\n  GDIData &lt;- calculateGDI(objCOTAN)\n\n  gdi &lt;- GDIData[[\"GDI\"]]\n  names(gdi) &lt;- rownames(GDIData)\n  gdi &lt;- sort(gdi, decreasing = TRUE)\n  \n  # Plot GDI\n  genesToRemark = list(\"Top 10 GDI genes\" = names(gdi)[1L:5L])\n  genesToRemark &lt;- append(genesToRemark, genesList)\n  plot &lt;- GDIPlot(objCOTAN, GDIIn = GDIData,\n                  GDIThreshold = GDIThreshold,\n                  genes = genesToRemark,\n                  condition = paste0(\"e15.0 cluster \", cluster))\n\n  rm(objCOTAN)\n  rm(GDIData)\n  gc()\n\n  # A cluster is deemed uniform if the number of genes\n  # with [GDI &gt; GDIThreshold] is not more than 1%\n  \n  highGDIRatio &lt;- sum(gdi &gt;= GDIThreshold) / length(gdi)\n  \n  lastPercentile &lt;- quantile(gdi, probs = 0.99)\n  \n  isUniform &lt;- highGDIRatio &lt;= 0.01\n\n  plot(plot)\n  \n  print(paste0(\"The cluster '\", cluster, \"' is \",\n               (if(isUniform) {\"\"} else {\"not \"}), \"uniform\"))\n  print(paste0(\"The percentage of genes with GDI above \", GDIThreshold, \" is: \",\n               round(highGDIRatio * 100.0, digits = 2), \"%\"))\n  print(paste0(\"The last percentile (99%) of the GDI values is: \",\n               round(lastPercentile, digits = 4)))\n  \n  return(list(\"isUniform\" = isUniform, \"highGDIRatio\" = highGDIRatio,\n              \"lastPercentile\" = lastPercentile, \"GDIPlot\" = plot))\n}\n\n\nfb150ObjRaw &lt;- readRDS(file = file.path(\"Data/MouseCortexFromLoom/SourceData/\", \"e15.0_ForebrainDorsal.cotan.RDS\"))\n\nfb150Obj &lt;- readRDS(file = file.path(\"Data/MouseCortexFromLoom/\", \"e15.0_ForebrainDorsal.cotan.RDS\"))\n\nAlign to cleaned cells’ list\n\nmetaC &lt;- getMetadataCells(fb150ObjRaw)[getCells(fb150Obj), ]\n\nmetaCDrop &lt;- getMetadataCells(fb150ObjRaw)[!getCells(fb150ObjRaw) %in% getCells(fb150Obj), ]\n\nExtract the cells of class ‘Neuron’\n\nmetaNeuron &lt;- metaC[metaC[[\"Class\"]] == \"Neuron\", ]\n\nsort(table(metaNeuron[[\"Subclass\"]]), decreasing = TRUE)\n\n\nCortical or hippocampal glutamatergic                   Forebrain GABAergic \n                                 3969                                   610 \n                        Cajal-Retzius                Mixed region GABAergic \n                                  145                                    21 \n                            Undefined               Forebrain glutamatergic \n                                   16                                    15 \n                         Hypothalamus            Mixed region glutamatergic \n                                    8                                     5 \n    Mixed region and neurotransmitter               Hindbrain glutamatergic \n                                    4                                     2 \n                Hindbrain glycinergic            Hypothalamus glutamatergic \n                                    2                                     2 \n        Dorsal midbrain glutamatergic                          Mixed region \n                                    1                                     1 \n\nsort(table(metaNeuron[[\"ClusterName\"]]), decreasing = TRUE)\n\n\nNeur525 Neur511 Neur509 Neur510 Neur508 Neur507 Neur568 Neur504 Neur505 Neur516 \n    826     540     402     402     397     183     181     174     147     137 \nNeur565 Neur524 Neur679 Neur493 Neur498 Neur497 Neur506 Neur502 Neur494 Neur574 \n    133     108     105      93      79      51      46      42      41      41 \nNeur575 Neur492 Neur519 Neur526 Neur566 Neur501 Neur573 Neur499 Neur518 Neur560 \n     41      38      31      28      28      24      24      23      22      20 \nNeur514 Neur523 Neur569 Neur557 Neur495 Neur520 Neur535 Neur542 Neur677 Neur527 \n     19      19      18      16      15      15      14      14      14      13 \nNeur496 Neur512 Neur676 Neur517 Neur558 Neur503 Neur739 Neur559 Neur564 Neur538 \n     11      11      11      10       9       8       8       7       7       6 \nNeur549 Neur561 Neur671 Neur695 Neur738 Neur747 Neur500 Neur536 Neur678 Neur534 \n      6       6       6       6       6       6       5       5       5       4 \nNeur550 Neur570 Neur686 Neur731 Neur737 Neur513 Neur515 Neur528 Neur533 Neur539 \n      4       4       4       4       4       3       3       3       3       3 \nNeur544 Neur571 Neur674 Neur675 Neur732 Neur531 Neur543 Neur548 Neur552 Neur554 \n      3       3       3       3       3       2       2       2       2       2 \nNeur562 Neur670 Neur689 Neur740 Neur529 Neur530 Neur532 Neur537 Neur540 Neur553 \n      2       2       2       2       1       1       1       1       1       1 \nNeur567 Neur572 Neur601 Neur614 Neur634 Neur647 Neur649 Neur672 Neur680 Neur681 \n      1       1       1       1       1       1       1       1       1       1 \nNeur684 Neur693 Neur696 Neur726 Neur734 Neur749 Neur750 Neur751 Neur760 Neur771 \n      1       1       1       1       1       1       1       1       1       1 \n\n\nCheck uniformity of sub-class: Cajal-Retzius\n\nFB_CaRe_Cells &lt;-\n  rownames(metaNeuron)[metaNeuron[[\"Subclass\"]] == \"Cajal-Retzius\"]\n\ntable(metaNeuron[FB_CaRe_Cells, \"ClusterName\"])\n\n\nNeur674 Neur675 Neur676 Neur677 Neur678 Neur679 Neur686 \n      3       3      11      14       5     105       4 \n\nc(FB_CaRe_IsUniform, FB_CaRe_HighGDIRatio,\n  FB_CaRe_LastPercentile, FB_CaRe_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Cajal-Retzius\",\n                   cells = FB_CaRe_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Cajal-Retzius' is uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 0.82%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.3896\"\n\n\nCheck uniformity of sub-class: Forebrain GABAergic\n\nFB_GABA_Cells &lt;-\n  rownames(metaNeuron)[metaNeuron[[\"Subclass\"]] == \"Forebrain GABAergic\"]\n\ntable(metaNeuron[FB_GABA_Cells, \"ClusterName\"])\n\n\nNeur529 Neur530 Neur531 Neur532 Neur533 Neur534 Neur535 Neur536 Neur537 Neur538 \n      1       1       2       1       3       4      14       5       1       6 \nNeur539 Neur540 Neur542 Neur543 Neur544 Neur548 Neur549 Neur550 Neur552 Neur553 \n      3       1      14       2       3       2       6       4       2       1 \nNeur554 Neur558 Neur559 Neur560 Neur561 Neur562 Neur564 Neur565 Neur566 Neur567 \n      2       9       7      20       6       2       7     133      28       1 \nNeur568 Neur569 Neur570 Neur571 Neur572 Neur573 Neur574 Neur575 Neur747 \n    181      18       4       3       1      24      41      41       6 \n\nc(FB_GABA_isUniform, FB_GABA_HighGDIRatio,\n  FB_GABA_LastPercentile, FB_GABA_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Forebrain_GABAergic\",\n                   cells = FB_GABA_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Forebrain_GABAergic' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 12.68%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.6987\"\n\n\nCheck uniformity of sub-class: Cortical or hippocampal glutamatergic\n\nFB_CHGl_Cells &lt;-\n  rownames(metaNeuron)[metaNeuron[[\"Subclass\"]] == \"Cortical or hippocampal glutamatergic\"]\n\ntable(metaNeuron[FB_CHGl_Cells, \"ClusterName\"])\n\n\nNeur492 Neur493 Neur494 Neur495 Neur496 Neur497 Neur498 Neur499 Neur500 Neur501 \n     38      93      41      15      11      51      79      23       5      24 \nNeur502 Neur503 Neur504 Neur505 Neur506 Neur507 Neur508 Neur509 Neur510 Neur511 \n     42       8     174     147      46     183     397     402     402     540 \nNeur512 Neur513 Neur514 Neur515 Neur516 Neur517 Neur518 Neur519 Neur520 Neur523 \n     11       3      19       3     137      10      22      31      15      19 \nNeur524 Neur525 Neur526 Neur527 Neur528 \n    108     826      28      13       3 \n\nc(FB_CHGl_IsUniform, FB_CHGl_HighGDIRatio,\n  FB_CHGl_LastPercentile, FB_CHGl_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Cortical or hippocampal glutamatergic\",\n                   cells = FB_CHGl_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Cortical or hippocampal glutamatergic' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 61.17%\"\n[1] \"The last percentile (99%) of the GDI values is: 3.0064\"\n\n\nCheck uniformity of Cajal-Retzius cluster: Neur679\n\nFB_Neur679_Cells &lt;-\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur679\"]\n\nc(FB_Neur679_IsUniform, FB_Neur679_HighGDIRatio,\n  FB_Neur679_LastPercentile, FB_Neur679_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur679\",\n                   cells = FB_Neur679_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur679' is uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 0.24%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.3392\"\n\n\nCheck uniformity of Forebrain GABAergic cluster: Neur568\n\nFB_Neur568_Cells &lt;-\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur568\"]\n\nc(FB_Neur568_IsUniform, FB_Neur568_HighGDIRatio,\n  FB_Neur568_LastPercentile, FB_Neur568_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur568\",\n                   cells = FB_Neur568_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur568' is uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 0%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.3058\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur525\n\nFB_Neur525_Cells &lt;-\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur525\"]\n\nc(FB_Neur525_IsUniform, FB_Neur525_HighGDIRatio,\n  FB_Neur525_LastPercentile, FB_Neur525_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur525\",\n                   cells = FB_Neur525_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur525' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 30.16%\"\n[1] \"The last percentile (99%) of the GDI values is: 2.3522\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur508\n\nFB_Neur508_Cells &lt;-\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur508\"]\n\nc(FB_Neur508_IsUniform, FB_Neur508_HighGDIRatio,\n  FB_Neur508_LastPercentile, FB_Neur508_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur508\",\n                   cells = FB_Neur508_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur508' is uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 0.46%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.3701\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur509\n\nFB_Neur509_Cells &lt;-\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur509\"]\n\nc(FB_Neur509_IsUniform, FB_Neur509_HighGDIRatio,\n  FB_Neur509_LastPercentile, FB_Neur509_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur509\",\n                   cells = FB_Neur509_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur509' is uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 0.67%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.3811\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur507\n\nFB_Neur507_Cells &lt;-\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur507\"]\n\nc(FB_Neur507_IsUniform, FB_Neur507_HighGDIRatio,\n  FB_Neur507_LastPercentile, FB_Neur507_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur507\",\n                   cells = FB_Neur507_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur507' is uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 0.94%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.3939\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur508 and Neur509\n\nFB_Neur508.Neur509_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur508\"],\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur509\"]\n)\n\nc(FB_Neur508.Neur509_IsUniform, FB_Neur508.Neur509_HighGDIRatio,\n  FB_Neur508.Neur509_LastPercentile, FB_Neur508.Neur509_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur508.Neur509\",\n                   cells = FB_Neur508.Neur509_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur508.Neur509' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 2.63%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.4529\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur508 and Neur507\n\nFB_Neur508.Neur507_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur508\"],\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur507\"]\n)\n\nc(FB_Neur508.Neur507_IsUniform, FB_Neur508.Neur507_HighGDIRatio,\n  FB_Neur508.Neur507_LastPercentile, FB_Neur508.Neur507_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur508.Neur507\",\n                   cells = FB_Neur508.Neur507_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur508.Neur507' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 3.76%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.5202\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur508 and Cajal-Retzius cluster: Neur679\n\nFB_Neur508.Neur679_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur508\"],\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur679\"]\n)\n\nc(FB_Neur508.Neur679_IsUniform, FB_Neur508.Neur679_HighGDIRatio,\n  FB_Neur508.Neur679_LastPercentile, FB_Neur508.Neur679_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur508.Neur679\",\n                   cells = FB_Neur508.Neur679_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur508.Neur679' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 15.95%\"\n[1] \"The last percentile (99%) of the GDI values is: 2.1736\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur508 and Forebrain GABAergic cluster: Neur568\n\nFB_Neur508.Neur568_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur508\"],\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur568\"]\n)\n\nc(FB_Neur508.Neur568_IsUniform, FB_Neur508.Neur568_HighGDIRatio,\n  FB_Neur508.Neur568_LastPercentile, FB_Neur508.Neur568_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur508.Neur568\",\n                   cells = FB_Neur508.Neur568_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur508.Neur568' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 21.27%\"\n[1] \"The last percentile (99%) of the GDI values is: 2.1539\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur509 and Cajal-Retzius cluster: Neur679\n\nFB_Neur509.Neur679_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur509\"],\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur679\"]\n)\n\nc(FB_Neur509.Neur679_IsUniform, FB_Neur509.Neur679_HighGDIRatio,\n  FB_Neur509.Neur679_LastPercentile, FB_Neur509.Neur679_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur509.Neur679\",\n                   cells = FB_Neur509.Neur679_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur509.Neur679' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 14.34%\"\n[1] \"The last percentile (99%) of the GDI values is: 2.1308\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur507 and Cajal-Retzius cluster: Neur679\n\nFB_Neur507.Neur679_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur507\"],\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur679\"]\n)\n\nc(FB_Neur507.Neur679_IsUniform, FB_Neur507.Neur679_HighGDIRatio,\n  FB_Neur507.Neur679_LastPercentile, FB_Neur507.Neur679_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur507.Neur679\",\n                   cells = FB_Neur507.Neur679_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur507.Neur679' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 8.6%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.8754\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur508 and 40 cells taken from Cajal-Retzius cluster: Neur679\n\nset.seed(639245)\n\nprint(paste0(\"Cluser Neur508 size: \", sum(metaNeuron[[\"ClusterName\"]] == \"Neur508\")))\n\n[1] \"Cluser Neur508 size: 397\"\n\nFB_Neur508.s40oNeur679_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur508\"],\n  sample(rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur679\"], 40)\n)\n\nc(FB_Neur508.s40oNeur679_IsUniform, FB_Neur508.s40oNeur679_HighGDIRatio,\n  FB_Neur508.s40oNeur679_LastPercentile, FB_Neur508.s40oNeur679_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur508.s40oNeur679\",\n                   cells = FB_Neur508.s40oNeur679_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur508.s40oNeur679' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 6.95%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.8052\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur508 and 20 cells taken from Cajal-Retzius cluster: Neur679\n\nset.seed(639245)\n\nprint(paste0(\"Cluser Neur508 size: \", sum(metaNeuron[[\"ClusterName\"]] == \"Neur508\")))\n\n[1] \"Cluser Neur508 size: 397\"\n\nFB_Neur508.s20oNeur679_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur508\"],\n  sample(rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur679\"], 20)\n)\n\nc(FB_Neur508.s20oNeur679_IsUniform, FB_Neur508.s20oNeur679_HighGDIRatio,\n  FB_Neur508.s20oNeur679_LastPercentile, FB_Neur508.s20oNeur679_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur508.s20oNeur679\",\n                   cells = FB_Neur508.s20oNeur679_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur508.s20oNeur679' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 4.3%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.61\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur508 and 10 cells taken from Cajal-Retzius cluster: Neur679\n\nset.seed(639245)\n\nprint(paste0(\"Cluser Neur508 size: \", sum(metaNeuron[[\"ClusterName\"]] == \"Neur508\")))\n\n[1] \"Cluser Neur508 size: 397\"\n\nFB_Neur508.s10oNeur679_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur508\"],\n  sample(rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur679\"], 10)\n)\n\nc(FB_Neur508.s10oNeur679_IsUniform, FB_Neur508.s10oNeur679_HighGDIRatio,\n  FB_Neur508.s10oNeur679_LastPercentile, FB_Neur508.s10oNeur679_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur508.s10oNeur679\",\n                   cells = FB_Neur508.s10oNeur679_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur508.s10oNeur679' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 1.92%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.4542\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur508 and 40 cells taken from all Neuron - non Cortical or hippocampal glutamatergic cells\n\nset.seed(639245)\n\nprint(paste0(\"Cluser Neur508 size: \", sum(metaNeuron[[\"ClusterName\"]] == \"Neur508\")))\n\n[1] \"Cluser Neur508 size: 397\"\n\nFB_Neur508.s40oNonCHGl_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur508\"],\n  sample(rownames(metaNeuron)[metaNeuron[[\"Subclass\"]] != \"Cortical or hippocampal glutamatergic\"], 40)\n)\n\nc(FB_Neur508.s40oNonCHGl_IsUniform, FB_Neur508.s40oNonCHGl_HighGDIRatio,\n  FB_Neur508.s40oNonCHGl_LastPercentile, FB_Neur508.s40oNonCHGl_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur508.s40oNonCHGl\",\n                   cells = FB_Neur508.s40oNonCHGl_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur508.s40oNonCHGl' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 3.05%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.514\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur508 and 20 cells taken from all Neuron - non Cortical or hippocampal glutamatergic cells\n\nset.seed(639245)\n\nprint(paste0(\"Cluser Neur508 size: \", sum(metaNeuron[[\"ClusterName\"]] == \"Neur508\")))\n\n[1] \"Cluser Neur508 size: 397\"\n\nFB_Neur508.s20oNonCHGl_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur508\"],\n  sample(rownames(metaNeuron)[metaNeuron[[\"Subclass\"]] != \"Cortical or hippocampal glutamatergic\"], 20)\n)\n\nc(FB_Neur508.s20oNonCHGl_IsUniform, FB_Neur508.s20oNonCHGl_HighGDIRatio,\n  FB_Neur508.s20oNonCHGl_LastPercentile, FB_Neur508.s20oNonCHGl_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur508.s20oNonCHGl\",\n                   cells = FB_Neur508.s20oNonCHGl_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur508.s20oNonCHGl' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 1.15%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.4091\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur508 and 10 cells taken from all Neuron - non Cortical or hippocampal glutamatergic cells\n\nset.seed(639245)\n\nprint(paste0(\"Cluser Neur508 size: \", sum(metaNeuron[[\"ClusterName\"]] == \"Neur508\")))\n\n[1] \"Cluser Neur508 size: 397\"\n\nFB_Neur508.s10oNonCHGl_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur508\"],\n  sample(rownames(metaNeuron)[metaNeuron[[\"Subclass\"]] != \"Cortical or hippocampal glutamatergic\"], 10)\n)\n\nc(FB_Neur508.s10oNonCHGl_IsUniform, FB_Neur508.s10oNonCHGl_HighGDIRatio,\n  FB_Neur508.s10oNonCHGl_LastPercentile, FB_Neur508.s10oNonCHGl_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur508.s10oNonCHGl\",\n                   cells = FB_Neur508.s10oNonCHGl_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur508.s10oNonCHGl' is uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 0.67%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.3853\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur509 and 40 cells taken from Forebrain GABAergic cluster: Neur568\n\nset.seed(639245)\n\nprint(paste0(\"Cluser Neur509 size: \", sum(metaNeuron[[\"ClusterName\"]] == \"Neur509\")))\n\n[1] \"Cluser Neur509 size: 402\"\n\nFB_Neur509.s40oNeur568_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur509\"],\n  sample(rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur568\"], 40)\n)\n\nc(FB_Neur509.s40oNeur568_IsUniform, FB_Neur509.s40oNeur568_HighGDIRatio,\n  FB_Neur509.s40oNeur568_LastPercentile, FB_Neur509.s40oNeur568_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur509.s40oNeur568\",\n                   cells = FB_Neur509.s40oNeur568_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur509.s40oNeur568' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 4.59%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.5904\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur509 and 20 cells taken from Forebrain GABAergic cluster: Neur568\n\nset.seed(639245)\n\nprint(paste0(\"Cluser Neur509 size: \", sum(metaNeuron[[\"ClusterName\"]] == \"Neur509\")))\n\n[1] \"Cluser Neur509 size: 402\"\n\nFB_Neur509.s20oNeur568_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur509\"],\n  sample(rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur568\"], 20)\n)\n\nc(FB_Neur509.s20oNeur568_IsUniform, FB_Neur509.s20oNeur568_HighGDIRatio,\n  FB_Neur509.s20oNeur568_LastPercentile, FB_Neur509.s20oNeur568_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur509.s20oNeur568\",\n                   cells = FB_Neur509.s20oNeur568_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur509.s20oNeur568' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 2.43%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.4661\"\n\n\nCheck uniformity of Cortical or hippocampal glutamatergic cluster: Neur509 and 10 cells taken from Forebrain GABAergic cluster: Neur568\n\nset.seed(639245)\n\nprint(paste0(\"Cluser Neur509 size: \", sum(metaNeuron[[\"ClusterName\"]] == \"Neur509\")))\n\n[1] \"Cluser Neur509 size: 402\"\n\nFB_Neur509.s10oNeur568_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur509\"],\n  sample(rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur568\"], 10)\n)\n\nc(FB_Neur509.s10oNeur568_IsUniform, FB_Neur509.s10oNeur568_HighGDIRatio,\n  FB_Neur509.s10oNeur568_LastPercentile, FB_Neur509.s10oNeur568_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur509.s10oNeur568\",\n                   cells = FB_Neur509.s10oNeur568_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur509.s10oNeur568' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 1.14%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.4103\"\n\n\nCheck uniformity of Forebrain GABAergic cluster: Neur568 and 20 cells taken from Cortical or hippocampal glutamatergic cluster: Neur507\n\nset.seed(639245)\n\nprint(paste0(\"Cluser Neur568 size: \", sum(metaNeuron[[\"ClusterName\"]] == \"Neur568\")))\n\n[1] \"Cluser Neur568 size: 181\"\n\nFB_Neur568.s20oNeur507_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur568\"],\n  sample(rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur507\"], 20)\n)\n\nc(FB_Neur568.s20oNeur507_IsUniform, FB_Neur568.s20oNeur507_HighGDIRatio,\n  FB_Neur568.s20oNeur507_LastPercentile, FB_Neur568.s20oNeur507_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur568.s20oNeur507\",\n                   cells = FB_Neur568.s20oNeur507_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur568.s20oNeur507' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 7.46%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.7445\"\n\n\nCheck uniformity of Forebrain GABAergic cluster: Neur568 and 10 cells taken from Cortical or hippocampal glutamatergic cluster: Neur507\n\nset.seed(639245)\n\nprint(paste0(\"Cluser Neur568 size: \", sum(metaNeuron[[\"ClusterName\"]] == \"Neur568\")))\n\n[1] \"Cluser Neur568 size: 181\"\n\nFB_Neur568.s10oNeur507_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur568\"],\n  sample(rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur507\"], 10)\n)\n\nc(FB_Neur568.s10oNeur507_IsUniform, FB_Neur568.s10oNeur507_HighGDIRatio,\n  FB_Neur568.s10oNeur507_LastPercentile, FB_Neur568.s10oNeur507_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur568.s10oNeur507\",\n                   cells = FB_Neur568.s10oNeur507_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur568.s10oNeur507' is not uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 1.9%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.4669\"\n\n\nCheck uniformity of Forebrain GABAergic cluster: Neur568 and 5 cells taken from Cortical or hippocampal glutamatergic cluster: Neur507\n\nset.seed(639245)\n\nprint(paste0(\"Cluser Neur568 size: \", sum(metaNeuron[[\"ClusterName\"]] == \"Neur568\")))\n\n[1] \"Cluser Neur568 size: 181\"\n\nFB_Neur568.s5oNeur507_Cells &lt;- c(\n  rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur568\"],\n  sample(rownames(metaNeuron)[metaNeuron[[\"ClusterName\"]] == \"Neur507\"], 5)\n)\n\nc(FB_Neur568.s5oNeur507_IsUniform, FB_Neur568.s5oNeur507_HighGDIRatio,\n  FB_Neur568.s5oNeur507_LastPercentile, FB_Neur568.s5oNeur507_GDIPlot) %&lt;-%\n  clusterIsUniform(fb150Obj, cluster = \"Neur568.s5oNeur507\",\n                   cells = FB_Neur568.s5oNeur507_Cells, GDIThreshold = 1.4)\n\n\n\n\n\n\n\n\n[1] \"The cluster 'Neur568.s5oNeur507' is uniform\"\n[1] \"The percentage of genes with GDI above 1.4 is: 0.48%\"\n[1] \"The last percentile (99%) of the GDI values is: 1.3517\"\n\n\n\nsessionInfo()\n\nR version 4.3.0 (2023-04-21)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Berlin\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] COTAN_2.1.5   zeallot_0.1.0 tibble_3.2.1  ggplot2_3.4.2\n\nloaded via a namespace (and not attached):\n  [1] RColorBrewer_1.1-3     rstudioapi_0.14        jsonlite_1.8.4        \n  [4] shape_1.4.6            umap_0.2.10.0          magrittr_2.0.3        \n  [7] spatstat.utils_3.0-3   farver_2.1.1           rmarkdown_2.21        \n [10] GlobalOptions_0.1.2    vctrs_0.6.1            ROCR_1.0-11           \n [13] spatstat.explore_3.2-1 askpass_1.1            htmltools_0.5.5       \n [16] sctransform_0.3.5      parallelly_1.36.0      KernSmooth_2.23-20    \n [19] htmlwidgets_1.6.2      ica_1.0-3              plyr_1.8.8            \n [22] plotly_4.10.1          zoo_1.8-12             igraph_1.4.2          \n [25] mime_0.12              lifecycle_1.0.3        iterators_1.0.14      \n [28] pkgconfig_2.0.3        Matrix_1.5-4.1         R6_2.5.1              \n [31] fastmap_1.1.1          fitdistrplus_1.1-8     future_1.32.0         \n [34] shiny_1.7.4            clue_0.3-64            digest_0.6.31         \n [37] colorspace_2.1-0       patchwork_1.1.2        S4Vectors_0.38.0      \n [40] Seurat_4.3.0           tensor_1.5             RSpectra_0.16-1       \n [43] irlba_2.3.5.1          labeling_0.4.2         progressr_0.13.0      \n [46] RcppZiggurat_0.1.6     fansi_1.0.4            spatstat.sparse_3.0-1 \n [49] httr_1.4.5             polyclip_1.10-4        abind_1.4-5           \n [52] compiler_4.3.0         withr_2.5.0            doParallel_1.0.17     \n [55] viridis_0.6.2          dendextend_1.17.1      MASS_7.3-59           \n [58] openssl_2.0.6          rjson_0.2.21           tools_4.3.0           \n [61] lmtest_0.9-40          httpuv_1.6.9           future.apply_1.11.0   \n [64] goftest_1.2-3          glue_1.6.2             nlme_3.1-162          \n [67] promises_1.2.0.1       grid_4.3.0             Rtsne_0.16            \n [70] cluster_2.1.4          reshape2_1.4.4         generics_0.1.3        \n [73] gtable_0.3.3           spatstat.data_3.0-1    tidyr_1.3.0           \n [76] data.table_1.14.8      sp_1.6-0               utf8_1.2.3            \n [79] BiocGenerics_0.46.0    spatstat.geom_3.2-1    RcppAnnoy_0.0.20      \n [82] ggrepel_0.9.3          RANN_2.6.1             foreach_1.5.2         \n [85] pillar_1.9.0           stringr_1.5.0          later_1.3.0           \n [88] circlize_0.4.15        splines_4.3.0          dplyr_1.1.2           \n [91] lattice_0.21-8         survival_3.5-5         deldir_1.0-6          \n [94] tidyselect_1.2.0       ComplexHeatmap_2.16.0  miniUI_0.1.1.1        \n [97] pbapply_1.7-0          knitr_1.42             gridExtra_2.3         \n[100] IRanges_2.34.0         scattermore_1.2        stats4_4.3.0          \n[103] xfun_0.39              factoextra_1.0.7       matrixStats_1.0.0     \n[106] stringi_1.7.12         lazyeval_0.2.2         yaml_2.3.7            \n[109] evaluate_0.20          codetools_0.2-19       cli_3.6.1             \n[112] RcppParallel_5.1.7     uwot_0.1.14            xtable_1.8-4          \n[115] reticulate_1.30        munsell_0.5.0          Rcpp_1.0.10           \n[118] globals_0.16.2         spatstat.random_3.1-4  png_0.1-8             \n[121] parallel_4.3.0         Rfast_2.0.7            ellipsis_0.3.2        \n[124] assertthat_0.2.1       parallelDist_0.2.6     listenv_0.9.0         \n[127] ggthemes_4.2.4         viridisLite_0.4.1      scales_1.2.1          \n[130] ggridges_0.5.4         SeuratObject_4.1.3     leiden_0.4.3          \n[133] purrr_1.0.1            crayon_1.5.2           GetoptLong_1.0.5      \n[136] rlang_1.1.0            cowplot_1.1.1",
    "crumbs": [
      "GDI sensitivity",
      "Cluster Unifomity and GDI score"
    ]
  },
  {
    "objectID": "NonCT_clusters.html",
    "href": "NonCT_clusters.html",
    "title": "Not Uniform Transcriptomic clusters with Logistic Regression",
    "section": "",
    "text": "library(ggplot2)\nlibrary(zeallot)\nlibrary(data.table)\nlibrary(parallelDist)\nlibrary(tidyr)\nlibrary(tidyverse)\nlibrary(caret)\ntheme_set(theme_bw())\nlibrary(COTAN)\nlibrary(stringr)\nlibrary(nnet)\n\noptions(parallelly.fork.enable = TRUE)\n\ninDir &lt;- file.path(\"Data/MouseCortexFromLoom/\")\n\n#setLoggingLevel(2)\n#setLoggingFile(file.path(inDir, \"MixingClustersGDI_ForebrainDorsal.log\"))\n\noutDir &lt;- file.path(\"Data/MouseCortexFromLoom/NotCTSingleClusters/\")\nif (!file.exists(outDir)) {\n  dir.create(outDir)\n}\n\n\nresult.df &lt;- data.frame()\n\nIn this part we want to show that if COTAN detects more division for cluster defined by other methods, this division is consitent and real. To test it we will use a simple logistic regression.",
    "crumbs": [
      "Cluster evaluation",
      "Not UT cluster with LR"
    ]
  },
  {
    "objectID": "NonCT_clusters.html#preamble",
    "href": "NonCT_clusters.html#preamble",
    "title": "Not Uniform Transcriptomic clusters with Logistic Regression",
    "section": "",
    "text": "library(ggplot2)\nlibrary(zeallot)\nlibrary(data.table)\nlibrary(parallelDist)\nlibrary(tidyr)\nlibrary(tidyverse)\nlibrary(caret)\ntheme_set(theme_bw())\nlibrary(COTAN)\nlibrary(stringr)\nlibrary(nnet)\n\noptions(parallelly.fork.enable = TRUE)\n\ninDir &lt;- file.path(\"Data/MouseCortexFromLoom/\")\n\n#setLoggingLevel(2)\n#setLoggingFile(file.path(inDir, \"MixingClustersGDI_ForebrainDorsal.log\"))\n\noutDir &lt;- file.path(\"Data/MouseCortexFromLoom/NotCTSingleClusters/\")\nif (!file.exists(outDir)) {\n  dir.create(outDir)\n}\n\n\nresult.df &lt;- data.frame()\n\nIn this part we want to show that if COTAN detects more division for cluster defined by other methods, this division is consitent and real. To test it we will use a simple logistic regression.",
    "crumbs": [
      "Cluster evaluation",
      "Not UT cluster with LR"
    ]
  },
  {
    "objectID": "NonCT_clusters.html#cluster-525-e15.0",
    "href": "NonCT_clusters.html#cluster-525-e15.0",
    "title": "Not Uniform Transcriptomic clusters with Logistic Regression",
    "section": "Cluster 525 e15.0",
    "text": "Cluster 525 e15.0\n\ne15.0 &lt;- readRDS(paste0(inDir,\"e15.0_ForebrainDorsal.cotan.RDS\")\ncells &lt;- getClusterizationData(e15.0,clName = \"CL_original.clusters\")[[1]][getClusterizationData(e15.0,clName = \"CL_original.clusters\")[[1]] == \"525\"]\n\ncells &lt;-names(cells)\n\nwrite.csv(getRawData(e15.0)[,cells],paste0(outDir,\"cl525/RawDataCL525.csv\"))\n\ncl525 &lt;-  automaticCOTANObjectCreation(raw = getRawData(e15.0)[,cells],\n                                       GEO = \"Loom\",\n                                       sequencingMethod = \"10X\",\n                                       sampleCondition = \"cl525\",\n                                       cores = 10,saveObj = T,\n                                       outDir = \"Data/MouseCortexFromLoom/NotCTSingleClusters/\",\n                                       calcCoex = T)\n\n\n\n  OriginalCluster CellNumber COTANClusterNumber Accuracy\n1      Cl525E15.0        826                  3     &lt;NA&gt;\n\n\n\ncl525GDI &lt;- calculateGDI(cl525)\n\nsubsetGDICl525 &lt;- cl525GDI[cl525GDI$sum.raw.norm &gt; 7,]\ntop.GDI.genes &lt;- rownames(subsetGDICl525[order(subsetGDICl525$GDI,decreasing = T),])[1:50]\n\nGDIPlot(cl525,genes = \"\",GDIIn = cl525GDI)\n\n\n\n\n\n\n\n\n\nlist.cl.CT &lt;- cellsUniformClustering(cl525, GDIThreshold = 1.43, cores = 10L,\n                         saveObj = TRUE, outDir = outDir)\n\ncl525 &lt;- addClusterization(cl525, clName = \"split\",\n                              clusters = list.cl.CT$clusters,\n                              coexDF = list.cl.CT$coex, override = TRUE)\n\ntable(list.cl.CT$clusters)\n\n\nc(mergedClusters, mergedCoexDF) %&lt;-%\n  mergeUniformCellsClusters(cl525, clusters = list.cl.CT$clusters,\n                            GDIThreshold = 1.43, batchSize = 4L, cores = 10L,\n                            saveObj = TRUE, outDir = outDir)\n\ncl525 &lt;- addClusterization(cl525, clName = \"merge\",\n                              clusters = mergedClusters,\n                              coexDF = mergedCoexDF,\n                              override = TRUE)\n\nsaveRDS(cl525,paste0(outDir,\"cl525.cotan.RDS\"))\n\ntable(str_split(names(mergedClusters),pattern = \"_\",simplify = T)[,1],mergedClusters)\n\nSo there isn’t a perfect separation due to the cell bar code.\n\ncl525ClsMarkers &lt;- findClustersMarkers(cl525,n = 200,adjustmentMethod = \"BH\")\n\nhead(cl525ClsMarkers)\n\n  CL   Gene        DEA      adjPVal IsMarker  logFoldCh\n1  1  Rps12 -0.4819441 1.557394e-39        0 -0.6040561\n2  1 Gm2000 -0.4778070 4.048141e-39        0 -0.6592709\n3  1  Uqcrq -0.4527215 4.377038e-35        0 -0.6017733\n4  1  Atp5e -0.4512791 5.642611e-35        0 -0.6855895\n5  1  Rpl12 -0.4431532 9.247019e-34        0 -0.5511911\n6  1  Rps25 -0.4312821 5.759166e-32        0 -0.5430405\n\n\n\ndata &lt;- getNormalizedData(cl525)\n\ndata &lt;- data[!rowSums(as.matrix(data)) &lt; 1,]\ndata &lt;- log(data*10000+1)\n\nrow_stdev &lt;- apply(data, 1, sd, na.rm=TRUE)\nrow_stdev &lt;- row_stdev[order(row_stdev,decreasing = T)]\n\ngenes.to.keep &lt;- c(names(row_stdev[1:100]),top.GDI.genes)\n\ndata.small &lt;- data[rownames(data) %in% genes.to.keep,]\n\n#data &lt;- t(as.matrix(data))\ndata.small &lt;- t(as.matrix(data.small))\n\n\nCOTAN_Cl.code &lt;- getClusterizationData(cl525)[[1]]\n#COTAN_Cl.code[COTAN_Cl.code == \"A549\"] &lt;- 0\n#COTAN_Cl.code[COTAN_Cl.code == \"CCL-185-IG\"] &lt;- 1\n\nCOTAN_Cl.code &lt;- as.numeric(COTAN_Cl.code)\n\ndata.small &lt;- cbind(data.small,COTAN_Cl.code)\ndata.small &lt;- as.data.frame(data.small)\n\n# Split the data into training and test set\nset.seed(123)\ntraining.samples &lt;- data.small[,\"COTAN_Cl.code\"] %&gt;% \n  createDataPartition(p = 0.8, list = FALSE)\ntrain.data  &lt;- data.small[training.samples, ]\ntest.data &lt;- data.small[-training.samples, ]\nhead(train.data)\n\n                                Mllt3     Cdh11     Flrt2      Fry     Gtdc1\n10X73_3_A_1:CCATCGTGAGGAGCx 10.812807  0.000000 10.525132 9.426573 10.119680\n10X73_3_A_1:GCCGACGAAGTCACx  9.954078  0.000000  9.260978 0.000000  9.954078\n10X74_4_A_1:GCATTGGAACACACx  9.585297 11.194680 10.683864 9.585297  0.000000\n10X73_3_A_1:GGCGACACGTTCAGx  0.000000  0.000000  8.845407 8.845407  8.845407\n10X74_4_A_1:TAGTGGTGGCGTTAx  0.000000  0.000000  0.000000 9.080972  0.000000\n10X73_3_A_1:CAGCACCTTTCATCx  9.889364  8.790854  9.483925 0.000000  9.483925\n                                 Ier2      Sla    Cadps   Kcnk10      Bcl2\n10X73_3_A_1:CCATCGTGAGGAGCx  0.000000 9.426573  0.00000 9.426573  9.426573\n10X73_3_A_1:GCCGACGAAGTCACx  0.000000 9.260978  0.00000 0.000000 10.359527\n10X74_4_A_1:GCATTGGAACACACx  9.585297 9.585297 10.27841 0.000000  0.000000\n10X73_3_A_1:GGCGACACGTTCAGx  0.000000 8.845407  0.00000 0.000000  0.000000\n10X74_4_A_1:TAGTGGTGGCGTTAx 10.179509 9.080972  0.00000 9.080972  9.080972\n10X73_3_A_1:CAGCACCTTTCATCx 10.177034 0.000000  0.00000 0.000000  8.790854\n                              Dlgap1    Atxn1    Foxp1    Frmd4b    Alcam\n10X73_3_A_1:CCATCGTGAGGAGCx 0.000000 9.426573 10.11968 11.035946  0.00000\n10X73_3_A_1:GCCGACGAAGTCACx 0.000000 0.000000  0.00000  9.260978 10.64720\n10X74_4_A_1:GCATTGGAACACACx 0.000000 0.000000 10.27841  0.000000  0.00000\n10X73_3_A_1:GGCGACACGTTCAGx 0.000000 0.000000 10.45473  8.845407  0.00000\n10X74_4_A_1:TAGTGGTGGCGTTAx 0.000000 9.774063  0.00000  9.080972 10.17951\n10X73_3_A_1:CAGCACCTTTCATCx 8.790854 9.483925  0.00000  0.000000 11.09330\n                               Gria1    Lrrtm3     Glp2r       Cpe     Ntrk2\n10X73_3_A_1:CCATCGTGAGGAGCx 0.000000  0.000000  0.000000  0.000000  9.426573\n10X73_3_A_1:GCCGACGAAGTCACx 0.000000  9.260978  0.000000  9.260978  9.260978\n10X74_4_A_1:GCATTGGAACACACx 9.585297  9.585297  0.000000  0.000000  0.000000\n10X73_3_A_1:GGCGACACGTTCAGx 9.538482 10.637047  9.538482  0.000000  0.000000\n10X74_4_A_1:TAGTGGTGGCGTTAx 0.000000  9.774063 10.179509  9.080972 10.179509\n10X73_3_A_1:CAGCACCTTTCATCx 8.790854  0.000000  0.000000 10.400170  9.483925\n                               Mmp16     Cadm2    Lsamp   Nkain2      Pak3\n10X73_3_A_1:CCATCGTGAGGAGCx 9.426573 10.525132 10.52513 9.426573  0.000000\n10X73_3_A_1:GCCGACGAAGTCACx 0.000000 10.359527  0.00000 9.954078  0.000000\n10X74_4_A_1:GCATTGGAACACACx 0.000000  9.585297  0.00000 0.000000  9.585297\n10X73_3_A_1:GGCGACACGTTCAGx 8.845407 10.454730  0.00000 9.538482 10.924723\n10X74_4_A_1:TAGTGGTGGCGTTAx 9.774063  9.774063  0.00000 0.000000  9.774063\n10X73_3_A_1:CAGCACCTTTCATCx 8.790854  9.889364 10.40017 9.889364  9.483925\n                               Sorbs2     Rspo3      Dcc    Elavl4  Fam171b\n10X73_3_A_1:CCATCGTGAGGAGCx  0.000000  0.000000 0.000000 10.119680 9.426573\n10X73_3_A_1:GCCGACGAAGTCACx  9.260978  9.260978 9.954078  0.000000 9.260978\n10X74_4_A_1:GCATTGGAACACACx  0.000000 10.683864 9.585297  0.000000 0.000000\n10X73_3_A_1:GGCGACACGTTCAGx  0.000000  8.845407 0.000000  8.845407 9.538482\n10X74_4_A_1:TAGTGGTGGCGTTAx  9.774063  9.080972 9.080972  0.000000 9.080972\n10X73_3_A_1:CAGCACCTTTCATCx 10.582486  0.000000 8.790854  0.000000 0.000000\n                                Ptprs      Nav2 Prickle1    Srgap3      Pak7\n10X73_3_A_1:CCATCGTGAGGAGCx  0.000000  0.000000 0.000000  0.000000  9.426573\n10X73_3_A_1:GCCGACGAAGTCACx  9.954078  9.954078 0.000000  0.000000 10.359527\n10X74_4_A_1:GCATTGGAACACACx  9.585297  0.000000 0.000000 10.278410  0.000000\n10X73_3_A_1:GGCGACACGTTCAGx  0.000000  0.000000 0.000000  0.000000  9.538482\n10X74_4_A_1:TAGTGGTGGCGTTAx  0.000000  0.000000 0.000000  0.000000  0.000000\n10X73_3_A_1:CAGCACCTTTCATCx 10.400170 10.582486 8.790854  9.483925  8.790854\n                                Akap6     Epha3      Dlg2    Bend6      Msra\n10X73_3_A_1:CCATCGTGAGGAGCx 10.812807  9.426573 10.525132 0.000000  0.000000\n10X73_3_A_1:GCCGACGAAGTCACx  0.000000  9.260978  9.260978 9.954078  9.954078\n10X74_4_A_1:GCATTGGAACACACx  9.585297  0.000000  0.000000 0.000000 10.278410\n10X73_3_A_1:GGCGACACGTTCAGx  0.000000  0.000000  0.000000 8.845407 10.791194\n10X74_4_A_1:TAGTGGTGGCGTTAx  9.774063  9.774063  0.000000 9.080972  9.080972\n10X73_3_A_1:CAGCACCTTTCATCx  8.790854 10.582486  8.790854 8.790854  0.000000\n                               Cnih3   B3gat1     Kcnq5      Tle4   St3gal1\n10X73_3_A_1:CCATCGTGAGGAGCx 0.000000 0.000000  0.000000  0.000000 10.119680\n10X73_3_A_1:GCCGACGAAGTCACx 9.260978 9.260978  9.260978  9.954078  0.000000\n10X74_4_A_1:GCATTGGAACACACx 0.000000 0.000000  9.585297  0.000000 10.278410\n10X73_3_A_1:GGCGACACGTTCAGx 8.845407 0.000000  8.845407  0.000000  8.845407\n10X74_4_A_1:TAGTGGTGGCGTTAx 9.774063 0.000000  0.000000 10.179509  0.000000\n10X73_3_A_1:CAGCACCTTTCATCx 8.790854 8.790854 10.400170  0.000000  8.790854\n                             Adamts18   Adamts3  Gm17750     Cnr1     Dscam\n10X73_3_A_1:CCATCGTGAGGAGCx  9.426573 10.119680 9.426573 0.000000  9.426573\n10X73_3_A_1:GCCGACGAAGTCACx 10.359527  0.000000 0.000000 0.000000  9.260978\n10X74_4_A_1:GCATTGGAACACACx  0.000000  0.000000 9.585297 0.000000  9.585297\n10X73_3_A_1:GGCGACACGTTCAGx  0.000000  9.538482 9.943923 9.943923  0.000000\n10X74_4_A_1:TAGTGGTGGCGTTAx  9.080972  9.080972 0.000000 0.000000 10.467181\n10X73_3_A_1:CAGCACCTTTCATCx  9.483925  0.000000 8.790854 8.790854  8.790854\n                              Runx1t1    Tshz3    Nr4a2       Tox    Cd200\n10X73_3_A_1:CCATCGTGAGGAGCx 11.824395 0.000000 0.000000  9.426573 9.426573\n10X73_3_A_1:GCCGACGAAGTCACx  0.000000 9.260978 0.000000  0.000000 9.260978\n10X74_4_A_1:GCATTGGAACACACx 12.293284 0.000000 0.000000  9.585297 9.585297\n10X73_3_A_1:GGCGACACGTTCAGx  9.538482 9.943923 8.845407 10.637047 0.000000\n10X74_4_A_1:TAGTGGTGGCGTTAx  0.000000 0.000000 0.000000  0.000000 0.000000\n10X73_3_A_1:CAGCACCTTTCATCx  0.000000 0.000000 0.000000  8.790854 0.000000\n                              Clstn2      Fat3     Kcnh7     Tenm1  Fam155a\n10X73_3_A_1:CCATCGTGAGGAGCx  0.00000  0.000000 10.812807 10.119680 9.426573\n10X73_3_A_1:GCCGACGAAGTCACx 10.87034  0.000000  9.260978  0.000000 9.954078\n10X74_4_A_1:GCATTGGAACACACx 10.97154 10.278410  0.000000  0.000000 0.000000\n10X73_3_A_1:GGCGACACGTTCAGx  0.00000  0.000000  0.000000  8.845407 0.000000\n10X74_4_A_1:TAGTGGTGGCGTTAx 10.17951  9.080972  0.000000  0.000000 0.000000\n10X73_3_A_1:CAGCACCTTTCATCx 10.58249 10.870162  0.000000  0.000000 8.790854\n                              Cacnb4    Usp29     Lmo3       Ntm    Atp1a3\n10X73_3_A_1:CCATCGTGAGGAGCx 0.000000 0.000000 0.000000  9.426573  0.000000\n10X73_3_A_1:GCCGACGAAGTCACx 0.000000 9.260978 0.000000  0.000000  0.000000\n10X74_4_A_1:GCATTGGAACACACx 0.000000 9.585297 0.000000 11.887821 10.683864\n10X73_3_A_1:GGCGACACGTTCAGx 8.845407 0.000000 0.000000 10.637047  0.000000\n10X74_4_A_1:TAGTGGTGGCGTTAx 0.000000 0.000000 9.080972  0.000000  9.080972\n10X73_3_A_1:CAGCACCTTTCATCx 8.790854 9.889364 0.000000  9.483925  0.000000\n                                 Caly     Foxp2 Hist3h2ba    Edil3    Enox1\n10X73_3_A_1:CCATCGTGAGGAGCx  0.000000 11.035946 10.119680 0.000000 0.000000\n10X73_3_A_1:GCCGACGAAGTCACx  9.260978 10.870340  9.260978 0.000000 9.260978\n10X74_4_A_1:GCATTGGAACACACx  0.000000  0.000000  9.585297 0.000000 0.000000\n10X73_3_A_1:GGCGACACGTTCAGx  8.845407  0.000000 10.454730 0.000000 0.000000\n10X74_4_A_1:TAGTGGTGGCGTTAx 10.179509  9.080972 10.467181 0.000000 0.000000\n10X73_3_A_1:CAGCACCTTTCATCx  0.000000 11.093302  9.483925 9.889364 9.889364\n                               Atrnl1    Dock3  Cacna1c  Tmem178b    Gria3\n10X73_3_A_1:CCATCGTGAGGAGCx  9.426573 9.426573 9.426573 10.525132 0.000000\n10X73_3_A_1:GCCGACGAAGTCACx  0.000000 9.954078 0.000000  0.000000 9.260978\n10X74_4_A_1:GCATTGGAACACACx  0.000000 0.000000 9.585297 10.278410 0.000000\n10X73_3_A_1:GGCGACACGTTCAGx 10.231594 8.845407 9.943923  8.845407 0.000000\n10X74_4_A_1:TAGTGGTGGCGTTAx  9.080972 0.000000 9.080972  9.080972 0.000000\n10X73_3_A_1:CAGCACCTTTCATCx 10.177034 8.790854 8.790854  9.889364 9.889364\n                               Trim2     Robo1     Apba1  Cacna1e      Rgs6\n10X73_3_A_1:CCATCGTGAGGAGCx 0.000000 11.372414  0.000000 0.000000 10.525132\n10X73_3_A_1:GCCGACGAAGTCACx 9.954078  0.000000  0.000000 9.260978  9.260978\n10X74_4_A_1:GCATTGGAACACACx 9.585297  9.585297  9.585297 0.000000  0.000000\n10X73_3_A_1:GGCGACACGTTCAGx 8.845407  8.845407 10.454730 0.000000  8.845407\n10X74_4_A_1:TAGTGGTGGCGTTAx 9.774063  0.000000  0.000000 0.000000 10.179509\n10X73_3_A_1:CAGCACCTTTCATCx 9.889364  9.483925  0.000000 8.790854  0.000000\n                              Trim17    Polr1d     Uqcrq     Hspa5    Rpl26\n10X73_3_A_1:CCATCGTGAGGAGCx 9.426573  0.000000  0.000000  0.000000 10.11968\n10X73_3_A_1:GCCGACGAAGTCACx 0.000000  9.260978  0.000000  9.954078 11.34034\n10X74_4_A_1:GCATTGGAACACACx 9.585297 10.278410 10.683864  9.585297 10.68386\n10X73_3_A_1:GGCGACACGTTCAGx 9.538482  9.943923  9.538482  8.845407 10.79119\n10X74_4_A_1:TAGTGGTGGCGTTAx 0.000000 10.179509  9.774063  0.000000 10.46718\n10X73_3_A_1:CAGCACCTTTCATCx 9.889364  8.790854  0.000000 10.177034 11.18861\n                                 Rpl5     Psma2     Rtraf     Rps10     Rps17\n10X73_3_A_1:CCATCGTGAGGAGCx 10.119680  0.000000  0.000000 10.119680 10.119680\n10X73_3_A_1:GCCGACGAAGTCACx  9.954078 10.359527 10.359527 10.870340 10.647201\n10X74_4_A_1:GCATTGGAACACACx  0.000000  9.585297  0.000000  9.585297  9.585297\n10X73_3_A_1:GGCGACACGTTCAGx  9.943923 10.454730 10.637047  9.943923 10.924723\n10X74_4_A_1:TAGTGGTGGCGTTAx  9.080972 10.467181 10.179509 10.690319 10.690319\n10X73_3_A_1:CAGCACCTTTCATCx  9.889364 10.177034  8.790854 10.870162 10.177034\n                                Rpl12    Rps15a     Rplp1     Rpl22     Rps12\n10X73_3_A_1:CCATCGTGAGGAGCx  0.000000  0.000000 10.812807  9.426573  9.426573\n10X73_3_A_1:GCCGACGAAGTCACx  9.260978 10.359527  9.954078 10.647201 10.647201\n10X74_4_A_1:GCATTGGAACACACx  0.000000  9.585297  9.585297  0.000000  0.000000\n10X73_3_A_1:GGCGACACGTTCAGx 10.231594 11.330182 10.924723 10.454730 10.231594\n10X74_4_A_1:TAGTGGTGGCGTTAx  9.774063 11.160314 10.467181 10.467181  9.774063\n10X73_3_A_1:CAGCACCTTTCATCx 10.177034 10.987943  9.889364 10.582486  9.483925\n                                Rps26     Rps24    Rps13      Rps3    Snrpd2\n10X73_3_A_1:CCATCGTGAGGAGCx  9.426573  9.426573 11.03595 10.525132 10.119680\n10X73_3_A_1:GCCGACGAAGTCACx 10.647201 11.206807 10.64720  9.954078  0.000000\n10X74_4_A_1:GCATTGGAACACACx  9.585297 10.683864 10.68386  9.585297  9.585297\n10X73_3_A_1:GGCGACACGTTCAGx 11.243172 11.243172 11.24317 11.243172  9.538482\n10X74_4_A_1:TAGTGGTGGCGTTAx 11.278096 11.645817 10.69032 10.690319  0.000000\n10X73_3_A_1:CAGCACCTTTCATCx 10.400170 11.275621 10.73663  9.889364  9.483925\n                                Snrpg     Rps21      Sub1   Slc25a5       Jun\n10X73_3_A_1:CCATCGTGAGGAGCx  0.000000 10.119680 10.119680  9.426573  0.000000\n10X73_3_A_1:GCCGACGAAGTCACx  0.000000  0.000000 10.647201  0.000000 10.647201\n10X74_4_A_1:GCATTGGAACACACx 10.971540 10.278410  9.585297  0.000000  9.585297\n10X73_3_A_1:GGCGACACGTTCAGx  9.538482  9.538482  8.845407  9.943923  8.845407\n10X74_4_A_1:TAGTGGTGGCGTTAx 10.179509 10.467181 10.179509  0.000000  9.774063\n10X73_3_A_1:CAGCACCTTTCATCx  9.483925  9.889364  9.483925 10.987943  0.000000\n                                Uqcrh     Rpl38    Tspan5    Igf1r    Atox1\n10X73_3_A_1:CCATCGTGAGGAGCx 10.119680  0.000000  9.426573 0.000000 0.000000\n10X73_3_A_1:GCCGACGAAGTCACx  9.260978  9.954078  0.000000 9.260978 9.260978\n10X74_4_A_1:GCATTGGAACACACx  9.585297 10.278410  9.585297 0.000000 0.000000\n10X73_3_A_1:GGCGACACGTTCAGx  9.538482  9.943923  0.000000 8.845407 8.845407\n10X74_4_A_1:TAGTGGTGGCGTTAx 10.467181  9.774063  9.080972 0.000000 9.080972\n10X73_3_A_1:CAGCACCTTTCATCx  9.889364  8.790854 10.177034 0.000000 8.790854\n                                Rps25     Pfdn5     Rps28     Pomp   Cox7a2l\n10X73_3_A_1:CCATCGTGAGGAGCx  9.426573 10.119680 10.525132 9.426573  9.426573\n10X73_3_A_1:GCCGACGAAGTCACx  0.000000 10.647201  9.260978 0.000000 10.647201\n10X74_4_A_1:GCATTGGAACACACx  0.000000  9.585297  0.000000 0.000000  9.585297\n10X73_3_A_1:GGCGACACGTTCAGx 10.454730 11.410224 10.231594 9.943923 10.791194\n10X74_4_A_1:TAGTGGTGGCGTTAx 11.278096 10.690319  0.000000 9.774063 10.179509\n10X73_3_A_1:CAGCACCTTTCATCx 10.177034  9.889364  9.889364 0.000000  9.483925\n                                Rps18     Rpl34     Rps29     Atp5j    Gm2000\n10X73_3_A_1:CCATCGTGAGGAGCx  9.426573  9.426573  0.000000  9.426573  0.000000\n10X73_3_A_1:GCCGACGAAGTCACx 11.052658  9.954078  9.954078  9.260978  0.000000\n10X74_4_A_1:GCATTGGAACACACx  0.000000  9.585297  9.585297  0.000000  0.000000\n10X73_3_A_1:GGCGACACGTTCAGx  9.943923 10.791194 11.243172  9.943923  9.538482\n10X74_4_A_1:TAGTGGTGGCGTTAx 10.690319 10.179509  9.774063  9.080972 10.690319\n10X73_3_A_1:CAGCACCTTTCATCx  9.889364 10.582486 10.177034 10.582486 10.400170\n                                Ptk2      Pfn1     Rpl27    Atp5j2      Jund\n10X73_3_A_1:CCATCGTGAGGAGCx 9.426573  9.426573 10.119680  0.000000  0.000000\n10X73_3_A_1:GCCGACGAAGTCACx 0.000000  9.954078 10.870340 10.359527 10.359527\n10X74_4_A_1:GCATTGGAACACACx 9.585297  0.000000  0.000000 10.278410  0.000000\n10X73_3_A_1:GGCGACACGTTCAGx 8.845407 10.231594 10.924723  9.943923 10.454730\n10X74_4_A_1:TAGTGGTGGCGTTAx 0.000000  9.080972 10.179509  0.000000  9.774063\n10X73_3_A_1:CAGCACCTTTCATCx 8.790854 10.177034  9.483925  9.889364 10.582486\n                                Rpl35     Sbf2    Dusp1     Atp5e    Ndufc1\n10X73_3_A_1:CCATCGTGAGGAGCx  9.426573 0.000000 0.000000 10.119680 10.119680\n10X73_3_A_1:GCCGACGAAGTCACx 11.340336 0.000000 9.260978  0.000000 10.359527\n10X74_4_A_1:GCATTGGAACACACx  9.585297 0.000000 0.000000  9.585297  9.585297\n10X73_3_A_1:GGCGACACGTTCAGx 11.147863 8.845407 9.538482  0.000000  9.943923\n10X74_4_A_1:TAGTGGTGGCGTTAx 11.383455 9.774063 9.080972 10.179509  0.000000\n10X73_3_A_1:CAGCACCTTTCATCx 11.355662 8.790854 8.790854  0.000000  8.790854\n                               Rpl35a     Ttc28     Sumo1     Srp14      Calr\n10X73_3_A_1:CCATCGTGAGGAGCx  0.000000 10.119680 10.525132  9.426573  0.000000\n10X73_3_A_1:GCCGACGAAGTCACx  9.954078  9.260978  0.000000 10.870340  9.260978\n10X74_4_A_1:GCATTGGAACACACx 10.971540  0.000000  0.000000  0.000000 10.683864\n10X73_3_A_1:GGCGACACGTTCAGx 10.454730  9.943923  8.845407 10.231594  9.538482\n10X74_4_A_1:TAGTGGTGGCGTTAx 10.467181  0.000000  9.774063  9.080972  9.080972\n10X73_3_A_1:CAGCACCTTTCATCx  9.889364 10.177034 10.177034  8.790854  9.483925\n                              Dynlrb1    Timm8b     Swi5      Ubl5      Xist\n10X73_3_A_1:CCATCGTGAGGAGCx 10.525132  9.426573 9.426573  0.000000 10.812807\n10X73_3_A_1:GCCGACGAAGTCACx 10.359527  9.954078 9.954078  0.000000  9.954078\n10X74_4_A_1:GCATTGGAACACACx  0.000000  9.585297 0.000000  0.000000  0.000000\n10X73_3_A_1:GGCGACACGTTCAGx 10.637047  9.538482 9.943923 10.454730 10.454730\n10X74_4_A_1:TAGTGGTGGCGTTAx  9.774063 10.467181 9.774063 10.179509  0.000000\n10X73_3_A_1:CAGCACCTTTCATCx 10.987943  9.483925 9.483925  8.790854 11.188610\n                                Dctn3      Tbca     Plcb1   Ube2e2    Ndufa6\n10X73_3_A_1:CCATCGTGAGGAGCx  0.000000  9.426573  0.000000 0.000000  0.000000\n10X73_3_A_1:GCCGACGAAGTCACx  0.000000  9.260978  9.260978 9.260978  9.260978\n10X74_4_A_1:GCATTGGAACACACx  0.000000 10.278410  0.000000 9.585297  9.585297\n10X73_3_A_1:GGCGACACGTTCAGx  9.538482  9.943923  0.000000 8.845407  9.538482\n10X74_4_A_1:TAGTGGTGGCGTTAx 10.467181  9.774063  0.000000 0.000000 10.179509\n10X73_3_A_1:CAGCACCTTTCATCx  9.483925  9.483925 10.870162 8.790854  0.000000\n                                Serf1    Clasp2   Atp5o.1  Atp6v1g1     Cox7c\n10X73_3_A_1:CCATCGTGAGGAGCx 10.119680 10.525132  0.000000  9.426573  0.000000\n10X73_3_A_1:GCCGACGAAGTCACx 10.359527  0.000000  9.954078 10.647201 10.870340\n10X74_4_A_1:GCATTGGAACACACx  9.585297  9.585297  0.000000 10.278410 10.278410\n10X73_3_A_1:GGCGACACGTTCAGx  9.538482  9.538482 10.637047 10.231594  9.943923\n10X74_4_A_1:TAGTGGTGGCGTTAx 10.179509  0.000000  0.000000  9.080972 11.278096\n10X73_3_A_1:CAGCACCTTTCATCx  9.889364 10.400170  9.483925  8.790854 10.400170\n                            COTAN_Cl.code\n10X73_3_A_1:CCATCGTGAGGAGCx             2\n10X73_3_A_1:GCCGACGAAGTCACx             2\n10X74_4_A_1:GCATTGGAACACACx             1\n10X73_3_A_1:GGCGACACGTTCAGx             3\n10X74_4_A_1:TAGTGGTGGCGTTAx             2\n10X73_3_A_1:CAGCACCTTTCATCx             3\n\n\n\ntrain.data$COTAN_Cl.code &lt;- as.factor(train.data$COTAN_Cl.code)\ntest.data$COTAN_Cl.code &lt;- as.factor(test.data$COTAN_Cl.code)\n# Fit the model\n#model &lt;- glm( COTAN_Cl.code ~., data = train.data, family = binomial,control = list(maxit = 75))\nmodel &lt;- multinom(COTAN_Cl.code ~ ., data = train.data, maxit = 500)\n\n# weights:  456 (302 variable)\ninitial  value 727.281335 \niter  10 value 149.467006\niter  20 value 144.360899\niter  30 value 132.731875\niter  40 value 90.384826\niter  50 value 82.420514\niter  60 value 77.185594\niter  70 value 56.263874\niter  80 value 50.423463\niter  90 value 46.538673\niter 100 value 34.109745\niter 110 value 29.731988\niter 120 value 11.248129\niter 130 value 8.008341\niter 140 value 4.510408\niter 150 value 1.640137\niter 160 value 0.232066\niter 170 value 0.003377\niter 180 value 0.000135\nfinal  value 0.000077 \nconverged\n\nprobabilities &lt;- predict(model, newdata = test.data, type = \"probs\")\n\n# Find the class with the highest probability for each case\npredicted.classes &lt;- apply(probabilities, 1, which.max)\n\n# Adjust predicted classes to match your factor levels\nlevels &lt;- levels(train.data$COTAN_Cl.code)\npredicted.classes &lt;- levels[predicted.classes]\n\n# Calculate model accuracy\naccuracy &lt;- mean(predicted.classes == test.data$COTAN_Cl.code)\nresult.df[nrow(result.df),\"Accuracy\"] &lt;- accuracy\nprint(accuracy)\n\n[1] 0.7865854\n\n\nSo also a simple logistic regression confirm that this cluster is in fact formed by four different cell populations.\nNow lets try to search the identity of these cells.\nSince COTAN can detect also very lowly expressed genes, but all the literature methods not, the online methods are bias for highly expressed genes. So, we will take all genes detected as enriched by COTAN and filter also for the highly expressed ones.\n\ntop &lt;- cl525ClsMarkers[cl525ClsMarkers$Gene %in% rownames(cl525GDI[cl525GDI$sum.raw.norm &gt; 7,]) & cl525ClsMarkers$Score &gt; 0,]\ntop\n\n[1] CL        Gene      DEA       adjPVal   IsMarker  logFoldCh\n&lt;0 rows&gt; (or 0-length row.names)\n\n\n\nwrite.csv(top,paste0(outDir,\"cl525/TopClustersMarkers.csv\"))",
    "crumbs": [
      "Cluster evaluation",
      "Not UT cluster with LR"
    ]
  },
  {
    "objectID": "NonCT_clusters.html#cluster-511-e15.0",
    "href": "NonCT_clusters.html#cluster-511-e15.0",
    "title": "Not Uniform Transcriptomic clusters with Logistic Regression",
    "section": "Cluster 511 e15.0",
    "text": "Cluster 511 e15.0\n\ncells &lt;- getClusterizationData(e15.0,clName = \"CL_original.clusters\")[[1]][getClusterizationData(e15.0,clName = \"CL_original.clusters\")[[1]] == \"511\"]\n\ncells &lt;-names(cells)\n\ncl511 &lt;-  automaticCOTANObjectCreation(raw = getRawData(e15.0)[,cells],\n                                       GEO = \"Loom\",\n                                       sequencingMethod = \"10X\",\n                                       sampleCondition = \"cl511\",\n                                       cores = 10,saveObj = T,\n                                       outDir = \"Data/MouseCortexFromLoom/NotCTSingleClusters/\",\n                                       calcCoex = T)\n\n\n\n  OriginalCluster CellNumber COTANClusterNumber          Accuracy\n1      Cl525E15.0        826                  3 0.786585365853659\n2      Cl511E15.0        540                  2              &lt;NA&gt;\n\n\n\ncl511GDI &lt;- calculateGDI(cl511)\n\nsubsetGDIcl511 &lt;- cl511GDI[cl511GDI$sum.raw.norm &gt; 7,]\ntop.GDI.genes &lt;- rownames(subsetGDIcl511[order(subsetGDIcl511$GDI,decreasing = T),])[1:50]\n\nGDIPlot(cl511,genes = \"\",GDIIn = cl511GDI)\n\n\n\n\n\n\n\n\n\nlist.cl.CT &lt;- cellsUniformClustering(cl511, GDIThreshold = 1.43, cores = 10L,\n                         saveObj = TRUE, outDir = outDir)\n\ncl511 &lt;- addClusterization(cl511, clName = \"split\",\n                              clusters = list.cl.CT$clusters,\n                              coexDF = list.cl.CT$coex, override = TRUE)\n\ntable(list.cl.CT$clusters)\n\n\nc(mergedClusters, mergedCoexDF) %&lt;-%\n  mergeUniformCellsClusters(cl511, clusters = list.cl.CT$clusters,\n                            GDIThreshold = 1.43, batchSize = 4L, cores = 10L,\n                            saveObj = TRUE, outDir = outDir)\n\ncl511 &lt;- addClusterization(cl511, clName = \"merge\",\n                              clusters = mergedClusters,\n                              coexDF = mergedCoexDF,\n                              override = TRUE)\n\nsaveRDS(cl511,paste0(outDir,\"cl511.cotan.RDS\"))\n\ntable(str_split(names(mergedClusters),pattern = \"_\",simplify = T)[,1],mergedClusters)\n\n\ndata &lt;- getNormalizedData(cl511)\ndata &lt;- data[!rowSums(as.matrix(data)) &lt; 1,]\ndata &lt;- log(data*10000+1)\n\nrow_stdev &lt;- apply(data, 1, sd, na.rm=TRUE)\nrow_stdev &lt;- row_stdev[order(row_stdev,decreasing = T)]\n\ngenes.to.keep &lt;- c(names(row_stdev[1:100]),top.GDI.genes)\n\ndata.small &lt;- data[rownames(data) %in% genes.to.keep,]\n\n#data &lt;- t(as.matrix(data))\ndata.small &lt;- t(as.matrix(data.small))\n\n\nCOTAN_Cl.code &lt;- getClusterizationData(cl511)[[1]]\n#COTAN_Cl.code[COTAN_Cl.code == \"A549\"] &lt;- 0\n#COTAN_Cl.code[COTAN_Cl.code == \"CCL-185-IG\"] &lt;- 1\n\nCOTAN_Cl.code &lt;- as.numeric(COTAN_Cl.code)-1\n\ndata.small &lt;- cbind(data.small,COTAN_Cl.code)\ndata.small &lt;- as.data.frame(data.small)\n\n# Split the data into training and test set\nset.seed(123)\ntraining.samples &lt;- data.small[,\"COTAN_Cl.code\"] %&gt;% \n  createDataPartition(p = 0.8, list = FALSE)\ntrain.data  &lt;- data.small[training.samples, ]\ntest.data &lt;- data.small[-training.samples, ]\nhead(train.data)\n\n                               Flrt2  Smarca2    Srgap1       Sla    Cadps\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000 0.000000  0.000000  0.000000 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000 0.000000  0.000000 10.471506 0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 9.207514 9.207514 10.306059  0.000000 9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 8.878654 8.878654  9.571731  0.000000 0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx 8.985081 9.678166 10.371281  0.000000 0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000 9.028611 10.127143  9.721698 9.028611\n                               Kcnk10 Itpr1    Klhl29   Elmod1       Nin\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.000000     0 10.627557 9.528994 10.915233\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000     0  9.778387 0.000000  9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx  9.207514     0  9.900611 0.000000  9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx  0.000000     0  0.000000 8.878654  0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx  0.000000     0  8.985081 8.985081  8.985081\n10X73_3_A_1:AAGCACTGCTTCGCx 10.127143     0  0.000000 9.028611  0.000000\n                               Kcnn2    Adgrb3    Foxp1     Alcam     Mtss1\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000  9.528994 0.000000  9.528994  0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000  0.000000 0.000000  0.000000  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 0.000000 11.153338 9.207514 10.593733  9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 9.571731 10.264844 9.571731  0.000000  8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 0.000000 10.083610 8.985081  8.985081 10.083610\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000  0.000000 9.028611  0.000000  9.028611\n                             Fam213a  Ralgps2       Ptn     Cadm2    Frmd4a\n10X74_4_A_1:CAGCGTCTCCTCGTx 9.528994 0.000000  0.000000 10.222104  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000 9.778387  0.000000  0.000000  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 0.000000 9.207514  9.207514  9.207514  9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 0.000000 0.000000 11.586574 10.487980  8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 0.000000 0.000000  0.000000  8.985081  0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000 9.028611  0.000000 10.127143 10.820270\n                              Nkain2     Tenm3     Grip1    Tanc2    Syt11\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000  0.000000 10.915233 0.000000 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 9.778387 10.876962  9.778387 9.778387 9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx 0.000000  9.207514  0.000000 0.000000 9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 0.000000  0.000000  8.878654 8.878654 8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 0.000000  9.678166  8.985081 8.985081 0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000 10.127143  0.000000 9.028611 0.000000\n                               Srgap3      Pak7    Mapk10     Sobp  Bhlhe22\n10X74_4_A_1:CAGCGTCTCCTCGTx  9.528994  0.000000 10.222104 9.528994 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 10.471506  9.778387  0.000000 0.000000 9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx  9.900611  0.000000  0.000000 0.000000 0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx  9.571731  8.878654 10.487980 8.878654 0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx  9.678166  0.000000  8.985081 9.678166 0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx  0.000000 10.820270  0.000000 0.000000 9.721698\n                               Epha3    Adgrl3      Dok5    Satb2    Hs6st2\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000  0.000000  0.000000  0.00000  0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000 10.471506  0.000000  0.00000  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 0.000000  0.000000  0.000000  0.00000  9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 9.571731  9.571731 10.487980 11.36343  8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 8.985081  8.985081  0.000000  0.00000  0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000  0.000000  9.028611  0.00000 12.024229\n                            X5730522E02Rik      Msra    Spock1     Enc1\n10X74_4_A_1:CAGCGTCTCCTCGTx       9.528994  0.000000  9.528994  0.00000\n10X74_4_A_1:GTCCACTGTCCTCGx       0.000000  0.000000  0.000000 10.47151\n10X64_3_A_1:ACGCCGGAGGATTCx       0.000000  0.000000  0.000000  0.00000\n10X73_3_A_1:GTTAACCTTGTCGAx       0.000000  0.000000  8.878654 10.26484\n10X74_4_A_1:CGTGATGAGAAGGCx      10.371281  8.985081  0.000000  0.00000\n10X73_3_A_1:AAGCACTGCTTCGCx      10.414815 10.820270 10.414815  0.00000\n                             Fam110b      Sybu     Lmo1     Dscam    Rab3c\n10X74_4_A_1:CAGCGTCTCCTCGTx 9.528994 10.627557 9.528994 10.222104 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000 10.471506 0.000000  9.778387 0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 0.000000  9.207514 0.000000  0.000000 0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx 8.878654  8.878654 8.878654  8.878654 8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 8.985081  0.000000 8.985081  8.985081 8.985081\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000  0.000000 9.028611  0.000000 9.028611\n                            Mir124.2hg    Clstn2      Fat3     Kcnh7    Usp29\n10X74_4_A_1:CAGCGTCTCCTCGTx   0.000000 10.222104 10.627557 10.222104 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx  10.471506 10.876962  9.778387  0.000000 0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx   9.207514 10.306059 10.816872  9.207514 0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx   8.878654  8.878654  9.571731  8.878654 0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx   8.985081  0.000000  0.000000  0.000000 0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx   0.000000  0.000000 10.414815 10.127143 9.028611\n                                 Cd47      Ryr3    Neto2     Ppm1e     Mdga2\n10X74_4_A_1:CAGCGTCTCCTCGTx 10.222104  0.000000 9.528994  0.000000  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000  0.000000 9.778387  9.778387 10.471506\n10X64_3_A_1:ACGCCGGAGGATTCx  9.207514  0.000000 0.000000  9.207514 10.306059\n10X73_3_A_1:GTTAACCTTGTCGAx  0.000000  8.878654 9.571731 11.517582  0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx  9.678166 10.083610 8.985081  9.678166 10.083610\n10X73_3_A_1:AAGCACTGCTTCGCx  0.000000 10.414815 9.721698  9.721698  9.721698\n                            Serpini1     Ralyl     Nrcam     Robo2    Csrnp3\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000 10.222104  0.000000  0.000000 10.627557\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000 10.471506 10.471506  0.000000  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 9.207514  0.000000  9.900611 10.593733 10.306059\n10X73_3_A_1:GTTAACCTTGTCGAx 9.571731  8.878654  9.977173  8.878654  9.571731\n10X74_4_A_1:CGTGATGAGAAGGCx 8.985081 10.371281  8.985081  0.000000  0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000 10.637953  0.000000  0.000000  0.000000\n                            Hist3h2ba   Jakmip1     Edil3     Enox1      Rprm\n10X74_4_A_1:CAGCGTCTCCTCGTx  10.62756  0.000000  0.000000 10.222104 10.627557\n10X74_4_A_1:GTCCACTGTCCTCGx   0.00000  0.000000 10.471506  9.778387  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx  10.30606  9.207514  9.900611  9.207514  0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx  10.95797  9.571731  0.000000  0.000000  8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx  10.93088 10.083610  8.985081 10.594419 10.594419\n10X73_3_A_1:AAGCACTGCTTCGCx  11.10795  0.000000  9.028611  9.721698  9.028611\n                               Olfm1 Tmem178b      Gng3    Cntn2     Scg3\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000 0.000000  9.528994 0.000000 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 9.778387 0.000000  9.778387 0.000000 9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx 9.207514 0.000000  0.000000 0.000000 0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx 8.878654 8.878654 10.670297 8.878654 8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 0.000000 0.000000  8.985081 0.000000 9.678166\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000 9.028611  0.000000 9.028611 0.000000\n                               Gnao1     Serp2     Pcdh9    Trim2     Nrg1\n10X74_4_A_1:CAGCGTCTCCTCGTx 9.528994 10.222104 10.222104 9.528994 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 9.778387  9.778387  9.778387 0.000000 0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 9.207514  0.000000 10.816872 0.000000 0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx 9.571731  9.571731 10.264844 9.571731 9.571731\n10X74_4_A_1:CGTGATGAGAAGGCx 8.985081  9.678166  9.678166 8.985081 8.985081\n10X73_3_A_1:AAGCACTGCTTCGCx 9.028611  9.721698 10.127143 9.721698 9.028611\n                               Ppfia2  Cacna2d1     Uqcrq      Bex3       Ran\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.000000  0.000000  0.000000 10.627557  0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000  0.000000  0.000000  9.778387 10.876962\n10X64_3_A_1:ACGCCGGAGGATTCx  0.000000  9.900611  9.900611 11.153338 10.306059\n10X73_3_A_1:GTTAACCTTGTCGAx 10.670297 11.181114 10.957974 10.264844 10.824445\n10X74_4_A_1:CGTGATGAGAAGGCx  9.678166  0.000000  8.985081  9.678166  9.678166\n10X73_3_A_1:AAGCACTGCTTCGCx  9.028611  0.000000 10.414815 10.414815 10.637953\n                               Atp5c1     Eif3k    Ppp1cb   Ndufaf2    Hmgb3\n10X74_4_A_1:CAGCGTCTCCTCGTx  9.528994  9.528994 10.222104  0.000000 9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000  9.778387  0.000000  0.000000 0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 10.999190 10.306059  9.207514  0.000000 9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 10.957974 10.264844  8.878654  9.977173 9.977173\n10X74_4_A_1:CGTGATGAGAAGGCx 10.083610 10.594419  0.000000 10.594419 0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx  9.721698  0.000000  0.000000  9.028611 0.000000\n                               Rps10     Rae1      Mbd3     Eif3c   Hnrnpab\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.00000 0.000000 10.222104  9.528994  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx 10.87696 0.000000  9.778387 10.876962  9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx 10.81687 0.000000  0.000000  9.207514 10.306059\n10X73_3_A_1:GTTAACCTTGTCGAx 10.82444 0.000000  9.977173  0.000000  9.977173\n10X74_4_A_1:CGTGATGAGAAGGCx 10.77674 8.985081  0.000000  8.985081  9.678166\n10X73_3_A_1:AAGCACTGCTTCGCx 10.12714 9.028611  0.000000  9.028611 10.414815\n                                Rpl12   Rps15a   Rpl13a     Rpl31    Rplp1\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.000000 10.22210  0.00000 10.222104 10.22210\n10X74_4_A_1:GTCCACTGTCCTCGx 10.876962  0.00000 10.87696 10.876962 11.16464\n10X64_3_A_1:ACGCCGGAGGATTCx 10.999190 10.59373 11.28687 10.999190 10.81687\n10X73_3_A_1:GTTAACCTTGTCGAx  8.878654 11.18111 10.82444  9.977173 11.27642\n10X74_4_A_1:CGTGATGAGAAGGCx 10.930884 11.62402 10.93088 10.930884 10.93088\n10X73_3_A_1:AAGCACTGCTTCGCx  9.721698 11.59345 10.97442 10.637953 10.82027\n                                Hspe1     Rps12    Ranbp1    Rpl39     Rps26\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.000000  9.528994 10.627557 0.000000 10.222104\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000  9.778387  0.000000 0.000000  9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx  0.000000 10.593733  9.207514 0.000000  9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx  9.977173 10.264844 10.487980 9.571731 11.586574\n10X74_4_A_1:CGTGATGAGAAGGCx 10.371281 10.371281  9.678166 0.000000 11.549915\n10X73_3_A_1:AAGCACTGCTTCGCx  9.028611 10.414815 10.127143 9.028611 10.974418\n                               Rplp2    Rps13     Rps3     Rps20     Snrpg\n10X74_4_A_1:CAGCGTCTCCTCGTx 10.22210 10.91523 10.22210  9.528994  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx 10.47151 10.87696 10.87696  9.778387  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 11.40465 11.28687 10.81687 10.593733 10.306059\n10X73_3_A_1:GTTAACCTTGTCGAx 11.07575 10.95797 11.07575 10.957974 10.487980\n10X74_4_A_1:CGTGATGAGAAGGCx 10.77674 11.54991 11.46987 11.064413  8.985081\n10X73_3_A_1:AAGCACTGCTTCGCx 11.22573 11.42640 10.41482  9.721698  9.721698\n                                Rps21      Nme1     Uqcrh     Rpl38   Rps3a1\n10X74_4_A_1:CAGCGTCTCCTCGTx  9.528994  0.000000  9.528994  0.000000 11.13837\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000 10.876962  9.778387  0.000000 10.47151\n10X64_3_A_1:ACGCCGGAGGATTCx 10.593733  9.900611 10.593733 10.306059 11.77237\n10X73_3_A_1:GTTAACCTTGTCGAx  8.878654  9.977173  9.571731  8.878654 10.95797\n10X74_4_A_1:CGTGATGAGAAGGCx 10.371281 10.930884  0.000000  9.678166 11.62402\n10X73_3_A_1:AAGCACTGCTTCGCx 10.127143  9.721698  9.721698 10.637953 11.10795\n                               Rps25     Pfdn5    Saraf     Rps28     Rps27\n10X74_4_A_1:CAGCGTCTCCTCGTx 10.62756  0.000000 0.000000  9.528994 11.320692\n10X74_4_A_1:GTCCACTGTCCTCGx 10.47151  9.778387 0.000000 10.471506  9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx 10.59373 10.593733 9.207514 10.593733 11.153338\n10X73_3_A_1:GTTAACCTTGTCGAx 10.67030 10.264844 8.878654  9.571731 10.670297\n10X74_4_A_1:CGTGATGAGAAGGCx 11.18219 10.776736 9.678166 11.064413 10.776736\n10X73_3_A_1:AAGCACTGCTTCGCx 10.12714 11.225729 9.028611 10.974418 10.974418\n                                Rpl37      Gnaq      Pomp     Rps18     Rpl34\n10X74_4_A_1:CAGCGTCTCCTCGTx 10.915233  0.000000  0.000000 10.627557  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx  9.778387  9.778387  0.000000  9.778387  9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx 11.510009  9.207514 10.816872 10.306059  9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 11.276423 10.264844  9.977173  8.878654 10.957974\n10X74_4_A_1:CGTGATGAGAAGGCx 11.549915  0.000000 10.371281 11.624022 10.371281\n10X73_3_A_1:AAGCACTGCTTCGCx 10.974418  9.721698 10.414815 11.225729 10.820270\n                               Rps29     Ppdpf      Pfn1     Rpl27    Atp5j2\n10X74_4_A_1:CAGCGTCTCCTCGTx 10.22210  0.000000 10.222104 10.627557  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx  0.00000  9.778387 10.876962  0.000000 10.471506\n10X64_3_A_1:ACGCCGGAGGATTCx 10.81687  0.000000  9.900611 10.816872  0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx 10.95797 10.670297 11.075755  9.977173  9.977173\n10X74_4_A_1:CGTGATGAGAAGGCx 10.59442  9.678166  8.985081 10.930884  9.678166\n10X73_3_A_1:AAGCACTGCTTCGCx 10.82027  9.028611 10.414815 10.127143 10.414815\n                                Pdia3    Rpl35      Sbf2     Crip2      Tpt1\n10X74_4_A_1:CAGCGTCTCCTCGTx  9.528994 10.22210  0.000000 10.222104  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx 10.876962  0.00000 10.471506  0.000000  9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx  9.207514 10.30606  0.000000 10.999190 10.306059\n10X73_3_A_1:GTTAACCTTGTCGAx  9.571731 11.07575  9.977173 10.670297 11.075755\n10X74_4_A_1:CGTGATGAGAAGGCx  8.985081 11.28755  8.985081  9.678166 10.776736\n10X73_3_A_1:AAGCACTGCTTCGCx 10.820270 11.10795  0.000000 10.127143 11.107948\n                              Rpl35a X4930402H24Rik    Ppm1l     Itfg1   Large1\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.00000       9.528994 0.000000  0.000000 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx  0.00000       9.778387 0.000000 10.876962 9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx  0.00000       0.000000 0.000000  9.207514 9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 10.95797       9.977173 0.000000  9.977173 0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx 11.28755       8.985081 8.985081  0.000000 0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 10.82027       0.000000 9.028611  0.000000 0.000000\n                                 Ktn1     Ddah2     Sumo1 Nipsnap3b   Dynlrb1\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.000000 10.222104 10.222104  0.000000  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx 10.876962  0.000000  0.000000  0.000000  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx  0.000000 10.816872 10.816872  9.207514 10.306059\n10X73_3_A_1:GTTAACCTTGTCGAx  8.878654  8.878654  9.977173  9.571731  9.977173\n10X74_4_A_1:CGTGATGAGAAGGCx  0.000000 10.083610 10.083610  0.000000 10.930884\n10X73_3_A_1:AAGCACTGCTTCGCx  9.028611 10.637953  9.721698  9.721698 10.127143\n                                 Svbp   Tmem57     Acat2   Hmgcs1    Prmt2\n10X74_4_A_1:CAGCGTCTCCTCGTx  9.528994 9.528994  9.528994 9.528994 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx  9.778387 9.778387  0.000000 9.778387 0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 10.306059 0.000000 10.306059 0.000000 0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx 10.264844 8.878654  8.878654 9.977173 0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx 10.776736 8.985081  8.985081 8.985081 9.678166\n10X73_3_A_1:AAGCACTGCTTCGCx  9.028611 9.721698  9.721698 0.000000 0.000000\n                               Kif1a   Atp5o.1  Atp6v1g1   Camta1    Tnrc6c\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000 10.222104  0.000000 9.528994  0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000  9.778387 10.471506 0.000000  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 0.000000 10.593733 11.153338 9.207514  0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx 9.571731 10.670297 10.264844 9.571731  8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 0.000000  9.678166 10.371281 0.000000  0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000 10.127143  9.721698 9.028611 10.127143\n                               Kifap3 COTAN_Cl.code\n10X74_4_A_1:CAGCGTCTCCTCGTx 10.915233             0\n10X74_4_A_1:GTCCACTGTCCTCGx 10.471506             0\n10X64_3_A_1:ACGCCGGAGGATTCx  0.000000             1\n10X73_3_A_1:GTTAACCTTGTCGAx  8.878654             1\n10X74_4_A_1:CGTGATGAGAAGGCx  0.000000             1\n10X73_3_A_1:AAGCACTGCTTCGCx  0.000000             1\n\n\n\n# Fit the model\nmodel &lt;- glm( COTAN_Cl.code ~., data = train.data, family = binomial,control = list(maxit = 50))\n# Summarize the model\nsummary(model)\n\n\nCall:\nglm(formula = COTAN_Cl.code ~ ., family = binomial, data = train.data, \n    control = list(maxit = 50))\n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)    -1.049e+02  2.871e+06       0        1\nFlrt2           6.629e-01  8.691e+04       0        1\nSmarca2         4.075e-01  5.965e+04       0        1\nSrgap1         -1.196e-01  6.491e+04       0        1\nSla             2.034e-01  6.556e+04       0        1\nCadps          -8.866e-02  6.676e+04       0        1\nKcnk10         -4.246e-01  8.725e+04       0        1\nItpr1          -1.009e+00  6.868e+04       0        1\nKlhl29          1.590e-01  6.882e+04       0        1\nElmod1          3.142e-01  9.102e+04       0        1\nNin            -1.495e-01  6.106e+04       0        1\nKcnn2          -1.893e-01  6.106e+04       0        1\nAdgrb3          1.495e-01  7.922e+04       0        1\nFoxp1          -2.477e-01  1.008e+05       0        1\nAlcam           6.261e-01  7.361e+04       0        1\nMtss1          -8.110e-02  8.371e+04       0        1\nFam213a        -2.518e-01  7.716e+04       0        1\nRalgps2        -5.499e-01  8.683e+04       0        1\nPtn             2.736e-01  1.076e+05       0        1\nCadm2          -3.845e-01  8.437e+04       0        1\nFrmd4a         -9.663e-02  7.256e+04       0        1\nNkain2          3.780e-01  8.739e+04       0        1\nTenm3           8.697e-02  9.268e+04       0        1\nGrip1           1.791e-01  8.187e+04       0        1\nTanc2          -3.292e-01  6.503e+04       0        1\nSyt11          -7.403e-01  8.730e+04       0        1\nSrgap3          2.804e-01  6.623e+04       0        1\nPak7           -1.187e-01  8.320e+04       0        1\nMapk10          4.246e-01  6.620e+04       0        1\nSobp           -3.389e-01  6.542e+04       0        1\nBhlhe22        -1.175e-01  8.535e+04       0        1\nEpha3          -3.949e-02  1.025e+05       0        1\nAdgrl3         -3.242e-01  8.414e+04       0        1\nDok5            4.329e-01  8.442e+04       0        1\nSatb2           6.319e-01  1.010e+05       0        1\nHs6st2         -2.440e-01  8.496e+04       0        1\nX5730522E02Rik -1.205e-02  7.793e+04       0        1\nMsra            2.379e-01  1.022e+05       0        1\nSpock1          3.863e-01  5.638e+04       0        1\nEnc1            1.667e-01  7.319e+04       0        1\nFam110b        -2.383e-01  6.774e+04       0        1\nSybu           -8.298e-02  6.530e+04       0        1\nLmo1            1.633e-01  8.353e+04       0        1\nDscam          -1.470e-01  6.781e+04       0        1\nRab3c          -1.161e-01  1.103e+05       0        1\nMir124.2hg     -4.476e-01  5.715e+04       0        1\nClstn2          6.641e-02  1.335e+05       0        1\nFat3           -6.251e-02  7.592e+04       0        1\nKcnh7          -1.409e-01  7.908e+04       0        1\nUsp29           5.262e-01  6.689e+04       0        1\nCd47            1.150e-01  7.403e+04       0        1\nRyr3            5.436e-02  7.676e+04       0        1\nNeto2          -5.954e-01  7.823e+04       0        1\nPpm1e           2.734e-02  5.762e+04       0        1\nMdga2          -3.037e-01  6.828e+04       0        1\nSerpini1       -2.279e-01  6.710e+04       0        1\nRalyl          -3.333e-01  6.759e+04       0        1\nNrcam           2.232e-01  1.150e+05       0        1\nRobo2           2.814e-01  9.011e+04       0        1\nCsrnp3          1.767e-01  7.869e+04       0        1\nHist3h2ba      -3.469e-01  7.690e+04       0        1\nJakmip1         1.356e-01  7.326e+04       0        1\nEdil3          -2.647e-01  7.989e+04       0        1\nEnox1          -4.503e-01  6.109e+04       0        1\nRprm           -1.513e-01  1.041e+05       0        1\nOlfm1          -6.746e-01  7.031e+04       0        1\nTmem178b       -6.360e-01  6.559e+04       0        1\nGng3           -5.081e-01  8.182e+04       0        1\nCntn2          -2.800e-01  7.506e+04       0        1\nScg3            1.798e-01  5.612e+04       0        1\nGnao1           1.006e+00  4.654e+04       0        1\nSerp2           5.087e-01  8.963e+04       0        1\nPcdh9           9.910e-02  5.588e+04       0        1\nTrim2           2.664e-01  8.437e+04       0        1\nNrg1            2.084e-01  6.518e+04       0        1\nPpfia2         -6.617e-01  8.399e+04       0        1\nCacna2d1       -8.806e-02  7.202e+04       0        1\nUqcrq           2.511e-01  1.384e+05       0        1\nBex3           -1.669e-01  1.273e+05       0        1\nRan             6.620e-01  1.443e+05       0        1\nAtp5c1         -3.353e-02  1.578e+05       0        1\nEif3k           4.805e-01  9.930e+04       0        1\nPpp1cb          1.551e-01  8.017e+04       0        1\nNdufaf2         3.192e-01  7.689e+04       0        1\nHmgb3          -1.110e-01  1.016e+05       0        1\nRps10           1.630e+00  1.090e+05       0        1\nRae1            5.199e-01  6.981e+04       0        1\nMbd3           -1.298e-01  9.411e+04       0        1\nEif3c           2.232e-01  8.238e+04       0        1\nHnrnpab         1.182e-01  1.083e+05       0        1\nRpl12           1.191e+00  9.106e+04       0        1\nRps15a          1.110e+00  2.237e+05       0        1\nRpl13a          8.337e-01  1.355e+05       0        1\nRpl31          -8.657e-01  1.168e+05       0        1\nRplp1          -1.786e+00  1.248e+05       0        1\nHspe1           1.058e+00  8.584e+04       0        1\nRps12           4.517e-01  1.105e+05       0        1\nRanbp1         -1.202e-01  1.214e+05       0        1\nRpl39          -1.539e-01  8.027e+04       0        1\nRps26           7.116e-01  1.420e+05       0        1\nRplp2           2.593e-02  1.459e+05       0        1\nRps13           1.006e+00  2.209e+05       0        1\nRps3            1.605e-01  2.148e+05       0        1\nRps20           6.931e-01  7.584e+04       0        1\nSnrpg           5.178e-01  1.196e+05       0        1\nRps21           2.324e-01  1.049e+05       0        1\nNme1            3.016e-01  8.911e+04       0        1\nUqcrh           9.312e-01  1.231e+05       0        1\nRpl38           1.087e+00  1.152e+05       0        1\nRps3a1          8.552e-01  2.686e+05       0        1\nRps25          -5.472e-01  1.139e+05       0        1\nPfdn5           1.396e+00  1.746e+05       0        1\nSaraf           1.785e-01  6.476e+04       0        1\nRps28           1.238e+00  7.323e+04       0        1\nRps27           1.297e+00  1.003e+05       0        1\nRpl37           3.752e-01  1.768e+05       0        1\nGnaq           -8.034e-01  7.836e+04       0        1\nPomp            4.339e-01  1.233e+05       0        1\nRps18           6.575e-01  1.207e+05       0        1\nRpl34          -2.467e-01  1.259e+05       0        1\nRps29          -3.668e-02  9.681e+04       0        1\nPpdpf          -2.466e-01  1.106e+05       0        1\nPfn1            6.434e-01  2.141e+05       0        1\nRpl27          -4.516e-01  1.775e+05       0        1\nAtp5j2         -1.048e+00  8.517e+04       0        1\nPdia3          -3.402e-02  6.777e+04       0        1\nRpl35          -3.067e-01  2.143e+05       0        1\nSbf2            9.417e-02  5.697e+04       0        1\nCrip2          -3.933e-01  1.004e+05       0        1\nTpt1            1.063e+00  1.331e+05       0        1\nRpl35a          9.226e-01  7.634e+04       0        1\nX4930402H24Rik  9.828e-02  8.299e+04       0        1\nPpm1l          -1.593e-01  7.842e+04       0        1\nItfg1          -5.603e-02  6.805e+04       0        1\nLarge1         -6.845e-01  9.282e+04       0        1\nKtn1           -8.549e-02  5.866e+04       0        1\nDdah2          -6.620e-01  8.598e+04       0        1\nSumo1           1.256e+00  8.659e+04       0        1\nNipsnap3b      -1.015e-01  6.388e+04       0        1\nDynlrb1        -8.849e-02  1.269e+05       0        1\nSvbp           -6.846e-01  1.063e+05       0        1\nTmem57          2.613e-01  8.641e+04       0        1\nAcat2          -4.663e-02  6.863e+04       0        1\nHmgcs1          6.751e-02  8.690e+04       0        1\nPrmt2           2.628e-01  7.913e+04       0        1\nKif1a          -7.816e-01  7.952e+04       0        1\nAtp5o.1         1.438e+00  8.623e+04       0        1\nAtp6v1g1       -5.073e-01  1.624e+05       0        1\nCamta1         -1.516e-01  8.179e+04       0        1\nTnrc6c         -3.085e-01  6.284e+04       0        1\nKifap3         -7.520e-01  5.213e+04       0        1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 5.1795e+02  on 431  degrees of freedom\nResidual deviance: 2.7747e-10  on 281  degrees of freedom\nAIC: 302\n\nNumber of Fisher Scoring iterations: 28\n\n# Make predictions\nprobabilities &lt;- model %&gt;% predict(test.data, type = \"response\")\npredicted.classes &lt;- ifelse(probabilities &gt; 0.5, \"1\", \"0\")\n# Model accuracy\naccuracy &lt;- mean(predicted.classes == test.data$COTAN_Cl.code)\nresult.df[nrow(result.df),\"Accuracy\"] &lt;- accuracy\n\naccuracy\n\n[1] 0.9166667\n\n\nSo also in this case a logistic regression confirm the difference in cell population detected by COTAN.\n\ncl511ClsMarkers &lt;- findClustersMarkers(cl511,n = 200,adjustmentMethod = \"BH\")\ncl511ClsMarkers\n\n    CL           Gene        DEA      adjPVal IsMarker  logFoldCh\n1    1          Rps12 -0.4631574 6.179304e-23        0 -0.6825116\n2    1          Atp5e -0.4421507 5.491674e-21        0 -0.6826112\n3    1          Rpl12 -0.4249280 2.145989e-19        0 -0.5752903\n4    1         Gm2000 -0.4178094 8.266734e-19        0 -0.7062262\n5    1          Rpl27 -0.4101463 3.545306e-18        0 -0.4851285\n6    1          Rpl35 -0.4095642 3.545306e-18        0 -0.6420850\n7    1          Rpl38 -0.3944000 8.478137e-17        0 -0.4901851\n8    1          Rpl34 -0.3839938 6.783729e-16        0 -0.5340951\n9    1         Rpl13a -0.3816076 9.935167e-16        0 -0.4674161\n10   1          Rps27 -0.3776191 2.046247e-15        0 -0.5241613\n11   1           Rps3 -0.3674962 1.463958e-14        0 -0.5091646\n12   1          Rps21 -0.3610531 4.848936e-14        0 -0.4306092\n13   1          Rps13 -0.3572065 9.536353e-14        0 -0.4967312\n14   1          Rps29 -0.3548193 1.410408e-13        0 -0.4107293\n15   1          Uqcrh -0.3468007 6.147911e-13        0 -0.4208264\n16   1         Rps15a -0.3458429 6.912919e-13        0 -0.5734880\n17   1          Pfdn5 -0.3412558 1.543625e-12        0 -0.4357714\n18   1         Uqcr10 -0.3369860 3.225511e-12        0 -0.4964385\n19   1          Rps26 -0.3311185 8.957326e-12        0 -0.5340777\n20   1          Rps18 -0.3305680 9.404136e-12        0 -0.4596902\n21   1           Tpt1 -0.3299757 9.821432e-12        0 -0.4076206\n22   1           Pomp -0.3298025 9.821432e-12        0 -0.4368943\n23   1          Uqcrq -0.3293949 1.011334e-11        0 -0.4547596\n24   1          Rps10 -0.3272393 1.429376e-11        0 -0.4795864\n25   1         Timm8b -0.3243765 2.202010e-11        0 -0.4229584\n26   1          Rps25 -0.3237942 2.352031e-11        0 -0.4375944\n27   1           Pfn1 -0.3207294 3.901832e-11        0 -0.4524917\n28   1       Atp6v1g1 -0.3200480 4.247356e-11        0 -0.3852555\n29   1         Snrpd2 -0.3191408 4.809087e-11        0 -0.4236104\n30   1      Hist3h2ba -0.3189606 4.809087e-11        0 -0.4143786\n31   1          Rpl37 -0.3182726 5.113078e-11        0 -0.5620636\n32   1         Ndufs6 -0.3181898 5.113078e-11        0 -0.4034311\n33   1        Atp5o.1 -0.3180827 5.113078e-11        0 -0.4328550\n34   1         Snrpd1 -0.3153742 7.959216e-11        0 -0.4110424\n35   1        Dynlrb1 -0.3138158 1.013177e-10        0 -0.4016523\n36   1         Uqcr11 -0.3127960 1.175129e-10        0 -0.3977030\n37   1         Rpl35a -0.3107331 1.629691e-10        0 -0.4733195\n38   1           Btf3 -0.3105683 1.633253e-10        0 -0.3262416\n39   1           Swi5 -0.3089875 2.084660e-10        0 -0.3992487\n40   1          Rps20 -0.3085851 2.163449e-10        0 -0.4357840\n41   1          Rps28 -0.3084818 2.163449e-10        0 -0.3976983\n42   1          Rpl31 -0.3080980 2.255272e-10        0 -0.3883420\n43   1         Ndufa7 -0.3058711 3.210511e-10        0 -0.3983718\n44   1           Tbca -0.3008359 7.277351e-10        0 -0.4041754\n45   1          Snrpb -0.3004162 7.631375e-10        0 -0.3556668\n46   1          Rplp2 -0.2994340 8.784554e-10        0 -0.3876488\n47   1          Rpl28 -0.2980796 1.052945e-09        0 -0.4146471\n48   1          Uqcc2 -0.2963589 1.340886e-09        0 -0.5371598\n49   1          Rpl36 -0.2959873 1.397320e-09        0 -0.3646947\n50   1           Edf1 -0.2907873 3.178356e-09        0 -0.3900142\n51   1          Fkbp3 -0.2887652 4.309332e-09        0 -0.3556366\n52   1          Rps24 -0.2855195 6.948539e-09        0 -0.4770224\n53   1           Gpx4 -0.2835266 9.334702e-09        0 -0.3245309\n54   1           Bex3 -0.2811619 1.303730e-08        0 -0.3180195\n55   1          Rps16 -0.2797315 1.599893e-08        0 -0.4247866\n56   1          Tomm7 -0.2794463 1.619178e-08        0 -0.4093449\n57   1          Hspe1 -0.2791884 1.656933e-08        0 -0.3462706\n58   1         Chchd1 -0.2776055 2.048508e-08        0 -0.4354694\n59   1          Rpl17 -0.2772519 2.129819e-08        0 -0.5191041\n60   1          Atp5k -0.2762977 2.391943e-08        0 -0.4740455\n61   1           Svbp -0.2760335 2.454234e-08        0 -0.3014819\n62   1         Atp5c1 -0.2745657 3.024473e-08        0 -0.2363772\n63   1          Eif3k -0.2733174 3.508935e-08        0 -0.3840566\n64   1          Sumo1 -0.2733073 3.508935e-08        0 -0.2914956\n65   1         Timm13 -0.2727718 3.702865e-08        0 -0.3686286\n66   1         Mrpl30 -0.2720558 4.017398e-08        0 -0.4749261\n67   1           Sem1 -0.2709400 4.629720e-08        0 -0.3741535\n68   1          Usmg5 -0.2698157 5.342106e-08        0 -0.3823320\n69   1          Rpl22 -0.2684437 6.472822e-08        0 -0.3428325\n70   1          Snrpg -0.2676395 7.204825e-08        0 -0.3005801\n71   1          Snrpf -0.2669220 7.916026e-08        0 -0.3441404\n72   1           Txn1 -0.2665875 8.218961e-08        0 -0.3887734\n73   1         Rps3a1 -0.2649592 1.008742e-07        0 -0.4636491\n74   1           Nol7 -0.2647717 1.025205e-07        0 -0.4529087\n75   1         Myl12b -0.2633126 1.217868e-07        0 -0.3769849\n76   1          Rpl7a -0.2628953 1.276785e-07        0 -0.3803800\n77   1          Cirbp -0.2626861 1.302382e-07        0 -0.2427524\n78   1         Ndufv3 -0.2624217 1.339336e-07        0 -0.3777157\n79   1         Rps27l -0.2612837 1.563403e-07        0 -0.5679664\n80   1         Rpl37a -0.2606170 1.704016e-07        0 -0.5219644\n81   1           Cycs -0.2595830 1.938262e-07        0 -0.3851088\n82   1         Rpl36a -0.2587267 2.134566e-07        0 -0.2850982\n83   1        Anapc13 -0.2587054 2.134566e-07        0 -0.4999552\n84   1          Smdt1 -0.2574564 2.478866e-07        0 -0.3049345\n85   1           Sdhb -0.2573936 2.478866e-07        0 -0.3655544\n86   1         Mrpl52 -0.2566519 2.729649e-07        0 -0.3746260\n87   1         Ranbp1 -0.2564555 2.745307e-07        0 -0.2617357\n88   1 X0610012G03Rik -0.2564191 2.745307e-07        0 -0.4450968\n89   1         Csnk2b -0.2562342 2.750654e-07        0 -0.3913248\n90   1          Rps17 -0.2562178 2.750654e-07        0 -0.4469891\n91   1         Chchd2 -0.2560472 2.793599e-07        0 -0.4363077\n92   1          Rpl21 -0.2552685 3.066352e-07        0 -0.3799537\n93   1          Hmgb1 -0.2548369 3.231737e-07        0 -0.3340397\n94   1         Mrpl28 -0.2536164 3.806468e-07        0 -0.4316112\n95   1          Rtraf -0.2534402 3.869427e-07        0 -0.2697156\n96   1          Cops9 -0.2500670 5.951063e-07        0 -0.3814245\n97   1          Atox1 -0.2499292 5.970482e-07        0 -0.4098502\n98   1          Rplp1 -0.2493355 6.431863e-07        0 -0.4307723\n99   1         Hnrnpc -0.2478595 7.764310e-07        0 -0.2664530\n100  1         Mrps17 -0.2474809 8.116952e-07        0 -0.4752512\n101  1           Vapa -0.2468766 8.721894e-07        0 -0.2749610\n102  1          Hmgn1 -0.2467652 8.754427e-07        0 -0.2649146\n103  1          Rps23 -0.2450458 1.067455e-06        0 -0.4578971\n104  1          Atp5h -0.2448166 1.093425e-06        0 -0.3256882\n105  1        Tmem256 -0.2442493 1.164429e-06        0 -0.3865038\n106  1         Dctpp1 -0.2439550 1.203392e-06        0 -0.2977997\n107  1        Hnrnpab -0.2435611 1.243292e-06        0 -0.2954051\n108  1          Pcbp2 -0.2424633 1.432268e-06        0 -0.3170388\n109  1         Tceal9 -0.2415600 1.595730e-06        0 -0.2648281\n110  1        Lamtor5 -0.2396741 2.026750e-06        0 -0.4350606\n111  1        Ndufb10 -0.2369256 2.845753e-06        0 -0.2863959\n112  1          Cox7c -0.2369182 2.845753e-06        0 -0.2824851\n113  1           Oaz1 -0.2366414 2.932600e-06        0 -0.2739040\n114  1         Scand1 -0.2362110 3.045776e-06        0 -0.4189525\n115  1         Polr2j -0.2362091 3.045776e-06        0 -0.2842206\n116  1          Rpl10 -0.2359108 3.147805e-06        0 -0.4748902\n117  1          Pfdn4 -0.2355480 3.280891e-06        0 -0.4199890\n118  1          Rps19 -0.2350084 3.456874e-06        0 -0.5025216\n119  1         Rpl10a -0.2349587 3.458358e-06        0 -0.3144984\n120  1           Nme1 -0.2348907 3.468223e-06        0 -0.2836137\n121  1          Arpc3 -0.2343649 3.670787e-06        0 -0.3467814\n122  1            Ran -0.2336881 3.939102e-06        0 -0.2541407\n123  1           Rnf7 -0.2330448 4.257928e-06        0 -0.3808571\n124  1           Bex2 -0.2329246 4.299934e-06        0 -0.2931452\n125  1         Snrpd3 -0.2324171 4.517130e-06        0 -0.4085823\n126  1        Gm10260 -0.2324063 4.517130e-06        0 -0.3556503\n127  1          Cox7b -0.2323683 4.517130e-06        0 -0.2699185\n128  1          H2afz -0.2321814 4.601751e-06        0 -0.3482270\n129  1          Ddah2 -0.2317266 4.853274e-06        0 -0.3249683\n130  1           Tbcb -0.2312374 5.112467e-06        0 -0.2296635\n131  1         Atp5j2 -0.2304235 5.636766e-06        0 -0.2909852\n132  1         Cox6b1 -0.2303935 5.636766e-06        0 -0.2710346\n133  1          Atp5j -0.2299245 5.889998e-06        0 -0.2785515\n134  1        Uqcrfs1 -0.2295070 6.115004e-06        0 -0.2729393\n135  1         Txnl4a -0.2284923 6.924840e-06        0 -0.4264706\n136  1         Mrps24 -0.2284003 6.969881e-06        0 -0.4010231\n137  1 X1110004F10Rik -0.2278742 7.413813e-06        0 -0.2576501\n138  1            Mif -0.2278143 7.431771e-06        0 -0.3175502\n139  1         Mrpl18 -0.2263196 8.711184e-06        0 -0.3538738\n140  1          Crip2 -0.2262740 8.717744e-06        0 -0.2328728\n141  1          Hsbp1 -0.2253209 9.566588e-06        0 -0.2581882\n142  1          Rpl19 -0.2253162 9.566588e-06        0 -0.3885120\n143  1          Rps11 -0.2251889 9.657436e-06        0 -0.3842770\n144  1         Rpl23a -0.2250230 9.813642e-06        0 -0.4333352\n145  1           Ubl5 -0.2248595 9.969336e-06        0 -0.3088737\n146  1        Ndufab1 -0.2238181 1.114580e-05        0 -0.3859670\n147  1         Atp5g1 -0.2231727 1.188843e-05        0 -0.2660431\n148  1           Rps6 -0.2231526 1.188843e-05        0 -0.3939822\n149  1          Eif3h -0.2230063 1.205170e-05        0 -0.2308491\n150  1          Pdcd5 -0.2227795 1.232027e-05        0 -0.3465369\n151  1         Zfp706 -0.2225782 1.248254e-05        0 -0.2112568\n152  1         Abracl -0.2213980 1.419549e-05        0 -0.2750669\n153  1          Pfdn6 -0.2209395 1.476171e-05        0 -0.4071708\n154  1          Prdx5 -0.2209157 1.476171e-05        0 -0.2559431\n155  1          Calm3 -0.2207705 1.494358e-05        0 -0.2573251\n156  1         Rex1bd -0.2205505 1.528890e-05        0 -0.4203590\n157  1            Esd -0.2203731 1.556032e-05        0 -0.2975594\n158  1          Psma2 -0.2203299 1.557673e-05        0 -0.2819089\n159  1         Dynll1 -0.2199227 1.610340e-05        0 -0.3676117\n160  1          Rpl15 -0.2194056 1.680821e-05        0 -0.2895195\n161  1          Glrx3 -0.2183435 1.868363e-05        0 -0.1083442\n162  1        Selenow -0.2181378 1.885712e-05        0 -0.3930863\n163  1           Gpx1 -0.2178310 1.949947e-05        0 -0.5381608\n164  1         Ndufa2 -0.2176474 1.980926e-05        0 -0.3264260\n165  1         Sec61b -0.2175938 1.983788e-05        0 -0.3811968\n166  1         Mrpl58 -0.2174523 1.995077e-05        0 -0.4914635\n167  1          Psma7 -0.2172906 2.020019e-05        0 -0.2739562\n168  1          Bcas2 -0.2172874 2.020019e-05        0 -0.3158613\n169  1          Srp14 -0.2170688 2.066579e-05        0 -0.2990073\n170  1          Nop10 -0.2166143 2.148915e-05        0 -0.3118031\n171  1         Rpl27a -0.2166118 2.148915e-05        0 -0.2738241\n172  1         Eif2s2 -0.2163760 2.189740e-05        0 -0.2296548\n173  1       Trappc2l -0.2156588 2.366951e-05        0 -0.3406024\n174  1          H3f3a -0.2155267 2.374037e-05        0 -0.3079225\n175  1         Gtf2h5 -0.2153756 2.409031e-05        0 -0.3434282\n176  1           Sub1 -0.2151238 2.465546e-05        0 -0.2508421\n177  1           Naca -0.2145087 2.636167e-05        0 -0.3565910\n178  1           Rpl7 -0.2135409 2.888891e-05        0 -0.3706477\n179  1          Ppdpf -0.2133283 2.942934e-05        0 -0.3391216\n180  1          Rpl24 -0.2132538 2.959067e-05        0 -0.4690503\n181  1        Gm10076 -0.2127651 3.115539e-05        0 -0.4772046\n182  1         Ndufb2 -0.2126279 3.145520e-05        0 -0.3525210\n183  1         Cox7a2 -0.2122745 3.258735e-05        0 -0.2379424\n184  1          Rpl18 -0.2119888 3.360081e-05        0 -0.2748972\n185  1           Rpl5 -0.2112880 3.615233e-05        0 -0.2924973\n186  1           Jund -0.2110193 3.712070e-05        0 -0.2279356\n187  1         Ndufc1 -0.2110091 3.712070e-05        0 -0.3252872\n188  1         Ndufb4 -0.2104183 3.954536e-05        0 -0.3979775\n189  1         Rps27a -0.2103446 3.976090e-05        0 -0.4295827\n190  1          Slirp -0.2102817 3.992712e-05        0 -0.4121032\n191  1            Fau -0.2100702 4.080285e-05        0 -0.4027868\n192  1         Ndufb8 -0.2095109 4.343912e-05        0 -0.2659853\n193  1        Txndc17 -0.2090668 4.521167e-05        0 -0.3694520\n194  1          Rpl32 -0.2083948 4.832366e-05        0 -0.5548520\n195  1          Ap2s1 -0.2082741 4.880111e-05        0 -0.2605882\n196  1        Gabarap -0.2080173 4.988644e-05        0 -0.2959616\n197  1        Smarcb1 -0.2080058 4.988644e-05        0 -0.2851375\n198  1          H2afj -0.2078339 5.073976e-05        0 -0.3315896\n199  1         Cacybp -0.2065095 5.741582e-05        0 -0.2614856\n200  1           Grm8 -0.2057302 6.118469e-05        0 -0.4215947\n201  1         Spock1  0.3251712 1.987472e-11        0  0.4817711\n202  1          Itfg1  0.2992721 8.834105e-10        0  0.3776583\n203  1        Serinc1  0.2965515 1.325342e-09        0  0.3825097\n204  1          Mdga2  0.2874687 5.199010e-09        0  0.4623846\n205  1           Ctsz  0.2824571 1.084179e-08        0  0.3565810\n206  1           Ryr3  0.2794415 1.619178e-08        0  0.4376830\n207  1          Ntrk3  0.2778532 2.002950e-08        0  0.3451647\n208  1          Mef2c  0.2768192 2.241673e-08        0  0.3636640\n209  1        Atp6ap2  0.2740521 3.223350e-08        0  0.3668009\n210  1         Sec11a  0.2731492 3.545140e-08        0  0.3837498\n211  1          Kat6b  0.2721583 4.007938e-08        0  0.4746228\n212  1        Atp6ap1  0.2712290 4.490246e-08        0  0.4142084\n213  1         Ctnnd2  0.2699332 5.314820e-08        0  0.3439896\n214  1           E2f7  0.2657007 9.256857e-08        0  0.8375014\n215  1           Sez6  0.2651659 9.898526e-08        0  0.3790612\n216  1         Tspan6  0.2641584 1.109053e-07        0  0.3765847\n217  1            App  0.2634301 1.217868e-07        0  0.3262137\n218  1          Mmp16  0.2632929 1.217868e-07        0  0.4886848\n219  1          Pcdh7  0.2605192 1.710786e-07        0  0.5049982\n220  1         Tspan3  0.2587958 2.134566e-07        0  0.2605555\n221  1          Aplp1  0.2586314 2.136606e-07        0  0.3496143\n222  1       Tmem131l  0.2581351 2.272127e-07        0  0.3784208\n223  1        Tspan14  0.2564934 2.745307e-07        0  0.3872160\n224  1         Igfbp2  0.2563489 2.748074e-07        0  0.3220609\n225  1         Arpp21  0.2559159 2.821614e-07        0  0.4396613\n226  1          Cadm1  0.2524424 4.414279e-07        0  0.4311111\n227  1         Slc1a3  0.2518736 4.739210e-07        0  0.5677610\n228  1          Qsox1  0.2518176 4.739210e-07        0  0.9440026\n229  1         Srgap1  0.2516320 4.824444e-07        0  0.3802237\n230  1          Dclk2  0.2499866 5.970152e-07        0  0.4091429\n231  1            Nin  0.2489162 6.763137e-07        0  0.3054527\n232  1        Txndc12  0.2468470 8.721894e-07        0  0.4258825\n233  1          Ssbp2  0.2459584 9.673892e-07        0  0.3774376\n234  1          Hspa5  0.2459273 9.673892e-07        0  0.3800562\n235  1            St7  0.2456147 1.002214e-06        0  0.4031442\n236  1           Rpn2  0.2451179 1.064678e-06        0  0.3923588\n237  1          Tusc3  0.2444387 1.142901e-06        0  0.3801631\n238  1          Tanc2  0.2438393 1.213928e-06        0  0.3503723\n239  1          Cntn1  0.2437268 1.224079e-06        0  0.4232511\n240  1        Kirrel3  0.2422930 1.455623e-06        0  0.4714545\n241  1          Stmn4  0.2398730 1.986851e-06        0  0.3311401\n242  1          Nfasc  0.2394718 2.068456e-06        0  0.4271409\n243  1           Copa  0.2370049 2.845753e-06        0  0.3776922\n244  1         Tmem59  0.2363463 3.029398e-06        0  0.2633921\n245  1           Psap  0.2354093 3.320500e-06        0  0.3226806\n246  1         Slc8a1  0.2351693 3.405560e-06        0  0.2340766\n247  1           Nrg3  0.2345848 3.588172e-06        0  0.3859916\n248  1           Cdh2  0.2342571 3.700757e-06        0  0.3735728\n249  1           Nptn  0.2336952 3.939102e-06        0  0.3492779\n250  1           Scg5  0.2327820 4.355076e-06        0  0.3128342\n251  1          Sgip1  0.2314536 4.999485e-06        0  0.3421051\n252  1        Arl6ip1  0.2302790 5.689163e-06        0  0.3017192\n253  1           Aig1  0.2299854 5.875742e-06        0  0.2858523\n254  1         Dnajc1  0.2298029 5.950542e-06        0  0.3192334\n255  1           Eya3  0.2295743 6.094840e-06        0  0.4881567\n256  1          Scn2a  0.2275217 7.673573e-06        0  0.3877597\n257  1          Neto2  0.2272724 7.854626e-06        0  0.3386953\n258  1          Ccnl2  0.2272571 7.854626e-06        0  0.2805397\n259  1           Snd1  0.2266029 8.489998e-06        0  0.4687846\n260  1           Itch  0.2264309 8.632912e-06        0  0.4055109\n261  1           Smg5  0.2258127 9.194418e-06        0  0.4186320\n262  1         Dhcr24  0.2257498 9.221748e-06        0  0.5983321\n263  1         Atp2b1  0.2256716 9.267149e-06        0  0.3856881\n264  1           Ctsb  0.2253026 9.566588e-06        0  0.3407802\n265  1           Nav3  0.2247291 1.008567e-05        0  0.2492735\n266  1        Fam214a  0.2245914 1.021286e-05        0  0.5798609\n267  1         Hs2st1  0.2245436 1.022577e-05        0  0.4343860\n268  1          Acvr1  0.2237108 1.124361e-05        0  0.4732941\n269  1        Gm43507  0.2233813 1.166148e-05        0  0.6365634\n270  1          Tmtc1  0.2227560 1.232027e-05        0  0.5203901\n271  1       Slc39a10  0.2227061 1.234105e-05        0  0.4692922\n272  1           Chga  0.2220755 1.322746e-05        0  0.4003207\n273  1          Nell2  0.2219452 1.338310e-05        0  0.3165228\n274  1            Tox  0.2217236 1.369482e-05        0  0.2845122\n275  1       Tmem185b  0.2212082 1.446869e-05        0  0.6700758\n276  1           Arnt  0.2211667 1.447939e-05        0  0.5088107\n277  1          Ttc17  0.2209047 1.476171e-05        0  0.4843724\n278  1         Anks1b  0.2202085 1.574453e-05        0  0.2459429\n279  1         Tmbim6  0.2201693 1.575400e-05        0  0.2638407\n280  1       Slc38a10  0.2199521 1.610340e-05        0  0.3700007\n281  1          Olfm2  0.2198541 1.617231e-05        0  0.3518482\n282  1          Kcnq5  0.2195847 1.664727e-05        0  0.4272948\n283  1         Kcnk10  0.2194963 1.675960e-05        0  0.3138762\n284  1           P3h4  0.2194473 1.679117e-05        0  0.8099715\n285  1        Tmem35a  0.2192435 1.707587e-05        0  0.4109415\n286  1            Boc  0.2191374 1.722917e-05        0  0.6010687\n287  1           Akt3  0.2187568 1.797847e-05        0  0.2628117\n288  1            Por  0.2186967 1.800140e-05        0  0.4889486\n289  1        Carmil1  0.2186805 1.800140e-05        0  0.2887406\n290  1           Mtdh  0.2182782 1.875823e-05        0  0.2807799\n291  1        Slc6a15  0.2181696 1.885712e-05        0  0.4716892\n292  1         Leprot  0.2181468 1.885712e-05        0  0.2951880\n293  1        Slc20a1  0.2176376 1.980926e-05        0  0.4314969\n294  1          Klf12  0.2175271 1.992265e-05        0  0.4983598\n295  1          H2.D1  0.2174530 1.995077e-05        0  0.3639213\n296  1          Saraf  0.2170315 2.068118e-05        0  0.3081942\n297  1       Tmem184c  0.2168042 2.118017e-05        0  0.3225185\n298  1          Fgf14  0.2165924 2.148915e-05        0  0.2876250\n299  1        Tmem108  0.2165529 2.151223e-05        0  0.3562990\n300  1          Lrp11  0.2160417 2.271805e-05        0  0.3773354\n301  1           Ldb2  0.2156172 2.366951e-05        0  0.2939618\n302  1           Syt1  0.2155833 2.366951e-05        0  0.3450811\n303  1        Cacna1c  0.2155815 2.366951e-05        0  0.3207911\n304  1          Csmd2  0.2151751 2.459131e-05        0  0.3452957\n305  1          Grik2  0.2145339 2.636167e-05        0  0.4514875\n306  1           Rcn2  0.2144294 2.652000e-05        0  0.2854721\n307  1         Grin2b  0.2143889 2.655527e-05        0  0.3129156\n308  1            Os9  0.2141573 2.720820e-05        0  0.3525981\n309  1         Fnbp1l  0.2141115 2.726253e-05        0  0.2614826\n310  1         Elovl5  0.2136834 2.859818e-05        0  0.5763508\n311  1         Rnf145  0.2135605 2.888891e-05        0  0.3942400\n312  1         Tnrc6c  0.2134860 2.897903e-05        0  0.2655012\n313  1         Ift172  0.2131423 2.988534e-05        0  0.7273950\n314  1         Setbp1  0.2126505 3.145520e-05        0  0.2808616\n315  1         Lrpap1  0.2123968 3.222429e-05        0  0.2556996\n316  1          Cdkl5  0.2119231 3.375163e-05        0  0.3911032\n317  1        Tmem63b  0.2116532 3.473486e-05        0  0.3875314\n318  1         Clstn2  0.2109563 3.723062e-05        0  0.3872830\n319  1           Calr  0.2092966 4.440350e-05        0  0.2802238\n320  1         Cdc14b  0.2092583 4.446097e-05        0  0.7198813\n321  1          Dock3  0.2090612 4.521167e-05        0  0.3741515\n322  1          Ddx50  0.2090289 4.523908e-05        0  0.2860189\n323  1         Ormdl3  0.2087933 4.635939e-05        0  0.3832619\n324  1          Foxp2  0.2083850 4.832366e-05        0  0.5684095\n325  1          Ntrk2  0.2080868 4.972509e-05        0  0.5329103\n326  1          Magi1  0.2076794 5.148581e-05        0  0.4553671\n327  1           Rgma  0.2076559 5.148581e-05        0  0.5780725\n328  1         Ergic2  0.2075656 5.187083e-05        0  0.2655840\n329  1         Zfp846  0.2071862 5.404855e-05        0  0.2995412\n330  1           Sybu  0.2070890 5.449645e-05        0  0.3264942\n331  1        Dync1i1  0.2069879 5.481618e-05        0  0.3032658\n332  1          Camkv  0.2069864 5.481618e-05        0  0.4211762\n333  1          Llgl1  0.2068048 5.581613e-05        0  0.4266499\n334  1           Alg6  0.2066856 5.642350e-05        0  0.9009502\n335  1           Lnpk  0.2063438 5.814647e-05        0  0.3247704\n336  1        Gm20517  0.2063231 5.814647e-05        0  1.1410193\n337  1          Spon1  0.2063231 5.814647e-05        0  1.0616953\n338  1          Trpm3  0.2061229 5.929493e-05        0  0.6898117\n339  1         Pgrmc1  0.2061031 5.929493e-05        0  0.3026805\n340  1           Ctsl  0.2060444 5.952276e-05        0  0.2874709\n341  1        B3galt1  0.2059271 6.015918e-05        0  0.3441872\n342  1        B3galt2  0.2057494 6.118469e-05        0  0.3838402\n343  1        Ldlrad4  0.2054385 6.309715e-05        0  0.3296407\n344  1            Cpe  0.2052019 6.465516e-05        0  0.3516827\n345  1           Emc3  0.2049225 6.619369e-05        0  0.3590846\n346  1          Ttc19  0.2048293 6.671582e-05        0  0.4082099\n347  1       Adamts18  0.2044224 6.971209e-05        0  0.3869474\n348  1         Scube1  0.2040749 7.193151e-05        0  0.4709928\n349  1            Fry  0.2033546 7.767694e-05        0  0.2718307\n350  1          Csmd3  0.2030060 8.037958e-05        0  0.5650582\n351  1          Cd200  0.2028440 8.133106e-05        0  0.2797321\n352  1          Flrt2  0.2028171 8.133106e-05        0  0.4293102\n353  1         Atraid  0.2028083 8.133106e-05        0  0.3129678\n354  1         Alkbh1  0.2026368 8.267641e-05        0  0.4014083\n355  1        Gm26835  0.2023977 8.449163e-05        0  0.4222330\n356  1        Phactr1  0.2021293 8.687322e-05        0  0.2632504\n357  1          Foxp1  0.2015481 9.229412e-05        0  0.2580225\n358  1        Cacna1e  0.2014218 9.336938e-05        0  0.3844196\n359  1           Ssr2  0.2012809 9.461454e-05        0  0.2615975\n360  1         Dopey1  0.2009499 9.769588e-05        0  0.3199163\n361  1         Hivep2  0.2003740 1.034248e-04        0  0.3244790\n362  1          Gdpd1  0.1999223 1.085345e-04        0  0.2925950\n363  1       Tmem132a  0.1998304 1.093707e-04        0  0.2428495\n364  1           Ssh2  0.1996881 1.108396e-04        0  0.3329310\n365  1          Cxadr  0.1995267 1.124015e-04        0  0.3356759\n366  1        Zdhhc20  0.1994962 1.124015e-04        0  0.3232686\n367  1          Cspg5  0.1994202 1.128686e-04        0  0.5253050\n368  1          Ascc3  0.1988958 1.180109e-04        0  0.3602826\n369  1          Myo9a  0.1987511 1.196295e-04        0  0.3474970\n370  1         Nedd4l  0.1981704 1.269985e-04        0  0.2870636\n371  1          Scaf8  0.1978388 1.307762e-04        0  0.3909157\n372  1           Rbl2  0.1974549 1.356099e-04        0  0.7665457\n373  1          Nemp1  0.1974446 1.356099e-04        0  0.5981904\n374  1       B3galnt1  0.1973052 1.373818e-04        0  0.4204007\n375  1        Slitrk5  0.1971875 1.388396e-04        0  0.4541803\n376  1           Fat3  0.1970097 1.409003e-04        0  0.2584599\n377  1          Pdia6  0.1960866 1.555464e-04        0  0.2786742\n378  1         Rnf215  0.1960722 1.555464e-04        0  0.4738305\n379  1       Serpini1  0.1960223 1.556320e-04        0  0.3356833\n380  1         Plppr1  0.1957434 1.597088e-04        0  0.2795475\n381  1           Sbf2  0.1955265 1.623747e-04        0  0.3006908\n382  1         Rnf112  0.1954556 1.632493e-04        0  0.8890006\n383  1           Trio  0.1952968 1.653238e-04        0  0.2908840\n384  1        Slc38a9  0.1947229 1.752457e-04        0  0.3353488\n385  1           Meg3  0.1946101 1.770021e-04        0  0.3784197\n386  1          Adcy3  0.1943568 1.811160e-04        0  0.5909601\n387  1          Epha7  0.1943252 1.813108e-04        0  0.4107213\n388  1           St7l  0.1940574 1.849371e-04        0  0.3886257\n389  1         Arxes1  0.1939779 1.860660e-04        0  0.4383596\n390  1         Lrrtm3  0.1939585 1.860660e-04        0  0.5679511\n391  1         R3hdm4  0.1936969 1.905676e-04        0  0.2734504\n392  1           Tia1  0.1936105 1.919255e-04        0  0.2339791\n393  1            Dst  0.1934045 1.958332e-04        0  0.2589698\n394  1         Mycbp2  0.1933357 1.968488e-04        0  0.2335223\n395  1          Mgat2  0.1927568 2.086952e-04        0  0.2780917\n396  1           Gpc6  0.1926176 2.112865e-04        0  0.5501739\n397  1          Trpv2  0.1925152 2.127680e-04        0  1.1914960\n398  1          Lamp1  0.1923454 2.157697e-04        0  0.2363786\n399  1           Ktn1  0.1923440 2.157697e-04        0  0.3159114\n400  1         Tmem9b  0.1918165 2.269125e-04        0  0.3040203\n401  2         Spock1 -0.3251727 1.986918e-11        0 -0.4817711\n402  2          Itfg1 -0.2992747 8.830343e-10        0 -0.3776583\n403  2        Serinc1 -0.2965425 1.327300e-09        0 -0.3825097\n404  2          Mdga2 -0.2874719 5.196375e-09        0 -0.4623846\n405  2           Ctsz -0.2824553 1.084481e-08        0 -0.3565810\n406  2           Ryr3 -0.2794362 1.620516e-08        0 -0.4376830\n407  2          Ntrk3 -0.2778571 2.001761e-08        0 -0.3451647\n408  2          Mef2c -0.2768284 2.238544e-08        0 -0.3636640\n409  2        Atp6ap2 -0.2740471 3.225774e-08        0 -0.3668009\n410  2         Sec11a -0.2731475 3.546047e-08        0 -0.3837498\n411  2          Kat6b -0.2721645 4.004189e-08        0 -0.4746228\n412  2        Atp6ap1 -0.2712336 4.487202e-08        0 -0.4142084\n413  2         Ctnnd2 -0.2699454 5.305199e-08        0 -0.3439896\n414  2           E2f7 -0.2656917 9.269129e-08        0 -0.8375014\n415  2           Sez6 -0.2651659 9.898528e-08        0 -0.3790612\n416  2         Tspan6 -0.2641542 1.109735e-07        0 -0.3765847\n417  2            App -0.2634345 1.218616e-07        0 -0.3262137\n418  2          Mmp16 -0.2632887 1.218616e-07        0 -0.4886848\n419  2          Pcdh7 -0.2605182 1.711040e-07        0 -0.5049982\n420  2         Tspan3 -0.2587857 2.135807e-07        0 -0.2605555\n421  2          Aplp1 -0.2586243 2.138782e-07        0 -0.3496143\n422  2       Tmem131l -0.2581374 2.271400e-07        0 -0.3784208\n423  2        Tspan14 -0.2564871 2.746660e-07        0 -0.3872160\n424  2         Igfbp2 -0.2563473 2.748693e-07        0 -0.3220609\n425  2         Arpp21 -0.2559070 2.825174e-07        0 -0.4396613\n426  2          Cadm1 -0.2524469 4.411479e-07        0 -0.4311111\n427  2         Slc1a3 -0.2518730 4.741182e-07        0 -0.5677610\n428  2          Qsox1 -0.2517963 4.753354e-07        0 -0.9440026\n429  2         Srgap1 -0.2516370 4.821080e-07        0 -0.3802237\n430  2          Dclk2 -0.2499856 5.967449e-07        0 -0.4091429\n431  2            Nin -0.2489245 6.755454e-07        0 -0.3054527\n432  2        Txndc12 -0.2468445 8.724833e-07        0 -0.4258825\n433  2          Ssbp2 -0.2459592 9.670182e-07        0 -0.3774376\n434  2          Hspa5 -0.2459301 9.670182e-07        0 -0.3800562\n435  2            St7 -0.2456164 1.001978e-06        0 -0.4031442\n436  2           Rpn2 -0.2451161 1.064941e-06        0 -0.3923588\n437  2          Tusc3 -0.2444311 1.144088e-06        0 -0.3801631\n438  2          Tanc2 -0.2438380 1.214142e-06        0 -0.3503723\n439  2          Cntn1 -0.2437246 1.224446e-06        0 -0.4232511\n440  2        Kirrel3 -0.2422936 1.455520e-06        0 -0.4714545\n441  2          Stmn4 -0.2398701 1.987621e-06        0 -0.3311401\n442  2          Nfasc -0.2394724 2.068306e-06        0 -0.4271409\n443  2           Copa -0.2370107 2.844142e-06        0 -0.3776922\n444  2         Tmem59 -0.2363461 3.029473e-06        0 -0.2633921\n445  2           Psap -0.2354175 3.316905e-06        0 -0.3226806\n446  2         Slc8a1 -0.2351684 3.405950e-06        0 -0.2340766\n447  2           Nrg3 -0.2345814 3.589783e-06        0 -0.3859916\n448  2           Cdh2 -0.2342556 3.701484e-06        0 -0.3735728\n449  2           Nptn -0.2336996 3.937207e-06        0 -0.3492779\n450  2           Scg5 -0.2327845 4.353659e-06        0 -0.3128342\n451  2          Sgip1 -0.2314531 4.999791e-06        0 -0.3421051\n452  2        Arl6ip1 -0.2302800 5.688491e-06        0 -0.3017192\n453  2           Aig1 -0.2299782 5.881194e-06        0 -0.2858523\n454  2         Dnajc1 -0.2298092 5.945769e-06        0 -0.3192334\n455  2           Eya3 -0.2295670 6.100529e-06        0 -0.4881567\n456  2          Scn2a -0.2275122 7.682828e-06        0 -0.3877597\n457  2          Neto2 -0.2272673 7.854185e-06        0 -0.3386953\n458  2          Ccnl2 -0.2272576 7.854185e-06        0 -0.2805397\n459  2           Snd1 -0.2266094 8.483010e-06        0 -0.4687846\n460  2           Itch -0.2264373 8.625908e-06        0 -0.4055109\n461  2           Smg5 -0.2258205 9.185318e-06        0 -0.4186320\n462  2         Dhcr24 -0.2257463 9.225802e-06        0 -0.5983321\n463  2         Atp2b1 -0.2256641 9.275968e-06        0 -0.3856881\n464  2           Ctsb -0.2253017 9.567604e-06        0 -0.3407802\n465  2           Nav3 -0.2247205 1.009659e-05        0 -0.2492735\n466  2        Fam214a -0.2245869 1.021576e-05        0 -0.5798609\n467  2         Hs2st1 -0.2245514 1.021576e-05        0 -0.4343860\n468  2          Acvr1 -0.2237028 1.125479e-05        0 -0.4732941\n469  2        Gm43507 -0.2233956 1.164069e-05        0 -0.6365634\n470  2          Tmtc1 -0.2227576 1.231783e-05        0 -0.5203901\n471  2       Slc39a10 -0.2227101 1.233483e-05        0 -0.4692922\n472  2           Chga -0.2220672 1.324119e-05        0 -0.4003207\n473  2          Nell2 -0.2219414 1.338939e-05        0 -0.3165228\n474  2            Tox -0.2217279 1.368759e-05        0 -0.2845122\n475  2       Tmem185b -0.2212111 1.446357e-05        0 -0.6700758\n476  2           Arnt -0.2211700 1.447350e-05        0 -0.5088107\n477  2          Ttc17 -0.2209115 1.475035e-05        0 -0.4843724\n478  2         Anks1b -0.2201991 1.575077e-05        0 -0.2459429\n479  2         Tmbim6 -0.2201709 1.575077e-05        0 -0.2638407\n480  2       Slc38a10 -0.2199636 1.609008e-05        0 -0.3700007\n481  2          Olfm2 -0.2198471 1.618613e-05        0 -0.3518482\n482  2          Kcnq5 -0.2195901 1.663637e-05        0 -0.4272948\n483  2         Kcnk10 -0.2195041 1.674338e-05        0 -0.3138762\n484  2           P3h4 -0.2194235 1.681993e-05        0 -0.8099715\n485  2        Tmem35a -0.2192482 1.706599e-05        0 -0.4109415\n486  2            Boc -0.2191264 1.725252e-05        0 -0.6010687\n487  2           Akt3 -0.2187650 1.796032e-05        0 -0.2628117\n488  2            Por -0.2187058 1.800550e-05        0 -0.4889486\n489  2        Carmil1 -0.2186786 1.800550e-05        0 -0.2887406\n490  2           Mtdh -0.2182809 1.875207e-05        0 -0.2807799\n491  2        Slc6a15 -0.2181638 1.884053e-05        0 -0.4716892\n492  2         Leprot -0.2181450 1.884053e-05        0 -0.2951880\n493  2        Slc20a1 -0.2176394 1.980493e-05        0 -0.4314969\n494  2          Klf12 -0.2175232 1.993214e-05        0 -0.4983598\n495  2          H2.D1 -0.2174584 1.994929e-05        0 -0.3639213\n496  2          Saraf -0.2170244 2.069912e-05        0 -0.3081942\n497  2       Tmem184c -0.2167978 2.119660e-05        0 -0.3225185\n498  2          Fgf14 -0.2165954 2.148125e-05        0 -0.2876250\n499  2        Tmem108 -0.2165627 2.148689e-05        0 -0.3562990\n500  2          Lrp11 -0.2160405 2.272142e-05        0 -0.3773354\n501  2           Ldb2 -0.2156147 2.367654e-05        0 -0.2939618\n502  2        Cacna1c -0.2155847 2.367654e-05        0 -0.3207911\n503  2           Syt1 -0.2155790 2.367654e-05        0 -0.3450811\n504  2          Csmd2 -0.2151655 2.462000e-05        0 -0.3452957\n505  2          Grik2 -0.2145322 2.631314e-05        0 -0.4514875\n506  2           Rcn2 -0.2144319 2.651186e-05        0 -0.2854721\n507  2         Grin2b -0.2143914 2.654737e-05        0 -0.3129156\n508  2            Os9 -0.2141584 2.720479e-05        0 -0.3525981\n509  2         Fnbp1l -0.2141045 2.728537e-05        0 -0.2614826\n510  2         Elovl5 -0.2136772 2.861939e-05        0 -0.5763508\n511  2         Rnf145 -0.2135561 2.893633e-05        0 -0.3942400\n512  2         Tnrc6c -0.2134906 2.896283e-05        0 -0.2655012\n513  2         Ift172 -0.2131292 2.993213e-05        0 -0.7273950\n514  2         Setbp1 -0.2126523 3.147019e-05        0 -0.2808616\n515  2         Lrpap1 -0.2123979 3.222011e-05        0 -0.2556996\n516  2          Cdkl5 -0.2119296 3.372541e-05        0 -0.3911032\n517  2        Tmem63b -0.2116461 3.476450e-05        0 -0.3875314\n518  2         Clstn2 -0.2109588 3.721956e-05        0 -0.3872830\n519  2           Calr -0.2093031 4.436976e-05        0 -0.2802238\n520  2         Cdc14b -0.2092744 4.437711e-05        0 -0.7198813\n521  2          Dock3 -0.2090558 4.523928e-05        0 -0.3741515\n522  2          Ddx50 -0.2090289 4.523928e-05        0 -0.2860189\n523  2         Ormdl3 -0.2087976 4.633580e-05        0 -0.3832619\n524  2          Foxp2 -0.2083742 4.838465e-05        0 -0.5684095\n525  2          Ntrk2 -0.2080832 4.974629e-05        0 -0.5329103\n526  2          Magi1 -0.2076817 5.144462e-05        0 -0.4553671\n527  2           Rgma -0.2076627 5.144462e-05        0 -0.5780725\n528  2         Ergic2 -0.2075678 5.185736e-05        0 -0.2655840\n529  2         Zfp846 -0.2071885 5.403425e-05        0 -0.2995412\n530  2           Sybu -0.2070879 5.450360e-05        0 -0.3264942\n531  2        Dync1i1 -0.2069837 5.486586e-05        0 -0.3032658\n532  2          Camkv -0.2069786 5.486586e-05        0 -0.4211762\n533  2          Llgl1 -0.2068022 5.583319e-05        0 -0.4266499\n534  2           Alg6 -0.2066740 5.649948e-05        0 -0.9009502\n535  2           Lnpk -0.2063485 5.810123e-05        0 -0.3247704\n536  2        Gm20517 -0.2063298 5.810123e-05        0 -1.1410193\n537  2          Spon1 -0.2063298 5.810123e-05        0 -1.0616953\n538  2          Trpm3 -0.2061208 5.923166e-05        0 -0.6898117\n539  2         Pgrmc1 -0.2061123 5.923166e-05        0 -0.3026805\n540  2           Ctsl -0.2060428 5.953423e-05        0 -0.2874709\n541  2        B3galt1 -0.2059237 6.018295e-05        0 -0.3441872\n542  2        B3galt2 -0.2057491 6.121111e-05        0 -0.3838402\n543  2        Ldlrad4 -0.2054362 6.311424e-05        0 -0.3296407\n544  2            Cpe -0.2051983 6.468208e-05        0 -0.3516827\n545  2           Emc3 -0.2049214 6.620182e-05        0 -0.3590846\n546  2          Ttc19 -0.2048220 6.677153e-05        0 -0.4082099\n547  2       Adamts18 -0.2044280 6.966750e-05        0 -0.3869474\n548  2         Scube1 -0.2040851 7.184739e-05        0 -0.4709928\n549  2            Fry -0.2033530 7.769159e-05        0 -0.2718307\n550  2          Csmd3 -0.2030058 8.038151e-05        0 -0.5650582\n551  2          Cd200 -0.2028380 8.131483e-05        0 -0.2797321\n552  2          Flrt2 -0.2028239 8.131483e-05        0 -0.4293102\n553  2         Atraid -0.2028083 8.131483e-05        0 -0.3129678\n554  2         Alkbh1 -0.2026408 8.263928e-05        0 -0.4014083\n555  2        Gm26835 -0.2023891 8.457433e-05        0 -0.4222330\n556  2        Phactr1 -0.2021275 8.689090e-05        0 -0.2632504\n557  2          Foxp1 -0.2015461 9.231480e-05        0 -0.2580225\n558  2        Cacna1e -0.2014118 9.347565e-05        0 -0.3844196\n559  2           Ssr2 -0.2012752 9.467585e-05        0 -0.2615975\n560  2         Dopey1 -0.2009604 9.757977e-05        0 -0.3199163\n561  2         Hivep2 -0.2003663 1.035141e-04        0 -0.3244790\n562  2          Gdpd1 -0.1999246 1.085061e-04        0 -0.2925950\n563  2       Tmem132a -0.1998393 1.092617e-04        0 -0.2428495\n564  2           Ssh2 -0.1996800 1.109416e-04        0 -0.3329310\n565  2          Cxadr -0.1995205 1.125124e-04        0 -0.3356759\n566  2        Zdhhc20 -0.1994903 1.125124e-04        0 -0.3232686\n567  2          Cspg5 -0.1994159 1.127918e-04        0 -0.5253050\n568  2          Ascc3 -0.1988892 1.180975e-04        0 -0.3602826\n569  2          Myo9a -0.1987439 1.197252e-04        0 -0.3474970\n570  2         Nedd4l -0.1981619 1.271194e-04        0 -0.2870636\n571  2          Scaf8 -0.1978457 1.306755e-04        0 -0.3909157\n572  2           Rbl2 -0.1974622 1.356527e-04        0 -0.7665457\n573  2          Nemp1 -0.1974417 1.356527e-04        0 -0.5981904\n574  2       B3galnt1 -0.1973076 1.373451e-04        0 -0.4204007\n575  2        Slitrk5 -0.1971726 1.390696e-04        0 -0.4541803\n576  2           Fat3 -0.1970110 1.408803e-04        0 -0.2584599\n577  2          Pdia6 -0.1960923 1.555679e-04        0 -0.2786742\n578  2         Rnf215 -0.1960710 1.555679e-04        0 -0.4738305\n579  2       Serpini1 -0.1960175 1.557135e-04        0 -0.3356833\n580  2         Plppr1 -0.1957489 1.596118e-04        0 -0.2795475\n581  2           Sbf2 -0.1955199 1.624925e-04        0 -0.3006908\n582  2         Rnf112 -0.1954497 1.633550e-04        0 -0.8890006\n583  2           Trio -0.1952979 1.653021e-04        0 -0.2908840\n584  2        Slc38a9 -0.1947198 1.753063e-04        0 -0.3353488\n585  2           Meg3 -0.1946128 1.769487e-04        0 -0.3784197\n586  2          Adcy3 -0.1943549 1.811538e-04        0 -0.5909601\n587  2          Epha7 -0.1943130 1.815532e-04        0 -0.4107213\n588  2           St7l -0.1940499 1.850877e-04        0 -0.3886257\n589  2         Arxes1 -0.1939825 1.859845e-04        0 -0.4383596\n590  2         Lrrtm3 -0.1939625 1.859845e-04        0 -0.5679511\n591  2         R3hdm4 -0.1936960 1.905873e-04        0 -0.2734504\n592  2           Tia1 -0.1936068 1.920028e-04        0 -0.2339791\n593  2            Dst -0.1934066 1.957878e-04        0 -0.2589698\n594  2         Mycbp2 -0.1933442 1.966651e-04        0 -0.2335223\n595  2          Mgat2 -0.1927482 2.088898e-04        0 -0.2780917\n596  2           Gpc6 -0.1926238 2.112472e-04        0 -0.5501739\n597  2          Trpv2 -0.1925211 2.126335e-04        0 -1.1914960\n598  2          Lamp1 -0.1923446 2.157594e-04        0 -0.2363786\n599  2           Ktn1 -0.1923444 2.157594e-04        0 -0.3159114\n600  2         Tmem9b -0.1918146 2.269600e-04        0 -0.3040203\n601  2          Rps12  0.4631549 6.183206e-23        0  0.6825116\n602  2          Atp5e  0.4421521 5.489863e-21        0  0.6826112\n603  2          Rpl12  0.4249284 2.145813e-19        0  0.5752903\n604  2         Gm2000  0.4178124 8.261193e-19        0  0.7062262\n605  2          Rpl27  0.4101575 3.538517e-18        0  0.4851285\n606  2          Rpl35  0.4095728 3.538517e-18        0  0.6420850\n607  2          Rpl38  0.3944075 8.464359e-17        0  0.4901851\n608  2          Rpl34  0.3839933 6.784492e-16        0  0.5340951\n609  2         Rpl13a  0.3816079 9.934717e-16        0  0.4674161\n610  2          Rps27  0.3776182 2.046629e-15        0  0.5241613\n611  2           Rps3  0.3675068 1.460826e-14        0  0.5091646\n612  2          Rps21  0.3610482 4.853602e-14        0  0.4306092\n613  2          Rps13  0.3572064 9.536627e-14        0  0.4967312\n614  2          Rps29  0.3548155 1.411443e-13        0  0.4107293\n615  2          Uqcrh  0.3468014 6.147145e-13        0  0.4208264\n616  2         Rps15a  0.3458384 6.918806e-13        0  0.5734880\n617  2          Pfdn5  0.3412500 1.545294e-12        0  0.4357714\n618  2         Uqcr10  0.3369872 3.224794e-12        0  0.4964385\n619  2          Rps26  0.3311064 8.977031e-12        0  0.5340777\n620  2          Rps18  0.3305636 9.411567e-12        0  0.4596902\n621  2           Tpt1  0.3299694 9.825250e-12        0  0.4076206\n622  2           Pomp  0.3298004 9.825250e-12        0  0.4368943\n623  2          Uqcrq  0.3294012 1.010187e-11        0  0.4547596\n624  2          Rps10  0.3272417 1.428769e-11        0  0.4795864\n625  2         Timm8b  0.3243726 2.203535e-11        0  0.4229584\n626  2          Rps25  0.3237953 2.351562e-11        0  0.4375944\n627  2           Pfn1  0.3207365 3.896942e-11        0  0.4524917\n628  2       Atp6v1g1  0.3200504 4.245618e-11        0  0.3852555\n629  2         Snrpd2  0.3191388 4.805527e-11        0  0.4236104\n630  2      Hist3h2ba  0.3189649 4.805527e-11        0  0.4143786\n631  2          Rpl37  0.3182724 5.123125e-11        0  0.5620636\n632  2         Ndufs6  0.3181885 5.123125e-11        0  0.4034311\n633  2        Atp5o.1  0.3180715 5.123125e-11        0  0.4328550\n634  2         Snrpd1  0.3153652 7.971523e-11        0  0.4110424\n635  2        Dynlrb1  0.3138211 1.012249e-10        0  0.4016523\n636  2         Uqcr11  0.3127887 1.176600e-10        0  0.3977030\n637  2         Rpl35a  0.3107299 1.630574e-10        0  0.4733195\n638  2           Btf3  0.3105600 1.635550e-10        0  0.3262416\n639  2           Swi5  0.3089918 2.083158e-10        0  0.3992487\n640  2          Rps20  0.3085745 2.163595e-10        0  0.4357840\n641  2          Rps28  0.3084814 2.163595e-10        0  0.3976983\n642  2          Rpl31  0.3080905 2.258154e-10        0  0.3883420\n643  2         Ndufa7  0.3058712 3.210445e-10        0  0.3983718\n644  2           Tbca  0.3008336 7.280122e-10        0  0.4041754\n645  2          Snrpb  0.3004187 7.628240e-10        0  0.3556668\n646  2          Rplp2  0.2994367 8.780648e-10        0  0.3876488\n647  2          Rpl28  0.2980768 1.053428e-09        0  0.4146471\n648  2          Uqcc2  0.2963570 1.341309e-09        0  0.5371598\n649  2          Rpl36  0.2959874 1.397297e-09        0  0.3646947\n650  2           Edf1  0.2907784 3.182905e-09        0  0.3900142\n651  2          Fkbp3  0.2887636 4.310446e-09        0  0.3556366\n652  2          Rps24  0.2855186 6.949575e-09        0  0.4770224\n653  2           Gpx4  0.2835273 9.333670e-09        0  0.3245309\n654  2           Bex3  0.2811669 1.302731e-08        0  0.3180195\n655  2          Rps16  0.2797322 1.599726e-08        0  0.4247866\n656  2          Tomm7  0.2794532 1.620516e-08        0  0.4093449\n657  2          Hspe1  0.2791867 1.657357e-08        0  0.3462706\n658  2         Chchd1  0.2776050 2.048674e-08        0  0.4354694\n659  2          Rpl17  0.2772637 2.125977e-08        0  0.5191041\n660  2          Atp5k  0.2763011 2.390680e-08        0  0.4740455\n661  2           Svbp  0.2760304 2.455412e-08        0  0.3014819\n662  2         Atp5c1  0.2745608 3.026725e-08        0  0.2363772\n663  2          Eif3k  0.2733197 3.506397e-08        0  0.3840566\n664  2          Sumo1  0.2733121 3.506397e-08        0  0.2914956\n665  2         Timm13  0.2727683 3.704806e-08        0  0.3686286\n666  2         Mrpl30  0.2720637 4.012608e-08        0  0.4749261\n667  2           Sem1  0.2709451 4.626165e-08        0  0.3741535\n668  2          Usmg5  0.2698205 5.338295e-08        0  0.3823320\n669  2          Rpl22  0.2684403 6.476015e-08        0  0.3428325\n670  2          Snrpg  0.2676331 7.211655e-08        0  0.3005801\n671  2          Snrpf  0.2669184 7.920313e-08        0  0.3441404\n672  2           Txn1  0.2665795 8.228619e-08        0  0.3887734\n673  2         Rps3a1  0.2649696 1.007190e-07        0  0.4636491\n674  2           Nol7  0.2647710 1.025313e-07        0  0.4529087\n675  2         Myl12b  0.2633170 1.218616e-07        0  0.3769849\n676  2          Rpl7a  0.2628980 1.276278e-07        0  0.3803800\n677  2          Cirbp  0.2626801 1.303533e-07        0  0.2427524\n678  2         Ndufv3  0.2624191 1.339840e-07        0  0.3777157\n679  2         Rps27l  0.2612859 1.562914e-07        0  0.5679664\n680  2         Rpl37a  0.2606248 1.702086e-07        0  0.5219644\n681  2           Cycs  0.2595888 1.936645e-07        0  0.3851088\n682  2         Rpl36a  0.2587217 2.135807e-07        0  0.2850982\n683  2        Anapc13  0.2587014 2.135807e-07        0  0.4999552\n684  2          Smdt1  0.2574554 2.478030e-07        0  0.3049345\n685  2           Sdhb  0.2573959 2.478030e-07        0  0.3655544\n686  2         Mrpl52  0.2566472 2.731507e-07        0  0.3746260\n687  2         Ranbp1  0.2564576 2.746660e-07        0  0.2617357\n688  2 X0610012G03Rik  0.2564156 2.746660e-07        0  0.4450968\n689  2         Csnk2b  0.2562380 2.751587e-07        0  0.3913248\n690  2          Rps17  0.2562154 2.751587e-07        0  0.4469891\n691  2         Chchd2  0.2560482 2.793180e-07        0  0.4363077\n692  2          Rpl21  0.2552768 3.062727e-07        0  0.3799537\n693  2          Hmgb1  0.2548389 3.230834e-07        0  0.3340397\n694  2         Mrpl28  0.2536180 3.805588e-07        0  0.4316112\n695  2          Rtraf  0.2534456 3.866532e-07        0  0.2697156\n696  2          Cops9  0.2500709 5.947902e-07        0  0.3814245\n697  2          Atox1  0.2499329 5.967449e-07        0  0.4098502\n698  2          Rplp1  0.2493323 6.434789e-07        0  0.4307723\n699  2         Hnrnpc  0.2478592 7.764553e-07        0  0.2664530\n700  2         Mrps17  0.2474735 8.125236e-07        0  0.4752512\n701  2           Vapa  0.2468733 8.724833e-07        0  0.2749610\n702  2          Hmgn1  0.2467629 8.757159e-07        0  0.2649146\n703  2          Rps23  0.2450356 1.068941e-06        0  0.4578971\n704  2          Atp5h  0.2448179 1.093221e-06        0  0.3256882\n705  2        Tmem256  0.2442495 1.164388e-06        0  0.3865038\n706  2         Dctpp1  0.2439548 1.203424e-06        0  0.2977997\n707  2        Hnrnpab  0.2435671 1.242278e-06        0  0.2954051\n708  2          Pcbp2  0.2424629 1.432352e-06        0  0.3170388\n709  2         Tceal9  0.2415540 1.597013e-06        0  0.2648281\n710  2        Lamtor5  0.2396744 2.026684e-06        0  0.4350606\n711  2        Ndufb10  0.2369275 2.844142e-06        0  0.2863959\n712  2          Cox7c  0.2369225 2.844142e-06        0  0.2824851\n713  2           Oaz1  0.2366477 2.930192e-06        0  0.2739040\n714  2         Scand1  0.2362155 3.049012e-06        0  0.4189525\n715  2         Polr2j  0.2362011 3.049012e-06        0  0.2842206\n716  2          Rpl10  0.2359047 3.150343e-06        0  0.4748902\n717  2          Pfdn4  0.2355440 3.282597e-06        0  0.4199890\n718  2          Rps19  0.2350001 3.457301e-06        0  0.5025216\n719  2         Rpl10a  0.2349610 3.457301e-06        0  0.3144984\n720  2           Nme1  0.2348924 3.467459e-06        0  0.2836137\n721  2          Arpc3  0.2343591 3.673533e-06        0  0.3467814\n722  2            Ran  0.2336918 3.937207e-06        0  0.2541407\n723  2           Rnf7  0.2330433 4.258758e-06        0  0.3808571\n724  2           Bex2  0.2329252 4.299581e-06        0  0.2931452\n725  2         Snrpd3  0.2324127 4.521549e-06        0  0.4085823\n726  2        Gm10260  0.2324024 4.521549e-06        0  0.3556503\n727  2          Cox7b  0.2323608 4.521549e-06        0  0.2699185\n728  2          H2afz  0.2321811 4.601972e-06        0  0.3482270\n729  2          Ddah2  0.2317245 4.854571e-06        0  0.3249683\n730  2           Tbcb  0.2312379 5.112130e-06        0  0.2296635\n731  2         Atp5j2  0.2304200 5.634610e-06        0  0.2909852\n732  2         Cox6b1  0.2303965 5.634610e-06        0  0.2710346\n733  2          Atp5j  0.2299308 5.885226e-06        0  0.2785515\n734  2        Uqcrfs1  0.2295095 6.113070e-06        0  0.2729393\n735  2         Txnl4a  0.2284938 6.923514e-06        0  0.4264706\n736  2         Mrps24  0.2283968 6.972967e-06        0  0.4010231\n737  2 X1110004F10Rik  0.2278692 7.418587e-06        0  0.2576501\n738  2            Mif  0.2278012 7.444171e-06        0  0.3175502\n739  2         Mrpl18  0.2263135 8.717060e-06        0  0.3538738\n740  2          Crip2  0.2262746 8.717060e-06        0  0.2328728\n741  2          Hsbp1  0.2253249 9.567604e-06        0  0.2581882\n742  2          Rpl19  0.2253114 9.567604e-06        0  0.3885120\n743  2          Rps11  0.2251894 9.656863e-06        0  0.3842770\n744  2         Rpl23a  0.2250285 9.806820e-06        0  0.4333352\n745  2           Ubl5  0.2248612 9.967272e-06        0  0.3088737\n746  2        Ndufab1  0.2238209 1.114197e-05        0  0.3859670\n747  2         Atp5g1  0.2231648 1.188149e-05        0  0.2660431\n748  2           Rps6  0.2231573 1.188149e-05        0  0.3939822\n749  2          Eif3h  0.2229958 1.206753e-05        0  0.2308491\n750  2          Pdcd5  0.2227854 1.231783e-05        0  0.3465369\n751  2         Zfp706  0.2225725 1.249138e-05        0  0.2112568\n752  2         Abracl  0.2213934 1.420354e-05        0  0.2750669\n753  2          Pfdn6  0.2209369 1.475035e-05        0  0.4071708\n754  2          Prdx5  0.2209109 1.475035e-05        0  0.2559431\n755  2          Calm3  0.2207639 1.495591e-05        0  0.2573251\n756  2         Rex1bd  0.2205570 1.527669e-05        0  0.4203590\n757  2            Esd  0.2203737 1.555921e-05        0  0.2975594\n758  2          Psma2  0.2203365 1.556413e-05        0  0.2819089\n759  2         Dynll1  0.2199209 1.610702e-05        0  0.3676117\n760  2          Rpl15  0.2193999 1.681993e-05        0  0.2895195\n761  2          Glrx3  0.2183361 1.870043e-05        0  0.1083442\n762  2        Selenow  0.2181498 1.884053e-05        0  0.3930863\n763  2           Gpx1  0.2178309 1.949979e-05        0  0.5381608\n764  2         Ndufa2  0.2176492 1.980493e-05        0  0.3264260\n765  2         Sec61b  0.2175909 1.984489e-05        0  0.3811968\n766  2         Mrpl58  0.2174529 1.994929e-05        0  0.4914635\n767  2          Psma7  0.2172964 2.021002e-05        0  0.2739562\n768  2          Bcas2  0.2172834 2.021002e-05        0  0.3158613\n769  2          Srp14  0.2170597 2.068867e-05        0  0.2990073\n770  2          Nop10  0.2166123 2.148125e-05        0  0.3118031\n771  2         Rpl27a  0.2166058 2.148125e-05        0  0.2738241\n772  2         Eif2s2  0.2163714 2.190974e-05        0  0.2296548\n773  2       Trappc2l  0.2156572 2.367654e-05        0  0.3406024\n774  2          H3f3a  0.2155351 2.371636e-05        0  0.3079225\n775  2         Gtf2h5  0.2153738 2.409548e-05        0  0.3434282\n776  2           Sub1  0.2151160 2.467880e-05        0  0.2508421\n777  2           Naca  0.2145240 2.631314e-05        0  0.3565910\n778  2           Rpl7  0.2135255 2.894195e-05        0  0.3706477\n779  2          Ppdpf  0.2133232 2.944698e-05        0  0.3391216\n780  2          Rpl24  0.2132565 2.958106e-05        0  0.4690503\n781  2        Gm10076  0.2127650 3.115580e-05        0  0.4772046\n782  2         Ndufb2  0.2126237 3.147088e-05        0  0.3525210\n783  2         Cox7a2  0.2122685 3.261049e-05        0  0.2379424\n784  2          Rpl18  0.2119882 3.360348e-05        0  0.2748972\n785  2           Rpl5  0.2112951 3.612182e-05        0  0.2924973\n786  2           Jund  0.2110174 3.713592e-05        0  0.2279356\n787  2         Ndufc1  0.2110056 3.713592e-05        0  0.3252872\n788  2         Ndufb4  0.2104104 3.958197e-05        0  0.3979775\n789  2         Rps27a  0.2103616 3.968123e-05        0  0.4295827\n790  2          Slirp  0.2102777 3.994578e-05        0  0.4121032\n791  2            Fau  0.2100576 4.086342e-05        0  0.4027868\n792  2         Ndufb8  0.2095178 4.340397e-05        0  0.2659853\n793  2        Txndc17  0.2090594 4.523928e-05        0  0.3694520\n794  2          Rpl32  0.2084089 4.834087e-05        0  0.5548520\n795  2          Ap2s1  0.2082742 4.880084e-05        0  0.2605882\n796  2        Gabarap  0.2080185 4.986800e-05        0  0.2959616\n797  2        Smarcb1  0.2080089 4.986800e-05        0  0.2851375\n798  2          H2afj  0.2078390 5.070994e-05        0  0.3315896\n799  2         Cacybp  0.2065126 5.739543e-05        0  0.2614856\n800  2           Grm8  0.2057265 6.121111e-05        0  0.4215947",
    "crumbs": [
      "Cluster evaluation",
      "Not UT cluster with LR"
    ]
  },
  {
    "objectID": "NonCT_clusters.html#cluster-184-e15.0",
    "href": "NonCT_clusters.html#cluster-184-e15.0",
    "title": "Not Uniform Transcriptomic clusters with Logistic Regression",
    "section": "Cluster 184 e15.0",
    "text": "Cluster 184 e15.0\n\n\n  OriginalCluster CellNumber COTANClusterNumber          Accuracy\n1      Cl525E15.0        826                  3 0.786585365853659\n2      Cl511E15.0        540                  2 0.916666666666667\n3      Cl184E15.0        322                  2              &lt;NA&gt;\n\n\n\ncells &lt;- getClusterizationData(e15.0,clName = \"CL_original.clusters\")[[1]][getClusterizationData(e15.0,clName = \"CL_original.clusters\")[[1]] == \"184\"]\n\ncells &lt;-names(cells)\n\ncl184 &lt;-  automaticCOTANObjectCreation(raw = getRawData(e15.0)[,cells],\n                                       GEO = \"Loom\",\n                                       sequencingMethod = \"10X\",\n                                       sampleCondition = \"cl184\",\n                                       cores = 10,saveObj = T,\n                                       outDir = \"Data/MouseCortexFromLoom/NotCTSingleClusters/\",\n                                       calcCoex = T)\n\n\ncl184GDI &lt;- calculateGDI(cl184)\n\nsubsetGDIcl184 &lt;- cl184GDI[cl184GDI$sum.raw.norm &gt; 7,]\ntop.GDI.genes &lt;- rownames(subsetGDIcl184[order(subsetGDIcl184$GDI,decreasing = T),])[1:50]\n\nGDIPlot(cl184,genes = \"\",GDIIn = cl184GDI)\n\n\n\n\n\n\n\n\n\nlist.cl.CT &lt;- cellsUniformClustering(cl184, GDIThreshold = 1.43, cores = 10L,\n                         saveObj = TRUE, outDir = outDir)\n\ncl184 &lt;- addClusterization(cl184, clName = \"split\",\n                              clusters = list.cl.CT$clusters,\n                              coexDF = list.cl.CT$coex, override = TRUE)\n\ntable(list.cl.CT$clusters)\n\n\nc(mergedClusters, mergedCoexDF) %&lt;-%\n  mergeUniformCellsClusters(cl184, clusters = list.cl.CT$clusters,\n                            GDIThreshold = 1.43, batchSize = 4L, cores = 10L,\n                            saveObj = TRUE, outDir = outDir)\n\ncl184 &lt;- addClusterization(cl184, clName = \"merge\",\n                              clusters = mergedClusters,\n                              coexDF = mergedCoexDF,\n                              override = TRUE)\n\nsaveRDS(cl184,paste0(outDir,\"cl184.cotan.RDS\"))\n\ntable(str_split(names(mergedClusters),pattern = \"_\",simplify = T)[,1],mergedClusters)\n\n\ndata &lt;- getNormalizedData(cl184)\ndata &lt;- data[!rowSums(as.matrix(data)) &lt; 1,]\ndata &lt;- log(data*10000+1)\n\nrow_stdev &lt;- apply(data, 1, sd, na.rm=TRUE)\nrow_stdev &lt;- row_stdev[order(row_stdev,decreasing = T)]\n\ngenes.to.keep &lt;- c(names(row_stdev[1:100]),top.GDI.genes)\n\ndata.small &lt;- data[rownames(data) %in% genes.to.keep,]\n\n#data &lt;- t(as.matrix(data))\ndata.small &lt;- t(as.matrix(data.small))\n\n\nCOTAN_Cl.code &lt;- getClusterizationData(cl184)[[1]]\n#COTAN_Cl.code[COTAN_Cl.code == \"A549\"] &lt;- 0\n#COTAN_Cl.code[COTAN_Cl.code == \"CCL-185-IG\"] &lt;- 1\n\nCOTAN_Cl.code &lt;- as.numeric(COTAN_Cl.code)-1\n\ndata.small &lt;- cbind(data.small,COTAN_Cl.code)\ndata.small &lt;- as.data.frame(data.small)\n\n# Split the data into training and test set\nset.seed(123)\ntraining.samples &lt;- data.small[,\"COTAN_Cl.code\"] %&gt;% \n  createDataPartition(p = 0.8, list = FALSE)\ntrain.data  &lt;- data.small[training.samples, ]\ntest.data &lt;- data.small[-training.samples, ]\nhead(train.data)\n\n                              Tfap2c     Gpc4      Psph    Pbdc1      Mcm6\n10X64_3_A_1:CTGTAACTGTGTTGx 9.921146 9.921146  9.515705 0.000000  0.000000\n10X74_4_A_1:ATCAAATGTCTCCGx 9.214393 9.214393  9.214393 9.214393 10.312939\n10X73_3_A_1:ACAACCGACCCACTx 0.000000 9.799638  9.106546 0.000000  0.000000\n10X64_3_A_1:AAACATTGGGTCTAx 9.258303 0.000000  0.000000 9.258303  9.258303\n10X64_3_A_1:TTGGTACTAGCGTTx 0.000000 0.000000  0.000000 0.000000  9.878809\n10X64_3_A_1:GAAACAGATCTCTAx 0.000000 0.000000 10.225911 0.000000  9.127371\n                                Cdca7   Nmral1     Tipin     Fbxl7     Btg2\n10X64_3_A_1:CTGTAACTGTGTTGx  9.921146 9.515705  9.921146  8.822632 8.822632\n10X74_4_A_1:ATCAAATGTCTCCGx  0.000000 9.214393  0.000000  9.907490 0.000000\n10X73_3_A_1:ACAACCGACCCACTx  9.106546 0.000000  0.000000  0.000000 9.106546\n10X64_3_A_1:AAACATTGGGTCTAx  9.258303 9.951403  9.258303 10.356852 0.000000\n10X64_3_A_1:TTGGTACTAGCGTTx 10.284257 9.185713 10.571931 10.795069 9.878809\n10X64_3_A_1:GAAACAGATCTCTAx  9.127371 9.820464 10.225911 10.225911 0.000000\n                               Nrarp     Ier2      Rgcc     Rlbp1   Gm29260\n10X64_3_A_1:CTGTAACTGTGTTGx 9.921146 9.921146  9.921146 10.208816  8.822632\n10X74_4_A_1:ATCAAATGTCTCCGx 0.000000 9.214393 10.600612 10.312939 10.823751\n10X73_3_A_1:ACAACCGACCCACTx 9.799638 0.000000 10.492757  9.106546 10.715895\n10X64_3_A_1:AAACATTGGGTCTAx 9.951403 0.000000  9.258303  9.258303  9.258303\n10X64_3_A_1:TTGGTACTAGCGTTx 9.185713 9.878809  0.000000  0.000000  9.185713\n10X64_3_A_1:GAAACAGATCTCTAx 0.000000 9.127371 11.324499  0.000000 11.206718\n                               Rgs20     Sfrp1       Nes     Msi1   Pantr1\n10X64_3_A_1:CTGTAACTGTGTTGx 8.822632  9.921146  0.000000 0.000000 10.20882\n10X74_4_A_1:ATCAAATGTCTCCGx 0.000000 11.006069  0.000000 0.000000 10.82375\n10X73_3_A_1:ACAACCGACCCACTx 0.000000 11.052361 10.205084 0.000000 11.05236\n10X64_3_A_1:AAACATTGGGTCTAx 9.258303 10.644526  0.000000 9.258303 10.86766\n10X64_3_A_1:TTGGTACTAGCGTTx 9.185713  0.000000  0.000000 0.000000 10.28426\n10X64_3_A_1:GAAACAGATCTCTAx 9.127371 10.919040  9.127371 0.000000 10.91904\n                                Cyr61   Zfp536   Pitpnc1    Polr3h     Csmd1\n10X64_3_A_1:CTGTAACTGTGTTGx  8.822632 9.515705  0.000000  8.822632  8.822632\n10X74_4_A_1:ATCAAATGTCTCCGx  9.907490 9.214393  9.214393  9.214393  9.214393\n10X73_3_A_1:ACAACCGACCCACTx 10.205084 9.799638  9.106546  0.000000 10.205084\n10X64_3_A_1:AAACATTGGGTCTAx  9.951403 0.000000  0.000000  0.000000 10.867665\n10X64_3_A_1:TTGGTACTAGCGTTx 10.795069 0.000000  0.000000  9.185713  9.185713\n10X64_3_A_1:GAAACAGATCTCTAx 11.206718 9.127371 10.919040 10.225911 10.919040\n                                  Mt3   Sncaip CT025619.1   Slc1a3   Rnf180\n10X64_3_A_1:CTGTAACTGTGTTGx  8.822632 9.921146   0.000000 9.515705 0.000000\n10X74_4_A_1:ATCAAATGTCTCCGx  9.214393 9.214393   9.907490 9.214393 9.214393\n10X73_3_A_1:ACAACCGACCCACTx  9.106546 0.000000   9.106546 9.106546 0.000000\n10X64_3_A_1:AAACATTGGGTCTAx 10.356852 0.000000   0.000000 0.000000 0.000000\n10X64_3_A_1:TTGGTACTAGCGTTx  9.185713 9.878809   9.185713 0.000000 0.000000\n10X64_3_A_1:GAAACAGATCTCTAx 11.073188 0.000000   0.000000 0.000000 9.820464\n                                  Ptn    Aldoc   Fgfbp3      Hes5    Mfge8\n10X64_3_A_1:CTGTAACTGTGTTGx  9.515705 10.20882 9.921146 11.125084 0.000000\n10X74_4_A_1:ATCAAATGTCTCCGx 11.516888 11.98689 0.000000  9.214393 9.214393\n10X73_3_A_1:ACAACCGACCCACTx 10.898213 10.20508 0.000000  9.106546 9.799638\n10X64_3_A_1:AAACATTGGGTCTAx 12.349254 11.33766 9.258303 10.356852 9.951403\n10X64_3_A_1:TTGGTACTAGCGTTx 10.795069 10.57193 9.878809  9.878809 9.185713\n10X64_3_A_1:GAAACAGATCTCTAx 11.835320 11.69222 0.000000  0.000000 0.000000\n                               Maml2    Lpar1     Cadm2    Sema5a       Qk\n10X64_3_A_1:CTGTAACTGTGTTGx 8.822632 0.000000  0.000000  0.000000 0.000000\n10X74_4_A_1:ATCAAATGTCTCCGx 0.000000 0.000000  9.214393 10.600612 0.000000\n10X73_3_A_1:ACAACCGACCCACTx 0.000000 9.799638  0.000000 10.492757 9.799638\n10X64_3_A_1:AAACATTGGGTCTAx 9.258303 0.000000 10.356852 10.644526 9.951403\n10X64_3_A_1:TTGGTACTAGCGTTx 9.185713 0.000000  0.000000  0.000000 0.000000\n10X64_3_A_1:GAAACAGATCTCTAx 9.127371 9.127371 10.225911  9.127371 0.000000\n                              Nkain2     Hes6    Rhbdl3  Neurog2     Chd7\n10X64_3_A_1:CTGTAACTGTGTTGx 8.822632 8.822632  9.515705 9.515705 0.000000\n10X74_4_A_1:ATCAAATGTCTCCGx 9.907490 0.000000  9.907490 0.000000 0.000000\n10X73_3_A_1:ACAACCGACCCACTx 9.106546 9.799638 10.205084 0.000000 0.000000\n10X64_3_A_1:AAACATTGGGTCTAx 0.000000 0.000000  0.000000 0.000000 0.000000\n10X64_3_A_1:TTGGTACTAGCGTTx 0.000000 9.185713  9.185713 0.000000 9.878809\n10X64_3_A_1:GAAACAGATCTCTAx 9.820464 0.000000  9.127371 0.000000 0.000000\n                               Msmo1  Igfbpl1    Zmiz1     Kat6b      Nfib\n10X64_3_A_1:CTGTAACTGTGTTGx 0.000000 11.22039 9.515705  0.000000 11.125084\n10X74_4_A_1:ATCAAATGTCTCCGx 9.214393  0.00000 9.214393 10.600612 10.600612\n10X73_3_A_1:ACAACCGACCCACTx 0.000000  0.00000 0.000000 10.492757  9.799638\n10X64_3_A_1:AAACATTGGGTCTAx 9.258303  0.00000 0.000000  0.000000  9.951403\n10X64_3_A_1:TTGGTACTAGCGTTx 0.000000  0.00000 9.185713  9.185713  9.878809\n10X64_3_A_1:GAAACAGATCTCTAx 9.127371  0.00000 0.000000  0.000000 10.225911\n                               Fezf2     Dok5     Tenm2     Meis2   Mpped2\n10X64_3_A_1:CTGTAACTGTGTTGx 8.822632 9.515705  9.921146  9.515705 11.81822\n10X74_4_A_1:ATCAAATGTCTCCGx 0.000000 9.214393  0.000000 10.823751 11.00607\n10X73_3_A_1:ACAACCGACCCACTx 0.000000 9.106546  0.000000 10.205084 10.49276\n10X64_3_A_1:AAACATTGGGTCTAx 9.258303 9.951403 10.356852 11.049983  0.00000\n10X64_3_A_1:TTGGTACTAGCGTTx 0.000000 0.000000  0.000000  9.878809 11.13154\n10X64_3_A_1:GAAACAGATCTCTAx 9.127371 9.820464  0.000000 11.206718 10.51358\n                             Gm17750    Kcnh7  Mir670hg      Gpc6      Dab1\n10X64_3_A_1:CTGTAACTGTGTTGx 8.822632 0.000000  9.515705  0.000000 10.208816\n10X74_4_A_1:ATCAAATGTCTCCGx 0.000000 9.907490 10.312939  0.000000  0.000000\n10X73_3_A_1:ACAACCGACCCACTx 9.799638 9.799638  0.000000  9.106546  0.000000\n10X64_3_A_1:AAACATTGGGTCTAx 9.258303 9.951403  0.000000  9.258303  9.258303\n10X64_3_A_1:TTGGTACTAGCGTTx 9.185713 0.000000  0.000000 10.795069  9.185713\n10X64_3_A_1:GAAACAGATCTCTAx 0.000000 9.127371  9.820464  0.000000  9.127371\n                            Hist3h2ba     Scrn1     Ank2    Bach2    Rbbp7\n10X64_3_A_1:CTGTAACTGTGTTGx  8.822632  8.822632 8.822632 10.43195 9.515705\n10X74_4_A_1:ATCAAATGTCTCCGx  9.214393  9.214393 9.214393  9.90749 0.000000\n10X73_3_A_1:ACAACCGACCCACTx  0.000000  9.106546 9.106546  0.00000 0.000000\n10X64_3_A_1:AAACATTGGGTCTAx  0.000000  9.258303 9.951403  0.00000 0.000000\n10X64_3_A_1:TTGGTACTAGCGTTx  0.000000  0.000000 0.000000  0.00000 0.000000\n10X64_3_A_1:GAAACAGATCTCTAx  0.000000 10.736722 0.000000  0.00000 9.820464\n                               Rpl26   Serbp1     Prmt1     Rack1  Hsp90aa1\n10X64_3_A_1:CTGTAACTGTGTTGx  0.00000 10.76842 10.208816 10.431952 11.019725\n10X74_4_A_1:ATCAAATGTCTCCGx 11.61220 10.82375 10.600612 10.312939  9.214393\n10X73_3_A_1:ACAACCGACCCACTx 11.50434 10.71590 11.303672 10.898213 10.715895\n10X64_3_A_1:AAACATTGGGTCTAx  0.00000 10.64453 10.356852 11.049983 10.867665\n10X64_3_A_1:TTGGTACTAGCGTTx  0.00000 10.28426 11.265065  0.000000 10.795069\n10X64_3_A_1:GAAACAGATCTCTAx  0.00000 10.22591  9.127371  9.127371 10.736722\n                               Ddx39      Cct5     H2afx     Lsm3     Ntmt1\n10X64_3_A_1:CTGTAACTGTGTTGx 8.822632 10.208816  9.921146 9.515705 10.208816\n10X74_4_A_1:ATCAAATGTCTCCGx 9.214393 10.600612  9.907490 9.214393  9.214393\n10X73_3_A_1:ACAACCGACCCACTx 0.000000 10.898213  0.000000 0.000000  9.106546\n10X64_3_A_1:AAACATTGGGTCTAx 9.258303 10.644526  0.000000 9.258303  9.258303\n10X64_3_A_1:TTGGTACTAGCGTTx 0.000000  9.878809  9.185713 9.185713  9.878809\n10X64_3_A_1:GAAACAGATCTCTAx 0.000000 10.919040 10.513584 9.820464  0.000000\n                               Hmgb3  Snrnp70      Rfc2   Tuba1b     Snrpb\n10X64_3_A_1:CTGTAACTGTGTTGx 10.76842 8.822632  0.000000 10.61427 10.208816\n10X74_4_A_1:ATCAAATGTCTCCGx  9.90749 9.907490 10.312939 11.16022 10.823751\n10X73_3_A_1:ACAACCGACCCACTx 10.49276 9.799638  9.106546 10.89821 10.715895\n10X64_3_A_1:AAACATTGGGTCTAx 10.35685 9.258303  0.000000 11.56080  9.951403\n10X64_3_A_1:TTGGTACTAGCGTTx 10.57193 0.000000  9.185713 11.67053 10.571931\n10X64_3_A_1:GAAACAGATCTCTAx 10.91904 0.000000  9.820464 11.52517 10.225911\n                               Psma7    Pmpcb    Srsf3   Rbmxl1      Cdk4\n10X64_3_A_1:CTGTAACTGTGTTGx 10.61427 0.000000 10.20882 0.000000  9.515705\n10X74_4_A_1:ATCAAATGTCTCCGx  9.90749 9.214393 10.82375 0.000000 11.160217\n10X73_3_A_1:ACAACCGACCCACTx 10.49276 0.000000  0.00000 9.106546 11.591351\n10X64_3_A_1:AAACATTGGGTCTAx 10.86766 9.258303 11.04998 9.258303 10.644526\n10X64_3_A_1:TTGGTACTAGCGTTx 11.13154 0.000000 10.57193 0.000000 11.131536\n10X64_3_A_1:GAAACAGATCTCTAx 11.07319 0.000000  0.00000 0.000000 10.736722\n                              Nap1l4   Fam133b    Cdc123    Dnajc9     Rpl12\n10X64_3_A_1:CTGTAACTGTGTTGx 9.921146  8.822632  9.515705  8.822632 10.768416\n10X74_4_A_1:ATCAAATGTCTCCGx 9.214393  9.907490  9.907490  9.907490 10.823751\n10X73_3_A_1:ACAACCGACCCACTx 0.000000  9.799638 10.205084  9.106546 11.185891\n10X64_3_A_1:AAACATTGGGTCTAx 0.000000  0.000000  9.258303  0.000000 11.049983\n10X64_3_A_1:TTGGTACTAGCGTTx 0.000000 10.284257  9.878809  0.000000  9.878809\n10X64_3_A_1:GAAACAGATCTCTAx 9.820464  9.127371  9.127371 10.225911 10.225911\n                                Rpl22     Hspe1     Cks1b    Snrpg      Ppia\n10X64_3_A_1:CTGTAACTGTGTTGx 10.768416 10.208816 10.431952 11.22039 10.208816\n10X74_4_A_1:ATCAAATGTCTCCGx  9.214393  9.214393  9.214393 10.60061 10.600612\n10X73_3_A_1:ACAACCGACCCACTx  9.799638 10.205084 10.205084 11.18589 10.715895\n10X64_3_A_1:AAACATTGGGTCTAx 10.644526 11.743122  9.258303 10.35685  9.951403\n10X64_3_A_1:TTGGTACTAGCGTTx 10.284257 10.284257  0.000000 10.28426 11.131536\n10X64_3_A_1:GAAACAGATCTCTAx 10.225911 10.225911  9.820464 10.73672 10.513584\n                                 Cnbp      Sub1     Psip1     Eprs      Jun\n10X64_3_A_1:CTGTAACTGTGTTGx  9.515705  9.921146 10.431952 9.515705 10.61427\n10X74_4_A_1:ATCAAATGTCTCCGx 11.006069  9.907490  9.214393 0.000000 10.31294\n10X73_3_A_1:ACAACCGACCCACTx 11.303672 10.492757 11.185891 0.000000 10.20508\n10X64_3_A_1:AAACATTGGGTCTAx 10.867665 10.356852  9.951403 0.000000 10.35685\n10X64_3_A_1:TTGGTACTAGCGTTx 10.977387 10.571931 11.131536 9.878809 11.58352\n10X64_3_A_1:GAAACAGATCTCTAx 10.736722  9.127371 10.225911 0.000000 11.07319\n                               Pgrmc1    Arl15     Dach1    Rps25    Dynll1\n10X64_3_A_1:CTGTAACTGTGTTGx 10.208816 9.515705 10.431952 11.30740 10.431952\n10X74_4_A_1:ATCAAATGTCTCCGx  0.000000 0.000000  0.000000 10.82375  9.907490\n10X73_3_A_1:ACAACCGACCCACTx  9.799638 9.799638  0.000000 10.71590 10.898213\n10X64_3_A_1:AAACATTGGGTCTAx  0.000000 0.000000  9.258303 11.04998  9.258303\n10X64_3_A_1:TTGGTACTAGCGTTx  9.878809 9.185713  9.878809 10.57193  9.185713\n10X64_3_A_1:GAAACAGATCTCTAx  0.000000 0.000000  0.000000 10.91904 10.736722\n                                 Sem1     Rps28     Eif3f   Tspan6    Rpl34\n10X64_3_A_1:CTGTAACTGTGTTGx 11.125084 10.768416 10.431952 9.515705 10.43195\n10X74_4_A_1:ATCAAATGTCTCCGx  0.000000  0.000000 10.823751 9.214393 11.00607\n10X73_3_A_1:ACAACCGACCCACTx 10.492757 10.492757 10.492757 9.106546 10.49276\n10X64_3_A_1:AAACATTGGGTCTAx 10.356852  9.951403 10.867665 0.000000 10.35685\n10X64_3_A_1:TTGGTACTAGCGTTx  9.878809 10.795069 10.284257 9.878809 10.79507\n10X64_3_A_1:GAAACAGATCTCTAx 10.225911  9.127371  9.820464 0.000000 10.22591\n                               Mrps17     Atp5j   Higd2a     Ddx50   Phf21a\n10X64_3_A_1:CTGTAACTGTGTTGx  9.515705  9.921146 9.515705 10.208816  0.00000\n10X74_4_A_1:ATCAAATGTCTCCGx  9.214393  9.907490 0.000000  9.907490  0.00000\n10X73_3_A_1:ACAACCGACCCACTx  9.799638  9.799638 9.106546  9.799638  0.00000\n10X64_3_A_1:AAACATTGGGTCTAx 10.644526 10.644526 9.258303  9.951403 10.35685\n10X64_3_A_1:TTGGTACTAGCGTTx  9.185713  9.878809 9.878809  0.000000  0.00000\n10X64_3_A_1:GAAACAGATCTCTAx  0.000000 10.225911 9.127371  0.000000  0.00000\n                               Baz2b      Elob     Btbd1      Ubb    H2afz\n10X64_3_A_1:CTGTAACTGTGTTGx 8.822632 11.019725  8.822632 10.76842 10.43195\n10X74_4_A_1:ATCAAATGTCTCCGx 0.000000  0.000000  0.000000 10.82375 11.29375\n10X73_3_A_1:ACAACCGACCCACTx 9.106546 10.492757  9.799638  0.00000 11.05236\n10X64_3_A_1:AAACATTGGGTCTAx 0.000000 10.356852 10.356852 10.35685 11.33766\n10X64_3_A_1:TTGGTACTAGCGTTx 9.878809 10.284257  9.185713 10.28426 10.28426\n10X64_3_A_1:GAAACAGATCTCTAx 0.000000  9.127371  9.127371 10.73672 11.07319\n                              Zfp609    Rpl35a   Nt5dc2    mt.Nd4    mt.Nd1\n10X64_3_A_1:CTGTAACTGTGTTGx 9.921146  8.822632 8.822632 10.208816 10.208816\n10X74_4_A_1:ATCAAATGTCTCCGx 0.000000 10.823751 9.214393 10.312939  9.907490\n10X73_3_A_1:ACAACCGACCCACTx 0.000000 11.052361 0.000000  9.799638 10.715895\n10X64_3_A_1:AAACATTGGGTCTAx 0.000000  9.258303 9.258303  9.951403  9.951403\n10X64_3_A_1:TTGGTACTAGCGTTx 0.000000  0.000000 9.185713  9.878809  9.185713\n10X64_3_A_1:GAAACAGATCTCTAx 9.820464  0.000000 9.820464 10.736722  9.820464\n                                Pcm1      Hes1    Ndufc2      Pcna    Atp5f1\n10X64_3_A_1:CTGTAACTGTGTTGx 0.000000 10.208816 10.768416  0.000000  9.515705\n10X74_4_A_1:ATCAAATGTCTCCGx 9.907490  9.214393 10.600612  9.214393 10.312939\n10X73_3_A_1:ACAACCGACCCACTx 9.106546 10.715895  9.799638  0.000000 10.715895\n10X64_3_A_1:AAACATTGGGTCTAx 9.258303  9.258303 10.356852  9.951403 10.356852\n10X64_3_A_1:TTGGTACTAGCGTTx 9.185713  9.185713  9.878809 10.284257 10.284257\n10X64_3_A_1:GAAACAGATCTCTAx 9.127371  9.127371 10.513584  9.820464  9.127371\n                                Gsk3b    Mtch1  Gpatch8     Map1b     Romo1\n10X64_3_A_1:CTGTAACTGTGTTGx  0.000000 0.000000 0.000000  9.921146  9.921146\n10X74_4_A_1:ATCAAATGTCTCCGx  0.000000 9.214393 9.214393  9.907490  0.000000\n10X73_3_A_1:ACAACCGACCCACTx 10.715895 9.106546 0.000000 10.205084  9.106546\n10X64_3_A_1:AAACATTGGGTCTAx  9.258303 9.258303 9.258303 10.867665 10.644526\n10X64_3_A_1:TTGGTACTAGCGTTx  0.000000 0.000000 9.185713 10.284257  0.000000\n10X64_3_A_1:GAAACAGATCTCTAx  9.127371 9.127371 9.127371  9.820464  9.820464\n                                Xist    Fdft1    Hmgcs1     Eif1b      Sox4\n10X64_3_A_1:CTGTAACTGTGTTGx  0.00000 8.822632  8.822632  9.515705 10.431952\n10X74_4_A_1:ATCAAATGTCTCCGx 10.60061 9.214393 10.312939 10.600612 10.600612\n10X73_3_A_1:ACAACCGACCCACTx  0.00000 9.799638  0.000000 10.492757 10.492757\n10X64_3_A_1:AAACATTGGGTCTAx  0.00000 9.258303  9.258303 11.204131  9.258303\n10X64_3_A_1:TTGGTACTAGCGTTx  0.00000 9.878809  0.000000  9.185713  0.000000\n10X64_3_A_1:GAAACAGATCTCTAx 10.73672 9.820464  9.127371  9.820464  9.127371\n                                Fxyd6      Eef2   Tubb2b      Rtn1     Acat1\n10X64_3_A_1:CTGTAACTGTGTTGx  0.000000 10.431952 10.90194  0.000000  0.000000\n10X74_4_A_1:ATCAAATGTCTCCGx 10.600612 11.411529 11.92235  9.907490  0.000000\n10X73_3_A_1:ACAACCGACCCACTx  9.106546 10.492757 10.20508  9.799638 10.205084\n10X64_3_A_1:AAACATTGGGTCTAx  9.951403 11.049983 11.74312  9.258303  0.000000\n10X64_3_A_1:TTGGTACTAGCGTTx  9.185713  9.878809 11.67053  0.000000  0.000000\n10X64_3_A_1:GAAACAGATCTCTAx  9.820464 10.513584 11.07319 10.919040  9.127371\n                               Glrx2    Ndufa4     Cox7c      Scg5\n10X64_3_A_1:CTGTAACTGTGTTGx 0.000000 10.431952 10.768416  9.515705\n10X74_4_A_1:ATCAAATGTCTCCGx 0.000000 10.600612  9.907490  0.000000\n10X73_3_A_1:ACAACCGACCCACTx 9.106546 10.715895 10.492757  0.000000\n10X64_3_A_1:AAACATTGGGTCTAx 9.258303  9.258303  9.258303  9.258303\n10X64_3_A_1:TTGGTACTAGCGTTx 0.000000 10.284257 10.571931 10.284257\n10X64_3_A_1:GAAACAGATCTCTAx 0.000000  9.127371 10.225911  0.000000\n                            COTAN_Cl.code\n10X64_3_A_1:CTGTAACTGTGTTGx             1\n10X74_4_A_1:ATCAAATGTCTCCGx             0\n10X73_3_A_1:ACAACCGACCCACTx             1\n10X64_3_A_1:AAACATTGGGTCTAx             0\n10X64_3_A_1:TTGGTACTAGCGTTx             0\n10X64_3_A_1:GAAACAGATCTCTAx             0\n\n\n\n# Fit the model\nmodel &lt;- glm( COTAN_Cl.code ~., data = train.data, family = binomial,control = list(maxit = 50))\n# Summarize the model\nsummary(model)\n\n\nCall:\nglm(formula = COTAN_Cl.code ~ ., family = binomial, data = train.data, \n    control = list(maxit = 50))\n\nCoefficients:\n              Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)  9.110e+01  1.100e+07       0        1\nTfap2c       1.269e+00  8.987e+04       0        1\nGpc4        -6.821e-02  9.506e+04       0        1\nPsph         1.573e-01  1.201e+05       0        1\nPbdc1        8.595e-01  1.087e+05       0        1\nMcm6        -4.889e-01  1.543e+05       0        1\nCdca7       -7.372e-01  1.271e+05       0        1\nNmral1       6.463e-01  9.466e+04       0        1\nTipin       -1.070e+00  1.682e+05       0        1\nFbxl7       -4.258e-01  7.749e+04       0        1\nBtg2         1.586e+00  9.758e+04       0        1\nNrarp       -7.463e-01  1.204e+05       0        1\nIer2        -8.686e-01  1.185e+05       0        1\nRgcc         8.656e-01  1.541e+05       0        1\nRlbp1       -6.125e-01  1.847e+05       0        1\nGm29260     -3.715e-01  1.893e+05       0        1\nRgs20       -1.391e+00  1.085e+05       0        1\nSfrp1        3.321e+00  1.832e+05       0        1\nNes          5.768e-01  1.546e+05       0        1\nMsi1        -2.990e-01  1.159e+05       0        1\nPantr1      -2.463e+00  3.393e+05       0        1\nCyr61        6.273e-02  1.076e+05       0        1\nZfp536       5.775e-01  9.432e+04       0        1\nPitpnc1     -4.029e-01  1.185e+05       0        1\nPolr3h       9.613e-01  9.686e+04       0        1\nCsmd1       -8.679e-01  1.555e+05       0        1\nMt3          6.199e-01  6.379e+04       0        1\nSncaip       5.435e-01  7.041e+04       0        1\nCT025619.1  -2.551e-01  8.493e+04       0        1\nSlc1a3       1.742e-02  9.355e+04       0        1\nRnf180      -1.198e-02  1.378e+05       0        1\nPtn          2.916e+00  3.358e+05       0        1\nAldoc       -7.125e-01  2.754e+05       0        1\nFgfbp3       6.299e-01  1.779e+05       0        1\nHes5        -4.311e-01  9.800e+04       0        1\nMfge8       -1.961e+00  1.023e+05       0        1\nMaml2        1.907e-02  5.771e+04       0        1\nLpar1        9.757e-01  9.494e+04       0        1\nCadm2       -3.372e+00  1.134e+05       0        1\nSema5a      -1.675e+00  1.458e+05       0        1\nQk           1.323e+00  1.343e+05       0        1\nNkain2      -9.102e-01  6.484e+04       0        1\nHes6         5.452e-02  6.297e+04       0        1\nRhbdl3      -9.056e-01  1.287e+05       0        1\nNeurog2      1.858e+00  1.775e+05       0        1\nChd7         1.672e+00  1.190e+05       0        1\nMsmo1       -1.116e+00  9.372e+04       0        1\nIgfbpl1     -1.102e+00  9.733e+04       0        1\nZmiz1       -8.943e-02  1.124e+05       0        1\nKat6b        1.046e-01  9.785e+04       0        1\nNfib         6.736e-01  1.481e+05       0        1\nFezf2       -4.256e-01  1.414e+05       0        1\nDok5        -2.646e-01  6.147e+04       0        1\nTenm2        6.249e-01  1.088e+05       0        1\nMeis2       -3.128e+00  4.298e+05       0        1\nMpped2      -1.662e+00  8.711e+04       0        1\nGm17750      8.710e-01  9.417e+04       0        1\nKcnh7       -2.218e+00  6.723e+04       0        1\nMir670hg    -3.468e-01  5.711e+04       0        1\nGpc6        -3.642e-01  1.059e+05       0        1\nDab1         1.157e+00  5.199e+04       0        1\nHist3h2ba    5.847e-02  8.058e+04       0        1\nScrn1        5.250e-01  1.096e+05       0        1\nAnk2         1.268e-01  7.979e+04       0        1\nBach2        9.614e-01  1.029e+05       0        1\nRbbp7       -8.930e-01  9.675e+04       0        1\nRpl26        8.709e-01  8.948e+04       0        1\nSerbp1       6.645e-01  2.959e+05       0        1\nPrmt1        1.329e+00  3.342e+05       0        1\nRack1        1.546e+00  1.748e+05       0        1\nHsp90aa1    -1.847e+00  2.365e+05       0        1\nDdx39        1.593e-01  8.123e+04       0        1\nCct5        -8.543e-01  1.388e+05       0        1\nH2afx       -1.026e+00  4.980e+04       0        1\nLsm3         5.727e-01  7.913e+04       0        1\nNtmt1        1.509e+00  7.867e+04       0        1\nHmgb3        1.084e+00  1.624e+05       0        1\nSnrnp70      2.391e-01  9.161e+04       0        1\nRfc2        -5.456e-02  1.359e+05       0        1\nTuba1b      -4.150e-01  3.443e+05       0        1\nSnrpb        1.624e+00  1.615e+05       0        1\nPsma7       -2.890e+00  2.978e+05       0        1\nPmpcb        3.020e-01  1.059e+05       0        1\nSrsf3        5.908e-01  1.061e+05       0        1\nRbmxl1       3.515e-01  1.152e+05       0        1\nCdk4        -2.678e+00  4.559e+05       0        1\nNap1l4      -1.278e+00  7.349e+04       0        1\nFam133b      1.006e-01  1.346e+05       0        1\nCdc123      -4.317e-01  6.492e+04       0        1\nDnajc9      -5.143e-01  1.678e+05       0        1\nRpl12        8.145e-01  1.663e+05       0        1\nRpl22       -1.353e+00  1.694e+05       0        1\nHspe1        1.330e+00  4.200e+05       0        1\nCks1b        1.058e-01  1.376e+05       0        1\nSnrpg        1.420e-01  2.873e+05       0        1\nPpia        -5.161e-01  1.577e+05       0        1\nCnbp         1.928e+00  3.159e+05       0        1\nSub1        -1.771e+00  2.784e+05       0        1\nPsip1       -4.159e-01  2.388e+05       0        1\nEprs         9.878e-02  8.837e+04       0        1\nJun         -2.926e-01  2.278e+05       0        1\nPgrmc1       5.101e-02  7.627e+04       0        1\nArl15        6.780e-01  7.922e+04       0        1\nDach1        1.080e+00  9.341e+04       0        1\nRps25        3.488e-01  2.584e+05       0        1\nDynll1      -6.168e-01  1.502e+05       0        1\nSem1         1.229e+00  1.703e+05       0        1\nRps28       -1.869e+00  2.408e+05       0        1\nEif3f        2.478e+00  2.076e+05       0        1\nTspan6      -2.873e-01  1.220e+05       0        1\nRpl34        1.559e+00  1.774e+05       0        1\nMrps17      -6.999e-01  7.009e+04       0        1\nAtp5j       -2.599e+00  1.580e+05       0        1\nHigd2a      -8.631e-01  8.685e+04       0        1\nDdx50        1.978e-01  6.112e+04       0        1\nPhf21a       4.734e-02  1.416e+05       0        1\nBaz2b        3.822e-01  1.065e+05       0        1\nElob         1.230e-01  2.714e+05       0        1\nBtbd1       -1.736e+00  1.589e+05       0        1\nUbb         -2.238e+00  2.281e+05       0        1\nH2afz       -3.049e-01  1.942e+05       0        1\nZfp609       8.505e-01  1.129e+05       0        1\nRpl35a       4.897e-01  8.416e+04       0        1\nNt5dc2      -1.427e+00  9.207e+04       0        1\nmt.Nd4      -7.328e-02  3.175e+05       0        1\nmt.Nd1      -1.908e+00  2.255e+05       0        1\nPcm1         5.611e-01  1.108e+05       0        1\nHes1         9.600e-01  1.061e+05       0        1\nNdufc2      -1.419e+00  2.676e+05       0        1\nPcna         4.616e-01  6.297e+04       0        1\nAtp5f1      -3.844e-01  1.011e+05       0        1\nGsk3b       -1.919e-01  7.113e+04       0        1\nMtch1        1.147e+00  1.202e+05       0        1\nGpatch8      4.568e-01  9.356e+04       0        1\nMap1b        1.551e+00  2.419e+05       0        1\nRomo1       -5.410e-01  1.238e+05       0        1\nXist        -1.305e-01  1.094e+05       0        1\nFdft1       -5.520e-01  7.836e+04       0        1\nHmgcs1      -7.972e-01  8.031e+04       0        1\nEif1b       -1.292e+00  1.656e+05       0        1\nSox4         3.599e-01  1.368e+05       0        1\nFxyd6       -1.258e+00  1.080e+05       0        1\nEef2         2.844e+00  3.756e+05       0        1\nTubb2b      -1.250e+00  2.711e+05       0        1\nRtn1        -7.304e-01  7.360e+04       0        1\nAcat1       -1.269e+00  1.311e+05       0        1\nGlrx2       -1.486e-01  8.741e+04       0        1\nNdufa4       1.511e+00  2.772e+05       0        1\nCox7c        2.185e+00  1.839e+05       0        1\nScg5        -3.069e-01  1.030e+05       0        1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 3.1622e+02  on 257  degrees of freedom\nResidual deviance: 5.5839e-10  on 108  degrees of freedom\nAIC: 300\n\nNumber of Fisher Scoring iterations: 27\n\n# Make predictions\nprobabilities &lt;- model %&gt;% predict(test.data, type = \"response\")\npredicted.classes &lt;- ifelse(probabilities &gt; 0.5, \"1\", \"0\")\n# Model accuracy\naccuracy &lt;- mean(predicted.classes == test.data$COTAN_Cl.code)\nresult.df[nrow(result.df),\"Accuracy\"] &lt;- accuracy\n\naccuracy\n\n[1] 0.734375\n\n\nSo also in this case a logistic regression confirm the difference in cell population detected by COTAN.\n\ncl184ClsMarkers &lt;- findClustersMarkers(cl184,n = 200,adjustmentMethod = \"BH\")\ncl184ClsMarkers\n\n    CL           Gene        DEA      adjPVal IsMarker   logFoldCh\n1    1        Neurog2 -0.5831758 1.512459e-21        0 -1.39130757\n2    1          Pttg1 -0.4033780 1.887999e-10        0 -1.43150739\n3    1        Gadd45g -0.3900940 8.341062e-10        0 -1.47879552\n4    1          Cenpa -0.3862799 1.224041e-09        0 -1.29099095\n5    1          Ccnb2 -0.3567580 3.493105e-08        0 -1.46159235\n6    1         Elavl4 -0.3468155 9.942177e-08        0 -0.75589932\n7    1      Hist1h2bc -0.3466218 9.995550e-08        0 -0.86447991\n8    1          Ascl1 -0.2878400 2.956244e-05        0 -1.23580955\n9    1        Zc3h12c -0.2809135 5.174697e-05        0 -0.71906028\n10   1          Rcor2 -0.2747659 8.379956e-05        0 -0.68126225\n11   1            Bsg -0.2711846 1.124021e-04        0 -0.16704556\n12   1           Chd7 -0.2689249 1.356518e-04        0 -0.45825134\n13   1           Btg2 -0.2612303 2.603476e-04        0 -0.57453573\n14   1           Dll1 -0.2579497 3.237474e-04        0 -1.48812048\n15   1          Palld -0.2522358 4.924999e-04        0 -0.39830033\n16   1          Ube2c -0.2475064 6.908938e-04        0 -0.41115299\n17   1          Kdm7a -0.2447899 8.183800e-04        0 -1.03349500\n18   1            Tpr -0.2430920 9.188377e-04        0 -0.23402062\n19   1            Mt2 -0.2426674 9.402582e-04        0 -0.21444711\n20   1           Hes6 -0.2422156 9.643956e-04        0 -0.44197418\n21   1           Fgd4 -0.2419726 9.724992e-04        0 -0.50218344\n22   1           Gpc4 -0.2400377 1.125518e-03        0 -0.31960198\n23   1       Mir9.3hg -0.2365443 1.419164e-03        0 -0.19384147\n24   1      Hist3h2ba -0.2311223 1.997610e-03        0 -0.34933545\n25   1          Cenpe -0.2300613 2.152345e-03        0 -1.45377818\n26   1           H1f0 -0.2288964 2.330474e-03        0 -0.30932670\n27   1         Knstrn -0.2281237 2.450699e-03        0 -0.68360700\n28   1         Atad2b -0.2266648 2.645925e-03        0 -0.42532807\n29   1        Igfbpl1 -0.2250937 2.926312e-03        0 -0.50257889\n30   1           Jam3 -0.2203988 3.798475e-03        0 -0.41024029\n31   1       Slc25a27 -0.2169349 4.818073e-03        0 -0.42497684\n32   1         Smim13 -0.2139037 5.765298e-03        0 -0.60289476\n33   1           Gng2 -0.2137225 5.810446e-03        0 -0.46536664\n34   1          Kdm5b -0.2121057 6.422646e-03        0 -0.36398690\n35   1          Cdca3 -0.2100974 7.207400e-03        0 -0.68499462\n36   1           Gja1 -0.2085117 7.958071e-03        0 -0.64915425\n37   1           Usp3 -0.2070993 8.523113e-03        0 -0.31011816\n38   1          Insm1 -0.2063698 8.944107e-03        0 -0.80644302\n39   1         Rnf146 -0.2019032 1.166266e-02        0 -0.49655832\n40   1          Prag1 -0.1999976 1.308082e-02        0 -0.53173283\n41   1         Dmrta2 -0.1968723 1.539823e-02        0 -0.28567311\n42   1           Eci2 -0.1959389 1.625165e-02        0 -0.16442599\n43   1         mt.Nd2 -0.1957754 1.633172e-02        0 -0.22039650\n44   1         Rhbdl3 -0.1944022 1.748583e-02        0 -0.25720862\n45   1           Ssr2 -0.1936495 1.811995e-02        0 -0.23702265\n46   1          Ccnb1 -0.1931041 1.868251e-02        0 -0.80824955\n47   1           Nfix -0.1921514 1.954910e-02        0 -0.17028655\n48   1         Ppp1cb -0.1918527 1.983731e-02        0 -0.27439314\n49   1           Rnf5 -0.1918121 1.983731e-02        0 -0.27232424\n50   1          Eomes -0.1913548 2.033188e-02        0 -1.50008613\n51   1        Laptm4a -0.1897758 2.218633e-02        0 -0.17299330\n52   1          Gdpd1 -0.1887891 2.340841e-02        0 -0.23825994\n53   1          Timp2 -0.1885776 2.366913e-02        0 -0.31062215\n54   1         Tmem59 -0.1880719 2.426355e-02        0 -0.27392623\n55   1          Cenpf -0.1864043 2.619452e-02        0 -0.41650568\n56   1        Tmem127 -0.1862853 2.619452e-02        0 -0.68982733\n57   1         Arxes2 -0.1862756 2.619452e-02        0 -0.68939246\n58   1          Lzts1 -0.1859740 2.664017e-02        0 -1.50408762\n59   1          Jmjd6 -0.1853850 2.745645e-02        0 -0.30428514\n60   1         Bckdha -0.1840007 2.910257e-02        0 -0.51569540\n61   1          Slit2 -0.1830365 3.058326e-02        0 -0.70007048\n62   1          Ddit4 -0.1830365 3.058326e-02        0 -0.23056730\n63   1          Siah3 -0.1829564 3.058326e-02        0 -0.50950870\n64   1          Asna1 -0.1828479 3.059255e-02        0 -0.24053934\n65   1         Akap8l -0.1822234 3.140759e-02        0 -0.43417761\n66   1            Os9 -0.1814048 3.229840e-02        0 -0.40610196\n67   1           Odc1 -0.1814037 3.229840e-02        0 -0.94708523\n68   1        Selenos -0.1799813 3.427183e-02        0 -0.19306172\n69   1          Aamdc -0.1798102 3.448342e-02        0 -0.40172927\n70   1         Agpat4 -0.1798102 3.448342e-02        0 -0.37770129\n71   1          Nop53 -0.1796210 3.473608e-02        0 -0.23849178\n72   1           Emc6 -0.1794437 3.496512e-02        0 -0.18767018\n73   1           Mfng -0.1783335 3.681725e-02        0 -0.54482185\n74   1         Zfp637 -0.1783185 3.681725e-02        0 -0.19956155\n75   1        Fam168b -0.1779520 3.735993e-02        0 -0.22485811\n76   1     AC154683.1 -0.1774342 3.837054e-02        0 -1.49632113\n77   1           Bptf -0.1771338 3.872229e-02        0 -0.34544312\n78   1            Jtb -0.1763457 4.028975e-02        0 -0.19863647\n79   1          Psrc1 -0.1760624 4.091123e-02        0 -0.93641309\n80   1          Ttc23 -0.1749525 4.342427e-02        0 -0.42880194\n81   1          Reps1 -0.1746468 4.405682e-02        0 -1.20006014\n82   1           Top1 -0.1745413 4.415475e-02        0 -0.23557563\n83   1           Psd3 -0.1742261 4.487590e-02        0 -1.13958202\n84   1           Cltc -0.1737510 4.566116e-02        0 -0.68818990\n85   1           Ktn1 -0.1733267 4.666085e-02        0 -0.22152324\n86   1          Wdr12 -0.1732132 4.688660e-02        0 -0.34963288\n87   1         Pabpc1 -0.1729215 4.752748e-02        0 -0.16464519\n88   1 X2610001J05Rik -0.1728352 4.767874e-02        0 -0.17472798\n89   1           Lhx2 -0.1726654 4.797466e-02        0 -0.28162939\n90   1          Foxp2 -0.1725622 4.817668e-02        0 -0.25513168\n91   1          Srrm4 -0.1720733 4.928654e-02        0 -1.03877312\n92   1           Eml5 -0.1718230 4.966763e-02        0 -0.32448358\n93   1         Sh3rf1 -0.1714391 5.054485e-02        0 -0.39969855\n94   1       Slc16a14 -0.1714257 5.054485e-02        0 -0.72548528\n95   1         Rb1cc1 -0.1713383 5.062964e-02        0 -0.42499406\n96   1          Lockd -0.1710020 5.145818e-02        0 -0.36446249\n97   1         Txnrd1 -0.1707097 5.216199e-02        0 -0.21117500\n98   1          Pfdn2 -0.1705995 5.224874e-02        0 -0.08400791\n99   1        Rps27rt -0.1696927 5.489125e-02        0 -0.19354428\n100  1           Mbd5 -0.1695000 5.520461e-02        0 -0.48897472\n101  1          Itgb1 -0.1694991 5.520461e-02        0 -0.19584190\n102  1          Ccnl2 -0.1692367 5.521501e-02        0 -0.09177134\n103  1           Rmst -0.1682253 5.796607e-02        0 -1.27032788\n104  1        Hnrnpa1 -0.1681509 5.811180e-02        0 -0.14576877\n105  1         Ccdc12 -0.1677864 5.915468e-02        0 -0.16906794\n106  1         Zfp157 -0.1673683 5.995028e-02        0 -0.52026271\n107  1         Trip12 -0.1673291 5.995028e-02        0 -0.34943156\n108  1        Laptm4b -0.1672823 5.995028e-02        0 -0.33170170\n109  1        Akirin2 -0.1670714 6.045082e-02        0 -0.40527418\n110  1           Tshr -0.1669968 6.055351e-02        0 -0.55592360\n111  1          Eif2a -0.1667767 6.105751e-02        0 -0.20248082\n112  1           Bfar -0.1663525 6.191719e-02        0 -0.36167688\n113  1          Ap3s1 -0.1663194 6.192523e-02        0 -0.33114029\n114  1           Dph1 -0.1659315 6.278121e-02        0 -1.48371426\n115  1         Cfap36 -0.1658042 6.291256e-02        0 -0.27506880\n116  1           Gpx8 -0.1647999 6.535431e-02        0 -0.32579681\n117  1          Hif1a -0.1640060 6.789374e-02        0 -0.48187187\n118  1       Aasdhppt -0.1636473 6.825505e-02        0 -0.28623795\n119  1         Draxin -0.1634910 6.834541e-02        0 -0.42253273\n120  1         Tmem33 -0.1634841 6.834541e-02        0 -0.23757017\n121  1            H13 -0.1626389 7.044856e-02        0 -0.32771944\n122  1           Fpgs -0.1621770 7.198537e-02        0 -0.74272924\n123  1          Mdga1 -0.1610644 7.450494e-02        0 -1.10884549\n124  1          Kdm6b -0.1609352 7.469519e-02        0 -0.46530168\n125  1          Bach2 -0.1606601 7.572134e-02        0 -0.29476183\n126  1        Ankrd37 -0.1606398 7.572134e-02        0 -0.56885622\n127  1           Lig3 -0.1604600 7.620548e-02        0 -0.57277632\n128  1           Lrp4 -0.1602753 7.633588e-02        0 -0.54255835\n129  1           Ccz1 -0.1600856 7.704235e-02        0 -0.13292645\n130  1        Slc2a13 -0.1599703 7.742686e-02        0 -0.50855381\n131  1           Ptms -0.1597050 7.830579e-02        0 -0.29259682\n132  1           Rab7 -0.1592093 7.995981e-02        0 -0.12293605\n133  1         Lrrc51 -0.1589161 8.104420e-02        0 -1.47316169\n134  1       Tnfrsf19 -0.1588692 8.113333e-02        0 -0.45311955\n135  1        Serinc1 -0.1587851 8.126099e-02        0 -0.21441979\n136  1 X1110004F10Rik -0.1587595 8.126099e-02        0 -0.10430969\n137  1         Klhl24 -0.1586593 8.126226e-02        0 -0.38142234\n138  1          Snrpa -0.1585852 8.131399e-02        0 -0.17180810\n139  1          Tmed4 -0.1585087 8.141722e-02        0 -0.28734854\n140  1          Syne2 -0.1581768 8.237897e-02        0 -0.23440549\n141  1          Kcnrg -0.1578483 8.335872e-02        0 -1.49462152\n142  1           Rnd2 -0.1578483 8.335872e-02        0 -1.48697089\n143  1          Hmgn5 -0.1570710 8.645971e-02        0 -0.24680033\n144  1           Mia2 -0.1568528 8.735149e-02        0 -0.26692785\n145  1         Kif21a -0.1567768 8.759292e-02        0 -0.11360722\n146  1           Cct2 -0.1566584 8.765398e-02        0 -0.13234402\n147  1          Eef2k -0.1564831 8.812519e-02        0 -0.57994616\n148  1          Ppm1b -0.1562277 8.912649e-02        0 -0.31158233\n149  1         Cacnb4 -0.1560213 8.965318e-02        0 -0.59596871\n150  1          Mex3a -0.1557274 9.097391e-02        0 -0.24904478\n151  1          Paip2 -0.1554416 9.202663e-02        0 -0.13123212\n152  1           Lsg1 -0.1553886 9.216399e-02        0 -0.24220200\n153  1        Arhgef2 -0.1553111 9.236420e-02        0 -0.52227443\n154  1          Hyal2 -0.1552934 9.236420e-02        0 -0.28606082\n155  1          Samd8 -0.1552303 9.244166e-02        0 -1.04246472\n156  1        Slc18b1 -0.1549973 9.350691e-02        0 -0.89119608\n157  1          Clcn3 -0.1546560 9.501403e-02        0 -0.27388620\n158  1         Igfbp2 -0.1545482 9.528203e-02        0 -0.17183487\n159  1          Rps25 -0.1540559 9.709776e-02        0 -0.08285596\n160  1          Tubb3 -0.1539727 9.730002e-02        0 -0.28710293\n161  1          Trrap -0.1539668 9.730002e-02        0 -0.69086779\n162  1          Rbm28 -0.1535993 9.900455e-02        0 -0.17512792\n163  1          Igf1r -0.1532320 1.001737e-01        0 -0.18565244\n164  1          Acsl4 -0.1524926 1.032971e-01        0 -1.47648044\n165  1        Tmem178 -0.1522797 1.043592e-01        0 -0.42984756\n166  1         Ndufa6 -0.1518572 1.062009e-01        0 -0.13794099\n167  1          Alpk1 -0.1508881 1.105650e-01        0 -0.77110477\n168  1           Wapl -0.1507023 1.113799e-01        0 -0.37155075\n169  1          Usp22 -0.1503368 1.134450e-01        0 -0.33912281\n170  1        Dnttip2 -0.1503071 1.134738e-01        0 -0.20322647\n171  1           Lrp8 -0.1499898 1.146573e-01        0 -0.53557896\n172  1          Masp1 -0.1497247 1.160696e-01        0 -0.32132151\n173  1         Hilpda -0.1494661 1.160696e-01        0 -0.40070065\n174  1          Rnf41 -0.1494661 1.160696e-01        0 -0.23944894\n175  1          Pias1 -0.1493413 1.163868e-01        0 -0.28687435\n176  1        Jakmip2 -0.1490263 1.179033e-01        0 -0.45703951\n177  1         Crebbp -0.1483156 1.214410e-01        0 -0.21721242\n178  1        Gm15545 -0.1476550 1.242196e-01        0 -1.49398047\n179  1         Mboat2 -0.1476355 1.242196e-01        0 -0.24453534\n180  1           Nle1 -0.1472637 1.260498e-01        0 -0.29531402\n181  1          Mbtd1 -0.1470653 1.265774e-01        0 -0.22167452\n182  1        Tmem35a -0.1469851 1.266466e-01        0 -1.50611416\n183  1          Cebpz -0.1469835 1.266466e-01        0 -0.17629012\n184  1           Emx1 -0.1468535 1.271638e-01        0 -0.20501463\n185  1           Tsr3 -0.1467125 1.273525e-01        0 -0.28468483\n186  1          Fezf2 -0.1462894 1.284581e-01        0 -0.25237380\n187  1       Col4a3bp -0.1462746 1.284581e-01        0 -0.53977782\n188  1          Ypel2 -0.1460369 1.293375e-01        0 -0.59908155\n189  1         Zdhhc9 -0.1460369 1.293375e-01        0 -0.82703245\n190  1       BC049730 -0.1458864 1.293375e-01        0 -0.86594762\n191  1        Slc15a4 -0.1458146 1.293375e-01        0 -0.81315673\n192  1          Mtus1 -0.1457745 1.293375e-01        0 -0.46501331\n193  1        Slc30a6 -0.1457424 1.293375e-01        0 -0.46955821\n194  1         mt.Nd5 -0.1455962 1.298816e-01        0 -0.26450106\n195  1          Cdc40 -0.1455164 1.302707e-01        0 -0.28549454\n196  1        Morf4l2 -0.1453907 1.306626e-01        0 -0.11739701\n197  1        Slc35e2 -0.1452965 1.310604e-01        0 -0.79268238\n198  1          Tmed9 -0.1452780 1.310604e-01        0 -0.06663226\n199  1         Fbxo11 -0.1452515 1.310604e-01        0 -0.49404543\n200  1       Ftl1.ps1 -0.1450887 1.319597e-01        0 -0.32582298\n201  1            Tk1  0.5481229 4.762447e-19        0  1.23101921\n202  1            Ung  0.5184538 5.470494e-17        0  0.79295818\n203  1          Hells  0.5052264 3.338213e-16        0  0.67681838\n204  1           Rrm2  0.5045323 3.338213e-16        0  0.90657877\n205  1           Lig1  0.4999158 5.921905e-16        0  0.89100637\n206  1          Prim1  0.4947631 1.170238e-15        0  0.66506406\n207  1           Mcm3  0.4924806 1.478449e-15        0  0.72979998\n208  1          Dscc1  0.4904379 1.823075e-15        0  1.75567703\n209  1           Dhfr  0.4855447 3.574481e-15        0  0.85281521\n210  1          Ccne2  0.4813898 6.257065e-15        0  1.50581190\n211  1           Rmi2  0.4764947 1.232433e-14        0  1.21147155\n212  1           Cdt1  0.4716972 2.389760e-14        0  0.87079957\n213  1           Gmnn  0.4705496 2.647318e-14        0  0.79120719\n214  1           E2f1  0.4691825 3.047224e-14        0  0.77782890\n215  1           Mcm5  0.4661990 4.505093e-14        0  0.73973513\n216  1           Exo1  0.4629547 6.935804e-14        0  1.31188184\n217  1          Gins2  0.4586114 1.259294e-13        0  0.74222428\n218  1         Pkmyt1  0.4525524 2.939510e-13        0  1.76480458\n219  1           Rpa2  0.4483145 5.210920e-13        0  0.75795432\n220  1         Chaf1b  0.4330415 4.482742e-12        0  0.83861798\n221  1           Smc2  0.4298745 6.691337e-12        0  0.65332490\n222  1           Mcm6  0.4255158 1.164964e-11        0  0.53880518\n223  1           Rfc3  0.4252908 1.164964e-11        0  0.67977204\n224  1           Fen1  0.4241740 1.306249e-11        0  0.79956735\n225  1           Cdc6  0.4147952 4.555751e-11        0  1.30725721\n226  1          Tipin  0.4128253 5.730175e-11        0  0.55333545\n227  1           Rfc4  0.4055504 1.465941e-10        0  0.56606644\n228  1           Orc6  0.4031162 1.889336e-10        0  0.51696150\n229  1          Atad2  0.4027014 1.931419e-10        0  0.82256923\n230  1          Rad51  0.4015230 2.185635e-10        0  1.05155473\n231  1         Sorcs1  0.3998672 2.634664e-10        0  0.71056991\n232  1          Cdc45  0.3994626 2.696508e-10        0  1.38985555\n233  1           Pcna  0.3958584 4.192105e-10        0  0.62245412\n234  1          Prim2  0.3926569 6.167546e-10        0  0.76923210\n235  1          Gins1  0.3889994 9.068043e-10        0  0.75790737\n236  1           Tyms  0.3889452 9.068043e-10        0  0.63069038\n237  1           Rfc2  0.3888308 9.068043e-10        0  0.48689426\n238  1          Pold1  0.3840099 1.592402e-09        0  0.85763653\n239  1          Brca1  0.3809564 2.282924e-09        0  1.53371887\n240  1            Nrm  0.3746952 4.855518e-09        0  0.71752912\n241  1          Uhrf1  0.3741092 5.102867e-09        0  0.71774577\n242  1          Tcf19  0.3726651 5.960484e-09        0  1.09393659\n243  1          Clspn  0.3708249 7.305879e-09        0  1.21161664\n244  1           Mcm4  0.3705882 7.363143e-09        0  0.69221047\n245  1       Rad51ap1  0.3664869 1.183208e-08        0  1.51093976\n246  1         Fignl1  0.3663395 1.183208e-08        0  0.78739338\n247  1         Tubb2a  0.3584901 2.959921e-08        0  0.58301867\n248  1           Rfc5  0.3580495 3.057987e-08        0  0.65123397\n249  1          Dnmt1  0.3534086 5.073745e-08        0  0.64921891\n250  1         Mms22l  0.3523348 5.644314e-08        0  0.47476249\n251  1            Blm  0.3513156 6.239238e-08        0  1.09753554\n252  1          Cadm2  0.3494327 7.619531e-08        0  0.43100882\n253  1        Kbtbd11  0.3475093 9.340953e-08        0  0.53870228\n254  1          Asf1b  0.3456599 1.097336e-07        0  1.12574407\n255  1          Gins3  0.3437180 1.346525e-07        0  1.43953193\n256  1            Dtl  0.3420028 1.609066e-07        0  0.63666799\n257  1           Lrr1  0.3410244 1.768658e-07        0  1.34776091\n258  1           Plk4  0.3375183 2.579469e-07        0  1.27616216\n259  1          Cenph  0.3368739 2.729450e-07        0  0.72695469\n260  1          Fbxo5  0.3365915 2.774533e-07        0  1.06334486\n261  1          Ccne1  0.3364004 2.792425e-07        0  0.82221801\n262  1          Grik1  0.3344476 3.417014e-07        0  0.72816303\n263  1           Alad  0.3327220 4.074095e-07        0  0.48414721\n264  1          Eepd1  0.3274962 7.106262e-07        0  0.77762316\n265  1           Pole  0.3222971 1.225679e-06        0  1.03798408\n266  1           Mcm2  0.3201911 1.512491e-06        0  0.37595352\n267  1          Kntc1  0.3185664 1.771901e-06        0  1.10636461\n268  1          Pold3  0.3184197 1.775550e-06        0  0.56141552\n269  1          Pclaf  0.3180722 1.815112e-06        0  0.64644078\n270  1          Csmd1  0.3179611 1.815112e-06        0  0.51261398\n271  1         Dnajc9  0.3161577 2.165687e-06        0  0.43077793\n272  1         Sdf2l1  0.3111449 3.575833e-06        0  0.55112559\n273  1          Cenps  0.3110926 3.575833e-06        0  0.56140907\n274  1       Rnaseh2a  0.3106096 3.712066e-06        0  0.43128750\n275  1         Rad54l  0.3088625 4.388036e-06        0  0.90032432\n276  1          Mastl  0.3086734 4.420005e-06        0  1.78749970\n277  1           Rrm1  0.3076512 4.848783e-06        0  0.48997891\n278  1           Cdk1  0.3053396 6.062574e-06        0  0.42998209\n279  1          Tedc1  0.3015961 8.739604e-06        0  1.57988859\n280  1           Polq  0.3005893 9.554950e-06        0  1.79941491\n281  1          Syce2  0.2998356 1.018436e-05        0  0.57870336\n282  1          Fanca  0.2995940 1.020068e-05        0  1.76252131\n283  1          Mcm10  0.2995940 1.020068e-05        0  1.77431964\n284  1          Cenpk  0.2970192 1.302457e-05        0  0.92684790\n285  1          Atad5  0.2960161 1.422295e-05        0  0.66497600\n286  1          Hspa5  0.2957557 1.443540e-05        0  0.34857351\n287  1         Donson  0.2942344 1.658229e-05        0  0.70953315\n288  1         Topbp1  0.2931980 1.815752e-05        0  0.56767034\n289  1           Mcm7  0.2908473 2.258309e-05        0  0.47125498\n290  1           Prc1  0.2885362 2.793528e-05        0  0.87174887\n291  1         Mis18a  0.2874469 3.038777e-05        0  0.71322525\n292  1          Cenpu  0.2864857 3.250784e-05        0  0.90962079\n293  1          Pola2  0.2864550 3.250784e-05        0  0.57334202\n294  1          Aunip  0.2864298 3.250784e-05        0  1.76517410\n295  1         Mthfd2  0.2850154 3.650680e-05        0  0.54048861\n296  1           Etv4  0.2850083 3.650680e-05        0  1.75903148\n297  1           Mcm8  0.2831852 4.297835e-05        0  0.78050949\n298  1          Top2a  0.2829825 4.339581e-05        0  0.82979097\n299  1          Fxyd6  0.2813744 5.001967e-05        0  0.40426670\n300  1           Nav2  0.2797307 5.727431e-05        0  0.66779549\n301  1          Wdr76  0.2786202 6.294447e-05        0  0.71742684\n302  1            Pgp  0.2772259 7.099889e-05        0  0.41317974\n303  1          Alcam  0.2766013 7.455105e-05        0  0.39154940\n304  1          Rad18  0.2764652 7.482670e-05        0  1.07430737\n305  1           Eme1  0.2757315 7.936558e-05        0  0.95504349\n306  1        Psmc3ip  0.2755943 7.959986e-05        0  0.45749056\n307  1       Timeless  0.2754980 7.959986e-05        0  0.54988161\n308  1           Wwox  0.2754176 7.959986e-05        0  0.32227988\n309  1         Hspa14  0.2727729 9.972895e-05        0  0.40857579\n310  1        Fam111a  0.2725486 1.001077e-04        0  1.76316774\n311  1          Cenpi  0.2725486 1.001077e-04        0  1.83787774\n312  1          Ticrr  0.2709664 1.137171e-04        0  1.09466338\n313  1           Cltb  0.2659193 1.761443e-04        0  0.47464273\n314  1           Vrk1  0.2657271 1.777642e-04        0  0.39919978\n315  1          Esco2  0.2616524 2.528592e-04        0  1.13610777\n316  1         Prkab1  0.2609828 2.639917e-04        0  0.69817315\n317  1          Cenpn  0.2606012 2.708575e-04        0  0.60515605\n318  1          Haus6  0.2601831 2.787937e-04        0  0.67359863\n319  1          Gna14  0.2592081 2.989626e-04        0  1.24822818\n320  1          Brip1  0.2592081 2.989626e-04        0  1.16674243\n321  1          Nup93  0.2587342 3.092151e-04        0  0.53491483\n322  1        Fam181b  0.2580633 3.230401e-04        0  0.35332726\n323  1         Shisa9  0.2580595 3.230401e-04        0  1.73879040\n324  1          Tex30  0.2578102 3.253080e-04        0  0.51878228\n325  1           Rfc1  0.2562919 3.680646e-04        0  0.31382899\n326  1          Ccnd1  0.2562135 3.680646e-04        0  0.49886167\n327  1           Manf  0.2558539 3.769365e-04        0  0.30846644\n328  1           Nsd2  0.2551691 3.960768e-04        0  0.36592805\n329  1           Rgcc  0.2551131 3.960768e-04        0  0.35209128\n330  1          Siva1  0.2545418 4.130557e-04        0  0.30396703\n331  1           Lsm2  0.2532311 4.587805e-04        0  0.27714384\n332  1           Nsl1  0.2524604 4.865060e-04        0  0.73228120\n333  1        Tnfaip8  0.2515013 5.205927e-04        0  0.53773780\n334  1         Tubb4b  0.2500445 5.847639e-04        0  0.32728177\n335  1        St8sia1  0.2494842 6.088915e-04        0  0.74123396\n336  1           Mtbp  0.2489993 6.299863e-04        0  0.74784551\n337  1          Gins4  0.2486660 6.435753e-04        0  0.35407544\n338  1           Hat1  0.2482886 6.567606e-04        0  0.39901499\n339  1          Cand2  0.2482675 6.567606e-04        0  0.84060034\n340  1            Dut  0.2480137 6.665157e-04        0  0.37622944\n341  1        Tmem201  0.2472057 7.039173e-04        0  0.67399836\n342  1          Rbbp7  0.2469684 7.134225e-04        0  0.25999405\n343  1        Zscan22  0.2462672 7.503276e-04        0  0.86018446\n344  1           Xbp1  0.2462103 7.503276e-04        0  0.49134064\n345  1          Ywhah  0.2461228 7.510983e-04        0  0.32825814\n346  1          Haus4  0.2458835 7.598680e-04        0  0.53385523\n347  1          Usp51  0.2458340 7.598680e-04        0  1.19671799\n348  1         Mrps26  0.2448680 8.180747e-04        0  0.40447865\n349  1          Cyr61  0.2441632 8.543449e-04        0  0.17814705\n350  1           Nrg1  0.2441222 8.543449e-04        0  0.27984683\n351  1            Dek  0.2435911 8.871954e-04        0  0.34892341\n352  1          Fstl5  0.2427873 9.365412e-04        0  0.33185528\n353  1          Kif24  0.2424962 9.479911e-04        0  1.15680175\n354  1           Nrg3  0.2421038 9.676553e-04        0  0.45766554\n355  1        Flywch2  0.2411600 1.033238e-03        0  0.58361314\n356  1          Chek1  0.2391718 1.200473e-03        0  0.91292776\n357  1         Trim37  0.2379107 1.321544e-03        0  0.28132708\n358  1         Chaf1a  0.2376088 1.346492e-03        0  0.68231148\n359  1         Pdzph1  0.2374147 1.360093e-03        0  0.57366634\n360  1          Haus8  0.2370510 1.392666e-03        0  0.49203394\n361  1           Hmbs  0.2369100 1.400802e-03        0  0.45776455\n362  1       Pcna.ps2  0.2367286 1.409097e-03        0  0.85437301\n363  1          Etaa1  0.2367006 1.409097e-03        0  0.36956284\n364  1        Tmem121  0.2362380 1.446582e-03        0  0.47909447\n365  1          Cdca2  0.2359494 1.472437e-03        0  1.34225876\n366  1        Irf2bpl  0.2356720 1.497428e-03        0  0.36188008\n367  1          Pde4b  0.2349984 1.571644e-03        0  0.45709381\n368  1           Mlf1  0.2346168 1.594202e-03        0  1.29851946\n369  1       Mis18bp1  0.2346168 1.594202e-03        0  1.21482781\n370  1          Spag5  0.2346168 1.594202e-03        0  1.34384480\n371  1          Zmym1  0.2345570 1.594202e-03        0  0.89458503\n372  1          Shmt1  0.2344105 1.600521e-03        0  0.52870919\n373  1          Tssc4  0.2343779 1.600521e-03        0  0.32770961\n374  1           Rhoc  0.2342239 1.611970e-03        0  0.36469101\n375  1          Cdca7  0.2338301 1.654677e-03        0  0.28447965\n376  1          Tfdp1  0.2335707 1.680510e-03        0  0.39952713\n377  1         Ncapg2  0.2327668 1.778155e-03        0  1.11538303\n378  1         Pradc1  0.2327289 1.778155e-03        0  0.53613567\n379  1           Slbp  0.2314104 1.962668e-03        0  0.51848583\n380  1          Hmga2  0.2300276 2.152345e-03        0  0.65705685\n381  1          Bard1  0.2299802 2.152345e-03        0  1.76615471\n382  1         Phlda1  0.2283316 2.423158e-03        0  0.55121094\n383  1           E2f6  0.2280089 2.457285e-03        0  0.59038008\n384  1           Cdk2  0.2279660 2.457285e-03        0  0.52067649\n385  1            Tnc  0.2276578 2.504683e-03        0  0.56151444\n386  1          Cks1b  0.2274528 2.532731e-03        0  0.27702256\n387  1           Glrb  0.2272253 2.565546e-03        0  0.52831459\n388  1         Trmt2a  0.2268055 2.637598e-03        0  0.46322401\n389  1          Hjurp  0.2266443 2.645925e-03        0  0.74464188\n390  1           Ect2  0.2257246 2.826640e-03        0  0.71038020\n391  1          Sall3  0.2255011 2.862344e-03        0  0.28170195\n392  1           Aars  0.2252039 2.914917e-03        0  0.47260875\n393  1          Hmgb2  0.2249976 2.933452e-03        0  0.07133909\n394  1          Htra2  0.2249440 2.933452e-03        0  0.61829587\n395  1          Ube2t  0.2248532 2.940696e-03        0  0.93571480\n396  1         Klhl29  0.2231737 3.316738e-03        0  0.77157230\n397  1           Slf1  0.2231390 3.316738e-03        0  0.13283425\n398  1           Msh6  0.2230983 3.316738e-03        0  0.49912847\n399  1         Tsen15  0.2229020 3.351720e-03        0  0.23835610\n400  1         Cep192  0.2226956 3.389717e-03        0  0.66700755\n401  2            Tk1 -0.5481345 4.752571e-19        0 -1.23101921\n402  2            Ung -0.5184663 5.458905e-17        0 -0.79295818\n403  2          Hells -0.5052327 3.334608e-16        0 -0.67681838\n404  2           Rrm2 -0.5045389 3.334608e-16        0 -0.90657877\n405  2           Lig1 -0.4999139 5.923731e-16        0 -0.89100637\n406  2          Prim1 -0.4947496 1.172798e-15        0 -0.66506406\n407  2           Mcm3 -0.4924667 1.481750e-15        0 -0.72979998\n408  2          Dscc1 -0.4904266 1.826358e-15        0 -1.75567703\n409  2           Dhfr -0.4855568 3.567640e-15        0 -0.85281521\n410  2          Ccne2 -0.4813782 6.268432e-15        0 -1.50581190\n411  2           Rmi2 -0.4764904 1.233260e-14        0 -1.21147155\n412  2           Cdt1 -0.4716974 2.389675e-14        0 -0.87079957\n413  2           Gmnn -0.4705553 2.644993e-14        0 -0.79120719\n414  2           E2f1 -0.4691944 3.041640e-14        0 -0.77782890\n415  2           Mcm5 -0.4661965 4.506787e-14        0 -0.73973513\n416  2           Exo1 -0.4629639 6.926220e-14        0 -1.31188184\n417  2          Gins2 -0.4586213 1.257432e-13        0 -0.74222428\n418  2         Pkmyt1 -0.4525684 2.932596e-13        0 -1.76480458\n419  2           Rpa2 -0.4483032 5.219558e-13        0 -0.75795432\n420  2         Chaf1b -0.4330365 4.485871e-12        0 -0.83861798\n421  2           Smc2 -0.4298835 6.682888e-12        0 -0.65332490\n422  2           Mcm6 -0.4255162 1.166768e-11        0 -0.53880518\n423  2           Rfc3 -0.4252797 1.166768e-11        0 -0.67977204\n424  2           Fen1 -0.4241640 1.308063e-11        0 -0.79956735\n425  2           Cdc6 -0.4147942 4.556424e-11        0 -1.30725721\n426  2          Tipin -0.4128119 5.740520e-11        0 -0.55333545\n427  2           Rfc4 -0.4055386 1.468243e-10        0 -0.56606644\n428  2           Orc6 -0.4031072 1.891601e-10        0 -0.51696150\n429  2          Atad2 -0.4026975 1.932413e-10        0 -0.82256923\n430  2          Rad51 -0.4015229 2.185669e-10        0 -1.05155473\n431  2         Sorcs1 -0.3998704 2.633575e-10        0 -0.71056991\n432  2          Cdc45 -0.3994418 2.703861e-10        0 -1.38985555\n433  2           Pcna -0.3958588 4.191910e-10        0 -0.62245412\n434  2          Prim2 -0.3926493 6.173534e-10        0 -0.76923210\n435  2          Gins1 -0.3890007 9.079434e-10        0 -0.75790737\n436  2           Tyms -0.3889389 9.079434e-10        0 -0.63069038\n437  2           Rfc2 -0.3888210 9.079434e-10        0 -0.48689426\n438  2          Pold1 -0.3840017 1.594052e-09        0 -0.85763653\n439  2          Brca1 -0.3809559 2.283052e-09        0 -1.53371887\n440  2            Nrm -0.3746927 4.857066e-09        0 -0.71752912\n441  2          Uhrf1 -0.3741173 5.097731e-09        0 -0.71774577\n442  2          Tcf19 -0.3726637 5.961525e-09        0 -1.09393659\n443  2          Clspn -0.3708075 7.321364e-09        0 -1.21161664\n444  2           Mcm4 -0.3706020 7.350728e-09        0 -0.69221047\n445  2       Rad51ap1 -0.3664745 1.182065e-08        0 -1.51093976\n446  2         Fignl1 -0.3663475 1.182065e-08        0 -0.78739338\n447  2         Tubb2a -0.3585003 2.956364e-08        0 -0.58301867\n448  2           Rfc5 -0.3580409 3.061082e-08        0 -0.65123397\n449  2          Dnmt1 -0.3534185 5.067871e-08        0 -0.64921891\n450  2         Mms22l -0.3523472 5.636179e-08        0 -0.47476249\n451  2            Blm -0.3513021 6.248984e-08        0 -1.09753554\n452  2          Cadm2 -0.3494273 7.624308e-08        0 -0.43100882\n453  2        Kbtbd11 -0.3475166 9.333162e-08        0 -0.53870228\n454  2          Asf1b -0.3456630 1.096947e-07        0 -1.12574407\n455  2          Gins3 -0.3437142 1.347095e-07        0 -1.43953193\n456  2            Dtl -0.3419938 1.610699e-07        0 -0.63666799\n457  2           Lrr1 -0.3410120 1.771134e-07        0 -1.34776091\n458  2           Plk4 -0.3375145 2.580565e-07        0 -1.27616216\n459  2          Cenph -0.3368874 2.725359e-07        0 -0.72695469\n460  2          Fbxo5 -0.3365765 2.779176e-07        0 -1.06334486\n461  2          Ccne1 -0.3363932 2.794664e-07        0 -0.82221801\n462  2          Grik1 -0.3344500 3.416098e-07        0 -0.72816303\n463  2           Alad -0.3327345 4.068515e-07        0 -0.48414721\n464  2          Eepd1 -0.3275144 7.092294e-07        0 -0.77762316\n465  2           Pole -0.3223002 1.225272e-06        0 -1.03798408\n466  2           Mcm2 -0.3201906 1.512578e-06        0 -0.37595352\n467  2          Kntc1 -0.3185619 1.772754e-06        0 -1.10636461\n468  2          Pold3 -0.3184306 1.773505e-06        0 -0.56141552\n469  2          Pclaf -0.3180640 1.813334e-06        0 -0.64644078\n470  2          Csmd1 -0.3179704 1.813334e-06        0 -0.51261398\n471  2         Dnajc9 -0.3161624 2.164628e-06        0 -0.43077793\n472  2         Sdf2l1 -0.3111584 3.574428e-06        0 -0.55112559\n473  2          Cenps -0.3110964 3.574428e-06        0 -0.56140907\n474  2       Rnaseh2a -0.3106038 3.714273e-06        0 -0.43128750\n475  2         Rad54l -0.3088671 4.385964e-06        0 -0.90032432\n476  2          Mastl -0.3086693 4.421875e-06        0 -1.78749970\n477  2           Rrm1 -0.3076603 4.844291e-06        0 -0.48997891\n478  2           Cdk1 -0.3053578 6.051432e-06        0 -0.42998209\n479  2          Tedc1 -0.3016261 8.713351e-06        0 -1.57988859\n480  2           Polq -0.3005773 9.566400e-06        0 -1.79941491\n481  2          Syce2 -0.2998414 1.017840e-05        0 -0.57870336\n482  2          Fanca -0.2995808 1.021407e-05        0 -1.76252131\n483  2          Mcm10 -0.2995808 1.021407e-05        0 -1.77431964\n484  2          Cenpk -0.2970270 1.301446e-05        0 -0.92684790\n485  2          Atad5 -0.2960144 1.422540e-05        0 -0.66497600\n486  2          Hspa5 -0.2957514 1.444147e-05        0 -0.34857351\n487  2         Donson -0.2942376 1.657710e-05        0 -0.70953315\n488  2         Topbp1 -0.2932021 1.815025e-05        0 -0.56767034\n489  2           Mcm7 -0.2908434 2.259163e-05        0 -0.47125498\n490  2           Prc1 -0.2885447 2.791246e-05        0 -0.87174887\n491  2         Mis18a -0.2874603 3.034868e-05        0 -0.71322525\n492  2          Cenpu -0.2864638 3.255471e-05        0 -0.90962079\n493  2          Pola2 -0.2864380 3.255471e-05        0 -0.57334202\n494  2          Aunip -0.2864147 3.255471e-05        0 -1.76517410\n495  2           Etv4 -0.2850162 3.653865e-05        0 -1.75903148\n496  2         Mthfd2 -0.2849991 3.653865e-05        0 -0.54048861\n497  2           Mcm8 -0.2831930 4.294694e-05        0 -0.78050949\n498  2          Top2a -0.2829765 4.342063e-05        0 -0.82979097\n499  2          Fxyd6 -0.2813864 4.996331e-05        0 -0.40426670\n500  2           Nav2 -0.2797154 5.735616e-05        0 -0.66779549\n501  2          Wdr76 -0.2786260 6.291080e-05        0 -0.71742684\n502  2            Pgp -0.2772129 7.108394e-05        0 -0.41317974\n503  2          Alcam -0.2765884 7.464013e-05        0 -0.39154940\n504  2          Rad18 -0.2764641 7.483439e-05        0 -1.07430737\n505  2           Eme1 -0.2757416 7.929175e-05        0 -0.95504349\n506  2        Psmc3ip -0.2756039 7.960615e-05        0 -0.45749056\n507  2       Timeless -0.2754954 7.966689e-05        0 -0.54988161\n508  2           Wwox -0.2754084 7.966689e-05        0 -0.32227988\n509  2         Hspa14 -0.2727748 9.971178e-05        0 -0.40857579\n510  2        Fam111a -0.2725442 1.001479e-04        0 -1.76316774\n511  2          Cenpi -0.2725442 1.001479e-04        0 -1.83787774\n512  2          Ticrr -0.2709964 1.134080e-04        0 -1.09466338\n513  2           Cltb -0.2659064 1.763467e-04        0 -0.47464273\n514  2           Vrk1 -0.2657318 1.776896e-04        0 -0.39919978\n515  2          Esco2 -0.2616651 2.525769e-04        0 -1.13610777\n516  2         Prkab1 -0.2609871 2.638929e-04        0 -0.69817315\n517  2          Cenpn -0.2606049 2.707702e-04        0 -0.60515605\n518  2          Haus6 -0.2601783 2.789102e-04        0 -0.67359863\n519  2          Gna14 -0.2591830 2.996177e-04        0 -1.24822818\n520  2          Brip1 -0.2591830 2.996177e-04        0 -1.16674243\n521  2          Nup93 -0.2587405 3.090453e-04        0 -0.53491483\n522  2         Shisa9 -0.2580660 3.231057e-04        0 -1.73879040\n523  2        Fam181b -0.2580571 3.231057e-04        0 -0.35332726\n524  2          Tex30 -0.2578000 3.255957e-04        0 -0.51878228\n525  2           Rfc1 -0.2562782 3.679706e-04        0 -0.31382899\n526  2          Ccnd1 -0.2562164 3.679706e-04        0 -0.49886167\n527  2           Manf -0.2558507 3.770416e-04        0 -0.30846644\n528  2           Nsd2 -0.2551829 3.961463e-04        0 -0.36592805\n529  2           Rgcc -0.2551111 3.961463e-04        0 -0.35209128\n530  2          Siva1 -0.2545297 4.134846e-04        0 -0.30396703\n531  2           Lsm2 -0.2532381 4.585073e-04        0 -0.27714384\n532  2           Nsl1 -0.2524423 4.872552e-04        0 -0.73228120\n533  2        Tnfaip8 -0.2515080 5.202976e-04        0 -0.53773780\n534  2         Tubb4b -0.2500482 5.845826e-04        0 -0.32728177\n535  2        St8sia1 -0.2494831 6.089485e-04        0 -0.74123396\n536  2           Mtbp -0.2490175 6.290258e-04        0 -0.74784551\n537  2          Gins4 -0.2486622 6.437783e-04        0 -0.35407544\n538  2           Hat1 -0.2482794 6.567812e-04        0 -0.39901499\n539  2          Cand2 -0.2482671 6.567812e-04        0 -0.84060034\n540  2            Dut -0.2480184 6.662547e-04        0 -0.37622944\n541  2        Tmem201 -0.2472088 7.037353e-04        0 -0.67399836\n542  2          Rbbp7 -0.2469797 7.127525e-04        0 -0.25999405\n543  2        Zscan22 -0.2462507 7.508874e-04        0 -0.86018446\n544  2           Xbp1 -0.2462013 7.508874e-04        0 -0.49134064\n545  2          Ywhah -0.2461255 7.509325e-04        0 -0.32825814\n546  2          Haus4 -0.2458945 7.607330e-04        0 -0.53385523\n547  2          Usp51 -0.2458027 7.618395e-04        0 -1.19671799\n548  2         Mrps26 -0.2448711 8.178595e-04        0 -0.40447865\n549  2          Cyr61 -0.2441738 8.535357e-04        0 -0.17814705\n550  2           Nrg1 -0.2441337 8.535357e-04        0 -0.27984683\n551  2            Dek -0.2435837 8.877308e-04        0 -0.34892341\n552  2          Fstl5 -0.2427972 9.357863e-04        0 -0.33185528\n553  2          Kif24 -0.2425030 9.474571e-04        0 -1.15680175\n554  2           Nrg3 -0.2421109 9.670970e-04        0 -0.45766554\n555  2        Flywch2 -0.2411415 1.034796e-03        0 -0.58361314\n556  2          Chek1 -0.2391568 1.201924e-03        0 -0.91292776\n557  2         Trim37 -0.2379087 1.321762e-03        0 -0.28132708\n558  2         Chaf1a -0.2376221 1.345055e-03        0 -0.68231148\n559  2         Pdzph1 -0.2374145 1.360119e-03        0 -0.57366634\n560  2          Haus8 -0.2370465 1.393171e-03        0 -0.49203394\n561  2           Hmbs -0.2368959 1.402389e-03        0 -0.45776455\n562  2       Pcna.ps2 -0.2367291 1.410749e-03        0 -0.85437301\n563  2          Etaa1 -0.2366860 1.410749e-03        0 -0.36956284\n564  2        Tmem121 -0.2362287 1.447658e-03        0 -0.47909447\n565  2          Cdca2 -0.2359450 1.472955e-03        0 -1.34225876\n566  2        Irf2bpl -0.2356631 1.498498e-03        0 -0.36188008\n567  2          Pde4b -0.2350038 1.570973e-03        0 -0.45709381\n568  2           Mlf1 -0.2346278 1.593471e-03        0 -1.29851946\n569  2       Mis18bp1 -0.2346278 1.593471e-03        0 -1.21482781\n570  2          Spag5 -0.2346278 1.593471e-03        0 -1.34384480\n571  2          Zmym1 -0.2345503 1.595050e-03        0 -0.89458503\n572  2          Shmt1 -0.2344091 1.600590e-03        0 -0.52870919\n573  2          Tssc4 -0.2343774 1.600590e-03        0 -0.32770961\n574  2           Rhoc -0.2342307 1.611104e-03        0 -0.36469101\n575  2          Cdca7 -0.2338417 1.653156e-03        0 -0.28447965\n576  2          Tfdp1 -0.2335739 1.680076e-03        0 -0.39952713\n577  2         Ncapg2 -0.2327548 1.776999e-03        0 -1.11538303\n578  2         Pradc1 -0.2327371 1.776999e-03        0 -0.53613567\n579  2           Slbp -0.2314011 1.964092e-03        0 -0.51848583\n580  2          Hmga2 -0.2300230 2.153792e-03        0 -0.65705685\n581  2          Bard1 -0.2299716 2.153792e-03        0 -1.76615471\n582  2         Phlda1 -0.2283186 2.425602e-03        0 -0.55121094\n583  2           E2f6 -0.2280026 2.455185e-03        0 -0.59038008\n584  2           Cdk2 -0.2279771 2.455185e-03        0 -0.52067649\n585  2            Tnc -0.2276397 2.508196e-03        0 -0.56151444\n586  2          Cks1b -0.2274410 2.535035e-03        0 -0.27702256\n587  2           Glrb -0.2272191 2.566777e-03        0 -0.52831459\n588  2         Trmt2a -0.2268075 2.637197e-03        0 -0.46322401\n589  2          Hjurp -0.2266469 2.645398e-03        0 -0.74464188\n590  2           Ect2 -0.2257472 2.821738e-03        0 -0.71038020\n591  2          Sall3 -0.2254999 2.862601e-03        0 -0.28170195\n592  2           Aars -0.2252047 2.914742e-03        0 -0.47260875\n593  2          Hmgb2 -0.2249984 2.933925e-03        0 -0.07133909\n594  2          Htra2 -0.2249419 2.933925e-03        0 -0.61829587\n595  2          Ube2t -0.2248689 2.937173e-03        0 -0.93571480\n596  2         Klhl29 -0.2231829 3.320246e-03        0 -0.77157230\n597  2           Slf1 -0.2231241 3.320246e-03        0 -0.13283425\n598  2           Msh6 -0.2230844 3.320246e-03        0 -0.49912847\n599  2         Tsen15 -0.2228915 3.354395e-03        0 -0.23835610\n600  2         Cep192 -0.2227014 3.388223e-03        0 -0.66700755\n601  2        Neurog2  0.5831705 1.513990e-21        0  1.39130757\n602  2          Pttg1  0.4033662 1.890949e-10        0  1.43150739\n603  2        Gadd45g  0.3900987 8.335976e-10        0  1.47879552\n604  2          Cenpa  0.3862762 1.224608e-09        0  1.29099095\n605  2          Ccnb2  0.3567634 3.490893e-08        0  1.46159235\n606  2         Elavl4  0.3468110 9.947233e-08        0  0.75589932\n607  2      Hist1h2bc  0.3466351 9.980272e-08        0  0.86447991\n608  2          Ascl1  0.2878236 2.960890e-05        0  1.23580955\n609  2        Zc3h12c  0.2809180 5.172512e-05        0  0.71906028\n610  2          Rcor2  0.2747655 8.380291e-05        0  0.68126225\n611  2            Bsg  0.2711735 1.125159e-04        0  0.16704556\n612  2           Chd7  0.2689165 1.357545e-04        0  0.45825134\n613  2           Btg2  0.2612244 2.604819e-04        0  0.57453573\n614  2           Dll1  0.2579554 3.235874e-04        0  1.48812048\n615  2          Palld  0.2522486 4.919641e-04        0  0.39830033\n616  2          Ube2c  0.2475209 6.900588e-04        0  0.41115299\n617  2          Kdm7a  0.2447976 8.178595e-04        0  1.03349500\n618  2            Tpr  0.2430861 9.192848e-04        0  0.23402062\n619  2            Mt2  0.2426740 9.397476e-04        0  0.21444711\n620  2           Hes6  0.2422195 9.640875e-04        0  0.44197418\n621  2           Fgd4  0.2419872 9.713416e-04        0  0.50218344\n622  2           Gpc4  0.2400295 1.126267e-03        0  0.31960198\n623  2       Mir9.3hg  0.2365568 1.417750e-03        0  0.19384147\n624  2      Hist3h2ba  0.2311144 1.998848e-03        0  0.34933545\n625  2          Cenpe  0.2300522 2.153792e-03        0  1.45377818\n626  2           H1f0  0.2288871 2.332162e-03        0  0.30932670\n627  2         Knstrn  0.2281380 2.447995e-03        0  0.68360700\n628  2         Atad2b  0.2266654 2.645398e-03        0  0.42532807\n629  2        Igfbpl1  0.2250901 2.927116e-03        0  0.50257889\n630  2           Jam3  0.2204014 3.797733e-03        0  0.41024029\n631  2       Slc25a27  0.2169481 4.813378e-03        0  0.42497684\n632  2         Smim13  0.2139058 5.764408e-03        0  0.60289476\n633  2           Gng2  0.2137151 5.815854e-03        0  0.46536664\n634  2          Kdm5b  0.2120960 6.427188e-03        0  0.36398690\n635  2          Cdca3  0.2100817 7.215511e-03        0  0.68499462\n636  2           Gja1  0.2085036 7.962702e-03        0  0.64915425\n637  2           Usp3  0.2070938 8.526446e-03        0  0.31011816\n638  2          Insm1  0.2063884 8.932343e-03        0  0.80644302\n639  2         Rnf146  0.2019070 1.165956e-02        0  0.49655832\n640  2          Prag1  0.2000067 1.308501e-02        0  0.53173283\n641  2         Dmrta2  0.1968664 1.540434e-02        0  0.28567311\n642  2           Eci2  0.1959468 1.624300e-02        0  0.16442599\n643  2         mt.Nd2  0.1957873 1.631856e-02        0  0.22039650\n644  2         Rhbdl3  0.1944032 1.748468e-02        0  0.25720862\n645  2           Ssr2  0.1936514 1.811766e-02        0  0.23702265\n646  2          Ccnb1  0.1931207 1.866173e-02        0  0.80824955\n647  2           Nfix  0.1921382 1.954309e-02        0  0.17028655\n648  2         Ppp1cb  0.1918466 1.983806e-02        0  0.27439314\n649  2           Rnf5  0.1918116 1.983806e-02        0  0.27232424\n650  2          Eomes  0.1913350 2.035845e-02        0  1.50008613\n651  2        Laptm4a  0.1897594 2.221036e-02        0  0.17299330\n652  2          Gdpd1  0.1887921 2.340382e-02        0  0.23825994\n653  2          Timp2  0.1885731 2.367619e-02        0  0.31062215\n654  2         Tmem59  0.1880633 2.427720e-02        0  0.27392623\n655  2          Cenpf  0.1864141 2.620852e-02        0  0.41650568\n656  2        Tmem127  0.1862794 2.620852e-02        0  0.68982733\n657  2         Arxes2  0.1862673 2.620852e-02        0  0.68939246\n658  2          Lzts1  0.1859711 2.664518e-02        0  1.50408762\n659  2          Jmjd6  0.1853788 2.746733e-02        0  0.30428514\n660  2         Bckdha  0.1839872 2.912772e-02        0  0.51569540\n661  2          Slit2  0.1830418 3.056483e-02        0  0.70007048\n662  2          Ddit4  0.1830287 3.056483e-02        0  0.23056730\n663  2          Siah3  0.1829428 3.056483e-02        0  0.50950870\n664  2          Asna1  0.1828525 3.056483e-02        0  0.24053934\n665  2         Akap8l  0.1822160 3.142236e-02        0  0.43417761\n666  2            Os9  0.1814018 3.232165e-02        0  0.40610196\n667  2           Odc1  0.1813924 3.232165e-02        0  0.94708523\n668  2        Selenos  0.1799740 3.428738e-02        0  0.19306172\n669  2          Aamdc  0.1797952 3.446034e-02        0  0.40172927\n670  2         Agpat4  0.1797952 3.446034e-02        0  0.37770129\n671  2          Nop53  0.1796128 3.475395e-02        0  0.23849178\n672  2           Emc6  0.1794405 3.497203e-02        0  0.18767018\n673  2         Zfp637  0.1783292 3.682671e-02        0  0.19956155\n674  2           Mfng  0.1783260 3.682671e-02        0  0.54482185\n675  2        Fam168b  0.1779487 3.736772e-02        0  0.22485811\n676  2     AC154683.1  0.1774403 3.835202e-02        0  1.49632113\n677  2           Bptf  0.1771458 3.874950e-02        0  0.34544312\n678  2            Jtb  0.1763424 4.029795e-02        0  0.19863647\n679  2          Psrc1  0.1760528 4.093552e-02        0  0.93641309\n680  2          Ttc23  0.1749617 4.339970e-02        0  0.42880194\n681  2          Reps1  0.1746310 4.409934e-02        0  1.20006014\n682  2           Top1  0.1745432 4.414974e-02        0  0.23557563\n683  2           Psd3  0.1742178 4.488840e-02        0  1.13958202\n684  2           Cltc  0.1737330 4.571130e-02        0  0.68818990\n685  2           Ktn1  0.1733240 4.666851e-02        0  0.22152324\n686  2          Wdr12  0.1732151 4.688129e-02        0  0.34963288\n687  2         Pabpc1  0.1729144 4.754789e-02        0  0.16464519\n688  2 X2610001J05Rik  0.1728402 4.766428e-02        0  0.17472798\n689  2           Lhx2  0.1726749 4.794708e-02        0  0.28162939\n690  2          Foxp2  0.1725655 4.816722e-02        0  0.25513168\n691  2          Srrm4  0.1720562 4.928818e-02        0  1.03877312\n692  2           Eml5  0.1718234 4.966616e-02        0  0.32448358\n693  2         Sh3rf1  0.1714332 5.051673e-02        0  0.39969855\n694  2       Slc16a14  0.1714196 5.051673e-02        0  0.72548528\n695  2         Rb1cc1  0.1713363 5.063565e-02        0  0.42499406\n696  2          Lockd  0.1709997 5.147271e-02        0  0.36446249\n697  2         Txnrd1  0.1707174 5.213788e-02        0  0.21117500\n698  2          Pfdn2  0.1705926 5.225422e-02        0  0.08400791\n699  2        Rps27rt  0.1696975 5.487550e-02        0  0.19354428\n700  2           Mbd5  0.1695074 5.518622e-02        0  0.48897472\n701  2          Itgb1  0.1695047 5.518622e-02        0  0.19584190\n702  2          Ccnl2  0.1692338 5.522438e-02        0  0.09177134\n703  2           Rmst  0.1682377 5.792345e-02        0  1.27032788\n704  2        Hnrnpa1  0.1681490 5.811857e-02        0  0.14576877\n705  2         Ccdc12  0.1677730 5.920151e-02        0  0.16906794\n706  2         Zfp157  0.1673699 5.989724e-02        0  0.52026271\n707  2         Trip12  0.1673163 5.989724e-02        0  0.34943156\n708  2        Laptm4b  0.1672896 5.989724e-02        0  0.33170170\n709  2        Akirin2  0.1670726 6.044633e-02        0  0.40527418\n710  2           Tshr  0.1669986 6.056937e-02        0  0.55592360\n711  2          Eif2a  0.1667874 6.101892e-02        0  0.20248082\n712  2           Bfar  0.1663484 6.190643e-02        0  0.36167688\n713  2          Ap3s1  0.1663118 6.190643e-02        0  0.33114029\n714  2           Dph1  0.1659134 6.284806e-02        0  1.48371426\n715  2         Cfap36  0.1658016 6.292215e-02        0  0.27506880\n716  2           Gpx8  0.1648038 6.531965e-02        0  0.32579681\n717  2          Hif1a  0.1640067 6.786081e-02        0  0.48187187\n718  2       Aasdhppt  0.1636368 6.827705e-02        0  0.28623795\n719  2         Draxin  0.1635003 6.834423e-02        0  0.42253273\n720  2         Tmem33  0.1634844 6.834423e-02        0  0.23757017\n721  2            H13  0.1626499 7.040415e-02        0  0.32771944\n722  2           Fpgs  0.1621757 7.199101e-02        0  0.74272924\n723  2          Mdga1  0.1610562 7.453807e-02        0  1.10884549\n724  2          Kdm6b  0.1609537 7.461636e-02        0  0.46530168\n725  2          Bach2  0.1606667 7.571972e-02        0  0.29476183\n726  2        Ankrd37  0.1606402 7.571972e-02        0  0.56885622\n727  2           Lig3  0.1604519 7.623253e-02        0  0.57277632\n728  2           Lrp4  0.1602715 7.635252e-02        0  0.54255835\n729  2           Ccz1  0.1600780 7.707543e-02        0  0.13292645\n730  2        Slc2a13  0.1599666 7.744285e-02        0  0.50855381\n731  2           Ptms  0.1596970 7.829392e-02        0  0.29259682\n732  2           Rab7  0.1592068 7.997150e-02        0  0.12293605\n733  2         Lrrc51  0.1589303 8.097922e-02        0  1.47316169\n734  2       Tnfrsf19  0.1588611 8.117062e-02        0  0.45311955\n735  2        Serinc1  0.1587842 8.122104e-02        0  0.21441979\n736  2 X1110004F10Rik  0.1587624 8.122104e-02        0  0.10430969\n737  2         Klhl24  0.1586645 8.122104e-02        0  0.38142234\n738  2          Snrpa  0.1586010 8.124152e-02        0  0.17180810\n739  2          Tmed4  0.1585172 8.137816e-02        0  0.28734854\n740  2          Syne2  0.1581705 8.240131e-02        0  0.23440549\n741  2          Kcnrg  0.1578183 8.349924e-02        0  1.49462152\n742  2           Rnd2  0.1578183 8.349924e-02        0  1.48697089\n743  2          Hmgn5  0.1570720 8.651970e-02        0  0.24680033\n744  2           Mia2  0.1568596 8.731838e-02        0  0.26692785\n745  2         Kif21a  0.1567786 8.758423e-02        0  0.11360722\n746  2           Cct2  0.1566585 8.765486e-02        0  0.13234402\n747  2          Eef2k  0.1564710 8.818496e-02        0  0.57994616\n748  2          Ppm1b  0.1562393 8.906899e-02        0  0.31158233\n749  2         Cacnb4  0.1560135 8.967001e-02        0  0.59596871\n750  2          Mex3a  0.1557236 9.099315e-02        0  0.24904478\n751  2          Paip2  0.1554324 9.207324e-02        0  0.13123212\n752  2           Lsg1  0.1553801 9.220718e-02        0  0.24220200\n753  2          Hyal2  0.1553093 9.233458e-02        0  0.28606082\n754  2        Arhgef2  0.1553032 9.233458e-02        0  0.52227443\n755  2          Samd8  0.1552314 9.243597e-02        0  1.04246472\n756  2        Slc18b1  0.1549956 9.351537e-02        0  0.89119608\n757  2          Clcn3  0.1546511 9.503981e-02        0  0.27388620\n758  2         Igfbp2  0.1545469 9.523666e-02        0  0.17183487\n759  2          Rps25  0.1540116 9.721140e-02        0  0.08285596\n760  2          Trrap  0.1539845 9.721140e-02        0  0.69086779\n761  2          Tubb3  0.1539833 9.721140e-02        0  0.28710293\n762  2          Rbm28  0.1536014 9.899314e-02        0  0.17512792\n763  2          Igf1r  0.1532369 1.001473e-01        0  0.18565244\n764  2          Acsl4  0.1524843 1.033439e-01        0  1.47648044\n765  2        Tmem178  0.1522769 1.043748e-01        0  0.42984756\n766  2         Ndufa6  0.1518733 1.061080e-01        0  0.13794099\n767  2          Alpk1  0.1508835 1.104910e-01        0  0.77110477\n768  2           Wapl  0.1507020 1.113812e-01        0  0.37155075\n769  2          Usp22  0.1503240 1.135232e-01        0  0.33912281\n770  2        Dnttip2  0.1502964 1.135389e-01        0  0.20322647\n771  2           Lrp8  0.1500065 1.145543e-01        0  0.53557896\n772  2          Masp1  0.1497192 1.161822e-01        0  0.32132151\n773  2         Hilpda  0.1494678 1.162472e-01        0  0.40070065\n774  2          Rnf41  0.1494678 1.162472e-01        0  0.23944894\n775  2          Pias1  0.1493379 1.164078e-01        0  0.28687435\n776  2        Jakmip2  0.1490277 1.178946e-01        0  0.45703951\n777  2         Crebbp  0.1483029 1.214373e-01        0  0.21721242\n778  2        Gm15545  0.1476591 1.241770e-01        0  1.49398047\n779  2         Mboat2  0.1476419 1.241770e-01        0  0.24453534\n780  2           Nle1  0.1472636 1.260502e-01        0  0.29531402\n781  2          Mbtd1  0.1470658 1.265740e-01        0  0.22167452\n782  2        Tmem35a  0.1469877 1.266961e-01        0  1.50611416\n783  2          Cebpz  0.1469761 1.266961e-01        0  0.17629012\n784  2           Emx1  0.1468458 1.271813e-01        0  0.20501463\n785  2           Tsr3  0.1467142 1.274341e-01        0  0.28468483\n786  2          Fezf2  0.1463003 1.285268e-01        0  0.25237380\n787  2       Col4a3bp  0.1462571 1.285268e-01        0  0.53977782\n788  2          Ypel2  0.1460458 1.293656e-01        0  0.59908155\n789  2         Zdhhc9  0.1460458 1.293656e-01        0  0.82703245\n790  2       BC049730  0.1458932 1.293656e-01        0  0.86594762\n791  2        Slc15a4  0.1458330 1.293656e-01        0  0.81315673\n792  2          Mtus1  0.1457899 1.293656e-01        0  0.46501331\n793  2        Slc30a6  0.1457487 1.293656e-01        0  0.46955821\n794  2         mt.Nd5  0.1456056 1.298175e-01        0  0.26450106\n795  2          Cdc40  0.1455259 1.302056e-01        0  0.28549454\n796  2        Morf4l2  0.1453975 1.306164e-01        0  0.11739701\n797  2        Slc35e2  0.1452838 1.310349e-01        0  0.79268238\n798  2          Tmed9  0.1452656 1.310349e-01        0  0.06663226\n799  2         Fbxo11  0.1452456 1.310349e-01        0  0.49404543\n800  2       Ftl1.ps1  0.1450878 1.319654e-01        0  0.32582298",
    "crumbs": [
      "Cluster evaluation",
      "Not UT cluster with LR"
    ]
  },
  {
    "objectID": "NonCT_clusters.html#cluster-432-e13.5",
    "href": "NonCT_clusters.html#cluster-432-e13.5",
    "title": "Not Uniform Transcriptomic clusters with Logistic Regression",
    "section": "Cluster 432 e13.5",
    "text": "Cluster 432 e13.5\n\n\n  OriginalCluster CellNumber COTANClusterNumber          Accuracy\n1      Cl525E15.0        826                  3 0.786585365853659\n2      Cl511E15.0        540                  2 0.916666666666667\n3      Cl184E15.0        322                  2          0.734375\n4      Cl432E13.5        536                  2              &lt;NA&gt;\n\n\n\ne13.5 &lt;- readRDS(paste0(inDir,\"e13.5_ForebrainDorsal.cotan.RDS\"))\n\ncells &lt;- getClusterizationData(e13.5,clName = \"original.clusters\")[[1]][getClusterizationData(e13.5,clName = \"original.clusters\")[[1]] == \"432\"]\n\ncells &lt;-names(cells)\n\ncl432 &lt;-  automaticCOTANObjectCreation(raw = getRawData(e13.5)[,cells],\n                                       GEO = \"Loom\",\n                                       sequencingMethod = \"10X\",\n                                       sampleCondition = \"cl432\",\n                                       cores = 10,saveObj = T,\n                                       outDir = \"Data/MouseCortexFromLoom/NotCTSingleClusters/\",\n                                       calcCoex = T)\n\n\ncl432GDI &lt;- calculateGDI(cl432)\n\nsubsetGDIcl432 &lt;- cl432GDI[cl432GDI$sum.raw.norm &gt; 5,]\ntop.GDI.genes &lt;- rownames(subsetGDIcl432[order(subsetGDIcl432$GDI,decreasing = T),])[1:25]\n\nGDIPlot(cl432,genes = list(\"topGDI\"=top.GDI.genes),GDIIn = cl432GDI)\n\n\n\n\n\n\n\n\n\nlist.cl.CT &lt;- cellsUniformClustering(cl432, GDIThreshold = 1.43, cores = 10L,\n                         saveObj = TRUE, outDir = outDir)\n\ncl432 &lt;- addClusterization(cl432, clName = \"split\",\n                              clusters = list.cl.CT$clusters,\n                              coexDF = list.cl.CT$coex, override = TRUE)\n\ntable(list.cl.CT$clusters)\n\n\nc(mergedClusters, mergedCoexDF) %&lt;-%\n  mergeUniformCellsClusters(cl432, clusters = list.cl.CT$clusters,\n                            GDIThreshold = 1.43, batchSize = 4L, cores = 10L,\n                            saveObj = TRUE, outDir = outDir)\n\ncl432 &lt;- addClusterization(cl432, clName = \"merge\",\n                              clusters = mergedClusters,\n                              coexDF = mergedCoexDF,\n                              override = TRUE)\n\nsaveRDS(cl432,paste0(outDir,\"cl432.cotan.RDS\"))\n\ntable(str_split(names(mergedClusters),pattern = \"_\",simplify = T)[,1],mergedClusters)\n\n\ndata &lt;- getNormalizedData(cl432)\ndata &lt;- data[!rowSums(as.matrix(data)) &lt; 1,]\ndata &lt;- log(data*10000+1)\n\nrow_stdev &lt;- apply(data, 1, sd, na.rm=TRUE)\nrow_stdev &lt;- row_stdev[order(row_stdev,decreasing = T)]\n\ngenes.to.keep &lt;- c(names(row_stdev[1:100]),top.GDI.genes)\n\ndata.small &lt;- data[rownames(data) %in% genes.to.keep,]\n\n#data &lt;- t(as.matrix(data))\ndata.small &lt;- t(as.matrix(data.small))\n\n\nCOTAN_Cl.code &lt;- getClusterizationData(cl432)[[1]]\n#COTAN_Cl.code[COTAN_Cl.code == \"A549\"] &lt;- 0\n#COTAN_Cl.code[COTAN_Cl.code == \"CCL-185-IG\"] &lt;- 1\n\nCOTAN_Cl.code &lt;- as.numeric(COTAN_Cl.code)-1\n\ndata.small &lt;- cbind(data.small,COTAN_Cl.code)\ndata.small &lt;- as.data.frame(data.small)\n\n# Split the data into training and test set\nset.seed(123)\ntraining.samples &lt;- data.small[,\"COTAN_Cl.code\"] %&gt;% \n  createDataPartition(p = 0.8, list = FALSE)\ntrain.data  &lt;- data.small[training.samples, ]\ntest.data &lt;- data.small[-training.samples, ]\nhead(train.data)\n\n                              Slc8a1    Csrp2   Rpl22l1   Sec61g      Pgk1\n10X14_4_A_1:AAGAACGAGGTAAAx 0.000000 0.000000 10.423023 0.000000  0.000000\n10X12_3_A_1:CAAGCATGAATCGCx 9.076224 9.076224  0.000000 0.000000  0.000000\n10X12_3_A_1:GTGATCGACCAATGx 0.000000 9.411567  0.000000 9.411567  9.411567\n10X12_3_A_1:CTGGATGAACAGCTx 0.000000 0.000000  0.000000 0.000000 10.748672\n10X14_4_A_1:ATTCAAGATCCCACx 0.000000 0.000000  0.000000 0.000000  0.000000\n10X12_3_A_1:CGATCCACCCGAATx 0.000000 9.132491  9.132491 9.132491  9.132491\n                              Gm10076  Rpl36al    Mfap4     Ier2     Ptprk\n10X14_4_A_1:AAGAACGAGGTAAAx  9.729905  0.00000 9.729905 9.729905 10.423023\n10X12_3_A_1:CAAGCATGAATCGCx  9.769314  0.00000 9.076224 0.000000  9.076224\n10X12_3_A_1:GTGATCGACCAATGx 10.510124  0.00000 0.000000 0.000000 10.104673\n10X12_3_A_1:CTGGATGAACAGCTx 10.343218  0.00000 9.650103 0.000000  9.650103\n10X14_4_A_1:ATTCAAGATCCCACx  0.000000  0.00000 9.866303 9.866303 10.271751\n10X12_3_A_1:CGATCCACCCGAATx 10.518705 10.23103 0.000000 0.000000  0.000000\n                                Cadps    Uba52    Pantr1 Mir9.3hg   Tmem108\n10X14_4_A_1:AAGAACGAGGTAAAx  9.729905  0.00000 11.521615 0.000000 10.423023\n10X12_3_A_1:CAAGCATGAATCGCx  9.076224 10.68557  9.076224 0.000000 10.685571\n10X12_3_A_1:GTGATCGACCAATGx  0.000000 11.60872  0.000000 9.411567  0.000000\n10X12_3_A_1:CTGGATGAACAGCTx  0.000000 11.59596 10.748672 9.650103  0.000000\n10X14_4_A_1:ATTCAAGATCCCACx 10.559424  0.00000  9.173208 9.866303  9.866303\n10X12_3_A_1:CGATCCACCCGAATx  9.132491 11.21184  0.000000 0.000000  9.825584\n                               Klhl29    Dusp14   Adgrb3    Alcam    Nell2\n10X14_4_A_1:AAGAACGAGGTAAAx  0.000000  9.729905 0.000000 0.000000 0.000000\n10X12_3_A_1:CAAGCATGAATCGCx  9.076224  0.000000 9.076224 9.769314 9.769314\n10X12_3_A_1:GTGATCGACCAATGx 10.104673  9.411567 0.000000 0.000000 9.411567\n10X12_3_A_1:CTGGATGAACAGCTx  0.000000  0.000000 0.000000 0.000000 0.000000\n10X14_4_A_1:ATTCAAGATCCCACx  9.866303 10.271751 9.173208 9.866303 9.866303\n10X12_3_A_1:CGATCCACCCGAATx  0.000000  9.825584 9.132491 9.825584 0.000000\n                                Fabp7       Ptn  Rasgef1b    Nckap5    Nfasc\n10X14_4_A_1:AAGAACGAGGTAAAx  0.000000 10.423023  0.000000  0.000000 9.729905\n10X12_3_A_1:CAAGCATGAATCGCx  0.000000  0.000000  0.000000  0.000000 9.769314\n10X12_3_A_1:GTGATCGACCAATGx 10.104673  9.411567 10.104673  0.000000 0.000000\n10X12_3_A_1:CTGGATGAACAGCTx  0.000000  9.650103  0.000000 10.343218 9.650103\n10X14_4_A_1:ATTCAAGATCCCACx  0.000000  0.000000  0.000000  0.000000 9.866303\n10X12_3_A_1:CGATCCACCCGAATx  9.132491  0.000000  9.132491  9.825584 0.000000\n                              Frmd4a   Nkain2    Tcf12 Ppp1r14a    Stmn2\n10X14_4_A_1:AAGAACGAGGTAAAx 0.000000 9.729905 9.729905 0.000000  0.00000\n10X12_3_A_1:CAAGCATGAATCGCx 9.076224 0.000000 0.000000 9.076224 10.68557\n10X12_3_A_1:GTGATCGACCAATGx 0.000000 0.000000 0.000000 0.000000  0.00000\n10X12_3_A_1:CTGGATGAACAGCTx 9.650103 0.000000 9.650103 0.000000  0.00000\n10X14_4_A_1:ATTCAAGATCCCACx 9.173208 9.173208 0.000000 0.000000  0.00000\n10X12_3_A_1:CGATCCACCCGAATx 0.000000 9.132491 0.000000 0.000000  0.00000\n                                Cadm1     Msmo1    Dpysl5    Sema6d      Ina\n10X14_4_A_1:AAGAACGAGGTAAAx  9.729905  9.729905  9.729905  0.000000 0.000000\n10X12_3_A_1:CAAGCATGAATCGCx 10.685571  0.000000  0.000000  0.000000 9.076224\n10X12_3_A_1:GTGATCGACCAATGx  0.000000  0.000000  9.411567  9.411567 0.000000\n10X12_3_A_1:CTGGATGAACAGCTx 10.748672  0.000000 10.343218  9.650103 0.000000\n10X14_4_A_1:ATTCAAGATCCCACx  9.866303 10.559424  0.000000  9.173208 9.173208\n10X12_3_A_1:CGATCCACCCGAATx  0.000000 10.518705  9.825584 10.231032 0.000000\n                                 Pak7     Unc5d     Sstr2      Aff2     Epha4\n10X14_4_A_1:AAGAACGAGGTAAAx 10.423023 11.521615 10.423023  0.000000  0.000000\n10X12_3_A_1:CAAGCATGAATCGCx  0.000000 10.462433  0.000000 10.462433  9.076224\n10X12_3_A_1:GTGATCGACCAATGx 10.104673  0.000000  9.411567  9.411567 10.104673\n10X12_3_A_1:CTGGATGAACAGCTx  0.000000  9.650103  9.650103  0.000000 10.343218\n10X14_4_A_1:ATTCAAGATCCCACx  0.000000 10.964881  9.173208  9.866303 10.964881\n10X12_3_A_1:CGATCCACCCGAATx  9.132491  0.000000  0.000000  0.000000  9.132491\n                            Zfpm2  Bhlhe22    Kcnq3     Nrp1    Satb2    Cdh13\n10X14_4_A_1:AAGAACGAGGTAAAx     0 0.000000 0.000000 0.000000 0.000000 0.000000\n10X12_3_A_1:CAAGCATGAATCGCx     0 9.076224 9.076224 9.076224 9.076224 0.000000\n10X12_3_A_1:GTGATCGACCAATGx     0 0.000000 9.411567 0.000000 0.000000 0.000000\n10X12_3_A_1:CTGGATGAACAGCTx     0 0.000000 0.000000 9.650103 0.000000 0.000000\n10X14_4_A_1:ATTCAAGATCCCACx     0 9.173208 0.000000 0.000000 9.173208 0.000000\n10X12_3_A_1:CGATCCACCCGAATx     0 9.132491 9.132491 0.000000 0.000000 9.825584\n                              Mpped2   Phactr1     Nol4     Cnr1  Runx1t1\n10X14_4_A_1:AAGAACGAGGTAAAx  0.00000 11.116155 0.000000  0.00000 0.000000\n10X12_3_A_1:CAAGCATGAATCGCx 10.17476  9.769314 9.769314  0.00000 9.769314\n10X12_3_A_1:GTGATCGACCAATGx  0.00000  9.411567 0.000000  0.00000 0.000000\n10X12_3_A_1:CTGGATGAACAGCTx  0.00000  0.000000 9.650103  0.00000 0.000000\n10X14_4_A_1:ATTCAAGATCCCACx  0.00000  9.173208 9.866303  0.00000 0.000000\n10X12_3_A_1:CGATCCACCCGAATx  0.00000  9.132491 9.825584 10.23103 0.000000\n                               Grik2 Mir124.2hg     Tbr1  B3galt1     Kcnb2\n10X14_4_A_1:AAGAACGAGGTAAAx 9.729905   9.729905 0.000000 0.000000  9.729905\n10X12_3_A_1:CAAGCATGAATCGCx 9.076224   0.000000 9.076224 9.076224  0.000000\n10X12_3_A_1:GTGATCGACCAATGx 0.000000   9.411567 9.411567 0.000000  9.411567\n10X12_3_A_1:CTGGATGAACAGCTx 0.000000  11.036349 0.000000 0.000000 11.036349\n10X14_4_A_1:ATTCAAGATCCCACx 9.173208   0.000000 9.173208 0.000000  0.000000\n10X12_3_A_1:CGATCCACCCGAATx 9.132491   9.132491 9.132491 9.132491  9.132491\n                                Ly6h    Negr1  Smarcd3     Ppm1e     Lmo4\n10X14_4_A_1:AAGAACGAGGTAAAx 0.000000 10.42302 9.729905  9.729905 9.729905\n10X12_3_A_1:CAAGCATGAATCGCx 0.000000  0.00000 0.000000 10.462433 9.076224\n10X12_3_A_1:GTGATCGACCAATGx 9.411567  0.00000 0.000000  0.000000 0.000000\n10X12_3_A_1:CTGGATGAACAGCTx 0.000000 11.44181 0.000000 10.343218 9.650103\n10X14_4_A_1:ATTCAAGATCCCACx 0.000000  0.00000 9.173208 10.271751 0.000000\n10X12_3_A_1:CGATCCACCCGAATx 0.000000  0.00000 9.825584  9.825584 0.000000\n                                 Dab1  Serpini1    Pcdh7     Robo2    Nrxn1\n10X14_4_A_1:AAGAACGAGGTAAAx  9.729905 10.423023  0.00000 11.339295  0.00000\n10X12_3_A_1:CAAGCATGAATCGCx  0.000000  9.769314  0.00000 10.867888  0.00000\n10X12_3_A_1:GTGATCGACCAATGx  0.000000  0.000000  0.00000  9.411567  0.00000\n10X12_3_A_1:CTGGATGAACAGCTx  0.000000  0.000000  0.00000 11.036349  0.00000\n10X14_4_A_1:ATTCAAGATCCCACx 10.964881  0.000000  0.00000 10.782562 10.27175\n10X12_3_A_1:CGATCCACCCGAATx 10.231032  9.825584 10.23103 11.078309  0.00000\n                               Hecw1    Stmn4  Galnt17     Acot7     Parp6\n10X14_4_A_1:AAGAACGAGGTAAAx 0.000000  0.00000 0.000000  0.000000  0.000000\n10X12_3_A_1:CAAGCATGAATCGCx 9.076224 10.46243 0.000000  0.000000  9.076224\n10X12_3_A_1:GTGATCGACCAATGx 9.411567  0.00000 0.000000 10.104673  9.411567\n10X12_3_A_1:CTGGATGAACAGCTx 0.000000  0.00000 0.000000  0.000000  9.650103\n10X14_4_A_1:ATTCAAGATCCCACx 9.866303  0.00000 0.000000  0.000000 10.271751\n10X12_3_A_1:CGATCCACCCGAATx 9.132491  0.00000 9.132491  9.132491  9.825584\n                             Tmem176b     Nrn1     Pcdh9      Cdh4     Nav3\n10X14_4_A_1:AAGAACGAGGTAAAx  0.000000 9.729905  0.000000  0.000000 9.729905\n10X12_3_A_1:CAAGCATGAATCGCx  0.000000 9.076224 11.155566  9.076224 9.769314\n10X12_3_A_1:GTGATCGACCAATGx 10.104673 0.000000  9.411567  0.000000 0.000000\n10X12_3_A_1:CTGGATGAACAGCTx 10.343218 9.650103  0.000000  0.000000 0.000000\n10X14_4_A_1:ATTCAAGATCCCACx  0.000000 9.173208  0.000000 10.271751 9.866303\n10X12_3_A_1:CGATCCACCCGAATx  9.132491 9.825584  0.000000  0.000000 0.000000\n                                 Nrg1    Ppfia2    Robo1      Cdh8    Lrpap1\n10X14_4_A_1:AAGAACGAGGTAAAx 11.116155  0.000000 0.000000 11.116155  0.000000\n10X12_3_A_1:CAAGCATGAATCGCx  9.769314  9.769314 0.000000  9.769314  9.076224\n10X12_3_A_1:GTGATCGACCAATGx  9.411567 10.104673 0.000000  9.411567  9.411567\n10X12_3_A_1:CTGGATGAACAGCTx  0.000000  0.000000 0.000000  9.650103  0.000000\n10X14_4_A_1:ATTCAAGATCCCACx 10.559424 10.559424 0.000000  9.866303 10.271751\n10X12_3_A_1:CGATCCACCCGAATx  0.000000  0.000000 9.825584  0.000000  0.000000\n                            X2010107E04Rik     Ssbp3    Srsf4      Mtf2\n10X14_4_A_1:AAGAACGAGGTAAAx        0.00000  0.000000 9.729905  9.729905\n10X12_3_A_1:CAAGCATGAATCGCx       10.46243  9.769314 9.076224 10.174760\n10X12_3_A_1:GTGATCGACCAATGx        0.00000  9.411567 9.411567  0.000000\n10X12_3_A_1:CTGGATGAACAGCTx        0.00000  0.000000 9.650103  9.650103\n10X14_4_A_1:ATTCAAGATCCCACx        0.00000  0.000000 0.000000  0.000000\n10X12_3_A_1:CGATCCACCCGAATx        0.00000 10.231032 0.000000  0.000000\n                              Gtf2a2      Canx      Phf6   Higd1a    Dctpp1\n10X14_4_A_1:AAGAACGAGGTAAAx 0.000000  0.000000  0.000000 0.000000  0.000000\n10X12_3_A_1:CAAGCATGAATCGCx 0.000000  9.769314  0.000000 9.076224  9.076224\n10X12_3_A_1:GTGATCGACCAATGx 0.000000  9.411567  9.411567 0.000000 10.510124\n10X12_3_A_1:CTGGATGAACAGCTx 0.000000  9.650103  9.650103 9.650103  0.000000\n10X14_4_A_1:ATTCAAGATCCCACx 9.173208  9.866303  9.173208 0.000000  0.000000\n10X12_3_A_1:CGATCCACCCGAATx 9.825584 10.231032 10.924161 9.825584  9.132491\n                                Srek1      Mdk     Prdx6       Jun   Tspan14\n10X14_4_A_1:AAGAACGAGGTAAAx  0.000000  0.00000  0.000000  0.000000  9.729905\n10X12_3_A_1:CAAGCATGAATCGCx  9.076224  0.00000  0.000000  9.769314  0.000000\n10X12_3_A_1:GTGATCGACCAATGx  0.000000  0.00000 10.104673 11.203258 10.510124\n10X12_3_A_1:CTGGATGAACAGCTx  9.650103 10.74867  9.650103  0.000000  0.000000\n10X14_4_A_1:ATTCAAGATCCCACx 10.782562  0.00000  0.000000  9.173208  0.000000\n10X12_3_A_1:CGATCCACCCGAATx  0.000000  0.00000  0.000000  9.825584  9.132491\n                             Prkar1a   Phf21a   Mrps21       Ubc Fam114a2\n10X14_4_A_1:AAGAACGAGGTAAAx 0.000000 9.729905 9.729905  0.000000 0.000000\n10X12_3_A_1:CAAGCATGAATCGCx 9.769314 0.000000 0.000000 10.174760 9.076224\n10X12_3_A_1:GTGATCGACCAATGx 0.000000 0.000000 0.000000  0.000000 9.411567\n10X12_3_A_1:CTGGATGAACAGCTx 9.650103 9.650103 0.000000  0.000000 0.000000\n10X14_4_A_1:ATTCAAGATCCCACx 0.000000 9.173208 9.173208  0.000000 9.866303\n10X12_3_A_1:CGATCCACCCGAATx 9.132491 9.825584 9.825584  9.132491 0.000000\n                               Large1     Gmcl1  Gpatch8  Csnk2a1     Xist\n10X14_4_A_1:AAGAACGAGGTAAAx  0.000000 10.423023 0.000000 0.000000  0.00000\n10X12_3_A_1:CAAGCATGAATCGCx  0.000000  0.000000 9.076224 0.000000 11.02204\n10X12_3_A_1:GTGATCGACCAATGx 10.104673 10.510124 0.000000 9.411567  0.00000\n10X12_3_A_1:CTGGATGAACAGCTx  0.000000  9.650103 0.000000 0.000000 11.44181\n10X14_4_A_1:ATTCAAGATCCCACx  0.000000  9.173208 9.866303 9.173208 10.55942\n10X12_3_A_1:CGATCCACCCGAATx  9.825584  0.000000 9.132491 9.132491  0.00000\n                                 Fdps     Phip     Sqle    Zbtb20   Fnbp1l\n10X14_4_A_1:AAGAACGAGGTAAAx  0.000000 0.000000 9.729905  0.000000 9.729905\n10X12_3_A_1:CAAGCATGAATCGCx 10.174760 9.076224 9.769314  0.000000 0.000000\n10X12_3_A_1:GTGATCGACCAATGx  9.411567 9.411567 9.411567 10.104673 9.411567\n10X12_3_A_1:CTGGATGAACAGCTx  0.000000 9.650103 0.000000  9.650103 9.650103\n10X14_4_A_1:ATTCAAGATCCCACx  0.000000 9.173208 9.173208  0.000000 9.173208\n10X12_3_A_1:CGATCCACCCGAATx 10.518705 9.132491 9.132491  0.000000 9.132491\n                              Tubb2a     Ncam1    Dclk1     Klc1 COTAN_Cl.code\n10X14_4_A_1:AAGAACGAGGTAAAx 0.000000  0.000000 9.729905 0.000000             0\n10X12_3_A_1:CAAGCATGAATCGCx 0.000000 10.174760 9.769314 0.000000             1\n10X12_3_A_1:GTGATCGACCAATGx 0.000000 10.510124 0.000000 0.000000             1\n10X12_3_A_1:CTGGATGAACAGCTx 0.000000  0.000000 0.000000 0.000000             1\n10X14_4_A_1:ATTCAAGATCCCACx 9.866303  9.866303 9.866303 9.173208             0\n10X12_3_A_1:CGATCCACCCGAATx 0.000000  0.000000 9.132491 0.000000             1\n\n\n\n# Fit the model\nmodel &lt;- glm( COTAN_Cl.code ~., data = train.data, family = binomial,control = list(maxit = 50))\n# Summarize the model\nsummary(model)\n\n\nCall:\nglm(formula = COTAN_Cl.code ~ ., family = binomial, data = train.data, \n    control = list(maxit = 50))\n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)    -5.161e+01  3.060e+06       0        1\nSlc8a1          7.693e-01  1.171e+05       0        1\nCsrp2           1.426e+00  7.682e+04       0        1\nRpl22l1        -2.862e-01  1.063e+05       0        1\nSec61g          1.296e+00  8.025e+04       0        1\nPgk1            1.829e+00  1.253e+05       0        1\nGm10076         9.697e-01  1.833e+05       0        1\nRpl36al         1.583e+00  1.728e+05       0        1\nMfap4           5.115e-01  1.249e+05       0        1\nIer2            7.954e-02  1.269e+05       0        1\nPtprk           1.319e+00  1.251e+05       0        1\nCadps           8.187e-01  9.443e+04       0        1\nUba52           7.255e+00  9.522e+04       0        1\nPantr1          1.752e+00  8.892e+04       0        1\nMir9.3hg       -4.958e-01  9.292e+04       0        1\nTmem108        -7.053e-01  9.884e+04       0        1\nKlhl29         -1.855e-01  9.946e+04       0        1\nDusp14         -1.196e+00  1.034e+05       0        1\nAdgrb3          1.743e-01  1.773e+05       0        1\nAlcam          -5.075e-01  1.555e+05       0        1\nNell2           4.394e-01  1.578e+05       0        1\nFabp7           1.186e+00  1.018e+05       0        1\nPtn             9.612e-01  1.517e+05       0        1\nRasgef1b       -7.001e-01  1.122e+05       0        1\nNckap5         -1.163e+00  1.047e+05       0        1\nNfasc           8.546e-01  6.054e+04       0        1\nFrmd4a         -6.578e-01  1.720e+05       0        1\nNkain2          4.318e-01  1.652e+05       0        1\nTcf12           7.042e-01  1.195e+05       0        1\nPpp1r14a       -2.636e-01  1.283e+05       0        1\nStmn2           9.936e-01  8.753e+04       0        1\nCadm1           1.011e+00  8.722e+04       0        1\nMsmo1          -1.956e-01  1.085e+05       0        1\nDpysl5         -5.631e-01  8.174e+04       0        1\nSema6d          1.209e+00  1.182e+05       0        1\nIna            -1.725e-01  1.004e+05       0        1\nPak7            1.784e-02  7.803e+04       0        1\nUnc5d          -9.328e-01  1.065e+05       0        1\nSstr2          -1.249e+00  9.338e+04       0        1\nAff2           -5.563e-01  5.025e+04       0        1\nEpha4           9.871e-01  1.085e+05       0        1\nZfpm2           3.716e+00  6.581e+04       0        1\nBhlhe22        -4.104e-02  9.431e+04       0        1\nKcnq3           8.499e-01  5.114e+04       0        1\nNrp1           -6.156e-01  2.355e+05       0        1\nSatb2           3.264e-01  1.145e+05       0        1\nCdh13           1.995e+00  2.566e+05       0        1\nMpped2          1.031e-01  2.213e+05       0        1\nPhactr1        -2.101e-01  1.566e+05       0        1\nNol4           -2.159e-01  1.206e+05       0        1\nCnr1           -1.690e+00  1.296e+05       0        1\nRunx1t1        -1.049e+00  1.793e+05       0        1\nGrik2           7.952e-01  9.668e+04       0        1\nMir124.2hg      3.016e-01  8.916e+04       0        1\nTbr1            3.688e-01  7.522e+04       0        1\nB3galt1        -5.395e-01  8.938e+04       0        1\nKcnb2           6.570e-01  1.125e+05       0        1\nLy6h            9.767e-01  1.810e+05       0        1\nNegr1           1.996e+00  1.346e+05       0        1\nSmarcd3         5.877e-01  6.313e+04       0        1\nPpm1e          -3.702e-04  1.134e+05       0        1\nLmo4            3.436e-01  1.531e+05       0        1\nDab1           -7.583e-01  9.049e+04       0        1\nSerpini1       -8.662e-01  7.453e+04       0        1\nPcdh7          -1.879e+00  9.777e+04       0        1\nRobo2          -3.806e+00  1.643e+05       0        1\nNrxn1           8.571e-01  7.508e+04       0        1\nHecw1           4.333e-01  1.495e+05       0        1\nStmn4          -1.913e+00  1.210e+05       0        1\nGalnt17         2.192e+00  1.638e+05       0        1\nAcot7           1.937e+00  1.024e+05       0        1\nParp6           5.778e-01  1.053e+05       0        1\nTmem176b       -4.505e-01  7.658e+04       0        1\nNrn1            1.895e+00  7.471e+04       0        1\nPcdh9           6.794e-01  9.677e+04       0        1\nCdh4            6.568e-01  1.501e+05       0        1\nNav3           -7.964e-01  8.285e+04       0        1\nNrg1           -5.768e-01  1.066e+05       0        1\nPpfia2         -1.026e+00  1.075e+05       0        1\nRobo1           3.440e-01  4.997e+04       0        1\nCdh8            3.917e-02  1.486e+05       0        1\nLrpap1         -2.107e-01  9.521e+04       0        1\nX2010107E04Rik -1.419e-01  1.283e+05       0        1\nSsbp3           6.578e-01  8.910e+04       0        1\nSrsf4           5.215e-01  7.464e+04       0        1\nMtf2            4.725e-01  8.384e+04       0        1\nGtf2a2         -1.462e+00  8.082e+04       0        1\nCanx           -1.029e+00  8.597e+04       0        1\nPhf6           -1.989e-01  1.017e+05       0        1\nHigd1a         -5.775e-01  9.319e+04       0        1\nDctpp1         -4.058e-01  7.024e+04       0        1\nSrek1           3.479e-01  6.937e+04       0        1\nMdk            -2.930e-01  7.334e+04       0        1\nPrdx6           6.210e-02  8.068e+04       0        1\nJun            -6.216e-01  5.076e+04       0        1\nTspan14         6.353e-01  9.293e+04       0        1\nPrkar1a         3.660e-01  1.070e+05       0        1\nPhf21a          5.023e-01  1.530e+05       0        1\nMrps21         -1.200e+00  1.308e+05       0        1\nUbc             1.663e-01  8.846e+04       0        1\nFam114a2        3.522e-01  4.596e+04       0        1\nLarge1         -3.051e-01  1.731e+05       0        1\nGmcl1          -1.071e+00  1.252e+05       0        1\nGpatch8         1.671e-01  7.485e+04       0        1\nCsnk2a1        -1.901e+00  1.483e+05       0        1\nXist            9.840e-01  6.415e+04       0        1\nFdps            1.136e+00  9.151e+04       0        1\nPhip            2.852e-01  1.443e+05       0        1\nSqle           -4.126e-01  8.765e+04       0        1\nZbtb20          3.140e-01  1.013e+05       0        1\nFnbp1l          7.334e-01  9.184e+04       0        1\nTubb2a         -1.487e-01  9.100e+04       0        1\nNcam1          -1.924e-01  1.362e+05       0        1\nDclk1          -1.084e+00  7.479e+04       0        1\nKlc1           -1.020e-01  7.647e+04       0        1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 5.9080e+02  on 428  degrees of freedom\nResidual deviance: 2.4052e-10  on 314  degrees of freedom\nAIC: 230\n\nNumber of Fisher Scoring iterations: 29\n\n# Make predictions\nprobabilities &lt;- model %&gt;% predict(test.data, type = \"response\")\npredicted.classes &lt;- ifelse(probabilities &gt; 0.5, \"1\", \"0\")\n# Model accuracy\naccuracy &lt;- mean(predicted.classes == test.data$COTAN_Cl.code)\nresult.df[nrow(result.df),\"Accuracy\"] &lt;- accuracy\n\naccuracy\n\n[1] 0.8878505\n\n\nSo also in this case a logistic regression confirm the difference in cell population detected by COTAN.\n\ncl432ClsMarkers &lt;- findClustersMarkers(cl432,n = 200, adjustmentMethod = \"BH\")\ncl432ClsMarkers\n\n    CL           Gene        DEA      adjPVal IsMarker   logFoldCh\n1    1          Uba52 -0.8106586 1.621708e-74        0 -1.53792300\n2    1           Pgk1 -0.5238207 4.456029e-30        0 -1.25344098\n3    1         Sec61g -0.4973970 4.322781e-27        0 -0.94392234\n4    1            Erh -0.4763866 8.139496e-25        0 -0.66616044\n5    1          Atp5l -0.4636196 1.667637e-23        0 -0.72958798\n6    1        Gm10076 -0.4404727 3.985478e-21        0 -0.64435861\n7    1        Gm10260 -0.4297397 4.276949e-20        0 -0.55876061\n8    1          Stmn1 -0.3970492 5.657414e-17        0 -0.62877743\n9    1        Rpl36al -0.3734641 6.959301e-15        0 -0.60240089\n10   1           Nme2 -0.3595564 9.986587e-14        0 -1.48759648\n11   1           Raly -0.3384064 4.257980e-12        0 -1.02907857\n12   1         Rpl27a -0.3273853 2.917431e-11        0 -0.39318812\n13   1        Hnrnpa1 -0.3204800 8.642931e-11        0 -0.42371612\n14   1          Rpl15 -0.3142968 2.373219e-10        0 -0.60150822\n15   1           Glo1 -0.3060652 9.036242e-10        0 -0.50825182\n16   1           Ppia -0.2990938 2.575683e-09        0 -0.61119720\n17   1          Gstp1 -0.2987705 2.586162e-09        0 -0.67817495\n18   1         Gm9844 -0.2873804 1.405859e-08        0 -0.72485194\n19   1           Gnb2 -0.2863104 1.596675e-08        0 -0.89089883\n20   1           Gps1 -0.2841718 2.144394e-08        0 -1.02113299\n21   1           Fdps -0.2786077 4.870749e-08        0 -0.35290526\n22   1         mt.Co1 -0.2701456 1.621212e-07        0 -0.45083061\n23   1          Pcdh9 -0.2600888 6.783712e-07        0 -0.33568931\n24   1           Eno1 -0.2521273 1.953908e-06        0 -0.34261648\n25   1         Tomm20 -0.2464009 4.161634e-06        0 -0.38429325\n26   1          Fopnl -0.2445309 5.059678e-06        0 -0.54335800\n27   1        Bloc1s1 -0.2445235 5.059678e-06        0 -0.68382633\n28   1           Nme1 -0.2368368 1.294655e-05        0 -0.31943344\n29   1           Mea1 -0.2358888 1.427839e-05        0 -1.22670712\n30   1         Polr2k -0.2314427 2.413075e-05        0 -0.74896109\n31   1       Tpm3.rs7 -0.2256287 4.917877e-05        0 -0.38346143\n32   1           Lsm7 -0.2247260 5.376587e-05        0 -0.29980444\n33   1          Rwdd1 -0.2236509 5.872473e-05        0 -0.25680432\n34   1         Ppp1cc -0.2216835 7.169717e-05        0 -0.42313946\n35   1           Tln1 -0.2176354 1.150343e-04        0 -0.60121336\n36   1           Cap1 -0.2167206 1.240952e-04        0 -0.28472756\n37   1        Lamtor3 -0.2166690 1.240952e-04        0 -0.43463703\n38   1           Btf3 -0.2147496 1.528275e-04        0 -0.27400311\n39   1         Ndufs5 -0.2128721 1.842585e-04        0 -0.48320512\n40   1         Tarbp2 -0.2123358 1.926960e-04        0 -0.98975553\n41   1         Ifitm2 -0.2075714 3.124845e-04        0 -0.93419770\n42   1           Btg1 -0.2074439 3.124845e-04        0 -0.48968203\n43   1         Atp5g2 -0.2050227 4.059691e-04        0 -1.00411870\n44   1            Ubb -0.2041784 4.397309e-04        0 -0.73394166\n45   1           Pop4 -0.2030165 4.858863e-04        0 -0.31795136\n46   1         Mrps33 -0.2024224 5.115751e-04        0 -0.31275401\n47   1           Xist -0.2015720 5.428791e-04        0 -0.20099999\n48   1          Zfpm2 -0.2013996 5.428791e-04        0 -0.48028351\n49   1          Serf2 -0.1979161 7.529353e-04        0 -0.33563043\n50   1       Serpini1 -0.1971836 7.943739e-04        0 -0.20380776\n51   1         Mrps36 -0.1953705 9.081659e-04        0 -0.77800701\n52   1          Sap18 -0.1946831 9.667589e-04        0 -0.25178663\n53   1           Psap -0.1940358 1.024567e-03        0 -0.25725676\n54   1          Ube2s -0.1919582 1.251923e-03        0 -0.61258722\n55   1        Cntnap2 -0.1901799 1.479238e-03        0 -0.27548961\n56   1         mt.Nd5 -0.1870497 1.990702e-03        0 -0.37227982\n57   1          Naa10 -0.1863570 2.070267e-03        0 -0.60095155\n58   1           Gpx4 -0.1857669 2.178201e-03        0 -0.20008708\n59   1          Stmn2 -0.1841842 2.487140e-03        0 -0.28112428\n60   1         Rnf114 -0.1828209 2.825226e-03        0 -0.24970003\n61   1           Rbm3 -0.1815005 3.114980e-03        0 -0.34334621\n62   1         Mrpl23 -0.1774233 4.525958e-03        0 -0.33564600\n63   1          Kpna2 -0.1765228 4.858883e-03        0 -0.63216478\n64   1         Mettl2 -0.1754189 5.322398e-03        0 -0.33267933\n65   1         Grcc10 -0.1746312 5.649315e-03        0 -0.93197938\n66   1          Ap3s1 -0.1737918 6.027032e-03        0 -0.20527616\n67   1         Psenen -0.1731937 6.217071e-03        0 -0.25801194\n68   1           Dstn -0.1729203 6.217071e-03        0 -0.27449226\n69   1 X4833439L19Rik -0.1727385 6.217071e-03        0 -0.22690981\n70   1            Ndn -0.1726871 6.217071e-03        0 -0.21869226\n71   1          Lrfn5 -0.1699586 7.843473e-03        0 -0.47692581\n72   1        Trmt112 -0.1689513 8.504892e-03        0 -0.22881986\n73   1         Exosc9 -0.1686363 8.697021e-03        0 -0.35186517\n74   1         Apopt1 -0.1682036 8.924860e-03        0 -0.26016106\n75   1           Gpx1 -0.1674662 9.501605e-03        0 -0.17772780\n76   1         Polr2l -0.1668766 9.897726e-03        0 -0.38342945\n77   1          Rtl8a -0.1664545 1.014883e-02        0 -0.43148510\n78   1           Lhx9 -0.1655502 1.097174e-02        0 -0.39696671\n79   1         Ube2d3 -0.1647669 1.172338e-02        0 -0.11304321\n80   1        Gadd45g -0.1635794 1.291070e-02        0 -0.19430562\n81   1        Gm10320 -0.1634505 1.297320e-02        0 -1.48259469\n82   1        Fam171b -0.1633075 1.305369e-02        0 -0.26127670\n83   1          Cdca4 -0.1630273 1.330377e-02        0 -0.39779613\n84   1         Hnrnpl -0.1614933 1.511836e-02        0 -0.24555980\n85   1         Prkag2 -0.1598483 1.721999e-02        0 -0.31107620\n86   1          Rpl35 -0.1576980 1.984815e-02        0 -0.35494978\n87   1         Kansl2 -0.1569664 2.092858e-02        0 -0.30446483\n88   1         Akr1b3 -0.1564546 2.177240e-02        0 -0.95812276\n89   1           Wtap -0.1550175 2.362290e-02        0 -0.24636895\n90   1        Tmem50a -0.1546376 2.415018e-02        0 -0.20486681\n91   1          Btbd9 -0.1544588 2.416976e-02        0 -0.16390100\n92   1         Churc1 -0.1542854 2.439997e-02        0 -0.59272102\n93   1           Stx7 -0.1539896 2.490030e-02        0 -0.15631767\n94   1          Tenm1 -0.1538699 2.493781e-02        0 -0.58258836\n95   1           Tma7 -0.1530726 2.587660e-02        0 -0.17778596\n96   1          Ncam2 -0.1529851 2.587660e-02        0 -0.55049454\n97   1          Taf13 -0.1514154 2.900826e-02        0 -0.20711175\n98   1           Cd81 -0.1507704 3.035059e-02        0 -0.14194102\n99   1          Rpl29 -0.1498042 3.281749e-02        0 -0.81233384\n100  1           Ly6h -0.1495588 3.313048e-02        0 -0.31738241\n101  1            Pts -0.1495101 3.313048e-02        0 -0.33479576\n102  1           Emc8 -0.1490463 3.411955e-02        0 -1.53338622\n103  1          Ntan1 -0.1487829 3.454074e-02        0 -0.14776099\n104  1          Ift46 -0.1486239 3.467576e-02        0 -0.19087506\n105  1           Rhob -0.1486181 3.467576e-02        0 -0.24365623\n106  1         Pabpc1 -0.1473347 3.781523e-02        0 -0.12731174\n107  1           Rpn1 -0.1473172 3.781523e-02        0 -0.29685829\n108  1          Cd164 -0.1470407 3.806987e-02        0 -0.95510002\n109  1         Ndufs3 -0.1469968 3.806987e-02        0 -0.19286496\n110  1         Faap20 -0.1457849 4.079903e-02        0 -0.40722095\n111  1         Rpp25l -0.1455277 4.090874e-02        0 -0.20533516\n112  1           Ctps -0.1453366 4.137977e-02        0 -0.20157322\n113  1          Gstm7 -0.1441713 4.459168e-02        0 -0.27771035\n114  1          Rwdd3 -0.1440951 4.467529e-02        0 -0.19818151\n115  1         Uqcrc1 -0.1423990 5.007439e-02        0 -0.17200440\n116  1        Fdxacb1 -0.1422882 5.009805e-02        0 -0.76452548\n117  1 X1300002E11Rik -0.1422882 5.009805e-02        0 -0.96681879\n118  1           Gdi1 -0.1416844 5.219774e-02        0 -0.12858017\n119  1            Sms -0.1415853 5.240009e-02        0 -0.16537841\n120  1          Rgs17 -0.1402212 5.759560e-02        0 -0.60867803\n121  1         Insig1 -0.1397145 5.951638e-02        0 -0.24820691\n122  1          Nop16 -0.1390305 6.187597e-02        0 -0.36967027\n123  1          Lrrn2 -0.1388253 6.231933e-02        0 -0.59551504\n124  1         Marcks -0.1387912 6.231933e-02        0 -0.16704611\n125  1         Supt4a -0.1385152 6.346419e-02        0 -0.10278269\n126  1          Tusc2 -0.1380959 6.511624e-02        0 -0.30700412\n127  1        Gm17231 -0.1377187 6.658470e-02        0 -0.48697134\n128  1          Gapdh -0.1372482 6.859523e-02        0 -0.24637523\n129  1          Hmga1 -0.1370103 6.963649e-02        0 -0.88024187\n130  1           Rprm -0.1361143 7.391134e-02        0 -0.17727408\n131  1           Ebf1 -0.1357991 7.491177e-02        0 -0.84978663\n132  1           Dad1 -0.1354080 7.638830e-02        0 -0.09449466\n133  1          Zbed4 -0.1351557 7.711751e-02        0 -0.36013105\n134  1          Cdk16 -0.1351448 7.711751e-02        0 -0.24855976\n135  1          Snrpe -0.1345307 7.942293e-02        0 -0.15794122\n136  1          Smim7 -0.1344885 7.942293e-02        0 -0.16480519\n137  1        Aldh1a7 -0.1341285 8.110384e-02        0 -1.51622445\n138  1           Acp1 -0.1336584 8.329023e-02        0 -0.35086645\n139  1          Gipc1 -0.1330803 8.675737e-02        0 -0.15192410\n140  1      Eef1akmt2 -0.1327564 8.833701e-02        0 -0.11416905\n141  1       Cacna2d3 -0.1325698 8.914832e-02        0 -0.63717391\n142  1         Rbmxl1 -0.1325473 8.914832e-02        0 -0.18170969\n143  1        Gm44790 -0.1321926 9.032299e-02        0 -0.52945025\n144  1          Rtn4r -0.1321600 9.032299e-02        0 -1.14607846\n145  1         Golga7 -0.1321165 9.032299e-02        0 -0.13871035\n146  1           Arf2 -0.1317252 9.207863e-02        0 -0.21418581\n147  1          Tnpo3 -0.1312512 9.442935e-02        0 -0.18232415\n148  1        Tspan13 -0.1312214 9.442935e-02        0 -0.12403069\n149  1          Pcbp2 -0.1308196 9.663177e-02        0 -0.06080126\n150  1         Mrpl42 -0.1302949 9.871472e-02        0 -0.11762894\n151  1          Rnf11 -0.1300110 9.957040e-02        0 -0.16489141\n152  1         Coro1a -0.1297707 1.009205e-01        0 -0.21200976\n153  1         Asnsd1 -0.1296167 1.009205e-01        0 -0.59351386\n154  1        Zmynd19 -0.1295814 1.009205e-01        0 -0.61218867\n155  1        Ndufaf1 -0.1294409 1.016811e-01        0 -0.41922942\n156  1          Copz1 -0.1292181 1.027647e-01        0 -0.06069248\n157  1          Kcnq5 -0.1289435 1.045958e-01        0 -0.21905449\n158  1           Lipa -0.1288125 1.049142e-01        0 -1.48389373\n159  1         Lgals1 -0.1287626 1.049142e-01        0 -0.77507374\n160  1           Cycs -0.1283205 1.066272e-01        0 -0.19111465\n161  1         Nap1l5 -0.1280920 1.078207e-01        0 -0.74166992\n162  1          Ndel1 -0.1279612 1.082311e-01        0 -0.21950820\n163  1           Emc4 -0.1277823 1.090392e-01        0 -0.18197192\n164  1        Ankrd40 -0.1275914 1.095144e-01        0 -1.04874102\n165  1          Cetn3 -0.1275658 1.095144e-01        0 -0.12402363\n166  1            Ddt -0.1274910 1.098060e-01        0 -0.21534417\n167  1         Ube2d1 -0.1274394 1.099072e-01        0 -0.05989198\n168  1          Lztr1 -0.1267043 1.154370e-01        0 -0.35554758\n169  1          Hdhd3 -0.1261863 1.187789e-01        0 -1.03765416\n170  1          Prmt2 -0.1260355 1.195789e-01        0 -0.15842919\n171  1           Gng2 -0.1257934 1.203993e-01        0 -0.05703520\n172  1         Ccdc71 -0.1257889 1.203993e-01        0 -0.29402403\n173  1        Sult4a1 -0.1256195 1.211950e-01        0 -0.19724735\n174  1         Dazap1 -0.1253577 1.218730e-01        0 -0.07491903\n175  1         Pagr1b -0.1251951 1.226600e-01        0 -0.09772905\n176  1          Med29 -0.1250112 1.231010e-01        0 -0.31959522\n177  1          H2afz -0.1249504 1.231010e-01        0 -0.13517372\n178  1         Pgrmc1 -0.1249224 1.231010e-01        0 -0.12353972\n179  1          F13a1 -0.1247344 1.238026e-01        0 -1.52270746\n180  1         Rpl35a -0.1246453 1.242499e-01        0 -0.22888981\n181  1          Jagn1 -0.1246119 1.242499e-01        0 -0.16362032\n182  1           Ugp2 -0.1243514 1.263105e-01        0 -0.26457037\n183  1          Slit1 -0.1242172 1.265399e-01        0 -1.24170259\n184  1         Akr1e1 -0.1241699 1.266415e-01        0 -0.26869253\n185  1         Zbtb18 -0.1241108 1.268546e-01        0 -0.02494936\n186  1          Skp1a -0.1236131 1.292788e-01        0 -0.08361736\n187  1           Alg8 -0.1233992 1.298407e-01        0 -0.29004950\n188  1 X4933404O12Rik -0.1232871 1.302624e-01        0 -1.53093894\n189  1        Gm48551 -0.1232842 1.302624e-01        0 -0.65149996\n190  1         Rwdd4a -0.1230208 1.314840e-01        0 -0.16272864\n191  1           Gcat -0.1227368 1.335001e-01        0 -0.90784266\n192  1          Psmg3 -0.1224230 1.358870e-01        0 -1.45761797\n193  1        Gm16973 -0.1224230 1.358870e-01        0 -1.52662646\n194  1          Trib1 -0.1220789 1.375852e-01        0 -1.12151004\n195  1          Rrp7a -0.1220364 1.376667e-01        0 -0.27596938\n196  1           Gpi1 -0.1214913 1.414366e-01        0 -0.13377824\n197  1          Psma3 -0.1213696 1.416416e-01        0 -0.03872378\n198  1        Gm36198 -0.1213099 1.419073e-01        0 -1.12334271\n199  1          Cyb5a -0.1212517 1.421581e-01        0 -0.14287255\n200  1         Txndc9 -0.1211333 1.430268e-01        0 -0.03272968\n201  1        Gm11808  0.3484559 7.691635e-13        0  0.49651641\n202  1          Traf5  0.3460910 1.102236e-12        0  0.61862023\n203  1           Grm8  0.3222584 6.750370e-11        0  0.36130888\n204  1        Gm12166  0.3031504 1.390566e-09        0  0.70766903\n205  1          Akap9  0.2963933 3.634612e-09        0  0.30684159\n206  1         Pdzrn3  0.2936841 5.383420e-09        0  0.58043775\n207  1        Csnk2a1  0.2760060 6.976655e-08        0  0.36399007\n208  1      Rpl10.ps3  0.2547755 1.393615e-06        0  0.40532835\n209  1          Txlng  0.2416229 7.259525e-06        0  0.65886271\n210  1        Rps27rt  0.2371948 1.268722e-05        0  0.34513991\n211  1         Hbb.bs  0.2344874 1.670480e-05        0  0.38981282\n212  1     Rpl13a.ps1  0.2243530 5.504190e-05        0  0.52788210\n213  1         Mrps28  0.2230924 6.156462e-05        0  0.27976541\n214  1         Tuba1a  0.2146050 1.528275e-04        0  0.50226547\n215  1          Rab39  0.2108862 2.244275e-04        0  0.44863682\n216  1           Vmp1  0.2086942 2.847840e-04        0  0.27843562\n217  1        Selenos  0.2078679 3.079542e-04        0  0.31692245\n218  1           Nrg1  0.2031470 4.858863e-04        0  0.24385197\n219  1       Aurkaip1  0.2016231 5.428791e-04        0  0.22703384\n220  1        Gm11361  0.2013583 5.428791e-04        0  0.41707948\n221  1            Pnn  0.2011177 5.496875e-04        0  0.25610844\n222  1           Fez1  0.2000549 6.103992e-04        0  0.15608070\n223  1         Gtf2a2  0.1980148 7.529353e-04        0  0.20731297\n224  1          Kalrn  0.1977169 7.591726e-04        0  0.25084516\n225  1        Cox7a2l  0.1960664 8.863459e-04        0  0.13539672\n226  1         Gm2000  0.1957360 9.069722e-04        0  0.35095049\n227  1          Rps29  0.1955730 9.081659e-04        0  0.26074972\n228  1      Nutf2.ps1  0.1954743 9.081659e-04        0  0.34815392\n229  1        Morf4l1  0.1935647 1.065207e-03        0  0.28841746\n230  1          Srpk1  0.1915643 1.290557e-03        0  0.27646069\n231  1        Gm10131  0.1888895 1.677258e-03        0  0.25190947\n232  1         Gtpbp4  0.1883130 1.762401e-03        0  0.26483373\n233  1           Rdh5  0.1867587 2.029449e-03        0  0.35676065\n234  1         Nedd4l  0.1864298 2.070267e-03        0  0.17374290\n235  1         Ndufb4  0.1846130 2.430047e-03        0  0.20375478\n236  1           Smc3  0.1842032 2.487140e-03        0  0.17446696\n237  1           Nsg2  0.1827488 2.825226e-03        0  0.15724921\n238  1        Gm10282  0.1823049 2.927000e-03        0  0.44216637\n239  1          Eif3m  0.1819904 2.992458e-03        0  0.15506031\n240  1           Rsf1  0.1801963 3.522809e-03        0  0.21615777\n241  1          Nop58  0.1795542 3.723095e-03        0  0.23662780\n242  1          Evi5l  0.1778623 4.373030e-03        0  0.39856473\n243  1          Prex1  0.1767249 4.807246e-03        0  0.21728572\n244  1           Pcm1  0.1758301 5.157203e-03        0  0.21233798\n245  1           Cbx3  0.1753131 5.329132e-03        0  0.23293264\n246  1        Ankrd12  0.1741340 5.879860e-03        0  0.26085483\n247  1           Rtf1  0.1734383 6.184841e-03        0  0.18667602\n248  1          Bend5  0.1732811 6.217071e-03        0  0.39412137\n249  1         Zfp131  0.1728544 6.217071e-03        0  0.32729559\n250  1         Ppp4r2  0.1728279 6.217071e-03        0  0.38181828\n251  1          Rsrc2  0.1727728 6.217071e-03        0  0.16424777\n252  1         Fam98b  0.1721118 6.522381e-03        0  0.33362966\n253  1          Robo2  0.1714409 6.905846e-03        0  0.17950207\n254  1         Tnrc18  0.1711932 7.016900e-03        0  0.23993018\n255  1          Tmed2  0.1692618 8.320781e-03        0  0.14006620\n256  1         Hba.a1  0.1682890 8.920983e-03        0  0.31612082\n257  1         Zfp326  0.1672114 9.660837e-03        0  0.20378968\n258  1          Rufy1  0.1667597 9.933330e-03        0  0.51521168\n259  1          Rsbn1  0.1641105 1.237573e-02        0  0.24213388\n260  1          Setd7  0.1621521 1.432645e-02        0  0.36853389\n261  1          Ubxn4  0.1604211 1.656725e-02        0  0.17550433\n262  1          Strn3  0.1600254 1.705995e-02        0  0.29537780\n263  1         Ly6g6e  0.1592500 1.806167e-02        0  0.61922904\n264  1           Mtdh  0.1591180 1.815719e-02        0  0.19389366\n265  1       Adamtsl3  0.1586308 1.885146e-02        0  0.20107630\n266  1         Dusp14  0.1584301 1.904970e-02        0  0.13102267\n267  1          Pttg1  0.1583690 1.904970e-02        0  0.55526647\n268  1          Pibf1  0.1581988 1.921884e-02        0  0.41003624\n269  1          Appl1  0.1577189 1.984815e-02        0  0.29426390\n270  1          H2afy  0.1574882 2.009731e-02        0  0.16285027\n271  1          Calm3  0.1562708 2.199430e-02        0  0.16070424\n272  1         Ino80b  0.1559814 2.242948e-02        0  0.34168188\n273  1          Bod1l  0.1553064 2.362290e-02        0  0.18358382\n274  1           Iws1  0.1552566 2.362290e-02        0  0.27071531\n275  1          Kif1a  0.1551482 2.362290e-02        0  0.22522502\n276  1          Alcam  0.1550095 2.362290e-02        0  0.16601032\n277  1          Sept6  0.1549856 2.362290e-02        0  0.58960723\n278  1         Zfp692  0.1546016 2.415018e-02        0  0.37221216\n279  1          Rock1  0.1545226 2.416976e-02        0  0.28766305\n280  1         Eif2b4  0.1538415 2.493781e-02        0  0.27560319\n281  1         Fnbp1l  0.1536705 2.517196e-02        0  0.17377379\n282  1           Ktn1  0.1534778 2.545738e-02        0  0.17307918\n283  1          Tcea1  0.1533702 2.555425e-02        0  0.33471381\n284  1         Zfp397  0.1532373 2.570944e-02        0  0.25674657\n285  1       Cdk5rap2  0.1529732 2.587660e-02        0  0.45056901\n286  1          Kdm2a  0.1526865 2.638960e-02        0  0.21137933\n287  1           Smg1  0.1521638 2.747340e-02        0  0.27114108\n288  1        Rabgap1  0.1517848 2.824278e-02        0  0.21136886\n289  1        Tmem267  0.1510929 2.967221e-02        0  0.31464961\n290  1        Gm43518  0.1496645 3.303897e-02        0  0.45701413\n291  1          Kdm5b  0.1492795 3.361768e-02        0  0.16632349\n292  1           Tpm3  0.1489575 3.420303e-02        0  0.20175765\n293  1          Dcaf5  0.1484868 3.489011e-02        0  0.36801821\n294  1          Kcnd2  0.1476244 3.736397e-02        0  0.33926994\n295  1          Lrch2  0.1473071 3.781523e-02        0  0.24954469\n296  1            Ncl  0.1471834 3.802584e-02        0  0.12797966\n297  1         Gm3550  0.1470355 3.806987e-02        0  0.21855095\n298  1           Abl2  0.1465309 3.937628e-02        0  0.29724249\n299  1        Dync1h1  0.1464838 3.937628e-02        0  0.20306988\n300  1             Ik  0.1462807 3.986552e-02        0  0.18514602\n301  1       Rpl9.ps6  0.1461052 4.026736e-02        0  0.22611091\n302  1        Zfand2b  0.1458493 4.079903e-02        0  0.32873114\n303  1           Atrx  0.1457394 4.079903e-02        0  0.13942252\n304  1           Gfm2  0.1456779 4.079903e-02        0  0.40499451\n305  1         Serbp1  0.1456699 4.079903e-02        0  0.14969501\n306  1         Gm9008  0.1455408 4.090874e-02        0  1.76164484\n307  1     CT025619.1  0.1449154 4.267056e-02        0  0.19392534\n308  1         Zc3h18  0.1447141 4.319791e-02        0  0.37215313\n309  1  A330084C13Rik  0.1443574 4.430262e-02        0  0.56562469\n310  1         Mycbp2  0.1441810 4.459168e-02        0  0.16615709\n311  1         Scaf11  0.1439549 4.499877e-02        0  0.20986198\n312  1          Nuak1  0.1435553 4.631266e-02        0  0.17576114\n313  1           Cul1  0.1434988 4.632527e-02        0  0.15170703\n314  1         Zfand5  0.1434020 4.649383e-02        0  0.13026238\n315  1          Mrps5  0.1431078 4.743323e-02        0  0.15458456\n316  1           Nrp1  0.1420521 5.086195e-02        0  0.06606303\n317  1           Ddx5  0.1408348 5.548305e-02        0  0.21826847\n318  1           Fat3  0.1403539 5.739234e-02        0  0.19218385\n319  1        Zcchc11  0.1403161 5.739234e-02        0  0.25537927\n320  1          Vgll4  0.1401097 5.787786e-02        0  0.13805112\n321  1        L3mbtl3  0.1395875 5.988395e-02        0  0.34384398\n322  1         Cep85l  0.1391752 6.166041e-02        0  0.26278821\n323  1          Lrch3  0.1390308 6.187597e-02        0  0.34368877\n324  1          Ddx24  0.1388622 6.231933e-02        0  0.12106951\n325  1           Chd7  0.1383650 6.397851e-02        0  0.23358757\n326  1       Ftl1.ps1  0.1379283 6.573575e-02        0  0.21973182\n327  1          Pde4d  0.1376638 6.661487e-02        0  0.03943154\n328  1        Gm45736  0.1366509 7.137961e-02        0  0.30265555\n329  1            Zfr  0.1361690 7.387710e-02        0  0.22322110\n330  1        Gm13402  0.1360212 7.417222e-02        0  1.78501126\n331  1           Cdh4  0.1358588 7.484470e-02        0  0.24472568\n332  1           Eml4  0.1355148 7.632325e-02        0  0.26994997\n333  1          Ptov1  0.1354443 7.638830e-02        0  0.15583284\n334  1         Map3k3  0.1352940 7.678851e-02        0  0.32635471\n335  1          Ddx3y  0.1348404 7.869394e-02        0  0.24123454\n336  1          Klf13  0.1347567 7.891962e-02        0  0.19762500\n337  1         Golgb1  0.1346709 7.916026e-02        0  0.16523988\n338  1           Bcor  0.1345941 7.934645e-02        0  0.18264437\n339  1          Pde9a  0.1344332 7.947821e-02        0  0.27008760\n340  1          Nop56  0.1336623 8.329023e-02        0  0.16798515\n341  1        Gm26848  0.1336498 8.329023e-02        0  0.52469205\n342  1           Chd2  0.1328581 8.795434e-02        0  0.32331614\n343  1       Slc38a10  0.1322315 9.032299e-02        0  0.24505316\n344  1           Lias  0.1321528 9.032299e-02        0  0.25865768\n345  1        Ccdc191  0.1321080 9.032299e-02        0  0.44177446\n346  1          Srrm4  0.1319044 9.143870e-02        0  0.14104522\n347  1          Hmgb1  0.1318126 9.177330e-02        0  0.22391249\n348  1           Aff2  0.1314396 9.380595e-02        0  0.16314267\n349  1          Tor2a  0.1312504 9.442935e-02        0  0.23475385\n350  1         Oxnad1  0.1310417 9.542021e-02        0  0.35324940\n351  1         Vps13a  0.1307438 9.663177e-02        0  0.48735806\n352  1           Opa1  0.1307054 9.663177e-02        0  0.34119936\n353  1           Apip  0.1307031 9.663177e-02        0  0.30031728\n354  1           Usp3  0.1306567 9.665538e-02        0  0.14793247\n355  1           Leo1  0.1305854 9.686486e-02        0  0.30054292\n356  1         Clasp1  0.1301527 9.932987e-02        0  0.11674027\n357  1         Prrc2c  0.1301279 9.932987e-02        0  0.17458086\n358  1         Iqgap2  0.1300294 9.957040e-02        0  0.39929966\n359  1          Znrf3  0.1297207 1.009205e-01        0  0.58115486\n360  1       Epm2aip1  0.1297036 1.009205e-01        0  0.34196457\n361  1          Lrrc7  0.1295886 1.009205e-01        0  0.14819548\n362  1           Jak1  0.1292634 1.027347e-01        0  0.30284988\n363  1        Ccdc186  0.1288669 1.048750e-01        0  0.13494288\n364  1           Sltm  0.1287386 1.049142e-01        0  0.13242058\n365  1           Rybp  0.1286916 1.049623e-01        0  0.36975968\n366  1          Gdpd5  0.1283864 1.066272e-01        0  0.31617136\n367  1          Igsf3  0.1283846 1.066272e-01        0  0.19494614\n368  1          Hdac4  0.1283498 1.066272e-01        0  0.44260801\n369  1  C530008M17Rik  0.1281383 1.077726e-01        0  0.24586000\n370  1         Agpat4  0.1279918 1.082311e-01        0  0.24201463\n371  1           Nek3  0.1278735 1.086200e-01        0  0.46543654\n372  1        Ccdc85c  0.1276971 1.092591e-01        0  0.86417579\n373  1         Rhbdl3  0.1276760 1.092591e-01        0  0.43639431\n374  1          Baz1b  0.1273824 1.100538e-01        0  0.20240472\n375  1         Frmd4a  0.1264058 1.176893e-01        0  0.23490660\n376  1          Pelp1  0.1263596 1.177511e-01        0  0.25685839\n377  1           Ezh2  0.1261647 1.187789e-01        0  0.11801844\n378  1           Ngef  0.1258210 1.203993e-01        0  1.69694386\n379  1       BC055324  0.1258210 1.203993e-01        0  1.66490323\n380  1           Bcl9  0.1256579 1.211950e-01        0  0.22112673\n381  1          Unc5d  0.1255533 1.211950e-01        0  0.12876094\n382  1            Bbx  0.1255469 1.211950e-01        0  0.18950593\n383  1          Synrg  0.1254709 1.215360e-01        0  0.19347041\n384  1        Hnrnph3  0.1254295 1.215670e-01        0  0.15967412\n385  1           Il10  0.1252627 1.223894e-01        0  0.25691673\n386  1        Gm10184  0.1250609 1.231010e-01        0  1.23840587\n387  1           Unkl  0.1250609 1.231010e-01        0  1.16904644\n388  1          Ywhae  0.1249717 1.231010e-01        0  0.10178118\n389  1         Ccdc34  0.1247871 1.236635e-01        0  0.09210400\n390  1        Plekha5  0.1247865 1.236635e-01        0  0.23105713\n391  1         Ppfia2  0.1242970 1.263882e-01        0  0.19928589\n392  1           Dnm3  0.1242700 1.263882e-01        0  0.68369775\n393  1         Diablo  0.1239599 1.279252e-01        0  0.20538381\n394  1          Eno1b  0.1238235 1.285838e-01        0  0.34441883\n395  1           Nt5m  0.1238176 1.285838e-01        0  0.30888221\n396  1          Odf2l  0.1237296 1.290743e-01        0  0.32395824\n397  1           Brd3  0.1236466 1.292788e-01        0  0.12744106\n398  1           Wnk3  0.1236006 1.292788e-01        0  0.30950183\n399  1          Ccar1  0.1234892 1.298407e-01        0  0.09869740\n400  1           Epg5  0.1234448 1.298407e-01        0  0.59491318\n401  2        Gm11808 -0.3484518 7.697548e-13        0 -0.49651641\n402  2          Traf5 -0.3460862 1.103237e-12        0 -0.61862023\n403  2           Grm8 -0.3222594 6.749210e-11        0 -0.36130888\n404  2        Gm12166 -0.3031474 1.391247e-09        0 -0.70766903\n405  2          Akap9 -0.2964012 3.629973e-09        0 -0.30684159\n406  2         Pdzrn3 -0.2936781 5.388553e-09        0 -0.58043775\n407  2        Csnk2a1 -0.2760001 6.982889e-08        0 -0.36399007\n408  2      Rpl10.ps3 -0.2547703 1.394645e-06        0 -0.40532835\n409  2          Txlng -0.2416189 7.263440e-06        0 -0.65886271\n410  2        Rps27rt -0.2371900 1.269524e-05        0 -0.34513991\n411  2         Hbb.bs -0.2344950 1.668837e-05        0 -0.38981282\n412  2     Rpl13a.ps1 -0.2243523 5.504692e-05        0 -0.52788210\n413  2         Mrps28 -0.2230893 6.158832e-05        0 -0.27976541\n414  2         Tuba1a -0.2146021 1.528810e-04        0 -0.50226547\n415  2          Rab39 -0.2108843 2.244774e-04        0 -0.44863682\n416  2           Vmp1 -0.2086986 2.846360e-04        0 -0.27843562\n417  2        Selenos -0.2078726 3.077870e-04        0 -0.31692245\n418  2           Nrg1 -0.2031443 4.858960e-04        0 -0.24385197\n419  2       Aurkaip1 -0.2016202 5.428977e-04        0 -0.22703384\n420  2        Gm11361 -0.2013580 5.428977e-04        0 -0.41707948\n421  2            Pnn -0.2011202 5.495292e-04        0 -0.25610844\n422  2           Fez1 -0.2000574 6.102337e-04        0 -0.15608070\n423  2         Gtf2a2 -0.1980178 7.533692e-04        0 -0.20731297\n424  2          Kalrn -0.1977204 7.588850e-04        0 -0.25084516\n425  2        Cox7a2l -0.1960558 8.873832e-04        0 -0.13539672\n426  2         Gm2000 -0.1957453 9.060456e-04        0 -0.35095049\n427  2          Rps29 -0.1955583 9.080899e-04        0 -0.26074972\n428  2      Nutf2.ps1 -0.1954740 9.080899e-04        0 -0.34815392\n429  2        Morf4l1 -0.1935622 1.065489e-03        0 -0.28841746\n430  2          Srpk1 -0.1915667 1.290231e-03        0 -0.27646069\n431  2        Gm10131 -0.1888901 1.677144e-03        0 -0.25190947\n432  2         Gtpbp4 -0.1883153 1.761979e-03        0 -0.26483373\n433  2           Rdh5 -0.1867627 2.028606e-03        0 -0.35676065\n434  2         Nedd4l -0.1864228 2.067776e-03        0 -0.17374290\n435  2         Ndufb4 -0.1846059 2.431827e-03        0 -0.20375478\n436  2           Smc3 -0.1842010 2.488602e-03        0 -0.17446696\n437  2           Nsg2 -0.1827508 2.824646e-03        0 -0.15724921\n438  2        Gm10282 -0.1823008 2.928218e-03        0 -0.44216637\n439  2          Eif3m -0.1819981 2.990112e-03        0 -0.15506031\n440  2           Rsf1 -0.1801900 3.525046e-03        0 -0.21615777\n441  2          Nop58 -0.1795474 3.725645e-03        0 -0.23662780\n442  2          Evi5l -0.1778636 4.372422e-03        0 -0.39856473\n443  2          Prex1 -0.1767190 4.810053e-03        0 -0.21728572\n444  2           Pcm1 -0.1758333 5.155561e-03        0 -0.21233798\n445  2           Cbx3 -0.1753203 5.325344e-03        0 -0.23293264\n446  2        Ankrd12 -0.1741269 5.883987e-03        0 -0.26085483\n447  2           Rtf1 -0.1734301 6.189829e-03        0 -0.18667602\n448  2          Bend5 -0.1732906 6.214230e-03        0 -0.39412137\n449  2         Zfp131 -0.1728609 6.214230e-03        0 -0.32729559\n450  2         Ppp4r2 -0.1728226 6.214230e-03        0 -0.38181828\n451  2          Rsrc2 -0.1727732 6.214230e-03        0 -0.16424777\n452  2         Fam98b -0.1721113 6.522691e-03        0 -0.33362966\n453  2          Robo2 -0.1714317 6.911986e-03        0 -0.17950207\n454  2         Tnrc18 -0.1711863 7.021606e-03        0 -0.23993018\n455  2          Tmed2 -0.1692572 8.324481e-03        0 -0.14006620\n456  2         Hba.a1 -0.1682859 8.923616e-03        0 -0.31612082\n457  2         Zfp326 -0.1672118 9.660406e-03        0 -0.20378968\n458  2          Rufy1 -0.1667701 9.923580e-03        0 -0.51521168\n459  2          Rsbn1 -0.1641050 1.238200e-02        0 -0.24213388\n460  2          Setd7 -0.1621581 1.431852e-02        0 -0.36853389\n461  2          Ubxn4 -0.1604206 1.656794e-02        0 -0.17550433\n462  2          Strn3 -0.1600201 1.706826e-02        0 -0.29537780\n463  2         Ly6g6e -0.1592551 1.805340e-02        0 -0.61922904\n464  2           Mtdh -0.1591228 1.814915e-02        0 -0.19389366\n465  2       Adamtsl3 -0.1586315 1.885016e-02        0 -0.20107630\n466  2         Dusp14 -0.1584262 1.903247e-02        0 -0.13102267\n467  2          Pttg1 -0.1583790 1.903247e-02        0 -0.55526647\n468  2          Pibf1 -0.1582008 1.921533e-02        0 -0.41003624\n469  2          Appl1 -0.1577168 1.981484e-02        0 -0.29426390\n470  2          H2afy -0.1574831 2.010660e-02        0 -0.16285027\n471  2          Calm3 -0.1562729 2.199016e-02        0 -0.16070424\n472  2         Ino80b -0.1559776 2.243697e-02        0 -0.34168188\n473  2          Bod1l -0.1553121 2.363774e-02        0 -0.18358382\n474  2           Iws1 -0.1552531 2.363774e-02        0 -0.27071531\n475  2          Kif1a -0.1551444 2.364238e-02        0 -0.22522502\n476  2          Alcam -0.1550037 2.364238e-02        0 -0.16601032\n477  2          Sept6 -0.1549763 2.364238e-02        0 -0.58960723\n478  2         Zfp692 -0.1546065 2.413978e-02        0 -0.37221216\n479  2          Rock1 -0.1545208 2.417674e-02        0 -0.28766305\n480  2         Eif2b4 -0.1538404 2.494024e-02        0 -0.27560319\n481  2         Fnbp1l -0.1536734 2.516567e-02        0 -0.17377379\n482  2           Ktn1 -0.1534807 2.545074e-02        0 -0.17307918\n483  2          Tcea1 -0.1533759 2.554144e-02        0 -0.33471381\n484  2         Zfp397 -0.1532392 2.570503e-02        0 -0.25674657\n485  2       Cdk5rap2 -0.1529680 2.588837e-02        0 -0.45056901\n486  2          Kdm2a -0.1526938 2.637271e-02        0 -0.21137933\n487  2           Smg1 -0.1521631 2.747503e-02        0 -0.27114108\n488  2        Rabgap1 -0.1517827 2.824798e-02        0 -0.21136886\n489  2        Tmem267 -0.1510996 2.965487e-02        0 -0.31464961\n490  2        Gm43518 -0.1496620 3.304610e-02        0 -0.45701413\n491  2          Kdm5b -0.1492767 3.362564e-02        0 -0.16632349\n492  2           Tpm3 -0.1489532 3.421561e-02        0 -0.20175765\n493  2          Dcaf5 -0.1484826 3.490277e-02        0 -0.36801821\n494  2          Kcnd2 -0.1476345 3.733185e-02        0 -0.33926994\n495  2          Lrch2 -0.1472992 3.784038e-02        0 -0.24954469\n496  2            Ncl -0.1471858 3.801824e-02        0 -0.12797966\n497  2         Gm3550 -0.1470382 3.807706e-02        0 -0.21855095\n498  2           Abl2 -0.1465348 3.939639e-02        0 -0.29724249\n499  2        Dync1h1 -0.1464765 3.940062e-02        0 -0.20306988\n500  2             Ik -0.1462855 3.984947e-02        0 -0.18514602\n501  2       Rpl9.ps6 -0.1461088 4.025505e-02        0 -0.22611091\n502  2        Zfand2b -0.1458378 4.081354e-02        0 -0.32873114\n503  2           Atrx -0.1457391 4.081354e-02        0 -0.13942252\n504  2           Gfm2 -0.1456801 4.081354e-02        0 -0.40499451\n505  2         Serbp1 -0.1456656 4.081354e-02        0 -0.14969501\n506  2         Gm9008 -0.1455257 4.091578e-02        0 -1.76164484\n507  2     CT025619.1 -0.1449230 4.264367e-02        0 -0.19392534\n508  2         Zc3h18 -0.1447176 4.318529e-02        0 -0.37215313\n509  2  A330084C13Rik -0.1443521 4.432214e-02        0 -0.56562469\n510  2         Mycbp2 -0.1441840 4.457820e-02        0 -0.16615709\n511  2         Scaf11 -0.1439583 4.498619e-02        0 -0.20986198\n512  2          Nuak1 -0.1435589 4.629872e-02        0 -0.17576114\n513  2           Cul1 -0.1434946 4.634138e-02        0 -0.15170703\n514  2         Zfand5 -0.1434052 4.648139e-02        0 -0.13026238\n515  2          Mrps5 -0.1431042 4.744731e-02        0 -0.15458456\n516  2           Nrp1 -0.1420546 5.085142e-02        0 -0.06606303\n517  2           Ddx5 -0.1408325 5.549341e-02        0 -0.21826847\n518  2           Fat3 -0.1403519 5.739409e-02        0 -0.19218385\n519  2        Zcchc11 -0.1403158 5.739409e-02        0 -0.25537927\n520  2          Vgll4 -0.1401099 5.787694e-02        0 -0.13805112\n521  2        L3mbtl3 -0.1395909 5.986721e-02        0 -0.34384398\n522  2         Cep85l -0.1391772 6.165036e-02        0 -0.26278821\n523  2          Lrch3 -0.1390245 6.191587e-02        0 -0.34368877\n524  2          Ddx24 -0.1388620 6.233519e-02        0 -0.12106951\n525  2           Chd7 -0.1383698 6.395383e-02        0 -0.23358757\n526  2       Ftl1.ps1 -0.1379344 6.570340e-02        0 -0.21973182\n527  2          Pde4d -0.1376713 6.657474e-02        0 -0.03943154\n528  2        Gm45736 -0.1366498 7.138544e-02        0 -0.30265555\n529  2            Zfr -0.1361699 7.387152e-02        0 -0.22322110\n530  2        Gm13402 -0.1360180 7.419125e-02        0 -1.78501126\n531  2           Cdh4 -0.1358559 7.486189e-02        0 -0.24472568\n532  2           Eml4 -0.1355109 7.634653e-02        0 -0.26994997\n533  2          Ptov1 -0.1354485 7.638457e-02        0 -0.15583284\n534  2         Map3k3 -0.1352972 7.676939e-02        0 -0.32635471\n535  2          Ddx3y -0.1348408 7.869134e-02        0 -0.24123454\n536  2          Klf13 -0.1347597 7.890145e-02        0 -0.19762500\n537  2         Golgb1 -0.1346720 7.915368e-02        0 -0.16523988\n538  2           Bcor -0.1345897 7.937393e-02        0 -0.18264437\n539  2          Pde9a -0.1344377 7.945022e-02        0 -0.27008760\n540  2          Nop56 -0.1336573 8.338971e-02        0 -0.16798515\n541  2        Gm26848 -0.1336345 8.338971e-02        0 -0.52469205\n542  2           Chd2 -0.1328623 8.792534e-02        0 -0.32331614\n543  2       Slc38a10 -0.1322398 9.040119e-02        0 -0.24505316\n544  2           Lias -0.1321459 9.040119e-02        0 -0.25865768\n545  2        Ccdc191 -0.1320968 9.040119e-02        0 -0.44177446\n546  2          Srrm4 -0.1319095 9.140254e-02        0 -0.14104522\n547  2          Hmgb1 -0.1318259 9.167927e-02        0 -0.22391249\n548  2           Aff2 -0.1314429 9.378199e-02        0 -0.16314267\n549  2          Tor2a -0.1312494 9.444128e-02        0 -0.23475385\n550  2         Oxnad1 -0.1310548 9.532378e-02        0 -0.35324940\n551  2         Vps13a -0.1307479 9.665266e-02        0 -0.48735806\n552  2           Apip -0.1307026 9.665266e-02        0 -0.30031728\n553  2           Opa1 -0.1307003 9.665266e-02        0 -0.34119936\n554  2           Usp3 -0.1306555 9.666486e-02        0 -0.14793247\n555  2           Leo1 -0.1305852 9.686614e-02        0 -0.30054292\n556  2         Clasp1 -0.1301519 9.933613e-02        0 -0.11674027\n557  2         Prrc2c -0.1301271 9.933613e-02        0 -0.17458086\n558  2         Iqgap2 -0.1300260 9.959059e-02        0 -0.39929966\n559  2       Epm2aip1 -0.1297069 1.009396e-01        0 -0.34196457\n560  2          Znrf3 -0.1297048 1.009396e-01        0 -0.58115486\n561  2          Lrrc7 -0.1295880 1.010264e-01        0 -0.14819548\n562  2           Jak1 -0.1292660 1.027148e-01        0 -0.30284988\n563  2        Ccdc186 -0.1288590 1.049197e-01        0 -0.13494288\n564  2           Sltm -0.1287321 1.049657e-01        0 -0.13242058\n565  2           Rybp -0.1286835 1.050266e-01        0 -0.36975968\n566  2          Gdpd5 -0.1283845 1.066594e-01        0 -0.31617136\n567  2          Igsf3 -0.1283813 1.066594e-01        0 -0.19494614\n568  2          Hdac4 -0.1283448 1.066594e-01        0 -0.44260801\n569  2  C530008M17Rik -0.1281322 1.077066e-01        0 -0.24586000\n570  2         Agpat4 -0.1279906 1.082208e-01        0 -0.24201463\n571  2           Nek3 -0.1278641 1.086972e-01        0 -0.46543654\n572  2        Ccdc85c -0.1276868 1.091727e-01        0 -0.86417579\n573  2         Rhbdl3 -0.1276866 1.091727e-01        0 -0.43639431\n574  2          Baz1b -0.1273785 1.100857e-01        0 -0.20240472\n575  2         Frmd4a -0.1264096 1.176558e-01        0 -0.23490660\n576  2          Pelp1 -0.1263606 1.177427e-01        0 -0.25685839\n577  2           Ezh2 -0.1261583 1.188359e-01        0 -0.11801844\n578  2           Ngef -0.1258276 1.203146e-01        0 -1.69694386\n579  2       BC055324 -0.1258276 1.203146e-01        0 -1.66490323\n580  2           Bcl9 -0.1256521 1.212058e-01        0 -0.22112673\n581  2          Unc5d -0.1255478 1.212058e-01        0 -0.12876094\n582  2            Bbx -0.1255457 1.212058e-01        0 -0.18950593\n583  2          Synrg -0.1254746 1.215027e-01        0 -0.19347041\n584  2        Hnrnph3 -0.1254333 1.215329e-01        0 -0.15967412\n585  2           Il10 -0.1252729 1.222976e-01        0 -0.25691673\n586  2        Gm10184 -0.1250318 1.230558e-01        0 -1.23840587\n587  2           Unkl -0.1250318 1.230558e-01        0 -1.16904644\n588  2          Ywhae -0.1249512 1.230558e-01        0 -0.10178118\n589  2         Ccdc34 -0.1247844 1.237110e-01        0 -0.09210400\n590  2        Plekha5 -0.1247813 1.237110e-01        0 -0.23105713\n591  2         Ppfia2 -0.1242922 1.264621e-01        0 -0.19928589\n592  2           Dnm3 -0.1242606 1.264621e-01        0 -0.68369775\n593  2         Diablo -0.1239611 1.279141e-01        0 -0.20538381\n594  2           Nt5m -0.1238218 1.285887e-01        0 -0.30888221\n595  2          Eno1b -0.1238171 1.285887e-01        0 -0.34441883\n596  2          Odf2l -0.1237346 1.290265e-01        0 -0.32395824\n597  2           Brd3 -0.1236467 1.292792e-01        0 -0.12744106\n598  2           Wnk3 -0.1236005 1.292792e-01        0 -0.30950183\n599  2          Ccar1 -0.1234960 1.297591e-01        0 -0.09869740\n600  2           Epg5 -0.1234494 1.297591e-01        0 -0.59491318\n601  2          Uba52  0.8106578 1.622319e-74        0  1.53792300\n602  2           Pgk1  0.5238239 4.452013e-30        0  1.25344098\n603  2         Sec61g  0.4973904 4.330414e-27        0  0.94392234\n604  2            Erh  0.4763877 8.137141e-25        0  0.66616044\n605  2          Atp5l  0.4636140 1.669979e-23        0  0.72958798\n606  2        Gm10076  0.4404746 3.983630e-21        0  0.64435861\n607  2        Gm10260  0.4297455 4.271154e-20        0  0.55876061\n608  2          Stmn1  0.3970580 5.646794e-17        0  0.62877743\n609  2        Rpl36al  0.3734641 6.959234e-15        0  0.60240089\n610  2           Nme2  0.3595523 9.994733e-14        0  1.48759648\n611  2           Raly  0.3384072 4.257342e-12        0  1.02907857\n612  2         Rpl27a  0.3273849 2.917626e-11        0  0.39318812\n613  2        Hnrnpa1  0.3204802 8.642714e-11        0  0.42371612\n614  2          Rpl15  0.3143006 2.371646e-10        0  0.60150822\n615  2           Glo1  0.3060682 9.031637e-10        0  0.50825182\n616  2           Ppia  0.2990919 2.576494e-09        0  0.61119720\n617  2          Gstp1  0.2987705 2.586181e-09        0  0.67817495\n618  2         Gm9844  0.2873811 1.405713e-08        0  0.72485194\n619  2           Gnb2  0.2863184 1.594659e-08        0  0.89089883\n620  2           Gps1  0.2841683 2.145561e-08        0  1.02113299\n621  2           Fdps  0.2786061 4.871945e-08        0  0.35290526\n622  2         mt.Co1  0.2701407 1.622385e-07        0  0.45083061\n623  2          Pcdh9  0.2600918 6.780802e-07        0  0.33568931\n624  2           Eno1  0.2521340 1.952078e-06        0  0.34261648\n625  2         Tomm20  0.2464028 4.160546e-06        0  0.38429325\n626  2          Fopnl  0.2445296 5.066179e-06        0  0.54335800\n627  2        Bloc1s1  0.2445140 5.066179e-06        0  0.68382633\n628  2           Nme1  0.2368440 1.293442e-05        0  0.31943344\n629  2           Mea1  0.2358807 1.429343e-05        0  1.22670712\n630  2         Polr2k  0.2314505 2.410659e-05        0  0.74896109\n631  2       Tpm3.rs7  0.2256353 4.913834e-05        0  0.38346143\n632  2           Lsm7  0.2247241 5.377900e-05        0  0.29980444\n633  2          Rwdd1  0.2236545 5.869821e-05        0  0.25680432\n634  2         Ppp1cc  0.2216787 7.173969e-05        0  0.42313946\n635  2           Tln1  0.2176258 1.151688e-04        0  0.60121336\n636  2           Cap1  0.2167225 1.241571e-04        0  0.28472756\n637  2        Lamtor3  0.2166648 1.241571e-04        0  0.43463703\n638  2           Btf3  0.2147536 1.528810e-04        0  0.27400311\n639  2         Ndufs5  0.2128700 1.843052e-04        0  0.48320512\n640  2         Tarbp2  0.2123420 1.925531e-04        0  0.98975553\n641  2         Ifitm2  0.2075667 3.122521e-04        0  0.93419770\n642  2           Btg1  0.2074504 3.122521e-04        0  0.48968203\n643  2         Atp5g2  0.2050316 4.055558e-04        0  1.00411870\n644  2            Ubb  0.2041761 4.398443e-04        0  0.73394166\n645  2           Pop4  0.2030163 4.858960e-04        0  0.31795136\n646  2         Mrps33  0.2024270 5.113065e-04        0  0.31275401\n647  2           Xist  0.2015710 5.428977e-04        0  0.20099999\n648  2          Zfpm2  0.2014001 5.428977e-04        0  0.48028351\n649  2          Serf2  0.1979109 7.533692e-04        0  0.33563043\n650  2       Serpini1  0.1971857 7.941919e-04        0  0.20380776\n651  2         Mrps36  0.1953713 9.080899e-04        0  0.77800701\n652  2          Sap18  0.1946847 9.665871e-04        0  0.25178663\n653  2           Psap  0.1940357 1.024577e-03        0  0.25725676\n654  2          Ube2s  0.1919584 1.251890e-03        0  0.61258722\n655  2        Cntnap2  0.1901810 1.479072e-03        0  0.27548961\n656  2         mt.Nd5  0.1870468 1.991312e-03        0  0.37227982\n657  2          Naa10  0.1863685 2.067776e-03        0  0.60095155\n658  2           Gpx4  0.1857663 2.178322e-03        0  0.20008708\n659  2          Stmn2  0.1841786 2.488602e-03        0  0.28112428\n660  2         Rnf114  0.1828246 2.824646e-03        0  0.24970003\n661  2           Rbm3  0.1815099 3.111986e-03        0  0.34334621\n662  2         Mrpl23  0.1774163 4.529131e-03        0  0.33564600\n663  2          Kpna2  0.1765308 4.855019e-03        0  0.63216478\n664  2         Mettl2  0.1754197 5.321950e-03        0  0.33267933\n665  2         Grcc10  0.1746264 5.652006e-03        0  0.93197938\n666  2          Ap3s1  0.1737990 6.022744e-03        0  0.20527616\n667  2         Psenen  0.1731957 6.214230e-03        0  0.25801194\n668  2           Dstn  0.1729236 6.214230e-03        0  0.27449226\n669  2 X4833439L19Rik  0.1727312 6.214230e-03        0  0.22690981\n670  2            Ndn  0.1726918 6.214230e-03        0  0.21869226\n671  2          Lrfn5  0.1699571 7.844594e-03        0  0.47692581\n672  2        Trmt112  0.1689505 8.505539e-03        0  0.22881986\n673  2         Exosc9  0.1686346 8.698411e-03        0  0.35186517\n674  2         Apopt1  0.1682024 8.925929e-03        0  0.26016106\n675  2           Gpx1  0.1674659 9.501882e-03        0  0.17772780\n676  2         Polr2l  0.1668801 9.894426e-03        0  0.38342945\n677  2          Rtl8a  0.1664593 1.014425e-02        0  0.43148510\n678  2           Lhx9  0.1655589 1.096274e-02        0  0.39696671\n679  2         Ube2d3  0.1647657 1.172467e-02        0  0.11304321\n680  2        Gadd45g  0.1635806 1.290916e-02        0  0.19430562\n681  2        Gm10320  0.1634424 1.298299e-02        0  1.48259469\n682  2        Fam171b  0.1633003 1.306246e-02        0  0.26127670\n683  2          Cdca4  0.1630280 1.330295e-02        0  0.39779613\n684  2         Hnrnpl  0.1614943 1.511702e-02        0  0.24555980\n685  2         Prkag2  0.1598511 1.721559e-02        0  0.31107620\n686  2          Rpl35  0.1577167 1.981484e-02        0  0.35494978\n687  2         Kansl2  0.1569738 2.091460e-02        0  0.30446483\n688  2         Akr1b3  0.1564470 2.178729e-02        0  0.95812276\n689  2           Wtap  0.1550206 2.364238e-02        0  0.24636895\n690  2        Tmem50a  0.1546371 2.413978e-02        0  0.20486681\n691  2          Btbd9  0.1544556 2.417674e-02        0  0.16390100\n692  2         Churc1  0.1542868 2.439696e-02        0  0.59272102\n693  2           Stx7  0.1539892 2.490119e-02        0  0.15631767\n694  2          Tenm1  0.1538810 2.494024e-02        0  0.58258836\n695  2           Tma7  0.1530701 2.588837e-02        0  0.17778596\n696  2          Ncam2  0.1529851 2.588837e-02        0  0.55049454\n697  2          Taf13  0.1514087 2.902505e-02        0  0.20711175\n698  2           Cd81  0.1507769 3.033349e-02        0  0.14194102\n699  2          Rpl29  0.1498115 3.279706e-02        0  0.81233384\n700  2           Ly6h  0.1495575 3.313462e-02        0  0.31738241\n701  2            Pts  0.1495086 3.313462e-02        0  0.33479576\n702  2           Emc8  0.1490372 3.414610e-02        0  1.53338622\n703  2          Ntan1  0.1487883 3.452461e-02        0  0.14776099\n704  2          Ift46  0.1486298 3.468291e-02        0  0.19087506\n705  2           Rhob  0.1486157 3.468291e-02        0  0.24365623\n706  2         Pabpc1  0.1473271 3.784038e-02        0  0.12731174\n707  2           Rpn1  0.1473114 3.784038e-02        0  0.29685829\n708  2          Cd164  0.1470494 3.807706e-02        0  0.95510002\n709  2         Ndufs3  0.1469945 3.807706e-02        0  0.19286496\n710  2         Faap20  0.1457802 4.081354e-02        0  0.40722095\n711  2         Rpp25l  0.1455308 4.091578e-02        0  0.20533516\n712  2           Ctps  0.1453310 4.139907e-02        0  0.20157322\n713  2          Gstm7  0.1441749 4.457820e-02        0  0.27771035\n714  2          Rwdd3  0.1441006 4.465475e-02        0  0.19818151\n715  2         Uqcrc1  0.1423919 5.010399e-02        0  0.17200440\n716  2        Fdxacb1  0.1422729 5.016131e-02        0  0.76452548\n717  2 X1300002E11Rik  0.1422729 5.016131e-02        0  0.96681879\n718  2           Gdi1  0.1416790 5.222127e-02        0  0.12858017\n719  2            Sms  0.1415829 5.241051e-02        0  0.16537841\n720  2          Rgs17  0.1402121 5.763811e-02        0  0.60867803\n721  2         Insig1  0.1397114 5.953162e-02        0  0.24820691\n722  2          Nop16  0.1390225 6.191587e-02        0  0.36967027\n723  2          Lrrn2  0.1388287 6.233519e-02        0  0.59551504\n724  2         Marcks  0.1387880 6.233519e-02        0  0.16704611\n725  2         Supt4a  0.1385178 6.345086e-02        0  0.10278269\n726  2          Tusc2  0.1380995 6.509740e-02        0  0.30700412\n727  2        Gm17231  0.1377162 6.657474e-02        0  0.48697134\n728  2          Gapdh  0.1372508 6.858074e-02        0  0.24637523\n729  2          Hmga1  0.1370253 6.955328e-02        0  0.88024187\n730  2           Rprm  0.1361056 7.396247e-02        0  0.17727408\n731  2           Ebf1  0.1357785 7.503423e-02        0  0.84978663\n732  2           Dad1  0.1354086 7.638457e-02        0  0.09449466\n733  2          Zbed4  0.1351606 7.713798e-02        0  0.36013105\n734  2          Cdk16  0.1351414 7.713798e-02        0  0.24855976\n735  2          Snrpe  0.1345382 7.940378e-02        0  0.15794122\n736  2          Smim7  0.1344905 7.941072e-02        0  0.16480519\n737  2        Aldh1a7  0.1341357 8.105790e-02        0  1.51622445\n738  2           Acp1  0.1336555 8.338971e-02        0  0.35086645\n739  2          Gipc1  0.1330729 8.680719e-02        0  0.15192410\n740  2      Eef1akmt2  0.1327587 8.832132e-02        0  0.11416905\n741  2       Cacna2d3  0.1325827 8.917601e-02        0  0.63717391\n742  2         Rbmxl1  0.1325433 8.917601e-02        0  0.18170969\n743  2        Gm44790  0.1321837 9.040119e-02        0  0.52945025\n744  2          Rtn4r  0.1321604 9.040119e-02        0  1.14607846\n745  2         Golga7  0.1321158 9.040119e-02        0  0.13871035\n746  2           Arf2  0.1317292 9.204989e-02        0  0.21418581\n747  2          Tnpo3  0.1312581 9.444128e-02        0  0.18232415\n748  2        Tspan13  0.1312197 9.444128e-02        0  0.12403069\n749  2          Pcbp2  0.1308219 9.665266e-02        0  0.06080126\n750  2         Mrpl42  0.1302880 9.876728e-02        0  0.11762894\n751  2          Rnf11  0.1300084 9.959059e-02        0  0.16489141\n752  2         Coro1a  0.1297722 1.009396e-01        0  0.21200976\n753  2         Asnsd1  0.1296320 1.010264e-01        0  0.59351386\n754  2        Zmynd19  0.1295676 1.010264e-01        0  0.61218867\n755  2        Ndufaf1  0.1294306 1.017604e-01        0  0.41922942\n756  2          Copz1  0.1292179 1.027661e-01        0  0.06069248\n757  2          Kcnq5  0.1289381 1.046382e-01        0  0.21905449\n758  2           Lipa  0.1288200 1.049197e-01        0  1.48389373\n759  2         Lgals1  0.1287713 1.049657e-01        0  0.77507374\n760  2           Cycs  0.1283165 1.066594e-01        0  0.19111465\n761  2         Nap1l5  0.1281061 1.077066e-01        0  0.74166992\n762  2          Ndel1  0.1279625 1.082208e-01        0  0.21950820\n763  2           Emc4  0.1277865 1.090053e-01        0  0.18197192\n764  2        Ankrd40  0.1275889 1.095669e-01        0  1.04874102\n765  2          Cetn3  0.1275594 1.095669e-01        0  0.12402363\n766  2            Ddt  0.1274969 1.097573e-01        0  0.21534417\n767  2         Ube2d1  0.1274425 1.098818e-01        0  0.05989198\n768  2          Lztr1  0.1267036 1.154428e-01        0  0.35554758\n769  2          Hdhd3  0.1262039 1.187774e-01        0  1.03765416\n770  2          Prmt2  0.1260393 1.195454e-01        0  0.15842919\n771  2           Gng2  0.1257989 1.203146e-01        0  0.05703520\n772  2         Ccdc71  0.1257984 1.203146e-01        0  0.29402403\n773  2        Sult4a1  0.1256188 1.212058e-01        0  0.19724735\n774  2         Dazap1  0.1253540 1.219067e-01        0  0.07491903\n775  2         Pagr1b  0.1251957 1.226547e-01        0  0.09772905\n776  2          Med29  0.1250203 1.230558e-01        0  0.31959522\n777  2          H2afz  0.1249464 1.230558e-01        0  0.13517372\n778  2         Pgrmc1  0.1249274 1.230558e-01        0  0.12353972\n779  2          F13a1  0.1247282 1.238593e-01        0  1.52270746\n780  2         Rpl35a  0.1246474 1.242606e-01        0  0.22888981\n781  2          Jagn1  0.1246057 1.243068e-01        0  0.16362032\n782  2           Ugp2  0.1243442 1.263772e-01        0  0.26457037\n783  2          Slit1  0.1242256 1.264621e-01        0  1.24170259\n784  2         Akr1e1  0.1241721 1.266214e-01        0  0.26869253\n785  2         Zbtb18  0.1241083 1.268779e-01        0  0.02494936\n786  2          Skp1a  0.1236075 1.292792e-01        0  0.08361736\n787  2           Alg8  0.1234078 1.297591e-01        0  0.29004950\n788  2 X4933404O12Rik  0.1232963 1.302453e-01        0  1.53093894\n789  2        Gm48551  0.1232860 1.302453e-01        0  0.65149996\n790  2         Rwdd4a  0.1230171 1.315205e-01        0  0.16272864\n791  2           Gcat  0.1227221 1.336424e-01        0  0.90784266\n792  2          Psmg3  0.1224162 1.359546e-01        0  1.45761797\n793  2        Gm16973  0.1224162 1.359546e-01        0  1.52662646\n794  2          Trib1  0.1220832 1.375425e-01        0  1.12151004\n795  2          Rrp7a  0.1220344 1.376864e-01        0  0.27596938\n796  2           Gpi1  0.1214876 1.413714e-01        0  0.13377824\n797  2          Psma3  0.1213763 1.415736e-01        0  0.03872378\n798  2        Gm36198  0.1213158 1.418467e-01        0  1.12334271\n799  2          Cyb5a  0.1212564 1.421096e-01        0  0.14287255\n800  2         Txndc9  0.1211408 1.429497e-01        0  0.03272968",
    "crumbs": [
      "Cluster evaluation",
      "Not UT cluster with LR"
    ]
  },
  {
    "objectID": "NonCT_clusters.html#cluster-510-e15.0",
    "href": "NonCT_clusters.html#cluster-510-e15.0",
    "title": "Not Uniform Transcriptomic clusters with Logistic Regression",
    "section": "Cluster 510 e15.0",
    "text": "Cluster 510 e15.0\n\n\n  OriginalCluster CellNumber COTANClusterNumber          Accuracy\n1      Cl525E15.0        826                  3 0.786585365853659\n2      Cl511E15.0        540                  2 0.916666666666667\n3      Cl184E15.0        322                  2          0.734375\n4      Cl432E13.5        536                  2  0.88785046728972\n5      Cl510E15.0        402                  2              &lt;NA&gt;\n\n\n\ncells &lt;- getClusterizationData(e15.0,clName = \"CL_original.clusters\")[[1]][getClusterizationData(e15.0,clName = \"CL_original.clusters\")[[1]] == \"510\"]\n\ncells &lt;-names(cells)\n\ncl510e15.0 &lt;-  automaticCOTANObjectCreation(raw = getRawData(e15.0)[,cells],\n                                       GEO = \"Loom\",\n                                       sequencingMethod = \"10X\",\n                                       sampleCondition = \"cl510e15.0\",\n                                       cores = 10,saveObj = T,\n                                       outDir = \"Data/MouseCortexFromLoom/NotCTSingleClusters/\",\n                                       calcCoex = T)\n\n\ncl510e15.0GDI &lt;- calculateGDI(cl510e15.0)\n\nsubsetGDIcl510e15.0 &lt;- cl510e15.0GDI[cl510e15.0GDI$sum.raw.norm &gt; 5,]\ntop.GDI.genes &lt;- rownames(subsetGDIcl510e15.0[order(subsetGDIcl510e15.0$GDI,decreasing = T),])[1:25]\n\nGDIPlot(cl510e15.0,genes = list(\"topGDI\"=top.GDI.genes),GDIIn = cl510e15.0GDI)\n\n\n\n\n\n\n\n\n\nlist.cl.CT &lt;- cellsUniformClustering(cl510e15.0, GDIThreshold = 1.43, cores = 10L,\n                         saveObj = TRUE, outDir = outDir)\n\ncl510e15.0 &lt;- addClusterization(cl510e15.0, clName = \"split\",\n                              clusters = list.cl.CT$clusters,\n                              coexDF = list.cl.CT$coex, override = TRUE)\n\ntable(list.cl.CT$clusters)\n\n\nc(mergedClusters, mergedCoexDF) %&lt;-%\n  mergeUniformCellsClusters(cl510e15.0, clusters = list.cl.CT$clusters,\n                            GDIThreshold = 1.43, batchSize = 4L, cores = 10L,\n                            saveObj = TRUE, outDir = outDir)\n\ncl510e15.0 &lt;- addClusterization(cl510e15.0, clName = \"merge\",\n                              clusters = mergedClusters,\n                              coexDF = mergedCoexDF,\n                              override = TRUE)\n\nsaveRDS(cl510e15.0,paste0(outDir,\"cl510e15.0.cotan.RDS\"))\n\ntable(str_split(names(mergedClusters),pattern = \"_\",simplify = T)[,1],mergedClusters)\n\n\ndata &lt;- getNormalizedData(cl510e15.0)\ndata &lt;- data[!rowSums(as.matrix(data)) &lt; 1,]\ndata &lt;- log(data*10000+1)\n\nrow_stdev &lt;- apply(data, 1, sd, na.rm=TRUE)\nrow_stdev &lt;- row_stdev[order(row_stdev,decreasing = T)]\n\ngenes.to.keep &lt;- c(names(row_stdev[1:100]),top.GDI.genes)\n\ndata.small &lt;- data[rownames(data) %in% genes.to.keep,]\n\n#data &lt;- t(as.matrix(data))\ndata.small &lt;- t(as.matrix(data.small))\n\n\nCOTAN_Cl.code &lt;- getClusterizationData(cl510e15.0)[[1]]\n#COTAN_Cl.code[COTAN_Cl.code == \"A549\"] &lt;- 0\n#COTAN_Cl.code[COTAN_Cl.code == \"CCL-185-IG\"] &lt;- 1\n\nCOTAN_Cl.code &lt;- as.numeric(COTAN_Cl.code)-1\n\ndata.small &lt;- cbind(data.small,COTAN_Cl.code)\ndata.small &lt;- as.data.frame(data.small)\n\n# Split the data into training and test set\nset.seed(123)\ntraining.samples &lt;- data.small[,\"COTAN_Cl.code\"] %&gt;% \n  createDataPartition(p = 0.8, list = FALSE)\ntrain.data  &lt;- data.small[training.samples, ]\ntest.data &lt;- data.small[-training.samples, ]\nhead(train.data)\n\n                                Add2     Cdh11 Flrt2    Gtdc1    Dock4     Ldb2\n10X74_4_A_1:GTCCCATGGTATCGx 0.000000  9.032079     0 0.000000 0.000000  0.00000\n10X74_4_A_1:CAATTCACCAATCGx 0.000000  0.000000     0 0.000000 9.137791 11.21714\n10X74_4_A_1:CGCGAGACCTCAAGx 0.000000 10.178981     0 0.000000 0.000000 10.87211\n10X64_3_A_1:AATGGAGATAAGGAx 0.000000  0.000000     0 0.000000 9.626479 10.31959\n10X64_3_A_1:TATACGCTAGCTCAx 9.323881  0.000000     0 9.323881 0.000000 10.42243\n10X64_3_A_1:GAGCATACTTGTCTx 9.162964  0.000000     0 0.000000 0.000000 10.26151\n                                 Lpl    Cadps  Slc35f1     Frmd5    Dlgap1\n10X74_4_A_1:GTCCCATGGTATCGx  0.00000 9.725166 0.000000  0.000000 10.418284\n10X74_4_A_1:CAATTCACCAATCGx  0.00000 9.137791 0.000000  9.137791  9.137791\n10X74_4_A_1:CGCGAGACCTCAAGx  0.00000 0.000000 0.000000 10.178981  0.000000\n10X64_3_A_1:AATGGAGATAAGGAx  0.00000 0.000000 8.933398  9.626479  8.933398\n10X64_3_A_1:TATACGCTAGCTCAx  0.00000 0.000000 9.323881  9.323881  9.323881\n10X64_3_A_1:GAGCATACTTGTCTx 10.54918 0.000000 9.162964  9.856059  0.000000\n                               Elmod1       Nin     Kcnn2    Foxp1     Alcam\n10X74_4_A_1:GTCCCATGGTATCGx 10.418284  0.000000  0.000000 10.13061  0.000000\n10X74_4_A_1:CAATTCACCAATCGx  9.137791 10.236331  9.137791  0.00000  9.137791\n10X74_4_A_1:CGCGAGACCTCAAGx  0.000000  0.000000 11.277568  0.00000  0.000000\n10X64_3_A_1:AATGGAGATAAGGAx  8.933398  9.626479 10.031922  0.00000 10.031922\n10X64_3_A_1:TATACGCTAGCTCAx 10.422434  0.000000  0.000000 10.42243  0.000000\n10X64_3_A_1:GAGCATACTTGTCTx  0.000000  0.000000 10.549180 10.26151  9.856059\n                               Plppr1     Gria1    Ncam2    Cadm2     Rnd2\n10X74_4_A_1:GTCCCATGGTATCGx  9.725166  0.000000  0.00000 0.000000 0.000000\n10X74_4_A_1:CAATTCACCAATCGx 10.236331  9.137791  0.00000 0.000000 0.000000\n10X74_4_A_1:CGCGAGACCTCAAGx 10.178981  0.000000  0.00000 0.000000 0.000000\n10X64_3_A_1:AATGGAGATAAGGAx  0.000000 10.319593  0.00000 0.000000 9.626479\n10X64_3_A_1:TATACGCTAGCTCAx  9.323881  0.000000 10.01698 0.000000 0.000000\n10X64_3_A_1:GAGCATACTTGTCTx  9.162964  0.000000  0.00000 9.162964 0.000000\n                                Tenm3    Sorbs2     Cotl1     Grip1     Slit3\n10X74_4_A_1:GTCCCATGGTATCGx  0.000000  9.032079  9.725166  9.032079 10.641421\n10X74_4_A_1:CAATTCACCAATCGx  0.000000  0.000000 10.929461  0.000000  0.000000\n10X74_4_A_1:CGCGAGACCTCAAGx  0.000000  0.000000 10.872110  0.000000 10.178981\n10X64_3_A_1:AATGGAGATAAGGAx  8.933398 10.031922 11.130505  9.626479  8.933398\n10X64_3_A_1:TATACGCTAGCTCAx 10.016984  0.000000  9.323881 10.422434 10.422434\n10X64_3_A_1:GAGCATACTTGTCTx 10.549180  0.000000  9.856059  0.000000  0.000000\n                                Pak7     Sobp     Zfpm2   Tmem178   Bhlhe22\n10X74_4_A_1:GTCCCATGGTATCGx 0.000000 9.032079  9.032079  9.725166  0.000000\n10X74_4_A_1:CAATTCACCAATCGx 9.830884 0.000000  0.000000  0.000000  9.830884\n10X74_4_A_1:CGCGAGACCTCAAGx 0.000000 0.000000 10.178981 10.178981 10.178981\n10X64_3_A_1:AATGGAGATAAGGAx 0.000000 0.000000  9.626479  0.000000  0.000000\n10X64_3_A_1:TATACGCTAGCTCAx 0.000000 0.000000  0.000000 10.016984  0.000000\n10X64_3_A_1:GAGCATACTTGTCTx 0.000000 9.162964  0.000000  9.856059 10.549180\n                               Epha3    Adgrl3     Kcnq3     Nrp1\n10X74_4_A_1:GTCCCATGGTATCGx 10.82374  9.032079  0.000000 11.42987\n10X74_4_A_1:CAATTCACCAATCGx  0.00000  0.000000  9.830884  0.00000\n10X74_4_A_1:CGCGAGACCTCAAGx  0.00000  0.000000 10.178981 11.27757\n10X64_3_A_1:AATGGAGATAAGGAx  0.00000  0.000000 10.725047  0.00000\n10X64_3_A_1:TATACGCTAGCTCAx 10.42243 10.016984  9.323881  0.00000\n10X64_3_A_1:GAGCATACTTGTCTx  0.00000  0.000000  0.000000  0.00000\n                            X3110039M20Rik     Cnih3  Dync1i1   Spock1    Gpr85\n10X74_4_A_1:GTCCCATGGTATCGx       0.000000 10.130612 9.032079 10.41828 9.032079\n10X74_4_A_1:CAATTCACCAATCGx       0.000000  0.000000 9.830884  0.00000 9.137791\n10X74_4_A_1:CGCGAGACCTCAAGx       0.000000  0.000000 0.000000  0.00000 0.000000\n10X64_3_A_1:AATGGAGATAAGGAx       0.000000  0.000000 9.626479  0.00000 8.933398\n10X64_3_A_1:TATACGCTAGCTCAx       9.323881  9.323881 0.000000 10.01698 0.000000\n10X64_3_A_1:GAGCATACTTGTCTx       0.000000  0.000000 0.000000  0.00000 9.856059\n                                Kcnq5    Sh3gl2    Lrrtm4  Gm17750 Mir124.2hg\n10X74_4_A_1:GTCCCATGGTATCGx  0.000000  0.000000  9.032079 0.000000   0.000000\n10X74_4_A_1:CAATTCACCAATCGx 10.747143  0.000000  0.000000 9.137791   0.000000\n10X74_4_A_1:CGCGAGACCTCAAGx  0.000000 10.178981 10.178981 0.000000   0.000000\n10X64_3_A_1:AATGGAGATAAGGAx  0.000000  8.933398  0.000000 0.000000   8.933398\n10X64_3_A_1:TATACGCTAGCTCAx  0.000000  9.323881  9.323881 0.000000   9.323881\n10X64_3_A_1:GAGCATACTTGTCTx  9.162964  0.000000  0.000000 0.000000   9.162964\n                                  Tox      Tbr1      Fat3    Kcnh7      Chl1\n10X74_4_A_1:GTCCCATGGTATCGx  0.000000  0.000000  0.000000 10.41828  0.000000\n10X74_4_A_1:CAATTCACCAATCGx 10.236331  0.000000  9.137791  0.00000  0.000000\n10X74_4_A_1:CGCGAGACCTCAAGx  0.000000 10.178981  0.000000  0.00000  0.000000\n10X64_3_A_1:AATGGAGATAAGGAx  8.933398  9.626479  0.000000 10.03192 10.031922\n10X64_3_A_1:TATACGCTAGCTCAx  0.000000  0.000000  0.000000 10.01698  0.000000\n10X64_3_A_1:GAGCATACTTGTCTx  0.000000  9.162964 10.261507  0.00000  9.856059\n                                 Cd47      Ntm     Ntng2      Ryr3     Neto2\n10X74_4_A_1:GTCCCATGGTATCGx 10.130612 10.64142  9.032079 10.130612  0.000000\n10X74_4_A_1:CAATTCACCAATCGx  9.137791 11.33492  0.000000  0.000000  9.830884\n10X74_4_A_1:CGCGAGACCTCAAGx  0.000000 10.17898  0.000000 10.178981  0.000000\n10X64_3_A_1:AATGGAGATAAGGAx  9.626479  0.00000  0.000000  0.000000 10.031922\n10X64_3_A_1:TATACGCTAGCTCAx  0.000000 10.42243 10.933248  0.000000 10.422434\n10X64_3_A_1:GAGCATACTTGTCTx  9.162964 11.56076 10.549180  9.162964  0.000000\n                                Ap1s2    Mdga2      Lmo4    Masp1      Snca\n10X74_4_A_1:GTCCCATGGTATCGx  9.032079 0.000000 11.596918 0.000000  9.032079\n10X74_4_A_1:CAATTCACCAATCGx  0.000000 9.137791  9.137791 9.137791  0.000000\n10X74_4_A_1:CGCGAGACCTCAAGx 10.178981 0.000000  0.000000 0.000000  0.000000\n10X64_3_A_1:AATGGAGATAAGGAx 10.031922 0.000000  8.933398 8.933398  8.933398\n10X64_3_A_1:TATACGCTAGCTCAx 10.016984 9.323881  9.323881 9.323881 10.422434\n10X64_3_A_1:GAGCATACTTGTCTx  0.000000 9.162964  9.856059 9.162964  0.000000\n                                Crym   Jakmip1  Galnt17     Enox1    Atrnl1\n10X74_4_A_1:GTCCCATGGTATCGx 9.725166  0.000000 9.032079  9.032079  0.000000\n10X74_4_A_1:CAATTCACCAATCGx 0.000000  9.137791 0.000000  0.000000  9.137791\n10X74_4_A_1:CGCGAGACCTCAAGx 0.000000 10.178981 0.000000 11.277568 10.178981\n10X64_3_A_1:AATGGAGATAAGGAx 0.000000  0.000000 0.000000  8.933398  0.000000\n10X64_3_A_1:TATACGCTAGCTCAx 0.000000  0.000000 0.000000  0.000000  0.000000\n10X64_3_A_1:GAGCATACTTGTCTx 0.000000  9.856059 9.162964  0.000000  0.000000\n                             Tmem178b   Kif21a     Cntn2     Dgki     Trim2\n10X74_4_A_1:GTCCCATGGTATCGx 10.130612 0.000000  9.725166 0.000000  0.000000\n10X74_4_A_1:CAATTCACCAATCGx  0.000000 0.000000  9.137791 9.137791  9.137791\n10X74_4_A_1:CGCGAGACCTCAAGx 10.178981 0.000000  0.000000 0.000000 10.178981\n10X64_3_A_1:AATGGAGATAAGGAx  8.933398 8.933398  8.933398 8.933398  0.000000\n10X64_3_A_1:TATACGCTAGCTCAx 10.422434 0.000000 10.016984 0.000000 10.016984\n10X64_3_A_1:GAGCATACTTGTCTx  9.162964 9.162964 10.549180 0.000000  0.000000\n                                 Neo1     Nrg1    Pcsk2   Cacna1e  Cacna2d1\n10X74_4_A_1:GTCCCATGGTATCGx  9.725166 0.000000 10.82374  9.032079  0.000000\n10X74_4_A_1:CAATTCACCAATCGx  0.000000 0.000000  0.00000  0.000000  9.137791\n10X74_4_A_1:CGCGAGACCTCAAGx 10.178981 0.000000  0.00000 10.178981  0.000000\n10X64_3_A_1:AATGGAGATAAGGAx  0.000000 8.933398  0.00000  0.000000 10.031922\n10X64_3_A_1:TATACGCTAGCTCAx  9.323881 0.000000  0.00000  0.000000  9.323881\n10X64_3_A_1:GAGCATACTTGTCTx  0.000000 0.000000  0.00000  0.000000  0.000000\n                                Rpl26     Rpl5   Hsp90b1     Sae1    Srsf1\n10X74_4_A_1:GTCCCATGGTATCGx 11.740018 10.41828  0.000000 0.000000 9.725166\n10X74_4_A_1:CAATTCACCAATCGx 10.236331 11.08361  9.137791 9.830884 0.000000\n10X74_4_A_1:CGCGAGACCTCAAGx 10.178981 10.17898 10.178981 0.000000 0.000000\n10X64_3_A_1:AATGGAGATAAGGAx  0.000000 10.03192  0.000000 0.000000 8.933398\n10X64_3_A_1:TATACGCTAGCTCAx  0.000000 10.42243 10.016984 9.323881 9.323881\n10X64_3_A_1:GAGCATACTTGTCTx  9.162964 10.54918  0.000000 9.162964 0.000000\n                               Ehmt1     Wdr33     Hmgb3    Ssrp1    Rps17\n10X74_4_A_1:GTCCCATGGTATCGx 0.000000  9.032079  0.000000 0.000000 11.59692\n10X74_4_A_1:CAATTCACCAATCGx 9.137791  0.000000  9.137791 9.137791 11.33492\n10X74_4_A_1:CGCGAGACCTCAAGx 0.000000  0.000000  0.000000 0.000000  0.00000\n10X64_3_A_1:AATGGAGATAAGGAx 8.933398  0.000000 10.319593 8.933398 11.70586\n10X64_3_A_1:TATACGCTAGCTCAx 0.000000 10.016984  0.000000 9.323881 10.93325\n10X64_3_A_1:GAGCATACTTGTCTx 0.000000  0.000000  0.000000 9.162964 11.46546\n                              Rpl13a    Rps12    Hmgn1    Rps26   Selenos\n10X74_4_A_1:GTCCCATGGTATCGx 10.82374 11.11142 10.13061 11.74002  9.725166\n10X74_4_A_1:CAATTCACCAATCGx 10.92946 11.08361 12.27318 11.62260 10.236331\n10X74_4_A_1:CGCGAGACCTCAAGx  0.00000 11.27757 10.87211 10.17898  0.000000\n10X64_3_A_1:AATGGAGATAAGGAx 11.41818 11.13051 10.54273 11.33117  9.626479\n10X64_3_A_1:TATACGCTAGCTCAx 11.26972 11.26972 10.71011 11.11557 10.016984\n10X64_3_A_1:GAGCATACTTGTCTx 11.24231 10.26151 10.77232 11.36010  0.000000\n                              Tspan5    Rps25     Rps28     Pomp    Thoc2\n10X74_4_A_1:GTCCCATGGTATCGx 0.000000 10.82374 10.641421 10.64142 9.032079\n10X74_4_A_1:CAATTCACCAATCGx 9.830884 11.33492  9.830884 10.74714 0.000000\n10X74_4_A_1:CGCGAGACCTCAAGx 0.000000 10.17898 10.178981  0.00000 0.000000\n10X64_3_A_1:AATGGAGATAAGGAx 9.626479 11.23586 10.879195 10.72505 0.000000\n10X64_3_A_1:TATACGCTAGCTCAx 0.000000 10.42243 11.403245 10.42243 0.000000\n10X64_3_A_1:GAGCATACTTGTCTx 0.000000 11.36010 10.772318 10.54918 9.162964\n                              Phf21a    Sptan1    Phf20    Maged2     Taok3\n10X74_4_A_1:GTCCCATGGTATCGx 9.725166  0.000000 9.725166 10.641421 10.130612\n10X74_4_A_1:CAATTCACCAATCGx 0.000000  0.000000 0.000000  0.000000  0.000000\n10X74_4_A_1:CGCGAGACCTCAAGx 0.000000  0.000000 0.000000 10.178981 10.178981\n10X64_3_A_1:AATGGAGATAAGGAx 8.933398 10.031922 8.933398  0.000000  8.933398\n10X64_3_A_1:TATACGCTAGCTCAx 0.000000  9.323881 0.000000  0.000000  0.000000\n10X64_3_A_1:GAGCATACTTGTCTx 0.000000  9.856059 0.000000  9.856059  0.000000\n                               Atp5e    Rpl35a      Pcm1   Cep170    Tmem57\n10X74_4_A_1:GTCCCATGGTATCGx 10.64142 10.418284  0.000000 9.725166 10.130612\n10X74_4_A_1:CAATTCACCAATCGx 10.92946  9.830884  0.000000 9.137791  9.137791\n10X74_4_A_1:CGCGAGACCTCAAGx  0.00000  0.000000 10.178981 0.000000 10.872110\n10X64_3_A_1:AATGGAGATAAGGAx 10.54273  9.626479  8.933398 0.000000  8.933398\n10X64_3_A_1:TATACGCTAGCTCAx 10.42243  0.000000  0.000000 9.323881  9.323881\n10X64_3_A_1:GAGCATACTTGTCTx 10.54918  0.000000 10.261507 9.162964  0.000000\n                                Foxn3     Xist    Hmgcs1     Eif1b   Smarcc2\n10X74_4_A_1:GTCCCATGGTATCGx 10.641421 11.22920  0.000000  9.725166  0.000000\n10X74_4_A_1:CAATTCACCAATCGx  0.000000 10.74714  9.137791  9.830884  0.000000\n10X74_4_A_1:CGCGAGACCTCAAGx  0.000000  0.00000  0.000000 10.178981 10.178981\n10X64_3_A_1:AATGGAGATAAGGAx  9.626479 10.87919 10.319593  9.626479  8.933398\n10X64_3_A_1:TATACGCTAGCTCAx 10.016984 10.42243  0.000000 10.016984  0.000000\n10X64_3_A_1:GAGCATACTTGTCTx  9.162964  0.00000 10.261507  9.162964  0.000000\n                                  Ndn     Plcb1    Clasp2   Tnrc6c    Mapk3\n10X74_4_A_1:GTCCCATGGTATCGx  9.725166  9.032079  9.725166 9.725166 10.13061\n10X74_4_A_1:CAATTCACCAATCGx  9.137791 10.236331  0.000000 9.137791  0.00000\n10X74_4_A_1:CGCGAGACCTCAAGx  0.000000 10.178981  0.000000 0.000000 10.87211\n10X64_3_A_1:AATGGAGATAAGGAx 11.012724  0.000000  9.626479 0.000000  0.00000\n10X64_3_A_1:TATACGCTAGCTCAx 10.016984  9.323881 10.710109 0.000000 10.01698\n10X64_3_A_1:GAGCATACTTGTCTx  0.000000  0.000000  9.162964 0.000000  0.00000\n                             Dync1h1   Ndfip1 COTAN_Cl.code\n10X74_4_A_1:GTCCCATGGTATCGx 9.725166 9.032079             1\n10X74_4_A_1:CAATTCACCAATCGx 0.000000 9.830884             1\n10X74_4_A_1:CGCGAGACCTCAAGx 0.000000 0.000000             1\n10X64_3_A_1:AATGGAGATAAGGAx 0.000000 0.000000             0\n10X64_3_A_1:TATACGCTAGCTCAx 0.000000 0.000000             1\n10X64_3_A_1:GAGCATACTTGTCTx 0.000000 0.000000             0\n\n\n\n# Fit the model\nmodel &lt;- glm( COTAN_Cl.code ~., data = train.data, family = binomial,control = list(maxit = 50))\n# Summarize the model\nsummary(model)\n\n\nCall:\nglm(formula = COTAN_Cl.code ~ ., family = binomial, data = train.data, \n    control = list(maxit = 50))\n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)     1.648e+01  2.538e+06       0        1\nAdd2            3.406e-01  6.709e+04       0        1\nCdh11           4.435e-01  8.331e+04       0        1\nFlrt2          -1.368e+00  6.504e+04       0        1\nGtdc1           5.586e-01  7.498e+04       0        1\nDock4          -7.226e-01  5.558e+04       0        1\nLdb2           -1.161e+00  9.863e+04       0        1\nLpl            -1.816e+00  7.031e+04       0        1\nCadps          -1.277e-01  7.767e+04       0        1\nSlc35f1         9.495e-01  1.162e+05       0        1\nFrmd5           5.888e-02  6.500e+04       0        1\nDlgap1          5.982e-01  9.289e+04       0        1\nElmod1         -1.618e+00  9.177e+04       0        1\nNin             3.962e-01  5.751e+04       0        1\nKcnn2           3.354e-01  5.583e+04       0        1\nFoxp1           1.078e-01  5.648e+04       0        1\nAlcam          -7.891e-01  7.024e+04       0        1\nPlppr1          9.337e-01  9.847e+04       0        1\nGria1          -6.976e-01  1.222e+05       0        1\nNcam2           3.917e-01  1.416e+05       0        1\nCadm2          -7.945e-01  5.926e+04       0        1\nRnd2           -6.843e-01  1.052e+05       0        1\nTenm3           1.531e+00  7.112e+04       0        1\nSorbs2          5.778e-01  7.114e+04       0        1\nCotl1          -8.660e-01  1.551e+05       0        1\nGrip1           1.188e+00  6.948e+04       0        1\nSlit3          -2.722e-01  8.231e+04       0        1\nPak7           -6.810e-01  8.440e+04       0        1\nSobp           -1.553e+00  1.008e+05       0        1\nZfpm2          -5.977e-01  1.242e+05       0        1\nTmem178         6.956e-01  7.115e+04       0        1\nBhlhe22         7.112e-01  9.282e+04       0        1\nEpha3          -1.113e+00  6.664e+04       0        1\nAdgrl3          6.038e-01  9.405e+04       0        1\nKcnq3           5.476e-01  1.043e+05       0        1\nNrp1            5.709e-01  8.500e+04       0        1\nX3110039M20Rik  7.328e-01  9.668e+04       0        1\nCnih3           4.598e-01  9.917e+04       0        1\nDync1i1         8.848e-02  1.291e+05       0        1\nSpock1          1.589e+00  1.089e+05       0        1\nGpr85           1.843e+00  9.086e+04       0        1\nKcnq5          -6.448e-01  6.210e+04       0        1\nSh3gl2         -5.639e-01  6.462e+04       0        1\nLrrtm4         -3.230e-01  8.841e+04       0        1\nGm17750         9.768e-01  1.322e+05       0        1\nMir124.2hg      5.690e-01  5.385e+04       0        1\nTox             1.579e+00  7.139e+04       0        1\nTbr1           -2.199e+00  9.993e+04       0        1\nFat3           -2.329e+00  7.544e+04       0        1\nKcnh7          -1.442e+00  8.955e+04       0        1\nChl1           -8.474e-01  6.276e+04       0        1\nCd47            2.609e-01  1.189e+05       0        1\nNtm             1.697e+00  1.032e+05       0        1\nNtng2           1.210e+00  9.358e+04       0        1\nRyr3            7.297e-01  7.496e+04       0        1\nNeto2          -1.247e-01  8.568e+04       0        1\nAp1s2          -8.177e-01  7.710e+04       0        1\nMdga2          -3.161e-01  7.195e+04       0        1\nLmo4            9.815e-01  4.587e+04       0        1\nMasp1           1.236e+00  9.610e+04       0        1\nSnca            8.278e-01  1.062e+05       0        1\nCrym           -3.996e-01  8.715e+04       0        1\nJakmip1         1.617e+00  1.182e+05       0        1\nGalnt17        -1.636e+00  8.228e+04       0        1\nEnox1          -6.653e-02  1.498e+05       0        1\nAtrnl1          5.075e-01  6.420e+04       0        1\nTmem178b       -1.211e+00  6.437e+04       0        1\nKif21a         -1.183e+00  8.275e+04       0        1\nCntn2          -6.145e-01  9.840e+04       0        1\nDgki            8.343e-01  6.970e+04       0        1\nTrim2           2.193e-01  1.035e+05       0        1\nNeo1            4.175e-01  9.042e+04       0        1\nNrg1            9.990e-01  8.920e+04       0        1\nPcsk2           1.356e+00  1.130e+05       0        1\nCacna1e        -3.779e-01  9.071e+04       0        1\nCacna2d1        7.626e-01  9.022e+04       0        1\nRpl26           3.607e+00  1.616e+05       0        1\nRpl5            4.595e-01  1.501e+05       0        1\nHsp90b1         9.838e-02  7.218e+04       0        1\nSae1            8.304e-01  9.806e+04       0        1\nSrsf1           8.954e-01  7.093e+04       0        1\nEhmt1          -5.895e-01  8.763e+04       0        1\nWdr33          -4.389e-02  6.339e+04       0        1\nHmgb3          -1.176e+00  9.332e+04       0        1\nSsrp1          -5.582e-01  9.471e+04       0        1\nRps17           4.539e+00  3.189e+05       0        1\nRpl13a         -4.667e+00  4.786e+05       0        1\nRps12          -1.058e+00  2.749e+05       0        1\nHmgn1           1.426e+00  2.199e+05       0        1\nRps26           6.857e-01  4.161e+05       0        1\nSelenos         6.071e-01  8.616e+04       0        1\nTspan5          1.076e+00  6.674e+04       0        1\nRps25          -1.283e+00  2.143e+05       0        1\nRps28          -2.860e+00  1.809e+05       0        1\nPomp           -4.704e-01  1.433e+05       0        1\nThoc2          -8.902e-01  7.183e+04       0        1\nPhf21a          1.319e+00  6.287e+04       0        1\nSptan1         -4.865e-01  7.307e+04       0        1\nPhf20          -4.587e-01  7.967e+04       0        1\nMaged2         -2.851e-01  6.644e+04       0        1\nTaok3          -6.431e-01  5.279e+04       0        1\nAtp5e          -1.980e+00  1.947e+05       0        1\nRpl35a          3.354e+00  1.172e+05       0        1\nPcm1            2.279e-01  4.695e+04       0        1\nCep170         -8.238e-01  1.058e+05       0        1\nTmem57          2.726e-01  1.193e+05       0        1\nFoxn3           7.669e-02  7.168e+04       0        1\nXist           -6.332e-01  7.549e+04       0        1\nHmgcs1         -1.033e+00  7.508e+04       0        1\nEif1b          -1.129e+00  6.464e+04       0        1\nSmarcc2         1.391e+00  8.941e+04       0        1\nNdn            -8.821e-01  6.755e+04       0        1\nPlcb1          -2.334e-01  6.322e+04       0        1\nClasp2          7.266e-01  1.107e+05       0        1\nTnrc6c          4.524e-01  9.929e+04       0        1\nMapk3          -2.477e-01  9.378e+04       0        1\nDync1h1         3.548e-01  7.543e+04       0        1\nNdfip1          9.539e-01  7.695e+04       0        1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 4.4189e+02  on 321  degrees of freedom\nResidual deviance: 3.7099e-10  on 204  degrees of freedom\nAIC: 236\n\nNumber of Fisher Scoring iterations: 28\n\n# Make predictions\nprobabilities &lt;- model %&gt;% predict(test.data, type = \"response\")\npredicted.classes &lt;- ifelse(probabilities &gt; 0.5, \"1\", \"0\")\n# Model accuracy\naccuracy &lt;- mean(predicted.classes == test.data$COTAN_Cl.code)\nresult.df[nrow(result.df),\"Accuracy\"] &lt;- accuracy\n\naccuracy\n\n[1] 0.825\n\n\nSo also in this case a logistic regression confirm the difference in cell population detected by COTAN.\n\ncl510e15.0ClsMarkers &lt;- findClustersMarkers(cl510e15.0,n = 200,adjustmentMethod = \"BH\")\ncl510e15.0ClsMarkers\n\n    CL           Gene        DEA      adjPVal IsMarker   logFoldCh\n1    1          Rpl26 -0.7828372 2.011317e-51        0 -1.57515134\n2    1         Rpl35a -0.6930519 4.191530e-40        0 -1.24898088\n3    1          Uba52 -0.5225985 4.522799e-22        0 -0.94946200\n4    1           Nrp1 -0.4696725 1.446485e-17        0 -1.10517320\n5    1           Hcn1 -0.3625100 6.476616e-10        0 -1.08301395\n6    1         Pantr1 -0.3607812 7.320065e-10        0 -0.80322987\n7    1          Gstp1 -0.3518125 2.167905e-09        0 -0.62139975\n8    1           Btg1 -0.3459701 4.544828e-09        0 -0.62262518\n9    1          Fgfr2 -0.3257636 5.790833e-08        0 -0.73656272\n10   1        Gm48091 -0.3208919 9.683038e-08        0 -0.80366280\n11   1          Pcdh8 -0.3189523 1.176346e-07        0 -0.65834688\n12   1          Nr4a2 -0.3125880 2.406869e-07        0 -1.55914852\n13   1           Ryr3 -0.2861349 5.715567e-06        0 -0.38400773\n14   1           Glo1 -0.2772202 1.475510e-05        0 -0.32896127\n15   1         Shisa9 -0.2756852 1.685852e-05        0 -1.29465903\n16   1            Fos -0.2713397 2.649096e-05        0 -0.81491072\n17   1          Cd200 -0.2702092 2.791450e-05        0 -0.41826689\n18   1           Msra -0.2698640 2.791450e-05        0 -0.37642731\n19   1           Xist -0.2645742 4.685246e-05        0 -0.21820655\n20   1          Wasf1 -0.2640100 4.823870e-05        0 -0.35028819\n21   1           Crym -0.2587839 8.173607e-05        0 -0.50575693\n22   1         Gabra2 -0.2577884 8.637252e-05        0 -0.55195273\n23   1          Btbd9 -0.2530640 1.244468e-04        0 -0.21456202\n24   1          Unc5d -0.2472700 2.139872e-04        0 -0.99447339\n25   1          Ssbp2 -0.2449376 2.564976e-04        0 -0.43966196\n26   1         Zfp608 -0.2419568 3.251422e-04        0 -0.49937452\n27   1            Erh -0.2413687 3.378497e-04        0 -0.34071185\n28   1           Raly -0.2408558 3.485106e-04        0 -0.48469271\n29   1        Slc16a2 -0.2403499 3.593711e-04        0 -0.32388771\n30   1          Stmn4 -0.2401442 3.596777e-04        0 -0.30591176\n31   1           Dlg2 -0.2396385 3.626002e-04        0 -0.33412509\n32   1         Klhl24 -0.2394935 3.626002e-04        0 -0.26915813\n33   1            Sla -0.2355136 5.266787e-04        0 -0.40947014\n34   1     St6galnac5 -0.2353702 5.266787e-04        0 -0.79039470\n35   1          Fgf13 -0.2347569 5.310035e-04        0 -0.29957368\n36   1         Dlgap2 -0.2340580 5.592429e-04        0 -0.58420474\n37   1        Lamtor3 -0.2328010 6.119982e-04        0 -0.45660421\n38   1           Ldb2 -0.2299657 7.805662e-04        0 -0.18277773\n39   1         Rgs7bp -0.2289057 8.382196e-04        0 -0.46136373\n40   1          Cdk14 -0.2275515 9.262468e-04        0 -0.60195604\n41   1           Rgs4 -0.2270250 9.598547e-04        0 -1.05661205\n42   1           Mycl -0.2262799 1.003577e-03        0 -0.25517353\n43   1           Pigt -0.2239292 1.216417e-03        0 -0.38317223\n44   1          Tnnt1 -0.2232951 1.265235e-03        0 -1.51510847\n45   1         Sh3rf3 -0.2223092 1.360169e-03        0 -0.71212302\n46   1        Fam131c -0.2195790 1.708244e-03        0 -0.50043032\n47   1        Gm17750 -0.2153237 2.362506e-03        0 -0.37451733\n48   1        Zfp385b -0.2152096 2.362506e-03        0 -1.01914318\n49   1         Spock1 -0.2150999 2.362506e-03        0 -0.27243287\n50   1        Gm44790 -0.2138004 2.626331e-03        0 -0.46109281\n51   1           Eml1 -0.2133412 2.705861e-03        0 -0.49580939\n52   1          Ntrk3 -0.2113750 3.190837e-03        0 -0.29238439\n53   1         Tmeff2 -0.2098536 3.572255e-03        0 -0.63366960\n54   1         Lingo1 -0.2092392 3.690063e-03        0 -0.32363975\n55   1           Rgs7 -0.2088403 3.781385e-03        0 -0.50748659\n56   1           Ncdn -0.2085916 3.824173e-03        0 -0.33167474\n57   1          Magi1 -0.2082854 3.846968e-03        0 -0.55544260\n58   1            Cpq -0.2071260 4.215064e-03        0 -0.45147205\n59   1         Ube2e3 -0.2068274 4.239927e-03        0 -0.18538121\n60   1        Dync1i1 -0.2055262 4.702362e-03        0 -0.28001247\n61   1         Elmod1 -0.2020201 6.091546e-03        0 -0.33924307\n62   1        Gm40418 -0.2019637 6.091546e-03        0 -1.00196057\n63   1          Stk25 -0.2015629 6.244668e-03        0 -0.25645309\n64   1         Rnf150 -0.2012348 6.362192e-03        0 -0.39764524\n65   1           Vav3 -0.2006221 6.580448e-03        0 -0.63535035\n66   1           Nrp2 -0.2000322 6.856061e-03        0 -0.84879141\n67   1          Glra2 -0.1995343 7.051469e-03        0 -0.31248709\n68   1            Ntm -0.1994763 7.051469e-03        0 -0.11491730\n69   1          Lyrm9 -0.1993835 7.051469e-03        0 -1.04917745\n70   1          Chsy3 -0.1981976 7.464014e-03        0 -0.54723834\n71   1          Afap1 -0.1978723 7.606681e-03        0 -0.72467466\n72   1          Insm1 -0.1976870 7.661707e-03        0 -0.67474095\n73   1            Jun -0.1971034 7.979780e-03        0 -0.39742424\n74   1           Nrg1 -0.1966621 8.212237e-03        0 -0.36396237\n75   1         Camk2b -0.1965394 8.229488e-03        0 -0.37424981\n76   1         Pggt1b -0.1958995 8.542057e-03        0 -0.50473799\n77   1         Klhdc4 -0.1955147 8.613471e-03        0 -0.61250522\n78   1          Efna5 -0.1945192 9.211540e-03        0 -0.45203288\n79   1         Dlgap1 -0.1942208 9.369765e-03        0 -0.42564188\n80   1         Dynll2 -0.1916262 1.125377e-02        0 -0.16343170\n81   1           Pgk1 -0.1912120 1.139226e-02        0 -0.36364730\n82   1        Bloc1s1 -0.1912071 1.139226e-02        0 -0.33457090\n83   1          Nr4a3 -0.1909022 1.159484e-02        0 -0.38224660\n84   1        Hnrnpa1 -0.1906361 1.175860e-02        0 -0.22896156\n85   1          Atp5l -0.1905543 1.175860e-02        0 -0.22804386\n86   1          Ccnd2 -0.1891045 1.300531e-02        0 -0.25660314\n87   1          Nr2f2 -0.1878990 1.391752e-02        0 -0.98414448\n88   1         Zbtb16 -0.1878680 1.391752e-02        0 -0.79304337\n89   1         Gm2164 -0.1875012 1.423682e-02        0 -0.85319962\n90   1        Snrnp48 -0.1869760 1.447967e-02        0 -0.23402910\n91   1           Prcp -0.1869589 1.447967e-02        0 -0.51523122\n92   1         Csrnp3 -0.1860576 1.535810e-02        0 -0.27861526\n93   1          Opcml -0.1844872 1.695596e-02        0 -0.37422735\n94   1         Kcnk10 -0.1844542 1.695596e-02        0 -0.29067023\n95   1           Chp1 -0.1844447 1.695596e-02        0 -0.26331136\n96   1         Asnsd1 -0.1844084 1.695596e-02        0 -0.45835879\n97   1            Psd -0.1840836 1.707599e-02        0 -0.49864314\n98   1         Igfbp3 -0.1836744 1.721283e-02        0 -0.49410243\n99   1          Ptprr -0.1835620 1.724581e-02        0 -0.84088273\n100  1          Epha6 -0.1834079 1.724581e-02        0 -1.26382484\n101  1        Gm30382 -0.1832747 1.724581e-02        0 -0.62577434\n102  1          Cntn1 -0.1826731 1.797432e-02        0 -0.38961775\n103  1          Mief1 -0.1818800 1.901371e-02        0 -0.41984198\n104  1         Frmd4b -0.1814745 1.951188e-02        0 -0.16555279\n105  1          Snx10 -0.1813731 1.955473e-02        0 -0.31792690\n106  1          Asic2 -0.1804126 2.071510e-02        0 -0.25466896\n107  1          Tsnax -0.1798048 2.159122e-02        0 -0.16361773\n108  1          Ckmt1 -0.1783983 2.379440e-02        0 -0.36194957\n109  1           Gps1 -0.1779668 2.419508e-02        0 -0.48103220\n110  1          Mast2 -0.1767480 2.618504e-02        0 -0.22886266\n111  1        B3galt2 -0.1758061 2.762310e-02        0 -0.37387360\n112  1          Glp1r -0.1749936 2.876891e-02        0 -1.29813641\n113  1           Rgs6 -0.1738753 3.081771e-02        0 -0.27342864\n114  1          Cnih3 -0.1737084 3.095944e-02        0 -0.19392913\n115  1         Dpysl4 -0.1735207 3.095944e-02        0 -0.34080199\n116  1           Lix1 -0.1734329 3.095944e-02        0 -0.24379550\n117  1         Cacnb4 -0.1732409 3.121252e-02        0 -0.32715324\n118  1           Cdh2 -0.1730778 3.144165e-02        0 -0.15879849\n119  1         Pou3f2 -0.1727867 3.184569e-02        0 -1.28397209\n120  1           Pak3 -0.1722478 3.265449e-02        0 -0.22725958\n121  1        Tmem108 -0.1720824 3.290242e-02        0 -0.10052886\n122  1         Adgrl3 -0.1714752 3.414042e-02        0 -0.23838521\n123  1           Pak7 -0.1709451 3.496912e-02        0 -0.21089453\n124  1           Fut9 -0.1702284 3.669697e-02        0 -0.26154758\n125  1         Trim36 -0.1699043 3.724013e-02        0 -0.67610277\n126  1          Rtl8a -0.1695151 3.814557e-02        0 -0.21199428\n127  1         Kcnmb4 -0.1692925 3.859813e-02        0 -0.34607968\n128  1           Lmo7 -0.1686382 3.977234e-02        0 -0.35459204\n129  1           Rpgr -0.1686382 3.977234e-02        0 -0.37719879\n130  1          Bcl6b -0.1684958 4.001042e-02        0 -0.55285610\n131  1           Sdhc -0.1678811 4.147618e-02        0 -0.15411969\n132  1         Snap25 -0.1677466 4.170156e-02        0 -0.25946972\n133  1         Gm9885 -0.1672299 4.310664e-02        0 -0.40777547\n134  1          Rint1 -0.1667188 4.434647e-02        0 -0.31311835\n135  1          Sept6 -0.1664469 4.503242e-02        0 -0.28471311\n136  1           Oma1 -0.1660209 4.604271e-02        0 -0.66865123\n137  1        Slc35f1 -0.1658674 4.635754e-02        0 -0.24250790\n138  1          Fosl2 -0.1654211 4.739498e-02        0 -0.47513449\n139  1           Clpb -0.1642537 5.075223e-02        0 -0.35225590\n140  1        Gm10260 -0.1639260 5.173832e-02        0 -0.23336764\n141  1           Mea1 -0.1632038 5.380129e-02        0 -0.73359774\n142  1           Cdh8 -0.1625672 5.564624e-02        0 -0.58109438\n143  1         Pou3f3 -0.1625571 5.564624e-02        0 -0.52217593\n144  1  C030034I22Rik -0.1622279 5.656407e-02        0 -0.56113965\n145  1          Crtc1 -0.1620476 5.677546e-02        0 -0.32146464\n146  1         Ctnnd2 -0.1612790 5.946096e-02        0 -0.17132854\n147  1         Commd1 -0.1609966 6.041451e-02        0 -0.23330268\n148  1          Dusp8 -0.1609135 6.046665e-02        0 -0.23123799\n149  1           Nol4 -0.1608187 6.046665e-02        0 -0.15319369\n150  1            Dap -0.1606727 6.074169e-02        0 -0.23228463\n151  1          Cdk19 -0.1606443 6.074169e-02        0 -0.32241950\n152  1         Zfp277 -0.1602165 6.234689e-02        0 -0.18222792\n153  1        Fam135b -0.1601354 6.246332e-02        0 -0.49787642\n154  1         Diaph3 -0.1597107 6.409686e-02        0 -0.69315519\n155  1        Cep57l1 -0.1592159 6.584269e-02        0 -0.50764025\n156  1          Snx21 -0.1589904 6.663172e-02        0 -0.43319094\n157  1          Ntrk2 -0.1584678 6.882997e-02        0 -0.24868556\n158  1         Ahcyl2 -0.1579957 7.073713e-02        0 -0.39857716\n159  1          Mtus1 -0.1579422 7.073713e-02        0 -0.32594782\n160  1  D130020L05Rik -0.1573145 7.314570e-02        0 -1.54913697\n161  1         Magee2 -0.1572268 7.314570e-02        0 -0.47897240\n162  1           Paxx -0.1570792 7.355087e-02        0 -0.15289852\n163  1           Dhfr -0.1569798 7.378742e-02        0 -0.95228582\n164  1         Zfp704 -0.1567213 7.430428e-02        0 -0.25996609\n165  1        Gm30054 -0.1563446 7.597411e-02        0 -1.02783611\n166  1         Snhg10 -0.1562388 7.611329e-02        0 -0.78649630\n167  1         Gtf2h3 -0.1561812 7.611329e-02        0 -0.34844018\n168  1          Shtn1 -0.1561629 7.611329e-02        0 -0.14371495\n169  1           Hax1 -0.1556525 7.825902e-02        0 -0.19926078\n170  1        Stxbp5l -0.1554698 7.896308e-02        0 -0.71053653\n171  1 X4933404O12Rik -0.1554074 7.902454e-02        0 -0.60493265\n172  1          Igsf3 -0.1552286 7.944085e-02        0 -0.26474386\n173  1          Rell2 -0.1551654 7.950903e-02        0 -0.27945422\n174  1          Tfdp1 -0.1550337 7.994944e-02        0 -0.20307052\n175  1         Tamm41 -0.1545774 8.174804e-02        0 -0.39566047\n176  1          Crlf1 -0.1544599 8.174804e-02        0 -0.64715042\n177  1           Fut8 -0.1544555 8.174804e-02        0 -0.43124548\n178  1        Gm21949 -0.1540545 8.331436e-02        0 -0.53590643\n179  1        Zkscan3 -0.1539431 8.350519e-02        0 -0.24397057\n180  1          Nr4a1 -0.1536578 8.446986e-02        0 -0.71999816\n181  1          Spast -0.1536260 8.446986e-02        0 -0.22873782\n182  1           Itpa -0.1525271 8.861084e-02        0 -0.13673904\n183  1        Gm38948 -0.1513361 9.502504e-02        0 -0.37127192\n184  1          Rusc2 -0.1510752 9.622233e-02        0 -0.25936942\n185  1          Ypel1 -0.1510476 9.622233e-02        0 -0.17766308\n186  1        Gpr137c -0.1510053 9.622233e-02        0 -0.23583596\n187  1           Tcf4 -0.1503701 9.911297e-02        0 -0.32236888\n188  1           Rgl1 -0.1503151 9.916711e-02        0 -0.56341013\n189  1          Eif4b -0.1501534 9.963563e-02        0 -0.15901624\n190  1         Dhrs13 -0.1494282 1.029138e-01        0 -0.23594266\n191  1           Sik1 -0.1492590 1.034034e-01        0 -0.63223288\n192  1         Pou3f1 -0.1491083 1.034034e-01        0 -0.54571045\n193  1        Rangap1 -0.1490887 1.034034e-01        0 -0.19146620\n194  1        Gm29478 -0.1490737 1.034034e-01        0 -1.59813122\n195  1         Dbpht2 -0.1490737 1.034034e-01        0 -1.58991377\n196  1          Dmac2 -0.1487370 1.039219e-01        0 -0.47524745\n197  1          Actr6 -0.1484514 1.045365e-01        0 -0.27628804\n198  1          Nup43 -0.1483965 1.045365e-01        0 -0.36551302\n199  1           Pja1 -0.1483256 1.045365e-01        0 -0.04782317\n200  1            Nln -0.1482548 1.045365e-01        0 -0.56574871\n201  1           Rnd2  0.4411526 2.278116e-15        0  0.71602945\n202  1           Fat3  0.3920370 7.953201e-12        0  0.49746970\n203  1        Akirin2  0.3578270 1.004909e-09        0  0.44708226\n204  1       Tmem176b  0.3299727 3.776860e-08        0  0.52656169\n205  1       Tpm3.rs7  0.3294885 3.776860e-08        0  0.49128964\n206  1         Necab3  0.3225718 8.270157e-08        0  0.54255970\n207  1          Alcam  0.3153783 1.771304e-07        0  0.43922226\n208  1           Tbr1  0.2873029 5.225192e-06        0  0.34863308\n209  1         Klhl29  0.2787360 1.295524e-05        0  0.50900417\n210  1          Hmgb3  0.2699098 2.791450e-05        0  0.25803900\n211  1           Airn  0.2668793 3.758144e-05        0  1.23149612\n212  1         Eef1a2  0.2585800 8.173607e-05        0  0.88080996\n213  1            Me1  0.2572081 8.928822e-05        0  0.63650782\n214  1           Mgll  0.2564800 9.383370e-05        0  0.45332306\n215  1        Zfp804a  0.2538858 1.188432e-04        0  0.46575236\n216  1        Slc35f4  0.2537466 1.188432e-04        0  0.80570310\n217  1          Kcnh7  0.2523974 1.301585e-04        0  0.44733664\n218  1          Glp2r  0.2471551 2.139872e-04        0  0.35983331\n219  1         Btbd11  0.2465342 2.228146e-04        0  0.59427668\n220  1        Tmem178  0.2445722 2.603409e-04        0  0.15104023\n221  1          Kcnt2  0.2432026 2.928075e-04        0  0.45415418\n222  1         Ccser1  0.2395868 3.626002e-04        0  0.21896740\n223  1          Pcdh9  0.2349183 5.310035e-04        0  0.21511597\n224  1          Nxph4  0.2348642 5.310035e-04        0  0.46231241\n225  1          Pcbp1  0.2330561 6.067328e-04        0  0.24616696\n226  1          Wnt7b  0.2320749 6.464241e-04        0  0.32823485\n227  1 X4833418N02Rik  0.2290800 8.369810e-04        0  0.61793352\n228  1          Ddah1  0.2279151 9.079579e-04        0  0.45550085\n229  1           Vcan  0.2262567 1.003577e-03        0  0.46188461\n230  1          Pttg1  0.2241669 1.206013e-03        0  0.81633983\n231  1         Eif4a1  0.2232230 1.265235e-03        0  0.45728645\n232  1          Lypd6  0.2201879 1.635603e-03        0  0.44198683\n233  1          Slit1  0.2192018 1.746423e-03        0  0.42018111\n234  1           Ngfr  0.2166520 2.179474e-03        0  0.48224168\n235  1        Gadd45g  0.2159379 2.297375e-03        0  0.26941855\n236  1            Dcc  0.2151425 2.362506e-03        0  0.30618565\n237  1          Dact1  0.2106093 3.377829e-03        0  0.31138312\n238  1           Nfia  0.2093243 3.690063e-03        0  0.20437947\n239  1          Nhlh1  0.2083884 3.846968e-03        0  1.08318362\n240  1          Rcor2  0.2070105 4.215064e-03        0  0.32594178\n241  1           Cnr1  0.2048162 4.952106e-03        0  0.22114131\n242  1           Nkd1  0.2036633 5.418059e-03        0  0.31376172\n243  1         Fam69a  0.2025172 5.921902e-03        0  0.30172294\n244  1          Epha3  0.2009170 6.476581e-03        0  0.21276778\n245  1          Dscam  0.1990018 7.180153e-03        0  0.23084660\n246  1           Ttc7  0.1989623 7.180153e-03        0  0.87499936\n247  1           Aff2  0.1985532 7.368447e-03        0  0.27208450\n248  1       Adamts18  0.1984406 7.375169e-03        0  0.32523533\n249  1          Ncor1  0.1964277 8.239653e-03        0  0.25074715\n250  1          Rab39  0.1955715 8.613471e-03        0  0.32821824\n251  1           Sgcz  0.1955481 8.613471e-03        0  0.79823063\n252  1          Lcorl  0.1951628 8.800384e-03        0  0.20412586\n253  1         Higd1a  0.1931756 1.013621e-02        0  0.13053823\n254  1          Sfxn1  0.1927318 1.043388e-02        0  0.23611785\n255  1          Rab3c  0.1920901 1.091559e-02        0  0.22163251\n256  1           Aff3  0.1913457 1.139226e-02        0  0.16007305\n257  1            Lpp  0.1892065 1.300531e-02        0  0.36001600\n258  1          Smap1  0.1890505 1.300531e-02        0  0.24879350\n259  1          Epha4  0.1878986 1.391752e-02        0  0.18840904\n260  1        Tmem50b  0.1878777 1.391752e-02        0  0.34579403\n261  1          Tnks2  0.1873925 1.426565e-02        0  0.25954419\n262  1           Vat1  0.1870031 1.447967e-02        0  0.34643001\n263  1          Fabp7  0.1861153 1.535810e-02        0  0.30531366\n264  1         Rbfox3  0.1858844 1.547126e-02        0  0.15332347\n265  1           Neo1  0.1842369 1.704745e-02        0  0.17904854\n266  1         Hbb.bt  0.1841828 1.704745e-02        0  0.61889653\n267  1           Hypk  0.1838950 1.721283e-02        0  0.22945778\n268  1          Stk40  0.1837853 1.721283e-02        0  0.44241082\n269  1           Rdh5  0.1837015 1.721283e-02        0  0.28654515\n270  1          Stk39  0.1834437 1.724581e-02        0  0.30722544\n271  1           Vrk2  0.1833025 1.724581e-02        0  0.32600848\n272  1          Sap30  0.1810603 1.989051e-02        0  0.16339897\n273  1          Cox5b  0.1810087 1.989051e-02        0  0.14959702\n274  1 X2010107E04Rik  0.1797066 2.163535e-02        0  0.13275819\n275  1        Gm10320  0.1781667 2.396615e-02        0  1.60229359\n276  1        Gm10131  0.1781618 2.396615e-02        0  0.23331333\n277  1       Ppp1r14a  0.1774100 2.511080e-02        0  0.35167875\n278  1          Snrpn  0.1767196 2.618504e-02        0  0.24864434\n279  1           Eid1  0.1764497 2.658604e-02        0  0.14528985\n280  1         Yeats4  0.1762184 2.691458e-02        0  0.07838677\n281  1       Trappc6b  0.1756682 2.776742e-02        0  0.12186465\n282  1          Mmp17  0.1755791 2.781028e-02        0  0.48650300\n283  1         Crabp1  0.1753723 2.810277e-02        0  0.48025137\n284  1         Arid4a  0.1746891 2.928622e-02        0  0.16133455\n285  1         Cab39l  0.1743192 2.995935e-02        0  0.38340017\n286  1         Nfe2l3  0.1736107 3.095944e-02        0  0.34784475\n287  1           Cap1  0.1735905 3.095944e-02        0  0.17730278\n288  1           Fat4  0.1734152 3.095944e-02        0  0.28882798\n289  1         H2afy2  0.1727771 3.184569e-02        0  0.13380026\n290  1         Sema7a  0.1726907 3.189800e-02        0  0.66007786\n291  1         Fam96a  0.1722868 3.265449e-02        0  0.24011122\n292  1          Gtf3a  0.1714577 3.414042e-02        0  0.28519266\n293  1          Cops9  0.1710146 3.496912e-02        0  0.09429890\n294  1           St18  0.1709555 3.496912e-02        0  0.35421704\n295  1          Hbb.y  0.1700387 3.704241e-02        0  0.78926208\n296  1           Ntf3  0.1692293 3.860317e-02        0  0.85374739\n297  1          Lrfn5  0.1690169 3.903262e-02        0  0.12982170\n298  1         Gm2000  0.1683222 4.034222e-02        0  0.19941445\n299  1         Nkain3  0.1670052 4.362492e-02        0  0.18708833\n300  1            Ndn  0.1661270 4.588663e-02        0  0.34670656\n301  1         Hmg20b  0.1656506 4.688799e-02        0  0.34990372\n302  1          Kctd8  0.1653842 4.739498e-02        0  0.29064360\n303  1           Lhfp  0.1643023 5.075223e-02        0  0.26519087\n304  1        Ier3ip1  0.1642683 5.075223e-02        0  0.18283423\n305  1           Lhx9  0.1637637 5.212585e-02        0  0.49523456\n306  1        Slc17a7  0.1634280 5.316759e-02        0  0.37078308\n307  1          Pcbp4  0.1630110 5.432173e-02        0  0.09870609\n308  1       Bcas3os1  0.1622079 5.656407e-02        0  1.73454326\n309  1        Ppp1r1b  0.1621564 5.656407e-02        0  0.34779065\n310  1          U2af1  0.1612813 5.946096e-02        0  0.08799859\n311  1        Slc44a5  0.1608207 6.046665e-02        0  0.22134424\n312  1 X9330111N05Rik  0.1594520 6.501513e-02        0  0.31883319\n313  1          Rpl38  0.1579112 7.073713e-02        0  0.19817423\n314  1         Alyref  0.1573450 7.314570e-02        0  0.34281340\n315  1          Gfpt1  0.1572123 7.314570e-02        0  0.35153345\n316  1         Mrpl22  0.1568935 7.395930e-02        0  0.22231450\n317  1  A930004D18Rik  0.1567618 7.430428e-02        0  0.59244464\n318  1          Ckap5  0.1560491 7.643820e-02        0  0.17254888\n319  1          Ddx24  0.1553231 7.920465e-02        0  0.15608934\n320  1         Hs3st5  0.1547861 8.102637e-02        0  0.72980921\n321  1          Cxxc5  0.1545233 8.174804e-02        0  0.38901299\n322  1        Rps27rt  0.1543364 8.213304e-02        0  0.17141059\n323  1          Actg1  0.1540262 8.331436e-02        0  0.19813585\n324  1        Gm11266  0.1538143 8.395577e-02        0  0.29723696\n325  1       Prickle1  0.1534663 8.510346e-02        0  0.23050354\n326  1          Ptpn4  0.1529844 8.728741e-02        0  0.25577778\n327  1           Rybp  0.1529466 8.728741e-02        0  0.31135162\n328  1          Itm2a  0.1528868 8.728741e-02        0  0.25466924\n329  1         Fam98b  0.1528674 8.728741e-02        0  0.31745602\n330  1          Pde4b  0.1528475 8.728741e-02        0  0.24929088\n331  1          Btbd2  0.1527695 8.746362e-02        0  0.27965574\n332  1         Fam96b  0.1524388 8.885228e-02        0  0.14057760\n333  1           Chd9  0.1518260 9.226896e-02        0  0.26430730\n334  1         Polr2f  0.1509082 9.654140e-02        0  0.08632195\n335  1          Kcnv1  0.1507933 9.697598e-02        0  0.50052974\n336  1         Igfbp4  0.1503835 9.911297e-02        0  0.26220639\n337  1        Cntnap2  0.1501506 9.963563e-02        0  0.21980518\n338  1          Myocd  0.1498322 1.014389e-01        0  0.86190551\n339  1        Tmem128  0.1496099 1.024219e-01        0  0.21076956\n340  1 X1600014C10Rik  0.1495932 1.024219e-01        0  0.35658238\n341  1          H2afv  0.1494887 1.028159e-01        0  0.13452553\n342  1         Hba.a1  0.1490678 1.034034e-01        0  0.24619288\n343  1      Eef1akmt1  0.1490374 1.034034e-01        0  0.13143220\n344  1       Mphosph8  0.1489404 1.036223e-01        0  0.14400395\n345  1        Trappc1  0.1489110 1.036223e-01        0  0.14495695\n346  1          Bola2  0.1488703 1.036223e-01        0  0.10057215\n347  1          Atp5e  0.1488138 1.037029e-01        0  0.19470655\n348  1        Gm43738  0.1486639 1.041170e-01        0  0.29171357\n349  1        Ndufa11  0.1484710 1.045365e-01        0  0.13796083\n350  1         Smim18  0.1484235 1.045365e-01        0  0.25998625\n351  1           Bex4  0.1482508 1.045365e-01        0  0.02698917\n352  1           Rara  0.1480521 1.054197e-01        0  0.87902800\n353  1         Ndufs6  0.1477372 1.059898e-01        0  0.09997795\n354  1          Bcar1  0.1474326 1.070932e-01        0  0.25748576\n355  1        Csnk2a1  0.1472493 1.073142e-01        0  0.17183070\n356  1         Dusp14  0.1466454 1.106914e-01        0  0.58853628\n357  1         Snrpb2  0.1461076 1.131580e-01        0  0.20076042\n358  1         Zswim4  0.1457403 1.145566e-01        0  0.40116514\n359  1           Ralb  0.1455356 1.157684e-01        0  0.38470025\n360  1        Morf4l1  0.1453371 1.169468e-01        0  0.12599869\n361  1           Chd4  0.1448418 1.201128e-01        0  0.17983513\n362  1       Eif4ebp2  0.1443908 1.223222e-01        0  0.15090560\n363  1          Prex1  0.1443464 1.223528e-01        0  0.64243954\n364  1          Rps29  0.1441031 1.236285e-01        0  0.23031547\n365  1         Hbb.bs  0.1435447 1.264763e-01        0  0.14423374\n366  1         Ndufa5  0.1435014 1.265038e-01        0  0.11474550\n367  1          Tmed7  0.1433370 1.271878e-01        0  0.17351150\n368  1       Adamts17  0.1428935 1.295659e-01        0  0.21970203\n369  1       Tmem178b  0.1426106 1.308690e-01        0  0.04533777\n370  1            Sln  0.1422944 1.328511e-01        0  0.37033212\n371  1           Pcp4  0.1416944 1.365014e-01        0  0.32137387\n372  1          Ddx25  0.1416696 1.365014e-01        0  0.14125154\n373  1       Baiap2l1  0.1413037 1.386797e-01        0  1.07747261\n374  1        Tmem222  0.1412632 1.386797e-01        0  0.17643405\n375  1            Boc  0.1410071 1.405851e-01        0  0.81045945\n376  1           Pag1  0.1406963 1.426587e-01        0  0.34697216\n377  1        Rtn4rl1  0.1399669 1.460633e-01        0  0.63325572\n378  1        Tmem214  0.1398709 1.460633e-01        0  0.32619762\n379  1        Laptm4b  0.1398343 1.460633e-01        0  0.80059546\n380  1         Zdhhc2  0.1397876 1.460633e-01        0  0.74532609\n381  1          Cox17  0.1397756 1.460633e-01        0  0.19810774\n382  1          Fkbp5  0.1397290 1.460633e-01        0  0.20638485\n383  1          Snrpg  0.1396610 1.460633e-01        0  0.12833465\n384  1          Tigd2  0.1396574 1.460633e-01        0  0.29428399\n385  1         Nt5dc2  0.1396042 1.460633e-01        0  0.45526285\n386  1         Rnf121  0.1394879 1.464515e-01        0  0.11661353\n387  1 X1810041L15Rik  0.1394192 1.467429e-01        0  0.57771942\n388  1        Fam131b  0.1392981 1.467845e-01        0  0.28079917\n389  1         Pcdh19  0.1389677 1.482100e-01        0  0.37795879\n390  1         Mapk11  0.1387758 1.493115e-01        0  0.28218854\n391  1         Ndufb4  0.1386285 1.500097e-01        0  0.13278025\n392  1          Tshz3  0.1384993 1.504059e-01        0  0.21632384\n393  1 X4930452B06Rik  0.1384785 1.504059e-01        0  1.58605173\n394  1          Snrpb  0.1383426 1.511109e-01        0  0.12047449\n395  1          Nxph3  0.1382607 1.511109e-01        0  0.63726411\n396  1         Atp2b2  0.1374796 1.571708e-01        0  0.40497307\n397  1           Fis1  0.1374043 1.575583e-01        0  0.08315116\n398  1         Smim11  0.1370936 1.595521e-01        0  0.22203238\n399  1         Ubald2  0.1369603 1.605140e-01        0  0.13118681\n400  1       Srek1ip1  0.1367495 1.622474e-01        0  0.25181162\n401  2           Rnd2 -0.4411570 2.276296e-15        0 -0.71602945\n402  2           Fat3 -0.3920372 7.952912e-12        0 -0.49746970\n403  2        Akirin2 -0.3578265 1.004982e-09        0 -0.44708226\n404  2       Tmem176b -0.3299643 3.771584e-08        0 -0.52656169\n405  2       Tpm3.rs7 -0.3294989 3.771584e-08        0 -0.49128964\n406  2         Necab3 -0.3225685 8.273728e-08        0 -0.54255970\n407  2          Alcam -0.3153837 1.770072e-07        0 -0.43922226\n408  2           Tbr1 -0.2873052 5.223764e-06        0 -0.34863308\n409  2         Klhl29 -0.2787411 1.294764e-05        0 -0.50900417\n410  2          Hmgb3 -0.2699134 2.794622e-05        0 -0.25803900\n411  2           Airn -0.2668735 3.760591e-05        0 -1.23149612\n412  2         Eef1a2 -0.2585808 8.172944e-05        0 -0.88080996\n413  2            Me1 -0.2572127 8.924397e-05        0 -0.63650782\n414  2           Mgll -0.2564792 9.384147e-05        0 -0.45332306\n415  2        Zfp804a -0.2538870 1.188522e-04        0 -0.46575236\n416  2        Slc35f4 -0.2537458 1.188522e-04        0 -0.80570310\n417  2          Kcnh7 -0.2523884 1.302814e-04        0 -0.44733664\n418  2          Glp2r -0.2471585 2.139116e-04        0 -0.35983331\n419  2         Btbd11 -0.2465387 2.227118e-04        0 -0.59427668\n420  2        Tmem178 -0.2445731 2.603149e-04        0 -0.15104023\n421  2          Kcnt2 -0.2432086 2.926287e-04        0 -0.45415418\n422  2         Ccser1 -0.2395872 3.624036e-04        0 -0.21896740\n423  2          Pcdh9 -0.2349072 5.312439e-04        0 -0.21511597\n424  2          Nxph4 -0.2348654 5.312439e-04        0 -0.46231241\n425  2          Pcbp1 -0.2330489 6.071585e-04        0 -0.24616696\n426  2          Wnt7b -0.2320767 6.463130e-04        0 -0.32823485\n427  2 X4833418N02Rik -0.2290690 8.378593e-04        0 -0.61793352\n428  2          Ddah1 -0.2279122 9.082068e-04        0 -0.45550085\n429  2           Vcan -0.2262585 1.003402e-03        0 -0.46188461\n430  2          Pttg1 -0.2241597 1.206828e-03        0 -0.81633983\n431  2         Eif4a1 -0.2232316 1.264208e-03        0 -0.45728645\n432  2          Lypd6 -0.2201926 1.634888e-03        0 -0.44198683\n433  2          Slit1 -0.2191946 1.747581e-03        0 -0.42018111\n434  2           Ngfr -0.2166436 2.181150e-03        0 -0.48224168\n435  2        Gadd45g -0.2159415 2.296634e-03        0 -0.26941855\n436  2            Dcc -0.2151350 2.362935e-03        0 -0.30618565\n437  2          Dact1 -0.2106020 3.380021e-03        0 -0.31138312\n438  2           Nfia -0.2093300 3.690055e-03        0 -0.20437947\n439  2          Nhlh1 -0.2083925 3.848027e-03        0 -1.08318362\n440  2          Rcor2 -0.2070127 4.214257e-03        0 -0.32594178\n441  2           Cnr1 -0.2048150 4.952630e-03        0 -0.22114131\n442  2           Nkd1 -0.2036582 5.420418e-03        0 -0.31376172\n443  2         Fam69a -0.2025082 5.926484e-03        0 -0.30172294\n444  2          Epha3 -0.2009094 6.480751e-03        0 -0.21276778\n445  2          Dscam -0.1990074 7.190806e-03        0 -0.23084660\n446  2           Ttc7 -0.1989448 7.190806e-03        0 -0.87499936\n447  2           Aff2 -0.1985476 7.371963e-03        0 -0.27208450\n448  2       Adamts18 -0.1984386 7.376434e-03        0 -0.32523533\n449  2          Ncor1 -0.1964280 8.239449e-03        0 -0.25074715\n450  2          Rab39 -0.1955762 8.623059e-03        0 -0.32821824\n451  2           Sgcz -0.1955619 8.623059e-03        0 -0.79823063\n452  2          Lcorl -0.1951645 8.799141e-03        0 -0.20412586\n453  2         Higd1a -0.1931787 1.013363e-02        0 -0.13053823\n454  2          Sfxn1 -0.1927293 1.043603e-02        0 -0.23611785\n455  2          Rab3c -0.1920842 1.092085e-02        0 -0.22163251\n456  2           Aff3 -0.1913384 1.139449e-02        0 -0.16007305\n457  2            Lpp -0.1892143 1.300906e-02        0 -0.36001600\n458  2          Smap1 -0.1890469 1.300906e-02        0 -0.24879350\n459  2          Epha4 -0.1879045 1.393548e-02        0 -0.18840904\n460  2        Tmem50b -0.1878773 1.393548e-02        0 -0.34579403\n461  2          Tnks2 -0.1873839 1.427546e-02        0 -0.25954419\n462  2           Vat1 -0.1869974 1.448533e-02        0 -0.34643001\n463  2          Fabp7 -0.1861258 1.535699e-02        0 -0.30531366\n464  2         Rbfox3 -0.1858901 1.546425e-02        0 -0.15332347\n465  2           Neo1 -0.1842319 1.705804e-02        0 -0.17904854\n466  2         Hbb.bt -0.1841709 1.705804e-02        0 -0.61889653\n467  2           Hypk -0.1838964 1.721604e-02        0 -0.22945778\n468  2          Stk40 -0.1837977 1.721604e-02        0 -0.44241082\n469  2           Rdh5 -0.1836990 1.721604e-02        0 -0.28654515\n470  2          Stk39 -0.1834471 1.724852e-02        0 -0.30722544\n471  2           Vrk2 -0.1833112 1.724852e-02        0 -0.32600848\n472  2          Sap30 -0.1810694 1.990252e-02        0 -0.16339897\n473  2          Cox5b -0.1810009 1.990252e-02        0 -0.14959702\n474  2 X2010107E04Rik -0.1797048 2.163829e-02        0 -0.13275819\n475  2        Gm10131 -0.1781682 2.396922e-02        0 -0.23331333\n476  2        Gm10320 -0.1781602 2.396922e-02        0 -1.60229359\n477  2       Ppp1r14a -0.1774112 2.510862e-02        0 -0.35167875\n478  2          Snrpn -0.1767121 2.620001e-02        0 -0.24864434\n479  2           Eid1 -0.1764509 2.658378e-02        0 -0.14528985\n480  2         Yeats4 -0.1762094 2.693288e-02        0 -0.07838677\n481  2       Trappc6b -0.1756745 2.775429e-02        0 -0.12186465\n482  2          Mmp17 -0.1755893 2.778891e-02        0 -0.48650300\n483  2         Crabp1 -0.1753698 2.810805e-02        0 -0.48025137\n484  2         Arid4a -0.1746853 2.929463e-02        0 -0.16133455\n485  2         Cab39l -0.1743118 2.997604e-02        0 -0.38340017\n486  2         Nfe2l3 -0.1736102 3.097128e-02        0 -0.34784475\n487  2           Cap1 -0.1735833 3.097128e-02        0 -0.17730278\n488  2           Fat4 -0.1734101 3.097128e-02        0 -0.28882798\n489  2         H2afy2 -0.1727761 3.184818e-02        0 -0.13380026\n490  2         Sema7a -0.1726924 3.189398e-02        0 -0.66007786\n491  2         Fam96a -0.1722935 3.267503e-02        0 -0.24011122\n492  2          Gtf3a -0.1714647 3.412267e-02        0 -0.28519266\n493  2          Cops9 -0.1710006 3.496956e-02        0 -0.09429890\n494  2           St18 -0.1709449 3.496956e-02        0 -0.35421704\n495  2          Hbb.y -0.1700269 3.707461e-02        0 -0.78926208\n496  2           Ntf3 -0.1692109 3.865501e-02        0 -0.85374739\n497  2          Lrfn5 -0.1690142 3.904043e-02        0 -0.12982170\n498  2         Gm2000 -0.1683149 4.036359e-02        0 -0.19941445\n499  2         Nkain3 -0.1669972 4.364997e-02        0 -0.18708833\n500  2            Ndn -0.1661224 4.590183e-02        0 -0.34670656\n501  2         Hmg20b -0.1656456 4.690456e-02        0 -0.34990372\n502  2          Kctd8 -0.1653867 4.738665e-02        0 -0.29064360\n503  2           Lhfp -0.1642998 5.075077e-02        0 -0.26519087\n504  2        Ier3ip1 -0.1642715 5.075077e-02        0 -0.18283423\n505  2           Lhx9 -0.1637753 5.208286e-02        0 -0.49523456\n506  2        Slc17a7 -0.1634306 5.315753e-02        0 -0.37078308\n507  2          Pcbp4 -0.1630118 5.431873e-02        0 -0.09870609\n508  2       Bcas3os1 -0.1621862 5.657726e-02        0 -1.73454326\n509  2        Ppp1r1b -0.1621531 5.657726e-02        0 -0.34779065\n510  2          U2af1 -0.1612914 5.944737e-02        0 -0.08799859\n511  2        Slc44a5 -0.1608246 6.044149e-02        0 -0.22134424\n512  2 X9330111N05Rik -0.1594587 6.498497e-02        0 -0.31883319\n513  2          Rpl38 -0.1579288 7.065156e-02        0 -0.19817423\n514  2         Alyref -0.1573427 7.305509e-02        0 -0.34281340\n515  2          Gfpt1 -0.1572068 7.317366e-02        0 -0.35153345\n516  2         Mrpl22 -0.1568877 7.398874e-02        0 -0.22231450\n517  2  A930004D18Rik -0.1567611 7.434989e-02        0 -0.59244464\n518  2          Ckap5 -0.1560521 7.642267e-02        0 -0.17254888\n519  2          Ddx24 -0.1553297 7.916913e-02        0 -0.15608934\n520  2         Hs3st5 -0.1547885 8.101293e-02        0 -0.72980921\n521  2          Cxxc5 -0.1545235 8.169946e-02        0 -0.38901299\n522  2        Rps27rt -0.1543448 8.208665e-02        0 -0.17141059\n523  2          Actg1 -0.1540292 8.329741e-02        0 -0.19813585\n524  2        Gm11266 -0.1538113 8.397271e-02        0 -0.29723696\n525  2       Prickle1 -0.1534599 8.513983e-02        0 -0.23050354\n526  2          Ptpn4 -0.1529762 8.732358e-02        0 -0.25577778\n527  2           Rybp -0.1529496 8.732358e-02        0 -0.31135162\n528  2          Itm2a -0.1528973 8.732358e-02        0 -0.25466924\n529  2         Fam98b -0.1528669 8.732358e-02        0 -0.31745602\n530  2          Pde4b -0.1528414 8.732358e-02        0 -0.24929088\n531  2          Btbd2 -0.1527780 8.741391e-02        0 -0.27965574\n532  2         Fam96b -0.1524390 8.885086e-02        0 -0.14057760\n533  2           Chd9 -0.1518216 9.229570e-02        0 -0.26430730\n534  2         Polr2f -0.1509182 9.647721e-02        0 -0.08632195\n535  2          Kcnv1 -0.1507782 9.707306e-02        0 -0.50052974\n536  2         Igfbp4 -0.1503986 9.905870e-02        0 -0.26220639\n537  2        Cntnap2 -0.1501503 9.963751e-02        0 -0.21980518\n538  2          Myocd -0.1498479 1.013342e-01        0 -0.86190551\n539  2        Tmem128 -0.1496077 1.023962e-01        0 -0.21076956\n540  2 X1600014C10Rik -0.1495970 1.023962e-01        0 -0.35658238\n541  2          H2afv -0.1494983 1.027508e-01        0 -0.13452553\n542  2         Hba.a1 -0.1490698 1.033397e-01        0 -0.24619288\n543  2      Eef1akmt1 -0.1490467 1.033397e-01        0 -0.13143220\n544  2       Mphosph8 -0.1489356 1.036466e-01        0 -0.14400395\n545  2        Trappc1 -0.1489043 1.036466e-01        0 -0.14495695\n546  2          Bola2 -0.1488668 1.036466e-01        0 -0.10057215\n547  2          Atp5e -0.1488163 1.036859e-01        0 -0.19470655\n548  2        Gm43738 -0.1486565 1.041679e-01        0 -0.29171357\n549  2        Ndufa11 -0.1484711 1.045878e-01        0 -0.13796083\n550  2         Smim18 -0.1484339 1.045878e-01        0 -0.25998625\n551  2           Bex4 -0.1482433 1.045878e-01        0 -0.02698917\n552  2           Rara -0.1480282 1.054674e-01        0 -0.87902800\n553  2         Ndufs6 -0.1477370 1.059910e-01        0 -0.09997795\n554  2          Bcar1 -0.1474437 1.070992e-01        0 -0.25748576\n555  2        Csnk2a1 -0.1472509 1.073028e-01        0 -0.17183070\n556  2         Dusp14 -0.1466447 1.106960e-01        0 -0.58853628\n557  2         Snrpb2 -0.1461056 1.131696e-01        0 -0.20076042\n558  2         Zswim4 -0.1457478 1.145010e-01        0 -0.40116514\n559  2           Ralb -0.1455408 1.157298e-01        0 -0.38470025\n560  2        Morf4l1 -0.1453375 1.169432e-01        0 -0.12599869\n561  2           Chd4 -0.1448328 1.201579e-01        0 -0.17983513\n562  2       Eif4ebp2 -0.1443864 1.223566e-01        0 -0.15090560\n563  2          Prex1 -0.1443435 1.223752e-01        0 -0.64243954\n564  2          Rps29 -0.1441023 1.236344e-01        0 -0.23031547\n565  2         Hbb.bs -0.1435340 1.265628e-01        0 -0.14423374\n566  2         Ndufa5 -0.1434928 1.265729e-01        0 -0.11474550\n567  2          Tmed7 -0.1433340 1.272122e-01        0 -0.17351150\n568  2       Adamts17 -0.1428900 1.296332e-01        0 -0.21970203\n569  2       Tmem178b -0.1426121 1.308566e-01        0 -0.04533777\n570  2            Sln -0.1422902 1.328862e-01        0 -0.37033212\n571  2           Pcp4 -0.1416941 1.364816e-01        0 -0.32137387\n572  2          Ddx25 -0.1416720 1.364816e-01        0 -0.14125154\n573  2       Baiap2l1 -0.1413021 1.386559e-01        0 -1.07747261\n574  2        Tmem222 -0.1412660 1.386559e-01        0 -0.17643405\n575  2            Boc -0.1410281 1.403999e-01        0 -0.81045945\n576  2           Pag1 -0.1407007 1.426200e-01        0 -0.34697216\n577  2        Rtn4rl1 -0.1399455 1.461146e-01        0 -0.63325572\n578  2        Tmem214 -0.1398635 1.461146e-01        0 -0.32619762\n579  2        Laptm4b -0.1398405 1.461146e-01        0 -0.80059546\n580  2         Zdhhc2 -0.1397790 1.461146e-01        0 -0.74532609\n581  2          Cox17 -0.1397697 1.461146e-01        0 -0.19810774\n582  2          Fkbp5 -0.1397188 1.461146e-01        0 -0.20638485\n583  2          Snrpg -0.1396592 1.461146e-01        0 -0.12833465\n584  2          Tigd2 -0.1396514 1.461146e-01        0 -0.29428399\n585  2         Nt5dc2 -0.1396036 1.461146e-01        0 -0.45526285\n586  2         Rnf121 -0.1394838 1.464889e-01        0 -0.11661353\n587  2 X1810041L15Rik -0.1394285 1.466582e-01        0 -0.57771942\n588  2        Fam131b -0.1392925 1.468440e-01        0 -0.28079917\n589  2         Pcdh19 -0.1389782 1.481137e-01        0 -0.37795879\n590  2         Mapk11 -0.1387840 1.492364e-01        0 -0.28218854\n591  2         Ndufb4 -0.1386352 1.499475e-01        0 -0.13278025\n592  2          Tshz3 -0.1385019 1.503419e-01        0 -0.21632384\n593  2 X4930452B06Rik -0.1384854 1.503419e-01        0 -1.58605173\n594  2          Snrpb -0.1383325 1.511031e-01        0 -0.12047449\n595  2          Nxph3 -0.1382615 1.511031e-01        0 -0.63726411\n596  2         Atp2b2 -0.1374798 1.571689e-01        0 -0.40497307\n597  2           Fis1 -0.1374032 1.575690e-01        0 -0.08315116\n598  2         Smim11 -0.1371004 1.594861e-01        0 -0.22203238\n599  2         Ubald2 -0.1369566 1.605502e-01        0 -0.13118681\n600  2       Srek1ip1 -0.1367367 1.623742e-01        0 -0.25181162\n601  2          Rpl26  0.7828426 2.007887e-51        0  1.57515134\n602  2         Rpl35a  0.6930576 4.184848e-40        0  1.24898088\n603  2          Uba52  0.5226004 4.520972e-22        0  0.94946200\n604  2           Nrp1  0.4696631 1.449069e-17        0  1.10517320\n605  2           Hcn1  0.3625122 6.474560e-10        0  1.08301395\n606  2         Pantr1  0.3607812 7.320071e-10        0  0.80322987\n607  2          Gstp1  0.3518196 2.165691e-09        0  0.62139975\n608  2           Btg1  0.3459795 4.538815e-09        0  0.62262518\n609  2          Fgfr2  0.3257570 5.795983e-08        0  0.73656272\n610  2        Gm48091  0.3208886 9.687245e-08        0  0.80366280\n611  2          Pcdh8  0.3189455 1.177402e-07        0  0.65834688\n612  2          Nr4a2  0.3125882 2.406825e-07        0  1.55914852\n613  2           Ryr3  0.2861301 5.718789e-06        0  0.38400773\n614  2           Glo1  0.2772189 1.475729e-05        0  0.32896127\n615  2         Shisa9  0.2756894 1.685042e-05        0  1.29465903\n616  2            Fos  0.2713354 2.650373e-05        0  0.81491072\n617  2          Cd200  0.2702142 2.794622e-05        0  0.41826689\n618  2           Msra  0.2698538 2.794622e-05        0  0.37642731\n619  2           Xist  0.2645663 4.689303e-05        0  0.21820655\n620  2          Wasf1  0.2640077 4.825074e-05        0  0.35028819\n621  2           Crym  0.2587836 8.172944e-05        0  0.50575693\n622  2         Gabra2  0.2577862 8.639319e-05        0  0.55195273\n623  2          Btbd9  0.2530610 1.244864e-04        0  0.21456202\n624  2          Unc5d  0.2472737 2.139116e-04        0  0.99447339\n625  2          Ssbp2  0.2449342 2.565859e-04        0  0.43966196\n626  2         Zfp608  0.2419674 3.247943e-04        0  0.49937452\n627  2            Erh  0.2413593 3.381711e-04        0  0.34071185\n628  2           Raly  0.2408616 3.483071e-04        0  0.48469271\n629  2        Slc16a2  0.2403445 3.594750e-04        0  0.32388771\n630  2          Stmn4  0.2401499 3.594750e-04        0  0.30591176\n631  2           Dlg2  0.2396362 3.624036e-04        0  0.33412509\n632  2         Klhl24  0.2394989 3.624036e-04        0  0.26915813\n633  2            Sla  0.2355166 5.267088e-04        0  0.40947014\n634  2     St6galnac5  0.2353696 5.267088e-04        0  0.79039470\n635  2          Fgf13  0.2347523 5.312439e-04        0  0.29957368\n636  2         Dlgap2  0.2340611 5.590706e-04        0  0.58420474\n637  2        Lamtor3  0.2328012 6.119840e-04        0  0.45660421\n638  2           Ldb2  0.2299760 7.797888e-04        0  0.18277773\n639  2         Rgs7bp  0.2289019 8.385266e-04        0  0.46136373\n640  2          Cdk14  0.2275432 9.269817e-04        0  0.60195604\n641  2           Rgs4  0.2270104 9.611891e-04        0  1.05661205\n642  2           Mycl  0.2262836 1.003402e-03        0  0.25517353\n643  2           Pigt  0.2239211 1.217344e-03        0  0.38317223\n644  2          Tnnt1  0.2232832 1.264208e-03        0  1.51510847\n645  2         Sh3rf3  0.2223139 1.359579e-03        0  0.71212302\n646  2        Fam131c  0.2195833 1.707569e-03        0  0.50043032\n647  2        Gm17750  0.2153237 2.362935e-03        0  0.37451733\n648  2        Zfp385b  0.2152180 2.362935e-03        0  1.01914318\n649  2         Spock1  0.2150979 2.362935e-03        0  0.27243287\n650  2        Gm44790  0.2138094 2.624213e-03        0  0.46109281\n651  2           Eml1  0.2133367 2.706936e-03        0  0.49580939\n652  2          Ntrk3  0.2113780 3.189960e-03        0  0.29238439\n653  2         Tmeff2  0.2098578 3.570923e-03        0  0.63366960\n654  2         Lingo1  0.2092392 3.690055e-03        0  0.32363975\n655  2           Rgs7  0.2088273 3.785715e-03        0  0.50748659\n656  2           Ncdn  0.2085899 3.824757e-03        0  0.33167474\n657  2          Magi1  0.2082822 3.848027e-03        0  0.55544260\n658  2            Cpq  0.2071255 4.214257e-03        0  0.45147205\n659  2         Ube2e3  0.2068305 4.238758e-03        0  0.18538121\n660  2        Dync1i1  0.2055310 4.700415e-03        0  0.28001247\n661  2         Elmod1  0.2020152 6.089397e-03        0  0.33924307\n662  2        Gm40418  0.2019678 6.089397e-03        0  1.00196057\n663  2          Stk25  0.2015587 6.246908e-03        0  0.25645309\n664  2         Rnf150  0.2012291 6.365298e-03        0  0.39764524\n665  2           Vav3  0.2006276 6.577322e-03        0  0.63535035\n666  2           Nrp2  0.2000248 6.860371e-03        0  0.84879141\n667  2          Glra2  0.1995359 7.047146e-03        0  0.31248709\n668  2            Ntm  0.1994659 7.047146e-03        0  0.11491730\n669  2          Lyrm9  0.1993907 7.047146e-03        0  1.04917745\n670  2          Chsy3  0.1982109 7.455624e-03        0  0.54723834\n671  2          Afap1  0.1978803 7.601566e-03        0  0.72467466\n672  2          Insm1  0.1976726 7.670979e-03        0  0.67474095\n673  2            Jun  0.1971007 7.981593e-03        0  0.39742424\n674  2           Nrg1  0.1966691 8.207431e-03        0  0.36396237\n675  2         Camk2b  0.1965432 8.226889e-03        0  0.37424981\n676  2         Pggt1b  0.1958951 8.545202e-03        0  0.50473799\n677  2         Klhdc4  0.1955013 8.623059e-03        0  0.61250522\n678  2          Efna5  0.1945286 9.204387e-03        0  0.45203288\n679  2         Dlgap1  0.1942252 9.366381e-03        0  0.42564188\n680  2         Dynll2  0.1916165 1.126271e-02        0  0.16343170\n681  2           Pgk1  0.1912201 1.139449e-02        0  0.36364730\n682  2        Bloc1s1  0.1912047 1.139449e-02        0  0.33457090\n683  2          Nr4a3  0.1909133 1.158435e-02        0  0.38224660\n684  2        Hnrnpa1  0.1906458 1.175472e-02        0  0.22896156\n685  2          Atp5l  0.1905493 1.176334e-02        0  0.22804386\n686  2          Ccnd2  0.1891100 1.300906e-02        0  0.25660314\n687  2          Nr2f2  0.1879053 1.393548e-02        0  0.98414448\n688  2         Zbtb16  0.1878519 1.393548e-02        0  0.79304337\n689  2         Gm2164  0.1874797 1.426142e-02        0  0.85319962\n690  2        Snrnp48  0.1869704 1.448533e-02        0  0.23402910\n691  2           Prcp  0.1869540 1.448533e-02        0  0.51523122\n692  2         Csrnp3  0.1860585 1.535699e-02        0  0.27861526\n693  2          Opcml  0.1845007 1.695052e-02        0  0.37422735\n694  2         Kcnk10  0.1844529 1.695052e-02        0  0.29067023\n695  2           Chp1  0.1844444 1.695052e-02        0  0.26331136\n696  2         Asnsd1  0.1844125 1.695052e-02        0  0.45835879\n697  2            Psd  0.1840969 1.705804e-02        0  0.49864314\n698  2         Igfbp3  0.1836720 1.721604e-02        0  0.49410243\n699  2          Ptprr  0.1835774 1.724138e-02        0  0.84088273\n700  2          Epha6  0.1833884 1.724852e-02        0  1.26382484\n701  2        Gm30382  0.1832727 1.724852e-02        0  0.62577434\n702  2          Cntn1  0.1826716 1.797649e-02        0  0.38961775\n703  2          Mief1  0.1818818 1.901098e-02        0  0.41984198\n704  2         Frmd4b  0.1814788 1.950534e-02        0  0.16555279\n705  2          Snx10  0.1813776 1.954781e-02        0  0.31792690\n706  2          Asic2  0.1804006 2.073444e-02        0  0.25466896\n707  2          Tsnax  0.1798066 2.158833e-02        0  0.16361773\n708  2          Ckmt1  0.1784026 2.378661e-02        0  0.36194957\n709  2           Gps1  0.1779677 2.419352e-02        0  0.48103220\n710  2          Mast2  0.1767394 2.620001e-02        0  0.22886266\n711  2        B3galt2  0.1758063 2.762266e-02        0  0.37387360\n712  2          Glp1r  0.1749847 2.878828e-02        0  1.29813641\n713  2           Rgs6  0.1738745 3.081959e-02        0  0.27342864\n714  2          Cnih3  0.1737056 3.097128e-02        0  0.19392913\n715  2         Dpysl4  0.1735188 3.097128e-02        0  0.34080199\n716  2           Lix1  0.1734335 3.097128e-02        0  0.24379550\n717  2         Cacnb4  0.1732371 3.122133e-02        0  0.32715324\n718  2           Cdh2  0.1730790 3.143878e-02        0  0.15879849\n719  2         Pou3f2  0.1728066 3.184818e-02        0  1.28397209\n720  2           Pak3  0.1722393 3.267503e-02        0  0.22725958\n721  2        Tmem108  0.1720884 3.288774e-02        0  0.10052886\n722  2         Adgrl3  0.1714698 3.412267e-02        0  0.23838521\n723  2           Pak7  0.1709449 3.496956e-02        0  0.21089453\n724  2           Fut9  0.1702230 3.671149e-02        0  0.26154758\n725  2         Trim36  0.1699000 3.725189e-02        0  0.67610277\n726  2          Rtl8a  0.1695195 3.813317e-02        0  0.21199428\n727  2         Kcnmb4  0.1692915 3.860094e-02        0  0.34607968\n728  2           Lmo7  0.1686460 3.974968e-02        0  0.35459204\n729  2           Rpgr  0.1686460 3.974968e-02        0  0.37719879\n730  2          Bcl6b  0.1684924 4.002046e-02        0  0.55285610\n731  2           Sdhc  0.1678888 4.145304e-02        0  0.15411969\n732  2         Snap25  0.1677497 4.169212e-02        0  0.25946972\n733  2         Gm9885  0.1672221 4.313101e-02        0  0.40777547\n734  2          Rint1  0.1667180 4.434903e-02        0  0.31311835\n735  2          Sept6  0.1664524 4.501458e-02        0  0.28471311\n736  2           Oma1  0.1660362 4.599204e-02        0  0.66865123\n737  2        Slc35f1  0.1658691 4.635192e-02        0  0.24250790\n738  2          Fosl2  0.1654323 4.738665e-02        0  0.47513449\n739  2           Clpb  0.1642541 5.075077e-02        0  0.35225590\n740  2        Gm10260  0.1639247 5.174330e-02        0  0.23336764\n741  2           Mea1  0.1632112 5.377300e-02        0  0.73359774\n742  2         Pou3f3  0.1625600 5.563649e-02        0  0.52217593\n743  2           Cdh8  0.1625596 5.563649e-02        0  0.58109438\n744  2  C030034I22Rik  0.1622182 5.657726e-02        0  0.56113965\n745  2          Crtc1  0.1620612 5.672080e-02        0  0.32146464\n746  2         Ctnnd2  0.1612823 5.944737e-02        0  0.17132854\n747  2         Commd1  0.1609915 6.043641e-02        0  0.23330268\n748  2          Dusp8  0.1609237 6.044149e-02        0  0.23123799\n749  2           Nol4  0.1608261 6.044149e-02        0  0.15319369\n750  2            Dap  0.1606718 6.076637e-02        0  0.23228463\n751  2          Cdk19  0.1606385 6.076637e-02        0  0.32241950\n752  2         Zfp277  0.1602186 6.233772e-02        0  0.18222792\n753  2        Fam135b  0.1601492 6.240331e-02        0  0.49787642\n754  2         Diaph3  0.1597243 6.403619e-02        0  0.69315519\n755  2        Cep57l1  0.1592247 6.580262e-02        0  0.50764025\n756  2          Snx21  0.1589835 6.666323e-02        0  0.43319094\n757  2          Ntrk2  0.1584787 6.877776e-02        0  0.24868556\n758  2         Ahcyl2  0.1579997 7.065156e-02        0  0.39857716\n759  2          Mtus1  0.1579433 7.065156e-02        0  0.32594782\n760  2  D130020L05Rik  0.1573362 7.305509e-02        0  1.54913697\n761  2         Magee2  0.1572285 7.317366e-02        0  0.47897240\n762  2           Paxx  0.1570876 7.350847e-02        0  0.15289852\n763  2           Dhfr  0.1569884 7.374421e-02        0  0.95228582\n764  2         Zfp704  0.1567124 7.434989e-02        0  0.25996609\n765  2        Gm30054  0.1563421 7.598702e-02        0  1.02783611\n766  2         Snhg10  0.1562553 7.615000e-02        0  0.78649630\n767  2         Gtf2h3  0.1561913 7.615000e-02        0  0.34844018\n768  2          Shtn1  0.1561558 7.615000e-02        0  0.14371495\n769  2           Hax1  0.1556535 7.825361e-02        0  0.19926078\n770  2        Stxbp5l  0.1554517 7.904770e-02        0  0.71053653\n771  2 X4933404O12Rik  0.1554030 7.904770e-02        0  0.60493265\n772  2          Igsf3  0.1552294 7.943626e-02        0  0.26474386\n773  2          Rell2  0.1551582 7.954795e-02        0  0.27945422\n774  2          Tfdp1  0.1550273 7.998417e-02        0  0.20307052\n775  2         Tamm41  0.1545646 8.169946e-02        0  0.39566047\n776  2          Crlf1  0.1544794 8.169946e-02        0  0.64715042\n777  2           Fut8  0.1544642 8.169946e-02        0  0.43124548\n778  2        Gm21949  0.1540631 8.329741e-02        0  0.53590643\n779  2        Zkscan3  0.1539464 8.348668e-02        0  0.24397057\n780  2          Nr4a1  0.1536677 8.447684e-02        0  0.71999816\n781  2          Spast  0.1536247 8.447684e-02        0  0.22873782\n782  2           Itpa  0.1525185 8.866185e-02        0  0.13673904\n783  2        Gm38948  0.1513221 9.511377e-02        0  0.37127192\n784  2          Rusc2  0.1510813 9.619588e-02        0  0.25936942\n785  2          Ypel1  0.1510380 9.619588e-02        0  0.17766308\n786  2        Gpr137c  0.1510094 9.619588e-02        0  0.23583596\n787  2           Tcf4  0.1503784 9.905870e-02        0  0.32236888\n788  2           Rgl1  0.1503138 9.917564e-02        0  0.56341013\n789  2          Eif4b  0.1501503 9.963751e-02        0  0.15901624\n790  2         Dhrs13  0.1494255 1.029326e-01        0  0.23594266\n791  2           Sik1  0.1492612 1.033397e-01        0  0.63223288\n792  2         Pou3f1  0.1491085 1.033397e-01        0  0.54571045\n793  2        Rangap1  0.1490838 1.033397e-01        0  0.19146620\n794  2        Gm29478  0.1490499 1.033397e-01        0  1.59813122\n795  2         Dbpht2  0.1490499 1.033397e-01        0  1.58991377\n796  2          Dmac2  0.1487502 1.038322e-01        0  0.47524745\n797  2          Actr6  0.1484507 1.045878e-01        0  0.27628804\n798  2          Nup43  0.1483971 1.045878e-01        0  0.36551302\n799  2           Pja1  0.1483225 1.045878e-01        0  0.04782317\n800  2         Resp18  0.1482590 1.045878e-01        0  1.62870311",
    "crumbs": [
      "Cluster evaluation",
      "Not UT cluster with LR"
    ]
  },
  {
    "objectID": "NonCT_clusters.html#cluster-511-e15.0-1",
    "href": "NonCT_clusters.html#cluster-511-e15.0-1",
    "title": "Not Uniform Transcriptomic clusters with Logistic Regression",
    "section": "Cluster 511 e15.0",
    "text": "Cluster 511 e15.0\n\n\n  OriginalCluster CellNumber COTANClusterNumber          Accuracy\n1      Cl525E15.0        826                  3 0.786585365853659\n2      Cl511E15.0        540                  2 0.916666666666667\n3      Cl184E15.0        322                  2          0.734375\n4      Cl432E13.5        536                  2  0.88785046728972\n5      Cl510E15.0        402                  2             0.825\n6      Cl511E15.0        540                  2              &lt;NA&gt;\n\n\n\ncells &lt;- getClusterizationData(e15.0,clName = \"CL_original.clusters\")[[1]][getClusterizationData(e15.0,clName = \"CL_original.clusters\")[[1]] == \"511\"]\n\ncells &lt;-names(cells)\n\ncl511e15.0 &lt;-  automaticCOTANObjectCreation(raw = getRawData(e15.0)[,cells],\n                                       GEO = \"Loom\",\n                                       sequencingMethod = \"10X\",\n                                       sampleCondition = \"cl511e15.0\",\n                                       cores = 10,saveObj = T,\n                                       outDir = \"Data/MouseCortexFromLoom/NotCTSingleClusters/\",\n                                       calcCoex = T)\n\n\ncl511e15.0GDI &lt;- calculateGDI(cl511e15.0)\n\nsubsetGDIcl511e15.0 &lt;- cl511e15.0GDI[cl511e15.0GDI$sum.raw.norm &gt; 5,]\ntop.GDI.genes &lt;- rownames(subsetGDIcl511e15.0[order(subsetGDIcl511e15.0$GDI,decreasing = T),])[1:25]\n\nGDIPlot(cl511e15.0,genes = list(\"topGDI\"=top.GDI.genes),GDIIn = cl511e15.0GDI)\n\n\n\n\n\n\n\n\n\nlist.cl.CT &lt;- cellsUniformClustering(cl511e15.0, GDIThreshold = 1.43, cores = 10L,\n                         saveObj = TRUE, outDir = outDir)\n\ncl511e15.0 &lt;- addClusterization(cl511e15.0, clName = \"split\",\n                              clusters = list.cl.CT$clusters,\n                              coexDF = list.cl.CT$coex, override = TRUE)\n\ntable(list.cl.CT$clusters)\n\n\nc(mergedClusters, mergedCoexDF) %&lt;-%\n  mergeUniformCellsClusters(cl511e15.0, clusters = list.cl.CT$clusters,\n                            GDIThreshold = 1.43, batchSize = 4L, cores = 10L,\n                            saveObj = TRUE, outDir = outDir)\n\ncl511e15.0 &lt;- addClusterization(cl511e15.0, clName = \"merge\",\n                              clusters = mergedClusters,\n                              coexDF = mergedCoexDF,\n                              override = TRUE)\n\nsaveRDS(cl511e15.0,paste0(outDir,\"cl511e15.0.cotan.RDS\"))\n\ntable(str_split(names(mergedClusters),pattern = \"_\",simplify = T)[,1],mergedClusters)\n\n\ndata &lt;- getNormalizedData(cl511e15.0)\ndata &lt;- data[!rowSums(as.matrix(data)) &lt; 1,]\ndata &lt;- log(data*10000+1)\n\nrow_stdev &lt;- apply(data, 1, sd, na.rm=TRUE)\nrow_stdev &lt;- row_stdev[order(row_stdev,decreasing = T)]\n\ngenes.to.keep &lt;- c(names(row_stdev[1:100]),top.GDI.genes)\n\ndata.small &lt;- data[rownames(data) %in% genes.to.keep,]\n\n#data &lt;- t(as.matrix(data))\ndata.small &lt;- t(as.matrix(data.small))\n\n\nCOTAN_Cl.code &lt;- getClusterizationData(cl511e15.0)[[1]]\n#COTAN_Cl.code[COTAN_Cl.code == \"A549\"] &lt;- 0\n#COTAN_Cl.code[COTAN_Cl.code == \"CCL-185-IG\"] &lt;- 1\n\nCOTAN_Cl.code &lt;- as.numeric(COTAN_Cl.code)-1\n\ndata.small &lt;- cbind(data.small,COTAN_Cl.code)\ndata.small &lt;- as.data.frame(data.small)\n\n# Split the data into training and test set\nset.seed(123)\ntraining.samples &lt;- data.small[,\"COTAN_Cl.code\"] %&gt;% \n  createDataPartition(p = 0.8, list = FALSE)\ntrain.data  &lt;- data.small[training.samples, ]\ntest.data &lt;- data.small[-training.samples, ]\nhead(train.data)\n\n                               Flrt2  Smarca2    Srgap1       Sla    Cadps\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000 0.000000  0.000000  0.000000 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000 0.000000  0.000000 10.471506 0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 9.207514 9.207514 10.306059  0.000000 9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 8.878654 8.878654  9.571731  0.000000 0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx 8.985081 9.678166 10.371281  0.000000 0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000 9.028611 10.127143  9.721698 9.028611\n                               Kcnk10 Itpr1    Klhl29   Elmod1       Nin\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.000000     0 10.627557 9.528994 10.915233\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000     0  9.778387 0.000000  9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx  9.207514     0  9.900611 0.000000  9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx  0.000000     0  0.000000 8.878654  0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx  0.000000     0  8.985081 8.985081  8.985081\n10X73_3_A_1:AAGCACTGCTTCGCx 10.127143     0  0.000000 9.028611  0.000000\n                               Kcnn2    Adgrb3    Foxp1     Alcam     Mtss1\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000  9.528994 0.000000  9.528994  0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000  0.000000 0.000000  0.000000  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 0.000000 11.153338 9.207514 10.593733  9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 9.571731 10.264844 9.571731  0.000000  8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 0.000000 10.083610 8.985081  8.985081 10.083610\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000  0.000000 9.028611  0.000000  9.028611\n                             Fam213a  Ralgps2       Ptn     Cadm2    Frmd4a\n10X74_4_A_1:CAGCGTCTCCTCGTx 9.528994 0.000000  0.000000 10.222104  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000 9.778387  0.000000  0.000000  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 0.000000 9.207514  9.207514  9.207514  9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 0.000000 0.000000 11.586574 10.487980  8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 0.000000 0.000000  0.000000  8.985081  0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000 9.028611  0.000000 10.127143 10.820270\n                              Nkain2     Tenm3     Grip1    Tanc2    Syt11\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000  0.000000 10.915233 0.000000 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 9.778387 10.876962  9.778387 9.778387 9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx 0.000000  9.207514  0.000000 0.000000 9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 0.000000  0.000000  8.878654 8.878654 8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 0.000000  9.678166  8.985081 8.985081 0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000 10.127143  0.000000 9.028611 0.000000\n                               Srgap3      Pak7    Mapk10     Sobp  Bhlhe22\n10X74_4_A_1:CAGCGTCTCCTCGTx  9.528994  0.000000 10.222104 9.528994 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 10.471506  9.778387  0.000000 0.000000 9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx  9.900611  0.000000  0.000000 0.000000 0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx  9.571731  8.878654 10.487980 8.878654 0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx  9.678166  0.000000  8.985081 9.678166 0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx  0.000000 10.820270  0.000000 0.000000 9.721698\n                               Epha3    Adgrl3      Dok5    Satb2    Hs6st2\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000  0.000000  0.000000  0.00000  0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000 10.471506  0.000000  0.00000  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 0.000000  0.000000  0.000000  0.00000  9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 9.571731  9.571731 10.487980 11.36343  8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 8.985081  8.985081  0.000000  0.00000  0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000  0.000000  9.028611  0.00000 12.024229\n                            X5730522E02Rik      Msra    Spock1     Enc1\n10X74_4_A_1:CAGCGTCTCCTCGTx       9.528994  0.000000  9.528994  0.00000\n10X74_4_A_1:GTCCACTGTCCTCGx       0.000000  0.000000  0.000000 10.47151\n10X64_3_A_1:ACGCCGGAGGATTCx       0.000000  0.000000  0.000000  0.00000\n10X73_3_A_1:GTTAACCTTGTCGAx       0.000000  0.000000  8.878654 10.26484\n10X74_4_A_1:CGTGATGAGAAGGCx      10.371281  8.985081  0.000000  0.00000\n10X73_3_A_1:AAGCACTGCTTCGCx      10.414815 10.820270 10.414815  0.00000\n                             Fam110b      Sybu     Lmo1     Dscam    Rab3c\n10X74_4_A_1:CAGCGTCTCCTCGTx 9.528994 10.627557 9.528994 10.222104 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000 10.471506 0.000000  9.778387 0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 0.000000  9.207514 0.000000  0.000000 0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx 8.878654  8.878654 8.878654  8.878654 8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 8.985081  0.000000 8.985081  8.985081 8.985081\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000  0.000000 9.028611  0.000000 9.028611\n                            Mir124.2hg    Clstn2      Fat3     Kcnh7    Usp29\n10X74_4_A_1:CAGCGTCTCCTCGTx   0.000000 10.222104 10.627557 10.222104 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx  10.471506 10.876962  9.778387  0.000000 0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx   9.207514 10.306059 10.816872  9.207514 0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx   8.878654  8.878654  9.571731  8.878654 0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx   8.985081  0.000000  0.000000  0.000000 0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx   0.000000  0.000000 10.414815 10.127143 9.028611\n                                 Cd47      Ryr3    Neto2     Ppm1e     Mdga2\n10X74_4_A_1:CAGCGTCTCCTCGTx 10.222104  0.000000 9.528994  0.000000  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000  0.000000 9.778387  9.778387 10.471506\n10X64_3_A_1:ACGCCGGAGGATTCx  9.207514  0.000000 0.000000  9.207514 10.306059\n10X73_3_A_1:GTTAACCTTGTCGAx  0.000000  8.878654 9.571731 11.517582  0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx  9.678166 10.083610 8.985081  9.678166 10.083610\n10X73_3_A_1:AAGCACTGCTTCGCx  0.000000 10.414815 9.721698  9.721698  9.721698\n                            Serpini1     Ralyl     Nrcam     Robo2    Csrnp3\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000 10.222104  0.000000  0.000000 10.627557\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000 10.471506 10.471506  0.000000  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 9.207514  0.000000  9.900611 10.593733 10.306059\n10X73_3_A_1:GTTAACCTTGTCGAx 9.571731  8.878654  9.977173  8.878654  9.571731\n10X74_4_A_1:CGTGATGAGAAGGCx 8.985081 10.371281  8.985081  0.000000  0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000 10.637953  0.000000  0.000000  0.000000\n                            Hist3h2ba   Jakmip1     Edil3     Enox1      Rprm\n10X74_4_A_1:CAGCGTCTCCTCGTx  10.62756  0.000000  0.000000 10.222104 10.627557\n10X74_4_A_1:GTCCACTGTCCTCGx   0.00000  0.000000 10.471506  9.778387  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx  10.30606  9.207514  9.900611  9.207514  0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx  10.95797  9.571731  0.000000  0.000000  8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx  10.93088 10.083610  8.985081 10.594419 10.594419\n10X73_3_A_1:AAGCACTGCTTCGCx  11.10795  0.000000  9.028611  9.721698  9.028611\n                               Olfm1 Tmem178b      Gng3    Cntn2     Scg3\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000 0.000000  9.528994 0.000000 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 9.778387 0.000000  9.778387 0.000000 9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx 9.207514 0.000000  0.000000 0.000000 0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx 8.878654 8.878654 10.670297 8.878654 8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx 0.000000 0.000000  8.985081 0.000000 9.678166\n10X73_3_A_1:AAGCACTGCTTCGCx 0.000000 9.028611  0.000000 9.028611 0.000000\n                               Gnao1     Serp2     Pcdh9    Trim2     Nrg1\n10X74_4_A_1:CAGCGTCTCCTCGTx 9.528994 10.222104 10.222104 9.528994 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 9.778387  9.778387  9.778387 0.000000 0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 9.207514  0.000000 10.816872 0.000000 0.000000\n10X73_3_A_1:GTTAACCTTGTCGAx 9.571731  9.571731 10.264844 9.571731 9.571731\n10X74_4_A_1:CGTGATGAGAAGGCx 8.985081  9.678166  9.678166 8.985081 8.985081\n10X73_3_A_1:AAGCACTGCTTCGCx 9.028611  9.721698 10.127143 9.721698 9.028611\n                               Ppfia2  Cacna2d1     Uqcrq    Ndufs6    Ppp1cb\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.000000  0.000000  0.000000  9.528994 10.222104\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000  0.000000  0.000000  0.000000  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx  0.000000  9.900611  9.900611 10.593733  9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx 10.670297 11.181114 10.957974  9.571731  8.878654\n10X74_4_A_1:CGTGATGAGAAGGCx  9.678166  0.000000  8.985081  0.000000  0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx  9.028611  0.000000 10.414815  9.028611  0.000000\n                              Ndufaf2    Hmgb3    Rps10     Rae1     Snrpb\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.000000 9.528994  0.00000 0.000000 10.222104\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000 0.000000 10.87696 0.000000  9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx  0.000000 9.207514 10.81687 0.000000  9.900611\n10X73_3_A_1:GTTAACCTTGTCGAx  9.977173 9.977173 10.82444 0.000000 10.824445\n10X74_4_A_1:CGTGATGAGAAGGCx 10.594419 0.000000 10.77674 8.985081  9.678166\n10X73_3_A_1:AAGCACTGCTTCGCx  9.028611 0.000000 10.12714 9.028611  9.721698\n                                 Mbd3     Eif3c     Rpl12   Rpl13a     Rps12\n10X74_4_A_1:CAGCGTCTCCTCGTx 10.222104  9.528994  0.000000  0.00000  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx  9.778387 10.876962 10.876962 10.87696  9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx  0.000000  9.207514 10.999190 11.28687 10.593733\n10X73_3_A_1:GTTAACCTTGTCGAx  9.977173  0.000000  8.878654 10.82444 10.264844\n10X74_4_A_1:CGTGATGAGAAGGCx  0.000000  8.985081 10.930884 10.93088 10.371281\n10X73_3_A_1:AAGCACTGCTTCGCx  0.000000  9.028611  9.721698 10.97442 10.414815\n                               Rpl39     Rps3    Snrpd2     Rps21     Uqcrh\n10X74_4_A_1:CAGCGTCTCCTCGTx 0.000000 10.22210  9.528994  9.528994  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx 0.000000 10.87696  0.000000  0.000000  9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx 0.000000 10.81687  9.207514 10.593733 10.593733\n10X73_3_A_1:GTTAACCTTGTCGAx 9.571731 11.07575 10.670297  8.878654  9.571731\n10X74_4_A_1:CGTGATGAGAAGGCx 0.000000 11.46987 10.776736 10.371281  0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx 9.028611 10.41482  0.000000 10.127143  9.721698\n                                Rpl38    Rps25     Pfdn5    Saraf     Rps28\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.000000 10.62756  0.000000 0.000000  9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000 10.47151  9.778387 0.000000 10.471506\n10X64_3_A_1:ACGCCGGAGGATTCx 10.306059 10.59373 10.593733 9.207514 10.593733\n10X73_3_A_1:GTTAACCTTGTCGAx  8.878654 10.67030 10.264844 8.878654  9.571731\n10X74_4_A_1:CGTGATGAGAAGGCx  9.678166 11.18219 10.776736 9.678166 11.064413\n10X73_3_A_1:AAGCACTGCTTCGCx 10.637953 10.12714 11.225729 9.028611 10.974418\n                                Rps27    Ndufa7      Gnaq     Rpl34    Gm2000\n10X74_4_A_1:CAGCGTCTCCTCGTx 11.320692  0.000000  0.000000  9.528994  0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx  9.778387  9.778387  9.778387  9.778387  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 11.153338  0.000000  9.207514  9.207514 10.306059\n10X73_3_A_1:GTTAACCTTGTCGAx 10.670297  8.878654 10.264844 10.957974  9.571731\n10X74_4_A_1:CGTGATGAGAAGGCx 10.776736 10.594419  0.000000 10.371281 10.594419\n10X73_3_A_1:AAGCACTGCTTCGCx 10.974418  0.000000  9.721698 10.820270  9.028611\n                                Rpl27     Pdia3    Rpl35      Sbf2    Atp5e\n10X74_4_A_1:CAGCGTCTCCTCGTx 10.627557  9.528994 10.22210  0.000000 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000 10.876962  0.00000 10.471506 9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx 10.816872  9.207514 10.30606  0.000000 9.900611\n10X73_3_A_1:GTTAACCTTGTCGAx  9.977173  9.571731 11.07575  9.977173 9.977173\n10X74_4_A_1:CGTGATGAGAAGGCx 10.930884  8.985081 11.28755  8.985081 9.678166\n10X73_3_A_1:AAGCACTGCTTCGCx 10.127143 10.820270 11.10795  0.000000 9.028611\n                            X4930402H24Rik    Ppm1l     Itfg1   Large1\n10X74_4_A_1:CAGCGTCTCCTCGTx       9.528994 0.000000  0.000000 0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx       9.778387 0.000000 10.876962 9.778387\n10X64_3_A_1:ACGCCGGAGGATTCx       0.000000 0.000000  9.207514 9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx       9.977173 0.000000  9.977173 0.000000\n10X74_4_A_1:CGTGATGAGAAGGCx       8.985081 8.985081  0.000000 0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx       0.000000 9.028611  0.000000 0.000000\n                                 Ktn1 Nipsnap3b   Tmem57    Timm8b      Swi5\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.000000  0.000000 9.528994  9.528994  0.000000\n10X74_4_A_1:GTCCACTGTCCTCGx 10.876962  0.000000 9.778387  0.000000  0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx  0.000000  9.207514 0.000000  9.900611 10.816872\n10X73_3_A_1:GTTAACCTTGTCGAx  8.878654  9.571731 8.878654  9.571731  9.977173\n10X74_4_A_1:CGTGATGAGAAGGCx  0.000000  0.000000 8.985081  8.985081  0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx  9.028611  9.721698 9.721698 10.414815  9.721698\n                                Acat2   Hmgcs1    Prmt2    Kif1a   Camta1\n10X74_4_A_1:CAGCGTCTCCTCGTx  9.528994 9.528994 0.000000 0.000000 9.528994\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000 9.778387 0.000000 0.000000 0.000000\n10X64_3_A_1:ACGCCGGAGGATTCx 10.306059 0.000000 0.000000 0.000000 9.207514\n10X73_3_A_1:GTTAACCTTGTCGAx  8.878654 9.977173 0.000000 9.571731 9.571731\n10X74_4_A_1:CGTGATGAGAAGGCx  8.985081 8.985081 9.678166 0.000000 0.000000\n10X73_3_A_1:AAGCACTGCTTCGCx  9.721698 0.000000 0.000000 0.000000 9.028611\n                               Tnrc6c    Kifap3 COTAN_Cl.code\n10X74_4_A_1:CAGCGTCTCCTCGTx  0.000000 10.915233             0\n10X74_4_A_1:GTCCACTGTCCTCGx  0.000000 10.471506             0\n10X64_3_A_1:ACGCCGGAGGATTCx  0.000000  0.000000             1\n10X73_3_A_1:GTTAACCTTGTCGAx  8.878654  8.878654             1\n10X74_4_A_1:CGTGATGAGAAGGCx  0.000000  0.000000             1\n10X73_3_A_1:AAGCACTGCTTCGCx 10.127143  0.000000             1\n\n\n\n# Fit the model\nmodel &lt;- glm( COTAN_Cl.code ~., data = train.data, family = binomial,control = list(maxit = 50))\n# Summarize the model\nsummary(model)\n\n\nCall:\nglm(formula = COTAN_Cl.code ~ ., family = binomial, data = train.data, \n    control = list(maxit = 50))\n\nCoefficients:\n                 Estimate Std. Error z value Pr(&gt;|z|)\n(Intercept)    -7.945e+01  1.249e+06       0        1\nFlrt2           9.669e-02  4.410e+04       0        1\nSmarca2         5.568e-01  4.302e+04       0        1\nSrgap1          4.766e-01  4.205e+04       0        1\nSla             2.602e-01  5.163e+04       0        1\nCadps           5.389e-01  6.198e+04       0        1\nKcnk10         -1.342e+00  4.222e+04       0        1\nItpr1          -4.206e-01  3.758e+04       0        1\nKlhl29          4.027e-02  4.655e+04       0        1\nElmod1          2.079e-01  5.005e+04       0        1\nNin            -6.937e-01  4.213e+04       0        1\nKcnn2          -6.294e-01  4.782e+04       0        1\nAdgrb3          1.102e-01  4.018e+04       0        1\nFoxp1          -5.355e-01  4.032e+04       0        1\nAlcam           4.855e-02  3.849e+04       0        1\nMtss1           5.612e-01  5.163e+04       0        1\nFam213a        -3.578e-01  4.409e+04       0        1\nRalgps2        -4.821e-01  4.810e+04       0        1\nPtn             4.191e-01  4.797e+04       0        1\nCadm2          -3.072e-01  4.587e+04       0        1\nFrmd4a         -2.013e-01  4.167e+04       0        1\nNkain2          2.208e-02  4.750e+04       0        1\nTenm3           3.983e-02  3.346e+04       0        1\nGrip1          -9.333e-02  3.512e+04       0        1\nTanc2          -8.738e-02  4.168e+04       0        1\nSyt11           2.753e-01  4.338e+04       0        1\nSrgap3         -8.834e-02  3.477e+04       0        1\nPak7           -2.762e-01  4.729e+04       0        1\nMapk10         -3.358e-01  4.754e+04       0        1\nSobp           -2.577e-01  4.338e+04       0        1\nBhlhe22        -4.408e-02  3.406e+04       0        1\nEpha3           5.588e-02  4.989e+04       0        1\nAdgrl3         -5.449e-01  4.915e+04       0        1\nDok5            7.224e-01  4.131e+04       0        1\nSatb2           1.647e-03  4.448e+04       0        1\nHs6st2         -3.578e-01  5.633e+04       0        1\nX5730522E02Rik  5.379e-01  6.060e+04       0        1\nMsra           -1.336e-01  3.967e+04       0        1\nSpock1          4.897e-01  5.340e+04       0        1\nEnc1           -9.539e-01  3.439e+04       0        1\nFam110b        -5.607e-01  5.919e+04       0        1\nSybu            3.880e-01  4.917e+04       0        1\nLmo1           -1.989e-01  4.912e+04       0        1\nDscam           2.017e-01  4.326e+04       0        1\nRab3c          -7.815e-01  5.240e+04       0        1\nMir124.2hg     -4.134e-01  4.864e+04       0        1\nClstn2          4.551e-01  5.271e+04       0        1\nFat3           -8.711e-01  2.733e+04       0        1\nKcnh7          -5.668e-01  4.513e+04       0        1\nUsp29           4.330e-01  4.419e+04       0        1\nCd47           -2.179e-01  5.528e+04       0        1\nRyr3           -6.230e-01  3.575e+04       0        1\nNeto2          -8.651e-01  4.378e+04       0        1\nPpm1e           9.175e-01  3.048e+04       0        1\nMdga2          -5.625e-01  4.444e+04       0        1\nSerpini1       -1.806e-01  3.139e+04       0        1\nRalyl          -5.850e-01  3.726e+04       0        1\nNrcam           5.969e-01  5.130e+04       0        1\nRobo2           1.562e-01  5.022e+04       0        1\nCsrnp3          3.255e-01  4.258e+04       0        1\nHist3h2ba       9.792e-01  6.362e+04       0        1\nJakmip1         6.290e-01  4.494e+04       0        1\nEdil3           2.458e-01  5.274e+04       0        1\nEnox1          -3.492e-01  3.551e+04       0        1\nRprm           -6.761e-01  4.755e+04       0        1\nOlfm1          -6.009e-01  3.843e+04       0        1\nTmem178b       -3.975e-01  3.395e+04       0        1\nGng3           -5.421e-01  5.404e+04       0        1\nCntn2          -1.805e-01  3.823e+04       0        1\nScg3            1.909e-01  4.486e+04       0        1\nGnao1           1.284e+00  4.718e+04       0        1\nSerp2           1.339e+00  5.653e+04       0        1\nPcdh9           4.828e-01  4.228e+04       0        1\nTrim2           1.045e+00  3.278e+04       0        1\nNrg1           -1.721e-01  3.936e+04       0        1\nPpfia2         -5.492e-01  4.253e+04       0        1\nCacna2d1       -3.999e-01  4.381e+04       0        1\nUqcrq           1.761e+00  4.632e+04       0        1\nNdufs6         -5.486e-02  6.232e+04       0        1\nPpp1cb          3.328e-01  3.466e+04       0        1\nNdufaf2         2.087e-01  4.163e+04       0        1\nHmgb3           1.739e-01  6.558e+04       0        1\nRps10           1.753e+00  7.688e+04       0        1\nRae1            4.493e-01  4.665e+04       0        1\nSnrpb           1.501e-01  5.735e+04       0        1\nMbd3           -1.508e-01  4.537e+04       0        1\nEif3c           3.066e-01  2.789e+04       0        1\nRpl12           5.480e-01  6.321e+04       0        1\nRpl13a          1.490e+00  6.668e+04       0        1\nRps12           4.958e-01  4.057e+04       0        1\nRpl39           7.737e-02  4.342e+04       0        1\nRps3           -8.192e-01  8.276e+04       0        1\nSnrpd2         -1.881e-02  4.609e+04       0        1\nRps21           6.968e-01  6.075e+04       0        1\nUqcrh           7.500e-01  5.003e+04       0        1\nRpl38           1.977e+00  5.107e+04       0        1\nRps25           7.018e-01  7.171e+04       0        1\nPfdn5           9.737e-01  5.047e+04       0        1\nSaraf          -2.046e-02  4.546e+04       0        1\nRps28           6.424e-01  5.766e+04       0        1\nRps27           1.096e+00  6.508e+04       0        1\nNdufa7         -3.613e-02  6.935e+04       0        1\nGnaq           -1.607e+00  4.105e+04       0        1\nRpl34           7.638e-01  7.047e+04       0        1\nGm2000          1.596e+00  6.006e+04       0        1\nRpl27           6.610e-01  8.154e+04       0        1\nPdia3           5.276e-02  4.427e+04       0        1\nRpl35           5.017e-01  6.780e+04       0        1\nSbf2           -7.538e-01  4.982e+04       0        1\nAtp5e          -3.677e-02  4.550e+04       0        1\nX4930402H24Rik -2.239e-01  4.575e+04       0        1\nPpm1l          -2.472e-02  4.542e+04       0        1\nItfg1          -5.769e-01  3.699e+04       0        1\nLarge1         -1.508e+00  5.156e+04       0        1\nKtn1            1.685e-01  3.577e+04       0        1\nNipsnap3b       5.160e-01  4.255e+04       0        1\nTmem57          3.480e-01  3.485e+04       0        1\nTimm8b          1.778e-01  3.494e+04       0        1\nSwi5            4.639e-01  6.260e+04       0        1\nAcat2          -1.723e-01  3.157e+04       0        1\nHmgcs1         -2.428e-01  4.074e+04       0        1\nPrmt2           5.547e-01  3.435e+04       0        1\nKif1a          -1.959e+00  3.366e+04       0        1\nCamta1         -2.208e-01  3.990e+04       0        1\nTnrc6c         -4.644e-01  5.866e+04       0        1\nKifap3         -2.284e-01  4.404e+04       0        1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 5.1795e+02  on 431  degrees of freedom\nResidual deviance: 4.0943e-10  on 306  degrees of freedom\nAIC: 252\n\nNumber of Fisher Scoring iterations: 28\n\n# Make predictions\nprobabilities &lt;- model %&gt;% predict(test.data, type = \"response\")\npredicted.classes &lt;- ifelse(probabilities &gt; 0.5, \"1\", \"0\")\n# Model accuracy\naccuracy &lt;- mean(predicted.classes == test.data$COTAN_Cl.code)\nresult.df[nrow(result.df),\"Accuracy\"] &lt;- accuracy\n\naccuracy\n\n[1] 0.9166667\n\n\nSo also in this case a logistic regression confirm the difference in cell population detected by COTAN.\n\ncl511e15.0ClsMarkers &lt;- findClustersMarkers(cl511e15.0,n = 200,adjustmentMethod = \"BH\")\ncl511e15.0ClsMarkers\n\n    CL           Gene        DEA      adjPVal IsMarker  logFoldCh\n1    1          Rps12 -0.4631574 6.179304e-23        0 -0.6825116\n2    1          Atp5e -0.4421507 5.491674e-21        0 -0.6826112\n3    1          Rpl12 -0.4249280 2.145989e-19        0 -0.5752903\n4    1         Gm2000 -0.4178094 8.266734e-19        0 -0.7062262\n5    1          Rpl27 -0.4101463 3.545306e-18        0 -0.4851285\n6    1          Rpl35 -0.4095642 3.545306e-18        0 -0.6420850\n7    1          Rpl38 -0.3944000 8.478137e-17        0 -0.4901851\n8    1          Rpl34 -0.3839938 6.783729e-16        0 -0.5340951\n9    1         Rpl13a -0.3816076 9.935167e-16        0 -0.4674161\n10   1          Rps27 -0.3776191 2.046247e-15        0 -0.5241613\n11   1           Rps3 -0.3674962 1.463958e-14        0 -0.5091646\n12   1          Rps21 -0.3610531 4.848936e-14        0 -0.4306092\n13   1          Rps13 -0.3572065 9.536353e-14        0 -0.4967312\n14   1          Rps29 -0.3548193 1.410408e-13        0 -0.4107293\n15   1          Uqcrh -0.3468007 6.147911e-13        0 -0.4208264\n16   1         Rps15a -0.3458429 6.912919e-13        0 -0.5734880\n17   1          Pfdn5 -0.3412558 1.543625e-12        0 -0.4357714\n18   1         Uqcr10 -0.3369860 3.225511e-12        0 -0.4964385\n19   1          Rps26 -0.3311185 8.957326e-12        0 -0.5340777\n20   1          Rps18 -0.3305680 9.404136e-12        0 -0.4596902\n21   1           Tpt1 -0.3299757 9.821432e-12        0 -0.4076206\n22   1           Pomp -0.3298025 9.821432e-12        0 -0.4368943\n23   1          Uqcrq -0.3293949 1.011334e-11        0 -0.4547596\n24   1          Rps10 -0.3272393 1.429376e-11        0 -0.4795864\n25   1         Timm8b -0.3243765 2.202010e-11        0 -0.4229584\n26   1          Rps25 -0.3237942 2.352031e-11        0 -0.4375944\n27   1           Pfn1 -0.3207294 3.901832e-11        0 -0.4524917\n28   1       Atp6v1g1 -0.3200480 4.247356e-11        0 -0.3852555\n29   1         Snrpd2 -0.3191408 4.809087e-11        0 -0.4236104\n30   1      Hist3h2ba -0.3189606 4.809087e-11        0 -0.4143786\n31   1          Rpl37 -0.3182726 5.113078e-11        0 -0.5620636\n32   1         Ndufs6 -0.3181898 5.113078e-11        0 -0.4034311\n33   1        Atp5o.1 -0.3180827 5.113078e-11        0 -0.4328550\n34   1         Snrpd1 -0.3153742 7.959216e-11        0 -0.4110424\n35   1        Dynlrb1 -0.3138158 1.013177e-10        0 -0.4016523\n36   1         Uqcr11 -0.3127960 1.175129e-10        0 -0.3977030\n37   1         Rpl35a -0.3107331 1.629691e-10        0 -0.4733195\n38   1           Btf3 -0.3105683 1.633253e-10        0 -0.3262416\n39   1           Swi5 -0.3089875 2.084660e-10        0 -0.3992487\n40   1          Rps20 -0.3085851 2.163449e-10        0 -0.4357840\n41   1          Rps28 -0.3084818 2.163449e-10        0 -0.3976983\n42   1          Rpl31 -0.3080980 2.255272e-10        0 -0.3883420\n43   1         Ndufa7 -0.3058711 3.210511e-10        0 -0.3983718\n44   1           Tbca -0.3008359 7.277351e-10        0 -0.4041754\n45   1          Snrpb -0.3004162 7.631375e-10        0 -0.3556668\n46   1          Rplp2 -0.2994340 8.784554e-10        0 -0.3876488\n47   1          Rpl28 -0.2980796 1.052945e-09        0 -0.4146471\n48   1          Uqcc2 -0.2963589 1.340886e-09        0 -0.5371598\n49   1          Rpl36 -0.2959873 1.397320e-09        0 -0.3646947\n50   1           Edf1 -0.2907873 3.178356e-09        0 -0.3900142\n51   1          Fkbp3 -0.2887652 4.309332e-09        0 -0.3556366\n52   1          Rps24 -0.2855195 6.948539e-09        0 -0.4770224\n53   1           Gpx4 -0.2835266 9.334702e-09        0 -0.3245309\n54   1           Bex3 -0.2811619 1.303730e-08        0 -0.3180195\n55   1          Rps16 -0.2797315 1.599893e-08        0 -0.4247866\n56   1          Tomm7 -0.2794463 1.619178e-08        0 -0.4093449\n57   1          Hspe1 -0.2791884 1.656933e-08        0 -0.3462706\n58   1         Chchd1 -0.2776055 2.048508e-08        0 -0.4354694\n59   1          Rpl17 -0.2772519 2.129819e-08        0 -0.5191041\n60   1          Atp5k -0.2762977 2.391943e-08        0 -0.4740455\n61   1           Svbp -0.2760335 2.454234e-08        0 -0.3014819\n62   1         Atp5c1 -0.2745657 3.024473e-08        0 -0.2363772\n63   1          Eif3k -0.2733174 3.508935e-08        0 -0.3840566\n64   1          Sumo1 -0.2733073 3.508935e-08        0 -0.2914956\n65   1         Timm13 -0.2727718 3.702865e-08        0 -0.3686286\n66   1         Mrpl30 -0.2720558 4.017398e-08        0 -0.4749261\n67   1           Sem1 -0.2709400 4.629720e-08        0 -0.3741535\n68   1          Usmg5 -0.2698157 5.342106e-08        0 -0.3823320\n69   1          Rpl22 -0.2684437 6.472822e-08        0 -0.3428325\n70   1          Snrpg -0.2676395 7.204825e-08        0 -0.3005801\n71   1          Snrpf -0.2669220 7.916026e-08        0 -0.3441404\n72   1           Txn1 -0.2665875 8.218961e-08        0 -0.3887734\n73   1         Rps3a1 -0.2649592 1.008742e-07        0 -0.4636491\n74   1           Nol7 -0.2647717 1.025205e-07        0 -0.4529087\n75   1         Myl12b -0.2633126 1.217868e-07        0 -0.3769849\n76   1          Rpl7a -0.2628953 1.276785e-07        0 -0.3803800\n77   1          Cirbp -0.2626861 1.302382e-07        0 -0.2427524\n78   1         Ndufv3 -0.2624217 1.339336e-07        0 -0.3777157\n79   1         Rps27l -0.2612837 1.563403e-07        0 -0.5679664\n80   1         Rpl37a -0.2606170 1.704016e-07        0 -0.5219644\n81   1           Cycs -0.2595830 1.938262e-07        0 -0.3851088\n82   1         Rpl36a -0.2587267 2.134566e-07        0 -0.2850982\n83   1        Anapc13 -0.2587054 2.134566e-07        0 -0.4999552\n84   1          Smdt1 -0.2574564 2.478866e-07        0 -0.3049345\n85   1           Sdhb -0.2573936 2.478866e-07        0 -0.3655544\n86   1         Mrpl52 -0.2566519 2.729649e-07        0 -0.3746260\n87   1         Ranbp1 -0.2564555 2.745307e-07        0 -0.2617357\n88   1 X0610012G03Rik -0.2564191 2.745307e-07        0 -0.4450968\n89   1         Csnk2b -0.2562342 2.750654e-07        0 -0.3913248\n90   1          Rps17 -0.2562178 2.750654e-07        0 -0.4469891\n91   1         Chchd2 -0.2560472 2.793599e-07        0 -0.4363077\n92   1          Rpl21 -0.2552685 3.066352e-07        0 -0.3799537\n93   1          Hmgb1 -0.2548369 3.231737e-07        0 -0.3340397\n94   1         Mrpl28 -0.2536164 3.806468e-07        0 -0.4316112\n95   1          Rtraf -0.2534402 3.869427e-07        0 -0.2697156\n96   1          Cops9 -0.2500670 5.951063e-07        0 -0.3814245\n97   1          Atox1 -0.2499292 5.970482e-07        0 -0.4098502\n98   1          Rplp1 -0.2493355 6.431863e-07        0 -0.4307723\n99   1         Hnrnpc -0.2478595 7.764310e-07        0 -0.2664530\n100  1         Mrps17 -0.2474809 8.116952e-07        0 -0.4752512\n101  1           Vapa -0.2468766 8.721894e-07        0 -0.2749610\n102  1          Hmgn1 -0.2467652 8.754427e-07        0 -0.2649146\n103  1          Rps23 -0.2450458 1.067455e-06        0 -0.4578971\n104  1          Atp5h -0.2448166 1.093425e-06        0 -0.3256882\n105  1        Tmem256 -0.2442493 1.164429e-06        0 -0.3865038\n106  1         Dctpp1 -0.2439550 1.203392e-06        0 -0.2977997\n107  1        Hnrnpab -0.2435611 1.243292e-06        0 -0.2954051\n108  1          Pcbp2 -0.2424633 1.432268e-06        0 -0.3170388\n109  1         Tceal9 -0.2415600 1.595730e-06        0 -0.2648281\n110  1        Lamtor5 -0.2396741 2.026750e-06        0 -0.4350606\n111  1        Ndufb10 -0.2369256 2.845753e-06        0 -0.2863959\n112  1          Cox7c -0.2369182 2.845753e-06        0 -0.2824851\n113  1           Oaz1 -0.2366414 2.932600e-06        0 -0.2739040\n114  1         Scand1 -0.2362110 3.045776e-06        0 -0.4189525\n115  1         Polr2j -0.2362091 3.045776e-06        0 -0.2842206\n116  1          Rpl10 -0.2359108 3.147805e-06        0 -0.4748902\n117  1          Pfdn4 -0.2355480 3.280891e-06        0 -0.4199890\n118  1          Rps19 -0.2350084 3.456874e-06        0 -0.5025216\n119  1         Rpl10a -0.2349587 3.458358e-06        0 -0.3144984\n120  1           Nme1 -0.2348907 3.468223e-06        0 -0.2836137\n121  1          Arpc3 -0.2343649 3.670787e-06        0 -0.3467814\n122  1            Ran -0.2336881 3.939102e-06        0 -0.2541407\n123  1           Rnf7 -0.2330448 4.257928e-06        0 -0.3808571\n124  1           Bex2 -0.2329246 4.299934e-06        0 -0.2931452\n125  1         Snrpd3 -0.2324171 4.517130e-06        0 -0.4085823\n126  1        Gm10260 -0.2324063 4.517130e-06        0 -0.3556503\n127  1          Cox7b -0.2323683 4.517130e-06        0 -0.2699185\n128  1          H2afz -0.2321814 4.601751e-06        0 -0.3482270\n129  1          Ddah2 -0.2317266 4.853274e-06        0 -0.3249683\n130  1           Tbcb -0.2312374 5.112467e-06        0 -0.2296635\n131  1         Atp5j2 -0.2304235 5.636766e-06        0 -0.2909852\n132  1         Cox6b1 -0.2303935 5.636766e-06        0 -0.2710346\n133  1          Atp5j -0.2299245 5.889998e-06        0 -0.2785515\n134  1        Uqcrfs1 -0.2295070 6.115004e-06        0 -0.2729393\n135  1         Txnl4a -0.2284923 6.924840e-06        0 -0.4264706\n136  1         Mrps24 -0.2284003 6.969881e-06        0 -0.4010231\n137  1 X1110004F10Rik -0.2278742 7.413813e-06        0 -0.2576501\n138  1            Mif -0.2278143 7.431771e-06        0 -0.3175502\n139  1         Mrpl18 -0.2263196 8.711184e-06        0 -0.3538738\n140  1          Crip2 -0.2262740 8.717744e-06        0 -0.2328728\n141  1          Hsbp1 -0.2253209 9.566588e-06        0 -0.2581882\n142  1          Rpl19 -0.2253162 9.566588e-06        0 -0.3885120\n143  1          Rps11 -0.2251889 9.657436e-06        0 -0.3842770\n144  1         Rpl23a -0.2250230 9.813642e-06        0 -0.4333352\n145  1           Ubl5 -0.2248595 9.969336e-06        0 -0.3088737\n146  1        Ndufab1 -0.2238181 1.114580e-05        0 -0.3859670\n147  1         Atp5g1 -0.2231727 1.188843e-05        0 -0.2660431\n148  1           Rps6 -0.2231526 1.188843e-05        0 -0.3939822\n149  1          Eif3h -0.2230063 1.205170e-05        0 -0.2308491\n150  1          Pdcd5 -0.2227795 1.232027e-05        0 -0.3465369\n151  1         Zfp706 -0.2225782 1.248254e-05        0 -0.2112568\n152  1         Abracl -0.2213980 1.419549e-05        0 -0.2750669\n153  1          Pfdn6 -0.2209395 1.476171e-05        0 -0.4071708\n154  1          Prdx5 -0.2209157 1.476171e-05        0 -0.2559431\n155  1          Calm3 -0.2207705 1.494358e-05        0 -0.2573251\n156  1         Rex1bd -0.2205505 1.528890e-05        0 -0.4203590\n157  1            Esd -0.2203731 1.556032e-05        0 -0.2975594\n158  1          Psma2 -0.2203299 1.557673e-05        0 -0.2819089\n159  1         Dynll1 -0.2199227 1.610340e-05        0 -0.3676117\n160  1          Rpl15 -0.2194056 1.680821e-05        0 -0.2895195\n161  1          Glrx3 -0.2183435 1.868363e-05        0 -0.1083442\n162  1        Selenow -0.2181378 1.885712e-05        0 -0.3930863\n163  1           Gpx1 -0.2178310 1.949947e-05        0 -0.5381608\n164  1         Ndufa2 -0.2176474 1.980926e-05        0 -0.3264260\n165  1         Sec61b -0.2175938 1.983788e-05        0 -0.3811968\n166  1         Mrpl58 -0.2174523 1.995077e-05        0 -0.4914635\n167  1          Psma7 -0.2172906 2.020019e-05        0 -0.2739562\n168  1          Bcas2 -0.2172874 2.020019e-05        0 -0.3158613\n169  1          Srp14 -0.2170688 2.066579e-05        0 -0.2990073\n170  1          Nop10 -0.2166143 2.148915e-05        0 -0.3118031\n171  1         Rpl27a -0.2166118 2.148915e-05        0 -0.2738241\n172  1         Eif2s2 -0.2163760 2.189740e-05        0 -0.2296548\n173  1       Trappc2l -0.2156588 2.366951e-05        0 -0.3406024\n174  1          H3f3a -0.2155267 2.374037e-05        0 -0.3079225\n175  1         Gtf2h5 -0.2153756 2.409031e-05        0 -0.3434282\n176  1           Sub1 -0.2151238 2.465546e-05        0 -0.2508421\n177  1           Naca -0.2145087 2.636167e-05        0 -0.3565910\n178  1           Rpl7 -0.2135409 2.888891e-05        0 -0.3706477\n179  1          Ppdpf -0.2133283 2.942934e-05        0 -0.3391216\n180  1          Rpl24 -0.2132538 2.959067e-05        0 -0.4690503\n181  1        Gm10076 -0.2127651 3.115539e-05        0 -0.4772046\n182  1         Ndufb2 -0.2126279 3.145520e-05        0 -0.3525210\n183  1         Cox7a2 -0.2122745 3.258735e-05        0 -0.2379424\n184  1          Rpl18 -0.2119888 3.360081e-05        0 -0.2748972\n185  1           Rpl5 -0.2112880 3.615233e-05        0 -0.2924973\n186  1           Jund -0.2110193 3.712070e-05        0 -0.2279356\n187  1         Ndufc1 -0.2110091 3.712070e-05        0 -0.3252872\n188  1         Ndufb4 -0.2104183 3.954536e-05        0 -0.3979775\n189  1         Rps27a -0.2103446 3.976090e-05        0 -0.4295827\n190  1          Slirp -0.2102817 3.992712e-05        0 -0.4121032\n191  1            Fau -0.2100702 4.080285e-05        0 -0.4027868\n192  1         Ndufb8 -0.2095109 4.343912e-05        0 -0.2659853\n193  1        Txndc17 -0.2090668 4.521167e-05        0 -0.3694520\n194  1          Rpl32 -0.2083948 4.832366e-05        0 -0.5548520\n195  1          Ap2s1 -0.2082741 4.880111e-05        0 -0.2605882\n196  1        Gabarap -0.2080173 4.988644e-05        0 -0.2959616\n197  1        Smarcb1 -0.2080058 4.988644e-05        0 -0.2851375\n198  1          H2afj -0.2078339 5.073976e-05        0 -0.3315896\n199  1         Cacybp -0.2065095 5.741582e-05        0 -0.2614856\n200  1           Grm8 -0.2057302 6.118469e-05        0 -0.4215947\n201  1         Spock1  0.3251712 1.987472e-11        0  0.4817711\n202  1          Itfg1  0.2992721 8.834105e-10        0  0.3776583\n203  1        Serinc1  0.2965515 1.325342e-09        0  0.3825097\n204  1          Mdga2  0.2874687 5.199010e-09        0  0.4623846\n205  1           Ctsz  0.2824571 1.084179e-08        0  0.3565810\n206  1           Ryr3  0.2794415 1.619178e-08        0  0.4376830\n207  1          Ntrk3  0.2778532 2.002950e-08        0  0.3451647\n208  1          Mef2c  0.2768192 2.241673e-08        0  0.3636640\n209  1        Atp6ap2  0.2740521 3.223350e-08        0  0.3668009\n210  1         Sec11a  0.2731492 3.545140e-08        0  0.3837498\n211  1          Kat6b  0.2721583 4.007938e-08        0  0.4746228\n212  1        Atp6ap1  0.2712290 4.490246e-08        0  0.4142084\n213  1         Ctnnd2  0.2699332 5.314820e-08        0  0.3439896\n214  1           E2f7  0.2657007 9.256857e-08        0  0.8375014\n215  1           Sez6  0.2651659 9.898526e-08        0  0.3790612\n216  1         Tspan6  0.2641584 1.109053e-07        0  0.3765847\n217  1            App  0.2634301 1.217868e-07        0  0.3262137\n218  1          Mmp16  0.2632929 1.217868e-07        0  0.4886848\n219  1          Pcdh7  0.2605192 1.710786e-07        0  0.5049982\n220  1         Tspan3  0.2587958 2.134566e-07        0  0.2605555\n221  1          Aplp1  0.2586314 2.136606e-07        0  0.3496143\n222  1       Tmem131l  0.2581351 2.272127e-07        0  0.3784208\n223  1        Tspan14  0.2564934 2.745307e-07        0  0.3872160\n224  1         Igfbp2  0.2563489 2.748074e-07        0  0.3220609\n225  1         Arpp21  0.2559159 2.821614e-07        0  0.4396613\n226  1          Cadm1  0.2524424 4.414279e-07        0  0.4311111\n227  1         Slc1a3  0.2518736 4.739210e-07        0  0.5677610\n228  1          Qsox1  0.2518176 4.739210e-07        0  0.9440026\n229  1         Srgap1  0.2516320 4.824444e-07        0  0.3802237\n230  1          Dclk2  0.2499866 5.970152e-07        0  0.4091429\n231  1            Nin  0.2489162 6.763137e-07        0  0.3054527\n232  1        Txndc12  0.2468470 8.721894e-07        0  0.4258825\n233  1          Ssbp2  0.2459584 9.673892e-07        0  0.3774376\n234  1          Hspa5  0.2459273 9.673892e-07        0  0.3800562\n235  1            St7  0.2456147 1.002214e-06        0  0.4031442\n236  1           Rpn2  0.2451179 1.064678e-06        0  0.3923588\n237  1          Tusc3  0.2444387 1.142901e-06        0  0.3801631\n238  1          Tanc2  0.2438393 1.213928e-06        0  0.3503723\n239  1          Cntn1  0.2437268 1.224079e-06        0  0.4232511\n240  1        Kirrel3  0.2422930 1.455623e-06        0  0.4714545\n241  1          Stmn4  0.2398730 1.986851e-06        0  0.3311401\n242  1          Nfasc  0.2394718 2.068456e-06        0  0.4271409\n243  1           Copa  0.2370049 2.845753e-06        0  0.3776922\n244  1         Tmem59  0.2363463 3.029398e-06        0  0.2633921\n245  1           Psap  0.2354093 3.320500e-06        0  0.3226806\n246  1         Slc8a1  0.2351693 3.405560e-06        0  0.2340766\n247  1           Nrg3  0.2345848 3.588172e-06        0  0.3859916\n248  1           Cdh2  0.2342571 3.700757e-06        0  0.3735728\n249  1           Nptn  0.2336952 3.939102e-06        0  0.3492779\n250  1           Scg5  0.2327820 4.355076e-06        0  0.3128342\n251  1          Sgip1  0.2314536 4.999485e-06        0  0.3421051\n252  1        Arl6ip1  0.2302790 5.689163e-06        0  0.3017192\n253  1           Aig1  0.2299854 5.875742e-06        0  0.2858523\n254  1         Dnajc1  0.2298029 5.950542e-06        0  0.3192334\n255  1           Eya3  0.2295743 6.094840e-06        0  0.4881567\n256  1          Scn2a  0.2275217 7.673573e-06        0  0.3877597\n257  1          Neto2  0.2272724 7.854626e-06        0  0.3386953\n258  1          Ccnl2  0.2272571 7.854626e-06        0  0.2805397\n259  1           Snd1  0.2266029 8.489998e-06        0  0.4687846\n260  1           Itch  0.2264309 8.632912e-06        0  0.4055109\n261  1           Smg5  0.2258127 9.194418e-06        0  0.4186320\n262  1         Dhcr24  0.2257498 9.221748e-06        0  0.5983321\n263  1         Atp2b1  0.2256716 9.267149e-06        0  0.3856881\n264  1           Ctsb  0.2253026 9.566588e-06        0  0.3407802\n265  1           Nav3  0.2247291 1.008567e-05        0  0.2492735\n266  1        Fam214a  0.2245914 1.021286e-05        0  0.5798609\n267  1         Hs2st1  0.2245436 1.022577e-05        0  0.4343860\n268  1          Acvr1  0.2237108 1.124361e-05        0  0.4732941\n269  1        Gm43507  0.2233813 1.166148e-05        0  0.6365634\n270  1          Tmtc1  0.2227560 1.232027e-05        0  0.5203901\n271  1       Slc39a10  0.2227061 1.234105e-05        0  0.4692922\n272  1           Chga  0.2220755 1.322746e-05        0  0.4003207\n273  1          Nell2  0.2219452 1.338310e-05        0  0.3165228\n274  1            Tox  0.2217236 1.369482e-05        0  0.2845122\n275  1       Tmem185b  0.2212082 1.446869e-05        0  0.6700758\n276  1           Arnt  0.2211667 1.447939e-05        0  0.5088107\n277  1          Ttc17  0.2209047 1.476171e-05        0  0.4843724\n278  1         Anks1b  0.2202085 1.574453e-05        0  0.2459429\n279  1         Tmbim6  0.2201693 1.575400e-05        0  0.2638407\n280  1       Slc38a10  0.2199521 1.610340e-05        0  0.3700007\n281  1          Olfm2  0.2198541 1.617231e-05        0  0.3518482\n282  1          Kcnq5  0.2195847 1.664727e-05        0  0.4272948\n283  1         Kcnk10  0.2194963 1.675960e-05        0  0.3138762\n284  1           P3h4  0.2194473 1.679117e-05        0  0.8099715\n285  1        Tmem35a  0.2192435 1.707587e-05        0  0.4109415\n286  1            Boc  0.2191374 1.722917e-05        0  0.6010687\n287  1           Akt3  0.2187568 1.797847e-05        0  0.2628117\n288  1            Por  0.2186967 1.800140e-05        0  0.4889486\n289  1        Carmil1  0.2186805 1.800140e-05        0  0.2887406\n290  1           Mtdh  0.2182782 1.875823e-05        0  0.2807799\n291  1        Slc6a15  0.2181696 1.885712e-05        0  0.4716892\n292  1         Leprot  0.2181468 1.885712e-05        0  0.2951880\n293  1        Slc20a1  0.2176376 1.980926e-05        0  0.4314969\n294  1          Klf12  0.2175271 1.992265e-05        0  0.4983598\n295  1          H2.D1  0.2174530 1.995077e-05        0  0.3639213\n296  1          Saraf  0.2170315 2.068118e-05        0  0.3081942\n297  1       Tmem184c  0.2168042 2.118017e-05        0  0.3225185\n298  1          Fgf14  0.2165924 2.148915e-05        0  0.2876250\n299  1        Tmem108  0.2165529 2.151223e-05        0  0.3562990\n300  1          Lrp11  0.2160417 2.271805e-05        0  0.3773354\n301  1           Ldb2  0.2156172 2.366951e-05        0  0.2939618\n302  1           Syt1  0.2155833 2.366951e-05        0  0.3450811\n303  1        Cacna1c  0.2155815 2.366951e-05        0  0.3207911\n304  1          Csmd2  0.2151751 2.459131e-05        0  0.3452957\n305  1          Grik2  0.2145339 2.636167e-05        0  0.4514875\n306  1           Rcn2  0.2144294 2.652000e-05        0  0.2854721\n307  1         Grin2b  0.2143889 2.655527e-05        0  0.3129156\n308  1            Os9  0.2141573 2.720820e-05        0  0.3525981\n309  1         Fnbp1l  0.2141115 2.726253e-05        0  0.2614826\n310  1         Elovl5  0.2136834 2.859818e-05        0  0.5763508\n311  1         Rnf145  0.2135605 2.888891e-05        0  0.3942400\n312  1         Tnrc6c  0.2134860 2.897903e-05        0  0.2655012\n313  1         Ift172  0.2131423 2.988534e-05        0  0.7273950\n314  1         Setbp1  0.2126505 3.145520e-05        0  0.2808616\n315  1         Lrpap1  0.2123968 3.222429e-05        0  0.2556996\n316  1          Cdkl5  0.2119231 3.375163e-05        0  0.3911032\n317  1        Tmem63b  0.2116532 3.473486e-05        0  0.3875314\n318  1         Clstn2  0.2109563 3.723062e-05        0  0.3872830\n319  1           Calr  0.2092966 4.440350e-05        0  0.2802238\n320  1         Cdc14b  0.2092583 4.446097e-05        0  0.7198813\n321  1          Dock3  0.2090612 4.521167e-05        0  0.3741515\n322  1          Ddx50  0.2090289 4.523908e-05        0  0.2860189\n323  1         Ormdl3  0.2087933 4.635939e-05        0  0.3832619\n324  1          Foxp2  0.2083850 4.832366e-05        0  0.5684095\n325  1          Ntrk2  0.2080868 4.972509e-05        0  0.5329103\n326  1          Magi1  0.2076794 5.148581e-05        0  0.4553671\n327  1           Rgma  0.2076559 5.148581e-05        0  0.5780725\n328  1         Ergic2  0.2075656 5.187083e-05        0  0.2655840\n329  1         Zfp846  0.2071862 5.404855e-05        0  0.2995412\n330  1           Sybu  0.2070890 5.449645e-05        0  0.3264942\n331  1        Dync1i1  0.2069879 5.481618e-05        0  0.3032658\n332  1          Camkv  0.2069864 5.481618e-05        0  0.4211762\n333  1          Llgl1  0.2068048 5.581613e-05        0  0.4266499\n334  1           Alg6  0.2066856 5.642350e-05        0  0.9009502\n335  1           Lnpk  0.2063438 5.814647e-05        0  0.3247704\n336  1        Gm20517  0.2063231 5.814647e-05        0  1.1410193\n337  1          Spon1  0.2063231 5.814647e-05        0  1.0616953\n338  1          Trpm3  0.2061229 5.929493e-05        0  0.6898117\n339  1         Pgrmc1  0.2061031 5.929493e-05        0  0.3026805\n340  1           Ctsl  0.2060444 5.952276e-05        0  0.2874709\n341  1        B3galt1  0.2059271 6.015918e-05        0  0.3441872\n342  1        B3galt2  0.2057494 6.118469e-05        0  0.3838402\n343  1        Ldlrad4  0.2054385 6.309715e-05        0  0.3296407\n344  1            Cpe  0.2052019 6.465516e-05        0  0.3516827\n345  1           Emc3  0.2049225 6.619369e-05        0  0.3590846\n346  1          Ttc19  0.2048293 6.671582e-05        0  0.4082099\n347  1       Adamts18  0.2044224 6.971209e-05        0  0.3869474\n348  1         Scube1  0.2040749 7.193151e-05        0  0.4709928\n349  1            Fry  0.2033546 7.767694e-05        0  0.2718307\n350  1          Csmd3  0.2030060 8.037958e-05        0  0.5650582\n351  1          Cd200  0.2028440 8.133106e-05        0  0.2797321\n352  1          Flrt2  0.2028171 8.133106e-05        0  0.4293102\n353  1         Atraid  0.2028083 8.133106e-05        0  0.3129678\n354  1         Alkbh1  0.2026368 8.267641e-05        0  0.4014083\n355  1        Gm26835  0.2023977 8.449163e-05        0  0.4222330\n356  1        Phactr1  0.2021293 8.687322e-05        0  0.2632504\n357  1          Foxp1  0.2015481 9.229412e-05        0  0.2580225\n358  1        Cacna1e  0.2014218 9.336938e-05        0  0.3844196\n359  1           Ssr2  0.2012809 9.461454e-05        0  0.2615975\n360  1         Dopey1  0.2009499 9.769588e-05        0  0.3199163\n361  1         Hivep2  0.2003740 1.034248e-04        0  0.3244790\n362  1          Gdpd1  0.1999223 1.085345e-04        0  0.2925950\n363  1       Tmem132a  0.1998304 1.093707e-04        0  0.2428495\n364  1           Ssh2  0.1996881 1.108396e-04        0  0.3329310\n365  1          Cxadr  0.1995267 1.124015e-04        0  0.3356759\n366  1        Zdhhc20  0.1994962 1.124015e-04        0  0.3232686\n367  1          Cspg5  0.1994202 1.128686e-04        0  0.5253050\n368  1          Ascc3  0.1988958 1.180109e-04        0  0.3602826\n369  1          Myo9a  0.1987511 1.196295e-04        0  0.3474970\n370  1         Nedd4l  0.1981704 1.269985e-04        0  0.2870636\n371  1          Scaf8  0.1978388 1.307762e-04        0  0.3909157\n372  1           Rbl2  0.1974549 1.356099e-04        0  0.7665457\n373  1          Nemp1  0.1974446 1.356099e-04        0  0.5981904\n374  1       B3galnt1  0.1973052 1.373818e-04        0  0.4204007\n375  1        Slitrk5  0.1971875 1.388396e-04        0  0.4541803\n376  1           Fat3  0.1970097 1.409003e-04        0  0.2584599\n377  1          Pdia6  0.1960866 1.555464e-04        0  0.2786742\n378  1         Rnf215  0.1960722 1.555464e-04        0  0.4738305\n379  1       Serpini1  0.1960223 1.556320e-04        0  0.3356833\n380  1         Plppr1  0.1957434 1.597088e-04        0  0.2795475\n381  1           Sbf2  0.1955265 1.623747e-04        0  0.3006908\n382  1         Rnf112  0.1954556 1.632493e-04        0  0.8890006\n383  1           Trio  0.1952968 1.653238e-04        0  0.2908840\n384  1        Slc38a9  0.1947229 1.752457e-04        0  0.3353488\n385  1           Meg3  0.1946101 1.770021e-04        0  0.3784197\n386  1          Adcy3  0.1943568 1.811160e-04        0  0.5909601\n387  1          Epha7  0.1943252 1.813108e-04        0  0.4107213\n388  1           St7l  0.1940574 1.849371e-04        0  0.3886257\n389  1         Arxes1  0.1939779 1.860660e-04        0  0.4383596\n390  1         Lrrtm3  0.1939585 1.860660e-04        0  0.5679511\n391  1         R3hdm4  0.1936969 1.905676e-04        0  0.2734504\n392  1           Tia1  0.1936105 1.919255e-04        0  0.2339791\n393  1            Dst  0.1934045 1.958332e-04        0  0.2589698\n394  1         Mycbp2  0.1933357 1.968488e-04        0  0.2335223\n395  1          Mgat2  0.1927568 2.086952e-04        0  0.2780917\n396  1           Gpc6  0.1926176 2.112865e-04        0  0.5501739\n397  1          Trpv2  0.1925152 2.127680e-04        0  1.1914960\n398  1          Lamp1  0.1923454 2.157697e-04        0  0.2363786\n399  1           Ktn1  0.1923440 2.157697e-04        0  0.3159114\n400  1         Tmem9b  0.1918165 2.269125e-04        0  0.3040203\n401  2         Spock1 -0.3251727 1.986918e-11        0 -0.4817711\n402  2          Itfg1 -0.2992747 8.830343e-10        0 -0.3776583\n403  2        Serinc1 -0.2965425 1.327300e-09        0 -0.3825097\n404  2          Mdga2 -0.2874719 5.196375e-09        0 -0.4623846\n405  2           Ctsz -0.2824553 1.084481e-08        0 -0.3565810\n406  2           Ryr3 -0.2794362 1.620516e-08        0 -0.4376830\n407  2          Ntrk3 -0.2778571 2.001761e-08        0 -0.3451647\n408  2          Mef2c -0.2768284 2.238544e-08        0 -0.3636640\n409  2        Atp6ap2 -0.2740471 3.225774e-08        0 -0.3668009\n410  2         Sec11a -0.2731475 3.546047e-08        0 -0.3837498\n411  2          Kat6b -0.2721645 4.004189e-08        0 -0.4746228\n412  2        Atp6ap1 -0.2712336 4.487202e-08        0 -0.4142084\n413  2         Ctnnd2 -0.2699454 5.305199e-08        0 -0.3439896\n414  2           E2f7 -0.2656917 9.269129e-08        0 -0.8375014\n415  2           Sez6 -0.2651659 9.898528e-08        0 -0.3790612\n416  2         Tspan6 -0.2641542 1.109735e-07        0 -0.3765847\n417  2            App -0.2634345 1.218616e-07        0 -0.3262137\n418  2          Mmp16 -0.2632887 1.218616e-07        0 -0.4886848\n419  2          Pcdh7 -0.2605182 1.711040e-07        0 -0.5049982\n420  2         Tspan3 -0.2587857 2.135807e-07        0 -0.2605555\n421  2          Aplp1 -0.2586243 2.138782e-07        0 -0.3496143\n422  2       Tmem131l -0.2581374 2.271400e-07        0 -0.3784208\n423  2        Tspan14 -0.2564871 2.746660e-07        0 -0.3872160\n424  2         Igfbp2 -0.2563473 2.748693e-07        0 -0.3220609\n425  2         Arpp21 -0.2559070 2.825174e-07        0 -0.4396613\n426  2          Cadm1 -0.2524469 4.411479e-07        0 -0.4311111\n427  2         Slc1a3 -0.2518730 4.741182e-07        0 -0.5677610\n428  2          Qsox1 -0.2517963 4.753354e-07        0 -0.9440026\n429  2         Srgap1 -0.2516370 4.821080e-07        0 -0.3802237\n430  2          Dclk2 -0.2499856 5.967449e-07        0 -0.4091429\n431  2            Nin -0.2489245 6.755454e-07        0 -0.3054527\n432  2        Txndc12 -0.2468445 8.724833e-07        0 -0.4258825\n433  2          Ssbp2 -0.2459592 9.670182e-07        0 -0.3774376\n434  2          Hspa5 -0.2459301 9.670182e-07        0 -0.3800562\n435  2            St7 -0.2456164 1.001978e-06        0 -0.4031442\n436  2           Rpn2 -0.2451161 1.064941e-06        0 -0.3923588\n437  2          Tusc3 -0.2444311 1.144088e-06        0 -0.3801631\n438  2          Tanc2 -0.2438380 1.214142e-06        0 -0.3503723\n439  2          Cntn1 -0.2437246 1.224446e-06        0 -0.4232511\n440  2        Kirrel3 -0.2422936 1.455520e-06        0 -0.4714545\n441  2          Stmn4 -0.2398701 1.987621e-06        0 -0.3311401\n442  2          Nfasc -0.2394724 2.068306e-06        0 -0.4271409\n443  2           Copa -0.2370107 2.844142e-06        0 -0.3776922\n444  2         Tmem59 -0.2363461 3.029473e-06        0 -0.2633921\n445  2           Psap -0.2354175 3.316905e-06        0 -0.3226806\n446  2         Slc8a1 -0.2351684 3.405950e-06        0 -0.2340766\n447  2           Nrg3 -0.2345814 3.589783e-06        0 -0.3859916\n448  2           Cdh2 -0.2342556 3.701484e-06        0 -0.3735728\n449  2           Nptn -0.2336996 3.937207e-06        0 -0.3492779\n450  2           Scg5 -0.2327845 4.353659e-06        0 -0.3128342\n451  2          Sgip1 -0.2314531 4.999791e-06        0 -0.3421051\n452  2        Arl6ip1 -0.2302800 5.688491e-06        0 -0.3017192\n453  2           Aig1 -0.2299782 5.881194e-06        0 -0.2858523\n454  2         Dnajc1 -0.2298092 5.945769e-06        0 -0.3192334\n455  2           Eya3 -0.2295670 6.100529e-06        0 -0.4881567\n456  2          Scn2a -0.2275122 7.682828e-06        0 -0.3877597\n457  2          Neto2 -0.2272673 7.854185e-06        0 -0.3386953\n458  2          Ccnl2 -0.2272576 7.854185e-06        0 -0.2805397\n459  2           Snd1 -0.2266094 8.483010e-06        0 -0.4687846\n460  2           Itch -0.2264373 8.625908e-06        0 -0.4055109\n461  2           Smg5 -0.2258205 9.185318e-06        0 -0.4186320\n462  2         Dhcr24 -0.2257463 9.225802e-06        0 -0.5983321\n463  2         Atp2b1 -0.2256641 9.275968e-06        0 -0.3856881\n464  2           Ctsb -0.2253017 9.567604e-06        0 -0.3407802\n465  2           Nav3 -0.2247205 1.009659e-05        0 -0.2492735\n466  2        Fam214a -0.2245869 1.021576e-05        0 -0.5798609\n467  2         Hs2st1 -0.2245514 1.021576e-05        0 -0.4343860\n468  2          Acvr1 -0.2237028 1.125479e-05        0 -0.4732941\n469  2        Gm43507 -0.2233956 1.164069e-05        0 -0.6365634\n470  2          Tmtc1 -0.2227576 1.231783e-05        0 -0.5203901\n471  2       Slc39a10 -0.2227101 1.233483e-05        0 -0.4692922\n472  2           Chga -0.2220672 1.324119e-05        0 -0.4003207\n473  2          Nell2 -0.2219414 1.338939e-05        0 -0.3165228\n474  2            Tox -0.2217279 1.368759e-05        0 -0.2845122\n475  2       Tmem185b -0.2212111 1.446357e-05        0 -0.6700758\n476  2           Arnt -0.2211700 1.447350e-05        0 -0.5088107\n477  2          Ttc17 -0.2209115 1.475035e-05        0 -0.4843724\n478  2         Anks1b -0.2201991 1.575077e-05        0 -0.2459429\n479  2         Tmbim6 -0.2201709 1.575077e-05        0 -0.2638407\n480  2       Slc38a10 -0.2199636 1.609008e-05        0 -0.3700007\n481  2          Olfm2 -0.2198471 1.618613e-05        0 -0.3518482\n482  2          Kcnq5 -0.2195901 1.663637e-05        0 -0.4272948\n483  2         Kcnk10 -0.2195041 1.674338e-05        0 -0.3138762\n484  2           P3h4 -0.2194235 1.681993e-05        0 -0.8099715\n485  2        Tmem35a -0.2192482 1.706599e-05        0 -0.4109415\n486  2            Boc -0.2191264 1.725252e-05        0 -0.6010687\n487  2           Akt3 -0.2187650 1.796032e-05        0 -0.2628117\n488  2            Por -0.2187058 1.800550e-05        0 -0.4889486\n489  2        Carmil1 -0.2186786 1.800550e-05        0 -0.2887406\n490  2           Mtdh -0.2182809 1.875207e-05        0 -0.2807799\n491  2        Slc6a15 -0.2181638 1.884053e-05        0 -0.4716892\n492  2         Leprot -0.2181450 1.884053e-05        0 -0.2951880\n493  2        Slc20a1 -0.2176394 1.980493e-05        0 -0.4314969\n494  2          Klf12 -0.2175232 1.993214e-05        0 -0.4983598\n495  2          H2.D1 -0.2174584 1.994929e-05        0 -0.3639213\n496  2          Saraf -0.2170244 2.069912e-05        0 -0.3081942\n497  2       Tmem184c -0.2167978 2.119660e-05        0 -0.3225185\n498  2          Fgf14 -0.2165954 2.148125e-05        0 -0.2876250\n499  2        Tmem108 -0.2165627 2.148689e-05        0 -0.3562990\n500  2          Lrp11 -0.2160405 2.272142e-05        0 -0.3773354\n501  2           Ldb2 -0.2156147 2.367654e-05        0 -0.2939618\n502  2        Cacna1c -0.2155847 2.367654e-05        0 -0.3207911\n503  2           Syt1 -0.2155790 2.367654e-05        0 -0.3450811\n504  2          Csmd2 -0.2151655 2.462000e-05        0 -0.3452957\n505  2          Grik2 -0.2145322 2.631314e-05        0 -0.4514875\n506  2           Rcn2 -0.2144319 2.651186e-05        0 -0.2854721\n507  2         Grin2b -0.2143914 2.654737e-05        0 -0.3129156\n508  2            Os9 -0.2141584 2.720479e-05        0 -0.3525981\n509  2         Fnbp1l -0.2141045 2.728537e-05        0 -0.2614826\n510  2         Elovl5 -0.2136772 2.861939e-05        0 -0.5763508\n511  2         Rnf145 -0.2135561 2.893633e-05        0 -0.3942400\n512  2         Tnrc6c -0.2134906 2.896283e-05        0 -0.2655012\n513  2         Ift172 -0.2131292 2.993213e-05        0 -0.7273950\n514  2         Setbp1 -0.2126523 3.147019e-05        0 -0.2808616\n515  2         Lrpap1 -0.2123979 3.222011e-05        0 -0.2556996\n516  2          Cdkl5 -0.2119296 3.372541e-05        0 -0.3911032\n517  2        Tmem63b -0.2116461 3.476450e-05        0 -0.3875314\n518  2         Clstn2 -0.2109588 3.721956e-05        0 -0.3872830\n519  2           Calr -0.2093031 4.436976e-05        0 -0.2802238\n520  2         Cdc14b -0.2092744 4.437711e-05        0 -0.7198813\n521  2          Dock3 -0.2090558 4.523928e-05        0 -0.3741515\n522  2          Ddx50 -0.2090289 4.523928e-05        0 -0.2860189\n523  2         Ormdl3 -0.2087976 4.633580e-05        0 -0.3832619\n524  2          Foxp2 -0.2083742 4.838465e-05        0 -0.5684095\n525  2          Ntrk2 -0.2080832 4.974629e-05        0 -0.5329103\n526  2          Magi1 -0.2076817 5.144462e-05        0 -0.4553671\n527  2           Rgma -0.2076627 5.144462e-05        0 -0.5780725\n528  2         Ergic2 -0.2075678 5.185736e-05        0 -0.2655840\n529  2         Zfp846 -0.2071885 5.403425e-05        0 -0.2995412\n530  2           Sybu -0.2070879 5.450360e-05        0 -0.3264942\n531  2        Dync1i1 -0.2069837 5.486586e-05        0 -0.3032658\n532  2          Camkv -0.2069786 5.486586e-05        0 -0.4211762\n533  2          Llgl1 -0.2068022 5.583319e-05        0 -0.4266499\n534  2           Alg6 -0.2066740 5.649948e-05        0 -0.9009502\n535  2           Lnpk -0.2063485 5.810123e-05        0 -0.3247704\n536  2        Gm20517 -0.2063298 5.810123e-05        0 -1.1410193\n537  2          Spon1 -0.2063298 5.810123e-05        0 -1.0616953\n538  2          Trpm3 -0.2061208 5.923166e-05        0 -0.6898117\n539  2         Pgrmc1 -0.2061123 5.923166e-05        0 -0.3026805\n540  2           Ctsl -0.2060428 5.953423e-05        0 -0.2874709\n541  2        B3galt1 -0.2059237 6.018295e-05        0 -0.3441872\n542  2        B3galt2 -0.2057491 6.121111e-05        0 -0.3838402\n543  2        Ldlrad4 -0.2054362 6.311424e-05        0 -0.3296407\n544  2            Cpe -0.2051983 6.468208e-05        0 -0.3516827\n545  2           Emc3 -0.2049214 6.620182e-05        0 -0.3590846\n546  2          Ttc19 -0.2048220 6.677153e-05        0 -0.4082099\n547  2       Adamts18 -0.2044280 6.966750e-05        0 -0.3869474\n548  2         Scube1 -0.2040851 7.184739e-05        0 -0.4709928\n549  2            Fry -0.2033530 7.769159e-05        0 -0.2718307\n550  2          Csmd3 -0.2030058 8.038151e-05        0 -0.5650582\n551  2          Cd200 -0.2028380 8.131483e-05        0 -0.2797321\n552  2          Flrt2 -0.2028239 8.131483e-05        0 -0.4293102\n553  2         Atraid -0.2028083 8.131483e-05        0 -0.3129678\n554  2         Alkbh1 -0.2026408 8.263928e-05        0 -0.4014083\n555  2        Gm26835 -0.2023891 8.457433e-05        0 -0.4222330\n556  2        Phactr1 -0.2021275 8.689090e-05        0 -0.2632504\n557  2          Foxp1 -0.2015461 9.231480e-05        0 -0.2580225\n558  2        Cacna1e -0.2014118 9.347565e-05        0 -0.3844196\n559  2           Ssr2 -0.2012752 9.467585e-05        0 -0.2615975\n560  2         Dopey1 -0.2009604 9.757977e-05        0 -0.3199163\n561  2         Hivep2 -0.2003663 1.035141e-04        0 -0.3244790\n562  2          Gdpd1 -0.1999246 1.085061e-04        0 -0.2925950\n563  2       Tmem132a -0.1998393 1.092617e-04        0 -0.2428495\n564  2           Ssh2 -0.1996800 1.109416e-04        0 -0.3329310\n565  2          Cxadr -0.1995205 1.125124e-04        0 -0.3356759\n566  2        Zdhhc20 -0.1994903 1.125124e-04        0 -0.3232686\n567  2          Cspg5 -0.1994159 1.127918e-04        0 -0.5253050\n568  2          Ascc3 -0.1988892 1.180975e-04        0 -0.3602826\n569  2          Myo9a -0.1987439 1.197252e-04        0 -0.3474970\n570  2         Nedd4l -0.1981619 1.271194e-04        0 -0.2870636\n571  2          Scaf8 -0.1978457 1.306755e-04        0 -0.3909157\n572  2           Rbl2 -0.1974622 1.356527e-04        0 -0.7665457\n573  2          Nemp1 -0.1974417 1.356527e-04        0 -0.5981904\n574  2       B3galnt1 -0.1973076 1.373451e-04        0 -0.4204007\n575  2        Slitrk5 -0.1971726 1.390696e-04        0 -0.4541803\n576  2           Fat3 -0.1970110 1.408803e-04        0 -0.2584599\n577  2          Pdia6 -0.1960923 1.555679e-04        0 -0.2786742\n578  2         Rnf215 -0.1960710 1.555679e-04        0 -0.4738305\n579  2       Serpini1 -0.1960175 1.557135e-04        0 -0.3356833\n580  2         Plppr1 -0.1957489 1.596118e-04        0 -0.2795475\n581  2           Sbf2 -0.1955199 1.624925e-04        0 -0.3006908\n582  2         Rnf112 -0.1954497 1.633550e-04        0 -0.8890006\n583  2           Trio -0.1952979 1.653021e-04        0 -0.2908840\n584  2        Slc38a9 -0.1947198 1.753063e-04        0 -0.3353488\n585  2           Meg3 -0.1946128 1.769487e-04        0 -0.3784197\n586  2          Adcy3 -0.1943549 1.811538e-04        0 -0.5909601\n587  2          Epha7 -0.1943130 1.815532e-04        0 -0.4107213\n588  2           St7l -0.1940499 1.850877e-04        0 -0.3886257\n589  2         Arxes1 -0.1939825 1.859845e-04        0 -0.4383596\n590  2         Lrrtm3 -0.1939625 1.859845e-04        0 -0.5679511\n591  2         R3hdm4 -0.1936960 1.905873e-04        0 -0.2734504\n592  2           Tia1 -0.1936068 1.920028e-04        0 -0.2339791\n593  2            Dst -0.1934066 1.957878e-04        0 -0.2589698\n594  2         Mycbp2 -0.1933442 1.966651e-04        0 -0.2335223\n595  2          Mgat2 -0.1927482 2.088898e-04        0 -0.2780917\n596  2           Gpc6 -0.1926238 2.112472e-04        0 -0.5501739\n597  2          Trpv2 -0.1925211 2.126335e-04        0 -1.1914960\n598  2          Lamp1 -0.1923446 2.157594e-04        0 -0.2363786\n599  2           Ktn1 -0.1923444 2.157594e-04        0 -0.3159114\n600  2         Tmem9b -0.1918146 2.269600e-04        0 -0.3040203\n601  2          Rps12  0.4631549 6.183206e-23        0  0.6825116\n602  2          Atp5e  0.4421521 5.489863e-21        0  0.6826112\n603  2          Rpl12  0.4249284 2.145813e-19        0  0.5752903\n604  2         Gm2000  0.4178124 8.261193e-19        0  0.7062262\n605  2          Rpl27  0.4101575 3.538517e-18        0  0.4851285\n606  2          Rpl35  0.4095728 3.538517e-18        0  0.6420850\n607  2          Rpl38  0.3944075 8.464359e-17        0  0.4901851\n608  2          Rpl34  0.3839933 6.784492e-16        0  0.5340951\n609  2         Rpl13a  0.3816079 9.934717e-16        0  0.4674161\n610  2          Rps27  0.3776182 2.046629e-15        0  0.5241613\n611  2           Rps3  0.3675068 1.460826e-14        0  0.5091646\n612  2          Rps21  0.3610482 4.853602e-14        0  0.4306092\n613  2          Rps13  0.3572064 9.536627e-14        0  0.4967312\n614  2          Rps29  0.3548155 1.411443e-13        0  0.4107293\n615  2          Uqcrh  0.3468014 6.147145e-13        0  0.4208264\n616  2         Rps15a  0.3458384 6.918806e-13        0  0.5734880\n617  2          Pfdn5  0.3412500 1.545294e-12        0  0.4357714\n618  2         Uqcr10  0.3369872 3.224794e-12        0  0.4964385\n619  2          Rps26  0.3311064 8.977031e-12        0  0.5340777\n620  2          Rps18  0.3305636 9.411567e-12        0  0.4596902\n621  2           Tpt1  0.3299694 9.825250e-12        0  0.4076206\n622  2           Pomp  0.3298004 9.825250e-12        0  0.4368943\n623  2          Uqcrq  0.3294012 1.010187e-11        0  0.4547596\n624  2          Rps10  0.3272417 1.428769e-11        0  0.4795864\n625  2         Timm8b  0.3243726 2.203535e-11        0  0.4229584\n626  2          Rps25  0.3237953 2.351562e-11        0  0.4375944\n627  2           Pfn1  0.3207365 3.896942e-11        0  0.4524917\n628  2       Atp6v1g1  0.3200504 4.245618e-11        0  0.3852555\n629  2         Snrpd2  0.3191388 4.805527e-11        0  0.4236104\n630  2      Hist3h2ba  0.3189649 4.805527e-11        0  0.4143786\n631  2          Rpl37  0.3182724 5.123125e-11        0  0.5620636\n632  2         Ndufs6  0.3181885 5.123125e-11        0  0.4034311\n633  2        Atp5o.1  0.3180715 5.123125e-11        0  0.4328550\n634  2         Snrpd1  0.3153652 7.971523e-11        0  0.4110424\n635  2        Dynlrb1  0.3138211 1.012249e-10        0  0.4016523\n636  2         Uqcr11  0.3127887 1.176600e-10        0  0.3977030\n637  2         Rpl35a  0.3107299 1.630574e-10        0  0.4733195\n638  2           Btf3  0.3105600 1.635550e-10        0  0.3262416\n639  2           Swi5  0.3089918 2.083158e-10        0  0.3992487\n640  2          Rps20  0.3085745 2.163595e-10        0  0.4357840\n641  2          Rps28  0.3084814 2.163595e-10        0  0.3976983\n642  2          Rpl31  0.3080905 2.258154e-10        0  0.3883420\n643  2         Ndufa7  0.3058712 3.210445e-10        0  0.3983718\n644  2           Tbca  0.3008336 7.280122e-10        0  0.4041754\n645  2          Snrpb  0.3004187 7.628240e-10        0  0.3556668\n646  2          Rplp2  0.2994367 8.780648e-10        0  0.3876488\n647  2          Rpl28  0.2980768 1.053428e-09        0  0.4146471\n648  2          Uqcc2  0.2963570 1.341309e-09        0  0.5371598\n649  2          Rpl36  0.2959874 1.397297e-09        0  0.3646947\n650  2           Edf1  0.2907784 3.182905e-09        0  0.3900142\n651  2          Fkbp3  0.2887636 4.310446e-09        0  0.3556366\n652  2          Rps24  0.2855186 6.949575e-09        0  0.4770224\n653  2           Gpx4  0.2835273 9.333670e-09        0  0.3245309\n654  2           Bex3  0.2811669 1.302731e-08        0  0.3180195\n655  2          Rps16  0.2797322 1.599726e-08        0  0.4247866\n656  2          Tomm7  0.2794532 1.620516e-08        0  0.4093449\n657  2          Hspe1  0.2791867 1.657357e-08        0  0.3462706\n658  2         Chchd1  0.2776050 2.048674e-08        0  0.4354694\n659  2          Rpl17  0.2772637 2.125977e-08        0  0.5191041\n660  2          Atp5k  0.2763011 2.390680e-08        0  0.4740455\n661  2           Svbp  0.2760304 2.455412e-08        0  0.3014819\n662  2         Atp5c1  0.2745608 3.026725e-08        0  0.2363772\n663  2          Eif3k  0.2733197 3.506397e-08        0  0.3840566\n664  2          Sumo1  0.2733121 3.506397e-08        0  0.2914956\n665  2         Timm13  0.2727683 3.704806e-08        0  0.3686286\n666  2         Mrpl30  0.2720637 4.012608e-08        0  0.4749261\n667  2           Sem1  0.2709451 4.626165e-08        0  0.3741535\n668  2          Usmg5  0.2698205 5.338295e-08        0  0.3823320\n669  2          Rpl22  0.2684403 6.476015e-08        0  0.3428325\n670  2          Snrpg  0.2676331 7.211655e-08        0  0.3005801\n671  2          Snrpf  0.2669184 7.920313e-08        0  0.3441404\n672  2           Txn1  0.2665795 8.228619e-08        0  0.3887734\n673  2         Rps3a1  0.2649696 1.007190e-07        0  0.4636491\n674  2           Nol7  0.2647710 1.025313e-07        0  0.4529087\n675  2         Myl12b  0.2633170 1.218616e-07        0  0.3769849\n676  2          Rpl7a  0.2628980 1.276278e-07        0  0.3803800\n677  2          Cirbp  0.2626801 1.303533e-07        0  0.2427524\n678  2         Ndufv3  0.2624191 1.339840e-07        0  0.3777157\n679  2         Rps27l  0.2612859 1.562914e-07        0  0.5679664\n680  2         Rpl37a  0.2606248 1.702086e-07        0  0.5219644\n681  2           Cycs  0.2595888 1.936645e-07        0  0.3851088\n682  2         Rpl36a  0.2587217 2.135807e-07        0  0.2850982\n683  2        Anapc13  0.2587014 2.135807e-07        0  0.4999552\n684  2          Smdt1  0.2574554 2.478030e-07        0  0.3049345\n685  2           Sdhb  0.2573959 2.478030e-07        0  0.3655544\n686  2         Mrpl52  0.2566472 2.731507e-07        0  0.3746260\n687  2         Ranbp1  0.2564576 2.746660e-07        0  0.2617357\n688  2 X0610012G03Rik  0.2564156 2.746660e-07        0  0.4450968\n689  2         Csnk2b  0.2562380 2.751587e-07        0  0.3913248\n690  2          Rps17  0.2562154 2.751587e-07        0  0.4469891\n691  2         Chchd2  0.2560482 2.793180e-07        0  0.4363077\n692  2          Rpl21  0.2552768 3.062727e-07        0  0.3799537\n693  2          Hmgb1  0.2548389 3.230834e-07        0  0.3340397\n694  2         Mrpl28  0.2536180 3.805588e-07        0  0.4316112\n695  2          Rtraf  0.2534456 3.866532e-07        0  0.2697156\n696  2          Cops9  0.2500709 5.947902e-07        0  0.3814245\n697  2          Atox1  0.2499329 5.967449e-07        0  0.4098502\n698  2          Rplp1  0.2493323 6.434789e-07        0  0.4307723\n699  2         Hnrnpc  0.2478592 7.764553e-07        0  0.2664530\n700  2         Mrps17  0.2474735 8.125236e-07        0  0.4752512\n701  2           Vapa  0.2468733 8.724833e-07        0  0.2749610\n702  2          Hmgn1  0.2467629 8.757159e-07        0  0.2649146\n703  2          Rps23  0.2450356 1.068941e-06        0  0.4578971\n704  2          Atp5h  0.2448179 1.093221e-06        0  0.3256882\n705  2        Tmem256  0.2442495 1.164388e-06        0  0.3865038\n706  2         Dctpp1  0.2439548 1.203424e-06        0  0.2977997\n707  2        Hnrnpab  0.2435671 1.242278e-06        0  0.2954051\n708  2          Pcbp2  0.2424629 1.432352e-06        0  0.3170388\n709  2         Tceal9  0.2415540 1.597013e-06        0  0.2648281\n710  2        Lamtor5  0.2396744 2.026684e-06        0  0.4350606\n711  2        Ndufb10  0.2369275 2.844142e-06        0  0.2863959\n712  2          Cox7c  0.2369225 2.844142e-06        0  0.2824851\n713  2           Oaz1  0.2366477 2.930192e-06        0  0.2739040\n714  2         Scand1  0.2362155 3.049012e-06        0  0.4189525\n715  2         Polr2j  0.2362011 3.049012e-06        0  0.2842206\n716  2          Rpl10  0.2359047 3.150343e-06        0  0.4748902\n717  2          Pfdn4  0.2355440 3.282597e-06        0  0.4199890\n718  2          Rps19  0.2350001 3.457301e-06        0  0.5025216\n719  2         Rpl10a  0.2349610 3.457301e-06        0  0.3144984\n720  2           Nme1  0.2348924 3.467459e-06        0  0.2836137\n721  2          Arpc3  0.2343591 3.673533e-06        0  0.3467814\n722  2            Ran  0.2336918 3.937207e-06        0  0.2541407\n723  2           Rnf7  0.2330433 4.258758e-06        0  0.3808571\n724  2           Bex2  0.2329252 4.299581e-06        0  0.2931452\n725  2         Snrpd3  0.2324127 4.521549e-06        0  0.4085823\n726  2        Gm10260  0.2324024 4.521549e-06        0  0.3556503\n727  2          Cox7b  0.2323608 4.521549e-06        0  0.2699185\n728  2          H2afz  0.2321811 4.601972e-06        0  0.3482270\n729  2          Ddah2  0.2317245 4.854571e-06        0  0.3249683\n730  2           Tbcb  0.2312379 5.112130e-06        0  0.2296635\n731  2         Atp5j2  0.2304200 5.634610e-06        0  0.2909852\n732  2         Cox6b1  0.2303965 5.634610e-06        0  0.2710346\n733  2          Atp5j  0.2299308 5.885226e-06        0  0.2785515\n734  2        Uqcrfs1  0.2295095 6.113070e-06        0  0.2729393\n735  2         Txnl4a  0.2284938 6.923514e-06        0  0.4264706\n736  2         Mrps24  0.2283968 6.972967e-06        0  0.4010231\n737  2 X1110004F10Rik  0.2278692 7.418587e-06        0  0.2576501\n738  2            Mif  0.2278012 7.444171e-06        0  0.3175502\n739  2         Mrpl18  0.2263135 8.717060e-06        0  0.3538738\n740  2          Crip2  0.2262746 8.717060e-06        0  0.2328728\n741  2          Hsbp1  0.2253249 9.567604e-06        0  0.2581882\n742  2          Rpl19  0.2253114 9.567604e-06        0  0.3885120\n743  2          Rps11  0.2251894 9.656863e-06        0  0.3842770\n744  2         Rpl23a  0.2250285 9.806820e-06        0  0.4333352\n745  2           Ubl5  0.2248612 9.967272e-06        0  0.3088737\n746  2        Ndufab1  0.2238209 1.114197e-05        0  0.3859670\n747  2         Atp5g1  0.2231648 1.188149e-05        0  0.2660431\n748  2           Rps6  0.2231573 1.188149e-05        0  0.3939822\n749  2          Eif3h  0.2229958 1.206753e-05        0  0.2308491\n750  2          Pdcd5  0.2227854 1.231783e-05        0  0.3465369\n751  2         Zfp706  0.2225725 1.249138e-05        0  0.2112568\n752  2         Abracl  0.2213934 1.420354e-05        0  0.2750669\n753  2          Pfdn6  0.2209369 1.475035e-05        0  0.4071708\n754  2          Prdx5  0.2209109 1.475035e-05        0  0.2559431\n755  2          Calm3  0.2207639 1.495591e-05        0  0.2573251\n756  2         Rex1bd  0.2205570 1.527669e-05        0  0.4203590\n757  2            Esd  0.2203737 1.555921e-05        0  0.2975594\n758  2          Psma2  0.2203365 1.556413e-05        0  0.2819089\n759  2         Dynll1  0.2199209 1.610702e-05        0  0.3676117\n760  2          Rpl15  0.2193999 1.681993e-05        0  0.2895195\n761  2          Glrx3  0.2183361 1.870043e-05        0  0.1083442\n762  2        Selenow  0.2181498 1.884053e-05        0  0.3930863\n763  2           Gpx1  0.2178309 1.949979e-05        0  0.5381608\n764  2         Ndufa2  0.2176492 1.980493e-05        0  0.3264260\n765  2         Sec61b  0.2175909 1.984489e-05        0  0.3811968\n766  2         Mrpl58  0.2174529 1.994929e-05        0  0.4914635\n767  2          Psma7  0.2172964 2.021002e-05        0  0.2739562\n768  2          Bcas2  0.2172834 2.021002e-05        0  0.3158613\n769  2          Srp14  0.2170597 2.068867e-05        0  0.2990073\n770  2          Nop10  0.2166123 2.148125e-05        0  0.3118031\n771  2         Rpl27a  0.2166058 2.148125e-05        0  0.2738241\n772  2         Eif2s2  0.2163714 2.190974e-05        0  0.2296548\n773  2       Trappc2l  0.2156572 2.367654e-05        0  0.3406024\n774  2          H3f3a  0.2155351 2.371636e-05        0  0.3079225\n775  2         Gtf2h5  0.2153738 2.409548e-05        0  0.3434282\n776  2           Sub1  0.2151160 2.467880e-05        0  0.2508421\n777  2           Naca  0.2145240 2.631314e-05        0  0.3565910\n778  2           Rpl7  0.2135255 2.894195e-05        0  0.3706477\n779  2          Ppdpf  0.2133232 2.944698e-05        0  0.3391216\n780  2          Rpl24  0.2132565 2.958106e-05        0  0.4690503\n781  2        Gm10076  0.2127650 3.115580e-05        0  0.4772046\n782  2         Ndufb2  0.2126237 3.147088e-05        0  0.3525210\n783  2         Cox7a2  0.2122685 3.261049e-05        0  0.2379424\n784  2          Rpl18  0.2119882 3.360348e-05        0  0.2748972\n785  2           Rpl5  0.2112951 3.612182e-05        0  0.2924973\n786  2           Jund  0.2110174 3.713592e-05        0  0.2279356\n787  2         Ndufc1  0.2110056 3.713592e-05        0  0.3252872\n788  2         Ndufb4  0.2104104 3.958197e-05        0  0.3979775\n789  2         Rps27a  0.2103616 3.968123e-05        0  0.4295827\n790  2          Slirp  0.2102777 3.994578e-05        0  0.4121032\n791  2            Fau  0.2100576 4.086342e-05        0  0.4027868\n792  2         Ndufb8  0.2095178 4.340397e-05        0  0.2659853\n793  2        Txndc17  0.2090594 4.523928e-05        0  0.3694520\n794  2          Rpl32  0.2084089 4.834087e-05        0  0.5548520\n795  2          Ap2s1  0.2082742 4.880084e-05        0  0.2605882\n796  2        Gabarap  0.2080185 4.986800e-05        0  0.2959616\n797  2        Smarcb1  0.2080089 4.986800e-05        0  0.2851375\n798  2          H2afj  0.2078390 5.070994e-05        0  0.3315896\n799  2         Cacybp  0.2065126 5.739543e-05        0  0.2614856\n800  2           Grm8  0.2057265 6.121111e-05        0  0.4215947",
    "crumbs": [
      "Cluster evaluation",
      "Not UT cluster with LR"
    ]
  },
  {
    "objectID": "NonCT_clusters.html#summary",
    "href": "NonCT_clusters.html#summary",
    "title": "Not Uniform Transcriptomic clusters with Logistic Regression",
    "section": "Summary",
    "text": "Summary\n\nresult.df\n\n  OriginalCluster CellNumber COTANClusterNumber          Accuracy\n1      Cl525E15.0        826                  3 0.786585365853659\n2      Cl511E15.0        540                  2 0.916666666666667\n3      Cl184E15.0        322                  2          0.734375\n4      Cl432E13.5        536                  2  0.88785046728972\n5      Cl510E15.0        402                  2             0.825\n6      Cl511E15.0        540                  2 0.916666666666667\n\n\n\n\nSys.time()\n\n[1] \"2025-12-22 10:15:26 CET\"\n\n\n\nsessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 22.04.5 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n [1] nnet_7.3-20        COTAN_2.9.4        caret_7.0-1        lattice_0.22-7    \n [5] lubridate_1.9.4    forcats_1.0.0      stringr_1.5.1      dplyr_1.1.4       \n [9] purrr_1.2.0        readr_2.1.5        tibble_3.3.0       tidyverse_2.0.0   \n[13] tidyr_1.3.1        parallelDist_0.2.6 data.table_1.17.0  zeallot_0.2.0     \n[17] ggplot2_4.0.1     \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.22            splines_4.5.2              \n  [3] later_1.4.2                 polyclip_1.10-7            \n  [5] hardhat_1.4.1               pROC_1.18.5                \n  [7] rpart_4.1.24                fastDummies_1.7.5          \n  [9] lifecycle_1.0.4             doParallel_1.0.17          \n [11] globals_0.18.0              MASS_7.3-65                \n [13] dendextend_1.19.0           magrittr_2.0.4             \n [15] plotly_4.11.0               rmarkdown_2.29             \n [17] yaml_2.3.10                 httpuv_1.6.16              \n [19] Seurat_5.2.1                sctransform_0.4.2          \n [21] spam_2.11-1                 sp_2.2-0                   \n [23] spatstat.sparse_3.1-0       reticulate_1.42.0          \n [25] cowplot_1.1.3               pbapply_1.7-2              \n [27] RColorBrewer_1.1-3          abind_1.4-8                \n [29] GenomicRanges_1.60.0        Rtsne_0.17                 \n [31] BiocGenerics_0.54.0         ipred_0.9-15               \n [33] GenomeInfoDbData_1.2.14     circlize_0.4.16            \n [35] lava_1.8.1                  IRanges_2.42.0             \n [37] S4Vectors_0.46.0            ggrepel_0.9.6              \n [39] irlba_2.3.5.1               listenv_0.9.1              \n [41] spatstat.utils_3.1-4        goftest_1.2-3              \n [43] RSpectra_0.16-2             spatstat.random_3.4-1      \n [45] fitdistrplus_1.2-2          parallelly_1.45.0          \n [47] codetools_0.2-20            DelayedArray_0.34.1        \n [49] tidyselect_1.2.1            shape_1.4.6.1              \n [51] UCSC.utils_1.4.0            farver_2.1.2               \n [53] viridis_0.6.5               ScaledMatrix_1.16.0        \n [55] matrixStats_1.5.0           stats4_4.5.2               \n [57] spatstat.explore_3.4-2      jsonlite_2.0.0             \n [59] GetoptLong_1.0.5            gghalves_0.1.4             \n [61] progressr_0.15.1            ggridges_0.5.6             \n [63] survival_3.8-3              iterators_1.0.14           \n [65] foreach_1.5.2               tools_4.5.2                \n [67] ica_1.0-3                   Rcpp_1.0.14                \n [69] glue_1.8.0                  prodlim_2025.04.28         \n [71] gridExtra_2.3               SparseArray_1.8.0          \n [73] xfun_0.52                   MatrixGenerics_1.20.0      \n [75] ggthemes_5.1.0              GenomeInfoDb_1.44.0        \n [77] withr_3.0.2                 fastmap_1.2.0              \n [79] digest_0.6.37               rsvd_1.0.5                 \n [81] timechange_0.3.0            R6_2.6.1                   \n [83] mime_0.13                   colorspace_2.1-1           \n [85] scattermore_1.2             tensor_1.5                 \n [87] spatstat.data_3.1-6         generics_0.1.3             \n [89] recipes_1.3.0               class_7.3-23               \n [91] httr_1.4.7                  htmlwidgets_1.6.4          \n [93] S4Arrays_1.8.0              uwot_0.2.3                 \n [95] ModelMetrics_1.2.2.2        pkgconfig_2.0.3            \n [97] gtable_0.3.6                timeDate_4041.110          \n [99] ComplexHeatmap_2.24.0       lmtest_0.9-40              \n[101] S7_0.2.1                    SingleCellExperiment_1.30.0\n[103] XVector_0.48.0              htmltools_0.5.8.1          \n[105] dotCall64_1.2               zigg_0.0.2                 \n[107] clue_0.3-66                 Biobase_2.68.0             \n[109] SeuratObject_5.1.0          scales_1.4.0               \n[111] png_0.1-8                   gower_1.0.2                \n[113] spatstat.univar_3.1-3       knitr_1.50                 \n[115] tzdb_0.5.0                  reshape2_1.4.4             \n[117] rjson_0.2.23                nlme_3.1-168               \n[119] proxy_0.4-27                zoo_1.8-14                 \n[121] GlobalOptions_0.1.2         KernSmooth_2.23-26         \n[123] parallel_4.5.2              miniUI_0.1.2               \n[125] pillar_1.10.2               grid_4.5.2                 \n[127] vctrs_0.6.5                 RANN_2.6.2                 \n[129] promises_1.3.2              BiocSingular_1.24.0        \n[131] beachmat_2.24.0             xtable_1.8-4               \n[133] cluster_2.1.8.1             evaluate_1.0.3             \n[135] cli_3.6.5                   compiler_4.5.2             \n[137] rlang_1.1.6                 crayon_1.5.3               \n[139] future.apply_1.20.0         labeling_0.4.3             \n[141] plyr_1.8.9                  stringi_1.8.7              \n[143] deldir_2.0-4                viridisLite_0.4.2          \n[145] BiocParallel_1.42.0         assertthat_0.2.1           \n[147] lazyeval_0.2.2              spatstat.geom_3.4-1        \n[149] Matrix_1.7-4                RcppHNSW_0.6.0             \n[151] hms_1.1.3                   patchwork_1.3.2            \n[153] future_1.58.0               shiny_1.11.0               \n[155] SummarizedExperiment_1.38.1 ROCR_1.0-11                \n[157] Rfast_2.1.5.1               igraph_2.1.4               \n[159] RcppParallel_5.1.10",
    "crumbs": [
      "Cluster evaluation",
      "Not UT cluster with LR"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html",
    "href": "FDR_analisysResults5_20.html",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "",
    "text": "library(COTAN)\nlibrary(pROC)\noptions(parallelly.fork.enable = TRUE)\nlibrary(Seurat)\nlibrary(monocle3)\nlibrary(reticulate)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggpubr)\n\ndirOut &lt;- \"Results/FDR/\"\nif (!dir.exists(dirOut)) {\n  dir.create(dirOut)\n}\n\ndataSetDir &lt;- \"Data/MouseCortexFromLoom/FDR/MergedClusters_For_FDR/\"",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#preamble",
    "href": "FDR_analisysResults5_20.html#preamble",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "",
    "text": "library(COTAN)\nlibrary(pROC)\noptions(parallelly.fork.enable = TRUE)\nlibrary(Seurat)\nlibrary(monocle3)\nlibrary(reticulate)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggpubr)\n\ndirOut &lt;- \"Results/FDR/\"\nif (!dir.exists(dirOut)) {\n  dir.create(dirOut)\n}\n\ndataSetDir &lt;- \"Data/MouseCortexFromLoom/FDR/MergedClusters_For_FDR/\"",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#dataset-composition",
    "href": "FDR_analisysResults5_20.html#dataset-composition",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "Dataset composition",
    "text": "Dataset composition\n\ndatasets_csv &lt;- read.csv(file.path(dataSetDir,\"Cells_Usage_DataFrame.csv\"),\n                         row.names = 1\n                        ) \n\ndatasets_csv[1:3,]\n\n                 Group            Collection E13.5.432 E13.5.187 E13.5.434\n1 2_Clusters_even_near E13.5-434_+_E15.0-428         0         0       318\n2 2_Clusters_even_near E15.0-432_+_E13.5-432       536         0         0\n3 2_Clusters_even_near E15.0-508_+_E15.0-509         0         0         0\n  E13.5.184 E13.5.437 E13.5.510 E15.0.432 E15.0.509 E15.0.510 E15.0.508\n1         0         0         0         0         0         0         0\n2         0         0         0       536         0         0         0\n3         0         0         0         0       397         0       397\n  E15.0.428 E15.0.434 E15.0.437 E17.5.516 E17.5.505\n1       318         0         0         0         0\n2         0         0         0         0         0\n3         0         0         0         0         0\n\n\n\nDefine which genes are expressed\nFor each data set we need to define, independently from the DEA methods, which genes are specific for each cluster. So we need to define first which genes are expressed and which are not expressed. To do so we can take advantage from the fact that we have the original clusters from which the cells were sampled to create the artificial datasets. So looking to the original cluster we define as expressed all genes present in at least the 20% of cells and we define as not expressed the genes completely absent or expressed in less than 5% of cells.\nSince these two thresholds can have a big influence on the tools performances we will test also others in other pages.\n\nfile.presence &lt;- readRDS(\"Data/MouseCortexFromLoom/FDR/Results/GenePresence_PerCluster.RDS\")\n\nfor (file in list.files(\"Data/MouseCortexFromLoom/SingleClusterRawData/\")) {\n#  print(file)\n  Code &lt;- str_split(file,pattern = \"_\",simplify = T)[1]\n  Time &lt;- str_split(Code,pattern = \"e\",simplify = T)[2]\n  Cluster &lt;- str_split(Code,pattern = \"e\",simplify = T)[1]\n  Cluster &lt;- str_remove(Cluster,pattern = \"Cl\")\n  Cluster &lt;- paste0(\"E\",Time,\"-\",Cluster)\n  file.presence[,Cluster] &lt;- \"Absent\"\n  dataset.cl &lt;- readRDS(file.path(\"Data/MouseCortexFromLoom/SingleClusterRawData/\",\n                                         file))\n  number.cell.expressing &lt;- rowSums(dataset.cl &gt; 0)\n  AbsentThreshold &lt;- round(0.05*dim(dataset.cl)[2],digits = 0)\n  PresenceThreshold &lt;- round(0.2*dim(dataset.cl)[2],digits = 0)\n  file.presence[names(number.cell.expressing[number.cell.expressing &gt; AbsentThreshold]),Cluster] &lt;- \"Uncertain\" \n  \n  file.presence[names(number.cell.expressing[number.cell.expressing &gt;= PresenceThreshold]),Cluster] &lt;- \"Present\"\n  print(Cluster)\n  print(table(file.presence[,Cluster]))\n  \n  }\n\n[1] \"E13.5-184\"\n\n   Absent   Present Uncertain \n     6719      3476      4500 \n[1] \"E13.5-187\"\n\n   Absent   Present Uncertain \n     5930      4609      4156 \n[1] \"E15.0-428\"\n\n   Absent   Present Uncertain \n     7470      2864      4361 \n[1] \"E13.5-432\"\n\n   Absent   Present Uncertain \n     6847      3640      4208 \n[1] \"E15.0-432\"\n\n   Absent   Present Uncertain \n     6951      3514      4230 \n[1] \"E13.5-434\"\n\n   Absent   Present Uncertain \n     7191      3185      4319 \n[1] \"E15.0-434\"\n\n   Absent   Present Uncertain \n     7554      3028      4113 \n[1] \"E13.5-437\"\n\n   Absent   Present Uncertain \n     7024      3430      4241 \n[1] \"E15.0-437\"\n\n   Absent   Present Uncertain \n     7090      3419      4186 \n[1] \"E17.5-505\"\n\n   Absent   Present Uncertain \n     7141      3154      4400 \n[1] \"E15.0-508\"\n\n   Absent   Present Uncertain \n     6637      3892      4166 \n[1] \"E15.0-509\"\n\n   Absent   Present Uncertain \n     6495      4039      4161 \n[1] \"E13.5-510\"\n\n   Absent   Present Uncertain \n     5961      4541      4193 \n[1] \"E15.0-510\"\n\n   Absent   Present Uncertain \n     6082      4480      4133 \n[1] \"E17.5-516\"\n\n   Absent   Present Uncertain \n     6931      3496      4268",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#clusters_even_near",
    "href": "FDR_analisysResults5_20.html#clusters_even_near",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "2_Clusters_even_near",
    "text": "2_Clusters_even_near\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_near\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set             set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                     &lt;int&gt;\n1 Neil2 E13.5-434 FALSE 2_Clusters_even_near          1\n2 Neil2 E15.0-428 FALSE 2_Clusters_even_near          1\n3 Lamc1 E13.5-434 FALSE 2_Clusters_even_near          1\n4 Lamc1 E15.0-428 FALSE 2_Clusters_even_near          1\n5 Lama1 E13.5-434 FALSE 2_Clusters_even_near          1\n6 Lama1 E15.0-428 FALSE 2_Clusters_even_near          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 8\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwoClusters_even_near &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwoClusters_even_nearPL &lt;- TwoClusters_even_near + xlab(\"FPR\") + ylab(\"TPR\")\nTwoClusters_even_nearPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#clusters_even_medium",
    "href": "FDR_analisysResults5_20.html#clusters_even_medium",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "2_Clusters_even_medium",
    "text": "2_Clusters_even_medium\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_medium\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set               set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                       &lt;int&gt;\n1 Neil2 E13.5-187 FALSE 2_Clusters_even_medium          1\n2 Neil2 E13.5-184 FALSE 2_Clusters_even_medium          1\n3 Lamc1 E13.5-187 FALSE 2_Clusters_even_medium          1\n4 Lamc1 E13.5-184 FALSE 2_Clusters_even_medium          1\n5 Lama1 E13.5-187 FALSE 2_Clusters_even_medium          1\n6 Lama1 E13.5-184 FALSE 2_Clusters_even_medium          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 447\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E13.5-184\"\n[1] \"E17.5-516\"\n[1] \"E15.0-434\"\n[1] \"E15.0-508\"\n[1] \"E15.0-437\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_even_medium &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwo_Clusters_even_mediumPL &lt;- Two_Clusters_even_medium + xlab(\"FPR\") + ylab(\"TPR\")\nTwo_Clusters_even_mediumPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#clusters_even_far",
    "href": "FDR_analisysResults5_20.html#clusters_even_far",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "2_Clusters_even_far",
    "text": "2_Clusters_even_far\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_far\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set            set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                    &lt;int&gt;\n1 Neil2 E17.5-516 FALSE 2_Clusters_even_far          1\n2 Neil2 E13.5-187 FALSE 2_Clusters_even_far          1\n3 Lamc1 E17.5-516 FALSE 2_Clusters_even_far          1\n4 Lamc1 E13.5-187 FALSE 2_Clusters_even_far          1\n5 Lama1 E17.5-516 FALSE 2_Clusters_even_far          1\n6 Lama1 E13.5-187 FALSE 2_Clusters_even_far          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 1359\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E17.5-516\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-509\"\n[1] \"E13.5-184\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_even_far &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwo_Clusters_even_farPL &lt;- Two_Clusters_even_far + xlab(\"FPR\") + ylab(\"TPR\")\nTwo_Clusters_even_farPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#clusters_uneven_near",
    "href": "FDR_analisysResults5_20.html#clusters_uneven_near",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "2_Clusters_uneven_near",
    "text": "2_Clusters_uneven_near\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_near\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set               set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                       &lt;int&gt;\n1 Neil2 E13.5-434 FALSE 2_Clusters_uneven_near          1\n2 Neil2 E15.0-428 FALSE 2_Clusters_uneven_near          1\n3 Lamc1 E13.5-434 FALSE 2_Clusters_uneven_near          1\n4 Lamc1 E15.0-428 FALSE 2_Clusters_uneven_near          1\n5 Lama1 E13.5-434 FALSE 2_Clusters_uneven_near          1\n6 Lama1 E15.0-428 FALSE 2_Clusters_uneven_near          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 8\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\nplot(roc_resultSeurat)\n\n\n\n\n\n\n\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_uneven_near &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwo_Clusters_uneven_nearPL &lt;- Two_Clusters_uneven_near + xlab(\"FPR\") + ylab(\"TPR\")\nTwo_Clusters_uneven_nearPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#clusters_uneven_medium",
    "href": "FDR_analisysResults5_20.html#clusters_uneven_medium",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "2_Clusters_uneven_medium",
    "text": "2_Clusters_uneven_medium\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_medium\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set                 set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                         &lt;int&gt;\n1 Neil2 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n2 Neil2 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n3 Lamc1 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n4 Lamc1 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n5 Lama1 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n6 Lama1 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 447\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E13.5-184\"\n[1] \"E17.5-516\"\n[1] \"E15.0-434\"\n[1] \"E15.0-508\"\n[1] \"E15.0-437\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_uneven_medium &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwo_Clusters_uneven_mediumPL &lt;- Two_Clusters_uneven_medium + xlab(\"FPR\") + ylab(\"TPR\")\n\nTwo_Clusters_uneven_mediumPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#clusters_uneven_far",
    "href": "FDR_analisysResults5_20.html#clusters_uneven_far",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "2_Clusters_uneven_far",
    "text": "2_Clusters_uneven_far\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_far\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set              set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                      &lt;int&gt;\n1 Neil2 E17.5-516 FALSE 2_Clusters_uneven_far          1\n2 Neil2 E13.5-187 FALSE 2_Clusters_uneven_far          1\n3 Lamc1 E17.5-516 FALSE 2_Clusters_uneven_far          1\n4 Lamc1 E13.5-187 FALSE 2_Clusters_uneven_far          1\n5 Lama1 E17.5-516 FALSE 2_Clusters_uneven_far          1\n6 Lama1 E13.5-187 FALSE 2_Clusters_uneven_far          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 1359\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E17.5-516\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-509\"\n[1] \"E13.5-184\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_uneven_far &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nTwo_Clusters_uneven_farPL &lt;- Two_Clusters_uneven_far + xlab(\"FPR\") + ylab(\"TPR\")\n\nTwo_Clusters_uneven_farPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#clusters_even",
    "href": "FDR_analisysResults5_20.html#clusters_even",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "3_Clusters_even",
    "text": "3_Clusters_even\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"3_Clusters_even\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set        set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                &lt;int&gt;\n1 Neil2 E15.0-437 FALSE 3_Clusters_even          1\n2 Neil2 E13.5-510 FALSE 3_Clusters_even          1\n3 Neil2 E13.5-437 FALSE 3_Clusters_even          1\n4 Lamc1 E15.0-437 FALSE 3_Clusters_even          1\n5 Lamc1 E13.5-510 FALSE 3_Clusters_even          1\n6 Lamc1 E13.5-437 FALSE 3_Clusters_even          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 1305\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-437\"\n[1] \"E15.0-437\"\n[1] \"E13.5-510\"\n[1] \"E17.5-516\"\n[1] \"E13.5-437\"\n[1] \"E17.5-505\"\n[1] \"E15.0-510\"\n[1] \"E15.0-428\"\n[1] \"E13.5-510\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nThree_Clusters_even &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nThree_Clusters_evenPL &lt;- Three_Clusters_even + \n  xlab(\"FPR\") + ylab(\"TPR\")+theme(legend.position=\"none\")\nThree_Clusters_even",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#clusters_uneven",
    "href": "FDR_analisysResults5_20.html#clusters_uneven",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "3_Clusters_uneven",
    "text": "3_Clusters_uneven\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"3_Clusters_uneven\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set          set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                  &lt;int&gt;\n1 Neil2 E15.0-428 FALSE 3_Clusters_uneven          1\n2 Neil2 E13.5-434 FALSE 3_Clusters_uneven          1\n3 Neil2 E15.0-510 FALSE 3_Clusters_uneven          1\n4 Lamc1 E15.0-428 FALSE 3_Clusters_uneven          1\n5 Lamc1 E13.5-434 FALSE 3_Clusters_uneven          1\n6 Lamc1 E15.0-510 FALSE 3_Clusters_uneven          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 1577\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E15.0-510\"\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E13.5-187\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n[1] \"E13.5-184\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nThree_Clusters_uneven &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\nThree_Clusters_unevenPL &lt;- Three_Clusters_uneven + xlab(\"FPR\") + ylab(\"TPR\")+theme(legend.position=\"none\")\n\nThree_Clusters_uneven",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#clusters_uneven-1",
    "href": "FDR_analisysResults5_20.html#clusters_uneven-1",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "5_Clusters_uneven",
    "text": "5_Clusters_uneven\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"5_Clusters_uneven\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.555  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set          set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                  &lt;int&gt;\n1 Neil2 E13.5-510 FALSE 5_Clusters_uneven          1\n2 Neil2 E15.0-437 FALSE 5_Clusters_uneven          1\n3 Neil2 E15.0-510 FALSE 5_Clusters_uneven          1\n4 Neil2 E13.5-432 FALSE 5_Clusters_uneven          1\n5 Neil2 E13.5-437 FALSE 5_Clusters_uneven          1\n6 Lamc1 E13.5-510 FALSE 5_Clusters_uneven          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 1862\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod = \"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-432\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-437\"\n[1] \"E13.5-510\"\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E13.5-184\"\n[1] \"E15.0-434\"\n[1] \"E17.5-505\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n[1] \"E13.5-187\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from ScamPy\n\ndeaScamPy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScamPy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"ScanPy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScamPy[deaScamPy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScamPy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScamPy$set_number &lt;- ind \n  deaScamPy_tot &lt;- rbind(deaScamPy_tot, deaScamPy)\n  \n  \n  }\n deaScamPy_tot &lt;-  deaScamPy_tot[2:nrow(deaScamPy_tot),]\n \n deaScamPy_tot &lt;- merge.data.frame(deaScamPy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScamPy_tot$value &lt;- as.numeric(deaScamPy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScamPy &lt;- roc(deaScamPy_tot$value, 1 - deaScamPy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScamPy)\n\n\n\nSummary ROC for all methods\n\nFive_Clusters &lt;- ggroc(list(COTAN=roc_resultCOTAN, Seurat=roc_resultSeurat,                  Seurat_scTr = roc_resultSeurat_scTr, Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, ScamPy=roc_resultScamPy))\n\n \nFive_Clusters_unevenPL &lt;- Five_Clusters + xlab(\"FPR\") + ylab(\"TPR\")\n\nFive_Clusters_unevenPL",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#clusters-2",
    "href": "FDR_analisysResults5_20.html#clusters-2",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "2 Clusters",
    "text": "2 Clusters\n\nggarrange(TwoClusters_even_nearPL,Two_Clusters_even_mediumPL, Two_Clusters_even_farPL,Two_Clusters_uneven_nearPL, Two_Clusters_uneven_mediumPL,Two_Clusters_uneven_farPL,\n          labels = c(\"Even_Near\", \"Even_Medium\", \"Even_Far\", \"Uneven_Near\",\"Uneven_Medium\",\"Uneven_Far\"),\n          ncol = 3, nrow = 2, common.legend = T, legend = \"bottom\")",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#and-5-clusters",
    "href": "FDR_analisysResults5_20.html#and-5-clusters",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "3 and 5 Clusters",
    "text": "3 and 5 Clusters\n\nggarrange(Three_Clusters_evenPL,Three_Clusters_unevenPL, NULL, Five_Clusters_unevenPL,\n          labels = c(\"3_Even\", \"3_Uneven\", \"\", \"5_Uneven\"),\n          ncol = 2, nrow = 2, common.legend = T, legend = \"bottom\")",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults5_20.html#footer",
    "href": "FDR_analisysResults5_20.html#footer",
    "title": "FDR analysis - Results - thresholds true 5% 20%",
    "section": "Footer",
    "text": "Footer\n\nsessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 22.04.5 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] ggpubr_0.6.0                ggplot2_4.0.1              \n [3] tidyr_1.3.1                 dplyr_1.1.4                \n [5] stringr_1.5.1               reticulate_1.42.0          \n [7] monocle3_1.3.7              SingleCellExperiment_1.30.0\n [9] SummarizedExperiment_1.38.1 GenomicRanges_1.60.0       \n[11] GenomeInfoDb_1.44.0         IRanges_2.42.0             \n[13] S4Vectors_0.46.0            MatrixGenerics_1.20.0      \n[15] matrixStats_1.5.0           Biobase_2.68.0             \n[17] BiocGenerics_0.54.0         generics_0.1.3             \n[19] Seurat_5.2.1                SeuratObject_5.1.0         \n[21] sp_2.2-0                    pROC_1.18.5                \n[23] COTAN_2.9.4                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.22        splines_4.5.2           later_1.4.2            \n  [4] tibble_3.3.0            polyclip_1.10-7         fastDummies_1.7.5      \n  [7] lifecycle_1.0.4         rstatix_0.7.2           Rdpack_2.6.4           \n [10] doParallel_1.0.17       globals_0.18.0          lattice_0.22-7         \n [13] MASS_7.3-65             backports_1.5.0         dendextend_1.19.0      \n [16] magrittr_2.0.4          plotly_4.11.0           rmarkdown_2.29         \n [19] yaml_2.3.10             httpuv_1.6.16           sctransform_0.4.2      \n [22] spam_2.11-1             spatstat.sparse_3.1-0   minqa_1.2.8            \n [25] cowplot_1.1.3           pbapply_1.7-2           RColorBrewer_1.1-3     \n [28] abind_1.4-8             Rtsne_0.17              purrr_1.2.0            \n [31] circlize_0.4.16         GenomeInfoDbData_1.2.14 ggrepel_0.9.6          \n [34] irlba_2.3.5.1           listenv_0.9.1           spatstat.utils_3.1-4   \n [37] goftest_1.2-3           RSpectra_0.16-2         spatstat.random_3.4-1  \n [40] fitdistrplus_1.2-2      parallelly_1.45.0       codetools_0.2-20       \n [43] DelayedArray_0.34.1     tidyselect_1.2.1        shape_1.4.6.1          \n [46] UCSC.utils_1.4.0        farver_2.1.2            lme4_1.1-37            \n [49] ScaledMatrix_1.16.0     viridis_0.6.5           spatstat.explore_3.4-2 \n [52] jsonlite_2.0.0          GetoptLong_1.0.5        gghalves_0.1.4         \n [55] Formula_1.2-5           progressr_0.15.1        ggridges_0.5.6         \n [58] survival_3.8-3          iterators_1.0.14        foreach_1.5.2          \n [61] tools_4.5.2             ica_1.0-3               Rcpp_1.0.14            \n [64] glue_1.8.0              gridExtra_2.3           SparseArray_1.8.0      \n [67] xfun_0.52               ggthemes_5.1.0          withr_3.0.2            \n [70] fastmap_1.2.0           boot_1.3-32             digest_0.6.37          \n [73] rsvd_1.0.5              parallelDist_0.2.6      R6_2.6.1               \n [76] mime_0.13               colorspace_2.1-1        scattermore_1.2        \n [79] tensor_1.5              spatstat.data_3.1-6     utf8_1.2.5             \n [82] data.table_1.17.0       httr_1.4.7              htmlwidgets_1.6.4      \n [85] S4Arrays_1.8.0          uwot_0.2.3              pkgconfig_2.0.3        \n [88] gtable_0.3.6            ComplexHeatmap_2.24.0   lmtest_0.9-40          \n [91] S7_0.2.1                XVector_0.48.0          htmltools_0.5.8.1      \n [94] carData_3.0-5           dotCall64_1.2           zigg_0.0.2             \n [97] clue_0.3-66             scales_1.4.0            png_0.1-8              \n[100] reformulas_0.4.1        spatstat.univar_3.1-3   knitr_1.50             \n[103] reshape2_1.4.4          rjson_0.2.23            nloptr_2.2.1           \n[106] nlme_3.1-168            proxy_0.4-27            zoo_1.8-14             \n[109] GlobalOptions_0.1.2     KernSmooth_2.23-26      parallel_4.5.2         \n[112] miniUI_0.1.2            pillar_1.10.2           grid_4.5.2             \n[115] vctrs_0.6.5             RANN_2.6.2              promises_1.3.2         \n[118] car_3.1-3               BiocSingular_1.24.0     beachmat_2.24.0        \n[121] xtable_1.8-4            cluster_2.1.8.1         evaluate_1.0.3         \n[124] zeallot_0.2.0           cli_3.6.5               compiler_4.5.2         \n[127] rlang_1.1.6             crayon_1.5.3            ggsignif_0.6.4         \n[130] future.apply_1.20.0     labeling_0.4.3          plyr_1.8.9             \n[133] stringi_1.8.7           viridisLite_0.4.2       deldir_2.0-4           \n[136] BiocParallel_1.42.0     assertthat_0.2.1        lazyeval_0.2.2         \n[139] spatstat.geom_3.4-1     Matrix_1.7-4            RcppHNSW_0.6.0         \n[142] patchwork_1.3.2         future_1.58.0           shiny_1.11.0           \n[145] rbibutils_2.3           ROCR_1.0-11             Rfast_2.1.5.1          \n[148] broom_1.0.8             igraph_2.1.4            RcppParallel_5.1.10",
    "crumbs": [
      "DEA evaluation",
      "FDR and TPR - ROC curves",
      "Results - thresholds true 5% 20%"
    ]
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html",
    "href": "FDR_analisysResults3_10_th04.html",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "",
    "text": "library(COTAN)\nlibrary(pROC)\noptions(parallelly.fork.enable = TRUE)\nlibrary(Seurat)\nlibrary(monocle3)\nlibrary(reticulate)\nlibrary(cowplot)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggpubr)\n\nmethods.color &lt;- c(\"COTAN\"=\"#F73604\",\"Seurat\"=\"#ABD9E9\",\"Seurat_scTr\"=\"#74ADD1\",\"Seurat_Bimod\"=\"#4575B4\", \"Monocle\"=\"#DAABE9\", \"Scanpy\"=\"#7F9B5C\" )\n\ndirOut &lt;- \"Results/FDR/\"\nif (!dir.exists(dirOut)) {\n  dir.create(dirOut)\n}\n\ndataSetDir &lt;- \"Data/MouseCortexFromLoom/FDR/MergedClusters_For_FDR/\""
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#preamble",
    "href": "FDR_analisysResults3_10_th04.html#preamble",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "",
    "text": "library(COTAN)\nlibrary(pROC)\noptions(parallelly.fork.enable = TRUE)\nlibrary(Seurat)\nlibrary(monocle3)\nlibrary(reticulate)\nlibrary(cowplot)\nlibrary(stringr)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(ggplot2)\nlibrary(ggpubr)\n\nmethods.color &lt;- c(\"COTAN\"=\"#F73604\",\"Seurat\"=\"#ABD9E9\",\"Seurat_scTr\"=\"#74ADD1\",\"Seurat_Bimod\"=\"#4575B4\", \"Monocle\"=\"#DAABE9\", \"Scanpy\"=\"#7F9B5C\" )\n\ndirOut &lt;- \"Results/FDR/\"\nif (!dir.exists(dirOut)) {\n  dir.create(dirOut)\n}\n\ndataSetDir &lt;- \"Data/MouseCortexFromLoom/FDR/MergedClusters_For_FDR/\""
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#dataset-composition",
    "href": "FDR_analisysResults3_10_th04.html#dataset-composition",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "Dataset composition",
    "text": "Dataset composition\n\ndatasets_csv &lt;- read.csv(file.path(dataSetDir,\"Cells_Usage_DataFrame.csv\"),\n                         row.names = 1\n                        ) \n\ndatasets_csv[1:3,]\n\n                 Group            Collection E13.5.432 E13.5.187 E13.5.434\n1 2_Clusters_even_near E13.5-434_+_E15.0-428         0         0       318\n2 2_Clusters_even_near E15.0-432_+_E13.5-432       536         0         0\n3 2_Clusters_even_near E15.0-508_+_E15.0-509         0         0         0\n  E13.5.184 E13.5.437 E13.5.510 E15.0.432 E15.0.509 E15.0.510 E15.0.508\n1         0         0         0         0         0         0         0\n2         0         0         0       536         0         0         0\n3         0         0         0         0       397         0       397\n  E15.0.428 E15.0.434 E15.0.437 E17.5.516 E17.5.505\n1       318         0         0         0         0\n2         0         0         0         0         0\n3         0         0         0         0         0\n\n\n\nDefine which genes are expressed\nFor each data set we need to define, independently from the DEA methods, which genes are specific for each cluster. So we need to define first which genes are expressed and which are not expressed. To do so we can take advantage from the fact that we have the original clusters from which the cells were sampled to create the artificial datasets. So looking to the original cluster we define as expressed all genes present in at least the 10% of cells and we define as not expressed the genes completely absent or expressed in less than 3% of cells.\nSince these two thresholds can have a big influence on the tools performances we will test also others in other pages.\n\nfile.presence &lt;- readRDS(\"Data/MouseCortexFromLoom/FDR/Results/GenePresence_PerCluster.RDS\")\n\nfor (file in list.files(\"Data/MouseCortexFromLoom/SingleClusterRawData/\")) {\n#  print(file)\n  Code &lt;- str_split(file,pattern = \"_\",simplify = T)[1]\n  Time &lt;- str_split(Code,pattern = \"e\",simplify = T)[2]\n  Cluster &lt;- str_split(Code,pattern = \"e\",simplify = T)[1]\n  Cluster &lt;- str_remove(Cluster,pattern = \"Cl\")\n  Cluster &lt;- paste0(\"E\",Time,\"-\",Cluster)\n  file.presence[,Cluster] &lt;- \"Absent\"\n  dataset.cl &lt;- readRDS(file.path(\"Data/MouseCortexFromLoom/SingleClusterRawData/\",\n                                         file))\n  number.cell.expressing &lt;- rowSums(dataset.cl &gt; 0)\n  AbsentThreshold &lt;- round(0.03*dim(dataset.cl)[2],digits = 0)\n  PresenceThreshold &lt;- round(0.1*dim(dataset.cl)[2],digits = 0)\n  file.presence[names(number.cell.expressing[number.cell.expressing &gt; AbsentThreshold]),Cluster] &lt;- \"Uncertain\" \n  \n  file.presence[names(number.cell.expressing[number.cell.expressing &gt;= PresenceThreshold]),Cluster] &lt;- \"Present\"\n  print(Cluster)\n  print(table(file.presence[,Cluster]))\n  \n  }\n\n[1] \"E13.5-184\"\n\n   Absent   Present Uncertain \n     5519      6027      3149 \n[1] \"E13.5-187\"\n\n   Absent   Present Uncertain \n     4926      7151      2618 \n[1] \"E15.0-428\"\n\n   Absent   Present Uncertain \n     6386      5253      3056 \n[1] \"E13.5-432\"\n\n   Absent   Present Uncertain \n     5765      5975      2955 \n[1] \"E15.0-432\"\n\n   Absent   Present Uncertain \n     5912      5843      2940 \n[1] \"E13.5-434\"\n\n   Absent   Present Uncertain \n     6124      5487      3084 \n[1] \"E15.0-434\"\n\n   Absent   Present Uncertain \n     6301      5396      2998 \n[1] \"E13.5-437\"\n\n   Absent   Present Uncertain \n     5943      5783      2969 \n[1] \"E15.0-437\"\n\n   Absent   Present Uncertain \n     6017      5713      2965 \n[1] \"E17.5-505\"\n\n   Absent   Present Uncertain \n     6048      5662      2985 \n[1] \"E15.0-508\"\n\n   Absent   Present Uncertain \n     5625      6240      2830 \n[1] \"E15.0-509\"\n\n   Absent   Present Uncertain \n     5452      6454      2789 \n[1] \"E13.5-510\"\n\n   Absent   Present Uncertain \n     4924      6958      2813 \n[1] \"E15.0-510\"\n\n   Absent   Present Uncertain \n     5070      6952      2673 \n[1] \"E17.5-516\"\n\n   Absent   Present Uncertain \n     5821      5847      3027"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#clusters_even_near",
    "href": "FDR_analisysResults3_10_th04.html#clusters_even_near",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2_Clusters_even_near",
    "text": "2_Clusters_even_near\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_near\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.35  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot,20)\n\n# A tibble: 20 × 5\n   genes  clusters  value data_set             set_number\n   &lt;chr&gt;  &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                     &lt;int&gt;\n 1 Neil2  E13.5-434 FALSE 2_Clusters_even_near          1\n 2 Neil2  E15.0-428 FALSE 2_Clusters_even_near          1\n 3 Lamc1  E13.5-434 FALSE 2_Clusters_even_near          1\n 4 Lamc1  E15.0-428 FALSE 2_Clusters_even_near          1\n 5 Lama1  E13.5-434 FALSE 2_Clusters_even_near          1\n 6 Lama1  E15.0-428 FALSE 2_Clusters_even_near          1\n 7 Hs3st1 E13.5-434 FALSE 2_Clusters_even_near          1\n 8 Hs3st1 E15.0-428 FALSE 2_Clusters_even_near          1\n 9 Fabp3  E13.5-434 FALSE 2_Clusters_even_near          1\n10 Fabp3  E15.0-428 FALSE 2_Clusters_even_near          1\n11 Nrg2   E13.5-434 FALSE 2_Clusters_even_near          1\n12 Nrg2   E15.0-428 FALSE 2_Clusters_even_near          1\n13 Kdelr3 E13.5-434 FALSE 2_Clusters_even_near          1\n14 Kdelr3 E15.0-428 FALSE 2_Clusters_even_near          1\n15 Bend4  E13.5-434 FALSE 2_Clusters_even_near          1\n16 Bend4  E15.0-428 FALSE 2_Clusters_even_near          1\n17 Gjb4   E13.5-434 FALSE 2_Clusters_even_near          1\n18 Gjb4   E15.0-428 FALSE 2_Clusters_even_near          1\n19 Mogs   E13.5-434 FALSE 2_Clusters_even_near          1\n20 Mogs   E15.0-428 FALSE 2_Clusters_even_near          1\n\n\n\nlength(unique(ground_truth_tot$genes))\n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 24\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod =\"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nTwoClusters_even_near &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nTwoClusters_even_nearPL &lt;- TwoClusters_even_near + \n  xlab(\"FPR\") + \n  ylab(\"TPR\")\nTwoClusters_even_nearPL"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#clusters_even_medium",
    "href": "FDR_analisysResults3_10_th04.html#clusters_even_medium",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2_Clusters_even_medium",
    "text": "2_Clusters_even_medium\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_medium\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.35  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set               set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                       &lt;int&gt;\n1 Neil2 E13.5-187 FALSE 2_Clusters_even_medium          1\n2 Neil2 E13.5-184 FALSE 2_Clusters_even_medium          1\n3 Lamc1 E13.5-187 FALSE 2_Clusters_even_medium          1\n4 Lamc1 E13.5-184 FALSE 2_Clusters_even_medium          1\n5 Lama1 E13.5-187 FALSE 2_Clusters_even_medium          1\n6 Lama1 E13.5-184 FALSE 2_Clusters_even_medium          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 771\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod =\"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E13.5-184\"\n[1] \"E17.5-516\"\n[1] \"E15.0-434\"\n[1] \"E15.0-508\"\n[1] \"E15.0-437\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_even_medium &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nTwo_Clusters_even_mediumPL &lt;- Two_Clusters_even_medium + xlab(\"FPR\") + ylab(\"TPR\")\nTwo_Clusters_even_mediumPL"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#clusters_even_far",
    "href": "FDR_analisysResults3_10_th04.html#clusters_even_far",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2_Clusters_even_far",
    "text": "2_Clusters_even_far\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_even_far\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.35  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set            set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                    &lt;int&gt;\n1 Neil2 E17.5-516 FALSE 2_Clusters_even_far          1\n2 Neil2 E13.5-187 FALSE 2_Clusters_even_far          1\n3 Lamc1 E17.5-516 FALSE 2_Clusters_even_far          1\n4 Lamc1 E13.5-187 FALSE 2_Clusters_even_far          1\n5 Lama1 E17.5-516 FALSE 2_Clusters_even_far          1\n6 Lama1 E13.5-187 TRUE  2_Clusters_even_far          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 2325\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod =\"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E17.5-516\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-509\"\n[1] \"E13.5-184\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_even_far &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nTwo_Clusters_even_farPL &lt;- Two_Clusters_even_far + xlab(\"FPR\") + ylab(\"TPR\")\nTwo_Clusters_even_farPL"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#clusters_uneven_near",
    "href": "FDR_analisysResults3_10_th04.html#clusters_uneven_near",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2_Clusters_uneven_near",
    "text": "2_Clusters_uneven_near\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_near\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.35  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set               set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                       &lt;int&gt;\n1 Neil2 E13.5-434 FALSE 2_Clusters_uneven_near          1\n2 Neil2 E15.0-428 FALSE 2_Clusters_uneven_near          1\n3 Lamc1 E13.5-434 FALSE 2_Clusters_uneven_near          1\n4 Lamc1 E15.0-428 FALSE 2_Clusters_uneven_near          1\n5 Lama1 E13.5-434 FALSE 2_Clusters_uneven_near          1\n6 Lama1 E15.0-428 FALSE 2_Clusters_uneven_near          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 24\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod =\"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\nplot(roc_resultSeurat)\n\n\n\n\n\n\n\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_uneven_near &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nTwo_Clusters_uneven_nearPL &lt;- Two_Clusters_uneven_near + xlab(\"FPR\") + ylab(\"TPR\")\nTwo_Clusters_uneven_nearPL"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#clusters_uneven_medium",
    "href": "FDR_analisysResults3_10_th04.html#clusters_uneven_medium",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2_Clusters_uneven_medium",
    "text": "2_Clusters_uneven_medium\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_medium\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.35  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set                 set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                         &lt;int&gt;\n1 Neil2 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n2 Neil2 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n3 Lamc1 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n4 Lamc1 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n5 Lama1 E13.5-187 FALSE 2_Clusters_uneven_medium          1\n6 Lama1 E13.5-184 FALSE 2_Clusters_uneven_medium          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 771\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod =\"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E13.5-184\"\n[1] \"E17.5-516\"\n[1] \"E15.0-434\"\n[1] \"E15.0-508\"\n[1] \"E15.0-437\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_uneven_medium &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nTwo_Clusters_uneven_mediumPL &lt;- Two_Clusters_uneven_medium + xlab(\"FPR\") + ylab(\"TPR\")\n\nTwo_Clusters_uneven_mediumPL"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#clusters_uneven_far",
    "href": "FDR_analisysResults3_10_th04.html#clusters_uneven_far",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2_Clusters_uneven_far",
    "text": "2_Clusters_uneven_far\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"2_Clusters_uneven_far\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.35  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set              set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                      &lt;int&gt;\n1 Neil2 E17.5-516 FALSE 2_Clusters_uneven_far          1\n2 Neil2 E13.5-187 FALSE 2_Clusters_uneven_far          1\n3 Lamc1 E17.5-516 FALSE 2_Clusters_uneven_far          1\n4 Lamc1 E13.5-187 FALSE 2_Clusters_uneven_far          1\n5 Lama1 E17.5-516 FALSE 2_Clusters_uneven_far          1\n6 Lama1 E13.5-187 TRUE  2_Clusters_uneven_far          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 2325\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod =\"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-187\"\n[1] \"E17.5-516\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-509\"\n[1] \"E13.5-184\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nTwo_Clusters_uneven_far &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nTwo_Clusters_uneven_farPL &lt;- Two_Clusters_uneven_far + xlab(\"FPR\") + ylab(\"TPR\")\n\nlg &lt;- get_legend(Two_Clusters_uneven_farPL)\n\nTwo_Clusters_uneven_farPL"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#clusters_even",
    "href": "FDR_analisysResults3_10_th04.html#clusters_even",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "3_Clusters_even",
    "text": "3_Clusters_even\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"3_Clusters_even\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.35  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set        set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                &lt;int&gt;\n1 Neil2 E15.0-437 FALSE 3_Clusters_even          1\n2 Neil2 E13.5-510 FALSE 3_Clusters_even          1\n3 Neil2 E13.5-437 FALSE 3_Clusters_even          1\n4 Lamc1 E15.0-437 FALSE 3_Clusters_even          1\n5 Lamc1 E13.5-510 FALSE 3_Clusters_even          1\n6 Lamc1 E13.5-437 FALSE 3_Clusters_even          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 1288\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod =\"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-437\"\n[1] \"E15.0-437\"\n[1] \"E13.5-510\"\n[1] \"E17.5-516\"\n[1] \"E13.5-437\"\n[1] \"E17.5-505\"\n[1] \"E15.0-510\"\n[1] \"E15.0-428\"\n[1] \"E13.5-510\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nThree_Clusters_even &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nThree_Clusters_evenPL &lt;- Three_Clusters_even + \n  xlab(\"FPR\") + ylab(\"TPR\")+theme(legend.position=\"none\")\nThree_Clusters_even"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#clusters_uneven",
    "href": "FDR_analisysResults3_10_th04.html#clusters_uneven",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "3_Clusters_uneven",
    "text": "3_Clusters_uneven\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"3_Clusters_uneven\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.35  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set          set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                  &lt;int&gt;\n1 Neil2 E15.0-428 FALSE 3_Clusters_uneven          1\n2 Neil2 E13.5-434 FALSE 3_Clusters_uneven          1\n3 Neil2 E15.0-510 FALSE 3_Clusters_uneven          1\n4 Lamc1 E15.0-428 FALSE 3_Clusters_uneven          1\n5 Lamc1 E13.5-434 FALSE 3_Clusters_uneven          1\n6 Lamc1 E15.0-510 FALSE 3_Clusters_uneven          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 1804\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod =\"none\")\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E15.0-510\"\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E13.5-187\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n[1] \"E13.5-184\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n#onlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[order(onlyPositive.pVal.Cotan_tot$p_values,\n #                                                                decreasing = F),]\n# df &lt;- as.data.frame(matrix(nrow = nrow(onlyPositive.pVal.Cotan_tot),ncol = 3)) \n# colnames(df) &lt;- c(\"TPR\",\"FPR\",\"Method\")\n# df$Method &lt;- \"COTAN\"\n# \n# Positive &lt;- sum(onlyPositive.pVal.Cotan_tot$value) \n# Negative &lt;- sum(!onlyPositive.pVal.Cotan_tot$value)\n# \n# for (i in 1:nrow(onlyPositive.pVal.Cotan_tot)) {\n#   df[i,\"TPR\"] &lt;- sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"])/Positive\n#   df[i,\"FPR\"] &lt;- (i-sum(onlyPositive.pVal.Cotan_tot[1:i,\"value\"]))/Negative\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nThree_Clusters_uneven &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\nThree_Clusters_unevenPL &lt;- Three_Clusters_uneven + xlab(\"FPR\") + ylab(\"TPR\")+theme(legend.position=\"none\")\n\nThree_Clusters_uneven"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#clusters_uneven-1",
    "href": "FDR_analisysResults3_10_th04.html#clusters_uneven-1",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "5_Clusters_uneven",
    "text": "5_Clusters_uneven\n\nTrue vector\n\nsubset.datasets_csv &lt;-datasets_csv[datasets_csv$Group == \"5_Clusters_uneven\",] \n\nground_truth_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  clusters &lt;- str_split(subset.datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  file.presence.subset &lt;- file.presence[,clusters]\n  \n  \n  #file.presence.subset &lt;- as.matrix(file.presence.subset)\n  \n  \n  ground_truth &lt;- as.data.frame(matrix(nrow = nrow(file.presence.subset),\n                                       ncol = ncol(file.presence.subset)))\n  rownames(ground_truth) &lt;- rownames(file.presence.subset)\n  colnames(ground_truth) &lt;- colnames(file.presence.subset)\n  \n  ground_truth[file.presence.subset == \"Absent\"] &lt;- 0\n  ground_truth[file.presence.subset == \"Present\"] &lt;- 1\n  ground_truth[file.presence.subset == \"Uncertain\"] &lt;- 0.6\n  \n  file.presence.subset &lt;- ground_truth\n  \n  for (col in 1:ncol(ground_truth)) {\n    ground_truth[,col] &lt;- FALSE  \n    ground_truth[file.presence.subset[,col] == 1 & rowMeans(file.presence.subset[,-col,drop = FALSE]) &lt; 0.35  ,col] &lt;- TRUE\n    }\n  \n  ground_truth$genes &lt;- rownames(ground_truth) \n  ground_truth &lt;- pivot_longer(ground_truth,\n                               cols = 1:(ncol(ground_truth)-1),\n                               names_to = \"clusters\")\n  ground_truth$data_set &lt;- subset.datasets_csv[ind,1]\n  ground_truth$set_number &lt;- ind \n  ground_truth_tot &lt;- rbind(ground_truth_tot, ground_truth)\n  \n}\nground_truth_tot &lt;- ground_truth_tot[2:nrow(ground_truth_tot),]\n\n\n\nhead(ground_truth_tot)\n\n# A tibble: 6 × 5\n  genes clusters  value data_set          set_number\n  &lt;chr&gt; &lt;chr&gt;     &lt;lgl&gt; &lt;chr&gt;                  &lt;int&gt;\n1 Neil2 E13.5-510 FALSE 5_Clusters_uneven          1\n2 Neil2 E15.0-437 FALSE 5_Clusters_uneven          1\n3 Neil2 E15.0-510 FALSE 5_Clusters_uneven          1\n4 Neil2 E13.5-432 FALSE 5_Clusters_uneven          1\n5 Neil2 E13.5-437 FALSE 5_Clusters_uneven          1\n6 Lamc1 E13.5-510 FALSE 5_Clusters_uneven          1\n\n\n\nlength(unique(ground_truth_tot$genes)) \n\n[1] 14695\n\nsum(ground_truth_tot$value)\n\n[1] 1663\n\n\n\n\nROC for COTAN\n\nonlyPositive.pVal.Cotan_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",\n                      subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  deaCOTAN &lt;- getClusterizationData(dataset,clName = \"mergedClusters\")[[2]]\n  pvalCOTAN &lt;- pValueFromDEA(deaCOTAN,\n              numCells = getNumCells(dataset),adjustmentMethod =\"none\")\n  genesLambda &lt;- getLambda(dataset)\n  genesLambda &lt;- as.data.frame(genesLambda)\n  genesLambda$genes &lt;- rownames(genesLambda)\n  \n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.names &lt;- c(cl.names,\n                  str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1])\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  }\n  colnames(deaCOTAN) &lt;- cl.names\n  colnames(pvalCOTAN) &lt;- cl.names\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  onlyPositive.pVal.Cotan &lt;- pvalCOTAN\n\n    for (cl in cl.names) {\n    print(cl)\n    #temp.DEA.CotanSign &lt;- deaCOTAN[rownames(pvalCOTAN[pvalCOTAN[,cl] &lt; 0.05,]) ,]\n    onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl] &lt;-  1 #onlyPositive.pVal.Cotan[rownames(deaCOTAN[deaCOTAN[,cl] &lt; 0,]),cl]+1\n    }\n    \n    onlyPositive.pVal.Cotan$genes &lt;- rownames(onlyPositive.pVal.Cotan) \n    onlyPositive.pVal.Cotan &lt;- pivot_longer(onlyPositive.pVal.Cotan,\n                                            values_to = \"p_values\",\n                               cols = 1:(ncol(onlyPositive.pVal.Cotan)-1),\n                               names_to = \"clusters\")\n  onlyPositive.pVal.Cotan$data_set &lt;- subset.datasets_csv[ind,1]\n  onlyPositive.pVal.Cotan$set_number &lt;- ind \n  \n  onlyPositive.pVal.Cotan &lt;- merge(onlyPositive.pVal.Cotan,genesLambda,by=\"genes\")\n  \n  onlyPositive.pVal.Cotan_tot &lt;- rbind(onlyPositive.pVal.Cotan_tot, onlyPositive.pVal.Cotan)\n  \n  }\n\n[1] \"E13.5-432\"\n[1] \"E15.0-510\"\n[1] \"E13.5-437\"\n[1] \"E15.0-437\"\n[1] \"E13.5-510\"\n[1] \"E13.5-434\"\n[1] \"E15.0-428\"\n[1] \"E13.5-184\"\n[1] \"E15.0-434\"\n[1] \"E17.5-505\"\n[1] \"E15.0-432\"\n[1] \"E13.5-432\"\n[1] \"E15.0-509\"\n[1] \"E15.0-508\"\n[1] \"E13.5-187\"\n\nonlyPositive.pVal.Cotan_tot &lt;- onlyPositive.pVal.Cotan_tot[2:nrow(onlyPositive.pVal.Cotan_tot),]\n\nonlyPositive.pVal.Cotan_tot &lt;- merge.data.frame(onlyPositive.pVal.Cotan_tot,\n                                                ground_truth_tot,by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),all.x = T,all.y = F)\n\n\n  \n# Convert TRUE/FALSE to 1/0\nonlyPositive.pVal.Cotan_tot$value &lt;- as.numeric(onlyPositive.pVal.Cotan_tot$value)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultCOTAN &lt;- roc(onlyPositive.pVal.Cotan_tot$value, 1 - onlyPositive.pVal.Cotan_tot$p_values)\n\ncotan.threshold.pval &lt;- quantile(onlyPositive.pVal.Cotan_tot[onlyPositive.pVal.Cotan_tot$value == 0,]$p_values,probs = 0.05)\n\n# Plot the ROC curve\n#plot(roc_resultCOTAN)\n\n\n\nROC for Seurat\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\ndeaSeurat_tot_base &lt;- deaSeurat_tot\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\nseurat.threshold.pval &lt;- quantile(deaSeurat_tot_base[deaSeurat_tot_base$value == 0,]$p_val,probs = 0.05)\n# Plot the ROC curve\n#plot(roc_resultSeurat)\n\n\n\nROC for Seurat scTransform\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_ScTransform_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\ndeaSeurat_tot_scTr &lt;- deaSeurat_tot\n\nSeurat_scTr.threshold.pval &lt;- quantile(deaSeurat_tot_scTr[deaSeurat_tot_scTr$value == 0,]$p_val,probs = 0.05)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_scTr &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Seurat Bimod\n\ndeaSeurat_tot &lt;- NA\n\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  #print(ind)\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  \n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  \n  deaSeurat &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Seurat_DEA_Bimod_genes.csv\")), row.names = 1)\n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaSeurat[deaSeurat$cluster == cl.val,]$cluster &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"cluster\",\n                                     replacement = \"clusters\") \n  colnames(deaSeurat) &lt;- str_replace(colnames(deaSeurat),\n                                     pattern = \"gene\",\n                                     replacement = \"genes\") \n  \n  deaSeurat$data_set &lt;- subset.datasets_csv[ind,1]\n  deaSeurat$set_number &lt;- ind \n  deaSeurat_tot &lt;- rbind(deaSeurat_tot, deaSeurat)\n  \n  \n  }\n deaSeurat_tot &lt;-  deaSeurat_tot[2:nrow(deaSeurat_tot),]\n \n deaSeurat_tot &lt;- merge.data.frame(deaSeurat_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaSeurat_tot$value &lt;- as.numeric(deaSeurat_tot$value)\n\ndeaSeurat_tot_Bimod &lt;- deaSeurat_tot\n\nseurat_bimod.threshold.pval &lt;- quantile(deaSeurat_tot_Bimod[deaSeurat_tot_Bimod$value == 0,]$p_val,probs = 0.05)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultSeurat_Bimod &lt;- roc(deaSeurat_tot$value, 1 - deaSeurat_tot$p_val)\n\n\n\nROC for Monocle\n\ndeaMonocle_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n  \n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaMonocle &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Monocle_DEA_genes.csv\")),row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaMonocle[deaMonocle$cell_group == cl.val,\"cell_group\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n  \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"cell_group\",\n                                     replacement = \"clusters\") \n  colnames(deaMonocle) &lt;- str_replace(colnames(deaMonocle),\n                                     pattern = \"gene_id\",\n                                     replacement = \"genes\")\n  \n  deaMonocle$data_set &lt;- subset.datasets_csv[ind,1]\n  deaMonocle$set_number &lt;- ind \n  deaMonocle &lt;- as.data.frame(deaMonocle)\n  deaMonocle_tot &lt;- rbind(deaMonocle_tot, deaMonocle)\n  \n  \n  }\n deaMonocle_tot &lt;-  deaMonocle_tot[2:nrow(deaMonocle_tot),]\n \n deaMonocle_tot &lt;- merge.data.frame(deaMonocle_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaMonocle_tot$value &lt;- as.numeric(deaMonocle_tot$value)\n\nmonocle.threshold.pval &lt;- quantile(deaMonocle_tot[deaMonocle_tot$value == 0,]$marker_test_p_value,probs = 0.05)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultMonocle &lt;- roc(deaMonocle_tot$value, 1 - deaMonocle_tot$marker_test_p_value)\n\n# Plot the ROC curve\n#plot(roc_resultMonocle)\n\n\n\nROC from Scanpy\n\ndeaScanpy_tot &lt;- NA\nfor (ind in 1:dim(subset.datasets_csv)[1]) {\n  file.code &lt;- paste0(subset.datasets_csv$Group[ind],\"_\",subset.datasets_csv$Collection[ind])\n  dataset &lt;- readRDS(file = file.path(dataSetDir,paste0(file.code,\".RDS\")))\n\n  clusterization &lt;- getClusterizationData(dataset, clName = \"mergedClusters\")[[1]]\n  #print(file.code)\n  \n  deaScanpy &lt;- read.csv(file.path(dirOut,paste0(file.code,\"Scanpy_DEA_genes.csv\")),\n                        row.names = 1) \n  \n  cl.names &lt;- NA\n  \n  for (cl.val in  unique(clusterization)) {\n    #print(cl.val)\n    cl.name &lt;- str_split(names(clusterization[clusterization == cl.val])[1],\n                            pattern = \"_\",simplify = T)[1]\n    cl.names &lt;- c(cl.names,cl.name)\n    cl.names &lt;- cl.names[!is.na(cl.names)]\n  \n    deaScanpy[deaScanpy$clusters == paste0(\"cl\",cl.val),\"clusters\"] &lt;- cl.name   \n  \n  }\n  \n  clusters &lt;- str_split(datasets_csv$Collection[ind],pattern = \"_[+]_\",simplify = T)\n\n\n  deaScanpy$data_set &lt;- subset.datasets_csv[ind,1]\n  deaScanpy$set_number &lt;- ind \n  deaScanpy_tot &lt;- rbind(deaScanpy_tot, deaScanpy)\n  \n  \n  }\n deaScanpy_tot &lt;-  deaScanpy_tot[2:nrow(deaScanpy_tot),]\n \n deaScanpy_tot &lt;- merge.data.frame(deaScanpy_tot,\n                                   ground_truth_tot,\n                                   by = c(\"genes\",\"clusters\",\"data_set\",\"set_number\"),\n                                   all.x = T,all.y = F)\n\n# Convert TRUE/FALSE to 1/0\ndeaScanpy_tot$value &lt;- as.numeric(deaScanpy_tot$value)\n\nscanpy.threshold.pval &lt;- quantile(deaScanpy_tot[deaScanpy_tot$value == 0,]$pval,probs = 0.05)\n\n# Compute the ROC curve - note that we invert the p-values with 1 - p_values\nroc_resultScanpy &lt;- roc(deaScanpy_tot$value, 1 - deaScanpy_tot$pval)\n\n# Plot the ROC curve\n#plot(roc_resultScanpy)\n\n\n\nSummary ROC for all methods\n\nFive_Clusters &lt;- ggroc(list(COTAN=roc_resultCOTAN, \n                                    Seurat=roc_resultSeurat,\n                 Seurat_scTr = roc_resultSeurat_scTr, \n                 Seurat_Bimod = roc_resultSeurat_Bimod,\n                 Monocle=roc_resultMonocle, \n                 Scanpy=roc_resultScanpy),\n                 aes = c(\"colour\"),\n            legacy.axes = T,\n            linewidth = 1)+theme_light()+\n  scale_colour_manual(\"\", \n                      values = methods.color)\n\n \nFive_Clusters_unevenPL &lt;- Five_Clusters + xlab(\"FPR\") + ylab(\"TPR\")\n\nFive_Clusters_unevenPL"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#clusters-2",
    "href": "FDR_analisysResults3_10_th04.html#clusters-2",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "2 Clusters",
    "text": "2 Clusters\n\nplot_2cl &lt;- ggarrange(TwoClusters_even_nearPL,Two_Clusters_even_mediumPL, Two_Clusters_even_farPL,Two_Clusters_uneven_nearPL, Two_Clusters_uneven_mediumPL,Two_Clusters_uneven_farPL,\n          labels = c(\"Even_Near\", \"Even_Medium\", \"Even_Far\", \"Uneven_Near\",\"Uneven_Medium\",\"Uneven_Far\"),\n          ncol = 3, nrow = 2, common.legend = T, legend = \"bottom\")\n\npdf(paste0(dirOut,\"ROC_two_supp.pdf\"),width = 15,height = 10)\nplot(plot_2cl)\ndev.off()\n\npng \n  2 \n\nplot_2cl"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#and-5-clusters",
    "href": "FDR_analisysResults3_10_th04.html#and-5-clusters",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "3 and 5 Clusters",
    "text": "3 and 5 Clusters\n\nplot_3_5 &lt;- ggarrange(Three_Clusters_evenPL,Three_Clusters_unevenPL, NULL, Five_Clusters_unevenPL,\n          labels = c(\"3_Even\", \"3_Uneven\", \"\", \"5_Uneven\"),\n          ncol = 2, nrow = 2, common.legend = T, legend = \"bottom\")\n\npdf(paste0(dirOut,\"ROC_three_five_supp.pdf\"),width = 10,height = 10)\nplot(plot_3_5)\ndev.off()\n\npng \n  2 \n\nplot_3_5\n\n\n\n\n\n\n\n\n\nplot3 &lt;- ggarrange(Two_Clusters_uneven_farPL,Three_Clusters_unevenPL, Five_Clusters_unevenPL,\n          labels = c(\"A\", \"B\", \"C\"),\n          ncol = 3, nrow = 1, common.legend = T, legend = \"none\")\n\npdf(paste0(dirOut,\"ROC_three_main.pdf\"),width = 15,height = 5)\nplot(plot3)\ndev.off()\n\npng \n  2 \n\nplot3"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#histogram-with-gene-expression-level",
    "href": "FDR_analisysResults3_10_th04.html#histogram-with-gene-expression-level",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "Histogram with gene expression level",
    "text": "Histogram with gene expression level\n\nground_truth_tot_subset &lt;- as.data.frame(ground_truth_tot[ground_truth_tot$value ==1,])\n\nCOTAN_data &lt;- onlyPositive.pVal.Cotan_tot[,c(\"genes\",\"set_number\",\"clusters\",\"p_values\",\"genesLambda\")]\n\ncolnames(COTAN_data) &lt;- c(\"genes\",\"set_number\",\"clusters\",\"p_value_COTAN\",\"genesLambda\")\n\nground_truth_tot_subset &lt;- merge(ground_truth_tot_subset,\n                                 COTAN_data,\n                                 by=c(\"genes\",\"set_number\", \"clusters\"),\n                                 all.x = T, all.y= FALSE)\n\nSeurat_data_base &lt;- deaSeurat_tot_base[,c(\"genes\",\"set_number\",\"clusters\", \"p_val\")]\ncolnames(Seurat_data_base) &lt;- c(\"genes\",\"set_number\",\"clusters\",\"p_value_Seurat\")\n\nground_truth_tot_subset &lt;- merge(ground_truth_tot_subset,\n                                 Seurat_data_base,\n                                 by=c(\"genes\",\"set_number\",\"clusters\"),\n                                 all.x = T, all.y= FALSE)\n\nSeurat_data_scTr &lt;- deaSeurat_tot_scTr[,c(\"genes\",\"set_number\",\"clusters\", \"p_val\")]\ncolnames(Seurat_data_scTr) &lt;- c(\"genes\",\"set_number\",\"clusters\",\"p_value_Seurat_scTr\")\n\nground_truth_tot_subset &lt;- merge(ground_truth_tot_subset,\n                                 Seurat_data_scTr,\n                                 by=c(\"genes\",\"set_number\",\"clusters\"),\n                                 all.x = T, all.y= FALSE)\n\nSeurat_data_Bimod &lt;- deaSeurat_tot_Bimod[,c(\"genes\",\"set_number\",\"clusters\", \"p_val\")]\ncolnames(Seurat_data_Bimod) &lt;- c(\"genes\",\"set_number\",\"clusters\",\"p_value_Seurat_Bimod\")\n\nground_truth_tot_subset &lt;- merge(ground_truth_tot_subset,\n                                 Seurat_data_Bimod,\n                                 by=c(\"genes\",\"set_number\",\"clusters\"),\n                                 all.x = T, all.y= FALSE)\n\n\ndata_Monocle &lt;- deaMonocle_tot[,c(\"genes\",\"set_number\",\"clusters\", \"marker_test_p_value\")]\ncolnames(data_Monocle) &lt;- c(\"genes\",\"set_number\",\"clusters\",\"p_value_Monocle\")\n\nground_truth_tot_subset &lt;- merge(ground_truth_tot_subset,\n                                 data_Monocle,\n                                 by=c(\"genes\",\"set_number\",\"clusters\"),\n                                 all.x = T, all.y= FALSE)\n\ndata_Scanpy &lt;- deaScanpy_tot[,c(\"genes\",\"set_number\",\"clusters\", \"pval\")]\ncolnames(data_Scanpy) &lt;- c(\"genes\",\"set_number\",\"clusters\",\"p_value_Scanpy\")\n\nground_truth_tot_subset &lt;- merge(ground_truth_tot_subset,\n                                 data_Scanpy,\n                                 by=c(\"genes\",\"set_number\",\"clusters\"),\n                                 all.x = T, all.y= FALSE)\n\nground_truth_tot_subset &lt;- ground_truth_tot_subset %&gt;% mutate(lambda_bin = cut(genesLambda, breaks=50))\n\nground_truth_tot_subset[is.na(ground_truth_tot_subset)] &lt;- 1\n\nhead(ground_truth_tot_subset)\n\n          genes set_number  clusters value          data_set p_value_COTAN\n1 A330102I10Rik          2 E17.5-505  TRUE 5_Clusters_uneven  3.580400e-01\n2 A630089N07Rik          2 E13.5-184  TRUE 5_Clusters_uneven  1.152963e-10\n3 A830010M20Rik          1 E15.0-510  TRUE 5_Clusters_uneven  6.731088e-05\n4 A930004D18Rik          2 E13.5-184  TRUE 5_Clusters_uneven  1.847177e-04\n5         Aaed1          3 E13.5-187  TRUE 5_Clusters_uneven  1.613229e-05\n6          Abat          2 E15.0-428  TRUE 5_Clusters_uneven  4.997729e-07\n  genesLambda p_value_Seurat p_value_Seurat_scTr p_value_Seurat_Bimod\n1  0.03431373   1.000000e+00        1.000000e+00         2.718294e-04\n2  0.06617647   1.632048e-12        7.812652e-13         1.731541e-09\n3  0.07175926   2.117000e-07        1.205805e-07         1.913975e-06\n4  0.06740196   1.841516e-05        1.287232e-05         4.368518e-06\n5  0.01704158   8.730213e-07        7.218352e-07         3.744192e-05\n6  0.05514706   2.469818e-05        3.984286e-05         5.906623e-04\n  p_value_Monocle p_value_Scanpy       lambda_bin\n1    1.935776e-01    0.793509146  (0.0341,0.0641]\n2    1.328598e-09    0.004754579  (0.0641,0.0941]\n3    2.189873e-06    0.024391612  (0.0641,0.0941]\n4    1.947179e-04    0.074967388  (0.0641,0.0941]\n5    2.742404e-03    0.311500465 (0.00259,0.0341]\n6    6.040666e-05    0.102450927  (0.0341,0.0641]\n\n\n\nbins &lt;- levels(ground_truth_tot_subset$lambda_bin)\nbins &lt;- bins[!is.na(bins)]\n\nforBarChart &lt;- as.data.frame(matrix(nrow = length(bins),ncol = 7,data = 0))\n\ncolnames(forBarChart) &lt;- c(\"bins\",\"COTAN\",\"Seurat\",\"Seurat_Bimod\",\"Seurat_scTr\",\"Monocle\", \"Scanpy\")\nforBarChart$bins &lt;- bins\nrownames(forBarChart) &lt;- forBarChart$bins\n\n#p_val_threshold &lt;- 0.05\n\nfor (i in as.vector(forBarChart$bins)) {\n  forBarChart[ i,\"COTAN\"] &lt;- sum(ground_truth_tot_subset$lambda_bin == i & ground_truth_tot_subset$p_value_COTAN &lt;= cotan.threshold.pval)\n  \n  forBarChart[ i,\"Seurat\"] &lt;- sum(ground_truth_tot_subset$lambda_bin == i & ground_truth_tot_subset$p_value_Seurat &lt;= seurat.threshold.pval)\n  \n  forBarChart[ i,\"Seurat_Bimod\"] &lt;- sum(ground_truth_tot_subset$lambda_bin == i & ground_truth_tot_subset$p_value_Seurat_Bimod &lt;= seurat_bimod.threshold.pval)\n  \n  forBarChart[ i,\"Seurat_scTr\"] &lt;- sum(ground_truth_tot_subset$lambda_bin == i & ground_truth_tot_subset$p_value_Seurat_scTr &lt;= Seurat_scTr.threshold.pval)\n  \n  forBarChart[ i,\"Monocle\"] &lt;- sum(ground_truth_tot_subset$lambda_bin == i & ground_truth_tot_subset$p_value_Monocle &lt;= monocle.threshold.pval)\n  \n  forBarChart[ i,\"Scanpy\"] &lt;- sum(ground_truth_tot_subset$lambda_bin == i & ground_truth_tot_subset$p_value_Scanpy &lt;= scanpy.threshold.pval)\n  \n}\n\ntemp.bin &lt;- as.data.frame(str_split(forBarChart$bins,pattern = \",\",simplify = T))\ntemp.bin[,1] &lt;- as.numeric(str_remove(temp.bin[,1],pattern = \"[(]\"))\ntemp.bin[,2] &lt;- as.numeric(str_remove(temp.bin[,2],pattern = \"[]]\"))\n\nforBarChart$bins &lt;- round(rowMeans(temp.bin),digits = 2)\n\n\nforBarChart &lt;- forBarChart[rowSums(forBarChart[,2:ncol(forBarChart)]) &gt; 0,]\n\nforBarChart.perc &lt;- forBarChart[1:8,]\n\nforBarChart.perc$tot &lt;- rowSums(forBarChart.perc[,2:ncol(forBarChart.perc)])\n\nforBarChart.perc[,2:(ncol(forBarChart.perc)-1)] &lt;- round(forBarChart.perc[,2:(ncol(forBarChart.perc)-1)]/forBarChart.perc$tot,digits = 4)\n\nforBarChart.perc &lt;- pivot_longer(forBarChart.perc,\n                               cols = 2:(ncol(forBarChart.perc)-1),\n                               names_to = \"Methods\")\n\nforBarChart.number &lt;- pivot_longer(forBarChart[1:8,],\n                               cols = 2:(ncol(forBarChart)),\n                               names_to = \"Methods\")\n\ncolnames(forBarChart.number) &lt;- c(\"bins\",\"Methods\", \"valueOriginal\")\n\nforBarChart.perc &lt;- merge(forBarChart.perc,forBarChart.number, by = c(\"bins\",\"Methods\"))\n\nbarChart &lt;- ggplot(forBarChart.perc,aes(x=bins,y=value,fill=Methods))+\n  geom_bar(stat=\"identity\")+\n  geom_text(aes(label = valueOriginal), \n            position = position_stack(vjust = 0.5),  size=3)+\n  scale_fill_manual(\n    values = methods.color)+\n  theme_light()+\n  scale_x_continuous(breaks =forBarChart.perc$bins)+\n  theme(axis.title.y=element_blank(),axis.title.x=element_blank(),\n      legend.position=\"none\",axis.text.x = element_text(angle = 45, hjust=1)\n    )+\n  scale_y_continuous(labels = scales::percent_format())\n\npdf(paste0(dirOut,\"EnrichedGenesForExpressionLevel.pdf\"),height = 3,width = 5)\nbarChart\ndev.off()\n\npng \n  2 \n\nplot(barChart)\n\n\n\n\n\n\n\n\n\nplot.with.inset &lt;-\n  ggdraw() +\n  draw_plot(plot3) +\n  draw_plot(as_ggplot(lg), x = 0.18, y = 0.1, width = 0.2, height = .45)+\n  draw_plot(barChart, x = 0.78, y = 0.09, width = 0.22, height = .5)\n\npdf(paste0(dirOut,\"Plot3WihtGenesExLevel.pdf\"),height = 5,width = 15)\nplot(plot.with.inset)\ndev.off()\n\npng \n  2 \n\nplot(plot.with.inset)"
  },
  {
    "objectID": "FDR_analisysResults3_10_th04.html#footer",
    "href": "FDR_analisysResults3_10_th04.html#footer",
    "title": "FDR analysis - Results - thresholds true 3% 10%",
    "section": "Footer",
    "text": "Footer\n\nsessionInfo()\n\nR version 4.5.2 (2025-10-31)\nPlatform: x86_64-pc-linux-gnu\nRunning under: Ubuntu 22.04.5 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.10.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.10.0  LAPACK version 3.10.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] ggpubr_0.6.0                ggplot2_4.0.1              \n [3] tidyr_1.3.1                 dplyr_1.1.4                \n [5] stringr_1.5.1               cowplot_1.1.3              \n [7] reticulate_1.42.0           monocle3_1.3.7             \n [9] SingleCellExperiment_1.30.0 SummarizedExperiment_1.38.1\n[11] GenomicRanges_1.60.0        GenomeInfoDb_1.44.0        \n[13] IRanges_2.42.0              S4Vectors_0.46.0           \n[15] MatrixGenerics_1.20.0       matrixStats_1.5.0          \n[17] Biobase_2.68.0              BiocGenerics_0.54.0        \n[19] generics_0.1.3              Seurat_5.2.1               \n[21] SeuratObject_5.1.0          sp_2.2-0                   \n[23] pROC_1.18.5                 COTAN_2.9.4                \n\nloaded via a namespace (and not attached):\n  [1] RcppAnnoy_0.0.22        splines_4.5.2           later_1.4.2            \n  [4] tibble_3.3.0            polyclip_1.10-7         fastDummies_1.7.5      \n  [7] lifecycle_1.0.4         rstatix_0.7.2           Rdpack_2.6.4           \n [10] doParallel_1.0.17       globals_0.18.0          lattice_0.22-7         \n [13] MASS_7.3-65             backports_1.5.0         dendextend_1.19.0      \n [16] magrittr_2.0.4          plotly_4.11.0           rmarkdown_2.29         \n [19] yaml_2.3.10             httpuv_1.6.16           sctransform_0.4.2      \n [22] spam_2.11-1             spatstat.sparse_3.1-0   minqa_1.2.8            \n [25] pbapply_1.7-2           RColorBrewer_1.1-3      abind_1.4-8            \n [28] Rtsne_0.17              purrr_1.2.0             circlize_0.4.16        \n [31] GenomeInfoDbData_1.2.14 ggrepel_0.9.6           irlba_2.3.5.1          \n [34] listenv_0.9.1           spatstat.utils_3.1-4    goftest_1.2-3          \n [37] RSpectra_0.16-2         spatstat.random_3.4-1   fitdistrplus_1.2-2     \n [40] parallelly_1.45.0       codetools_0.2-20        DelayedArray_0.34.1    \n [43] tidyselect_1.2.1        shape_1.4.6.1           UCSC.utils_1.4.0       \n [46] farver_2.1.2            lme4_1.1-37             ScaledMatrix_1.16.0    \n [49] viridis_0.6.5           spatstat.explore_3.4-2  jsonlite_2.0.0         \n [52] GetoptLong_1.0.5        gghalves_0.1.4          Formula_1.2-5          \n [55] progressr_0.15.1        ggridges_0.5.6          survival_3.8-3         \n [58] iterators_1.0.14        foreach_1.5.2           tools_4.5.2            \n [61] ica_1.0-3               Rcpp_1.0.14             glue_1.8.0             \n [64] gridExtra_2.3           SparseArray_1.8.0       xfun_0.52              \n [67] ggthemes_5.1.0          withr_3.0.2             fastmap_1.2.0          \n [70] boot_1.3-32             digest_0.6.37           rsvd_1.0.5             \n [73] parallelDist_0.2.6      R6_2.6.1                mime_0.13              \n [76] colorspace_2.1-1        scattermore_1.2         tensor_1.5             \n [79] spatstat.data_3.1-6     utf8_1.2.5              data.table_1.17.0      \n [82] httr_1.4.7              htmlwidgets_1.6.4       S4Arrays_1.8.0         \n [85] uwot_0.2.3              pkgconfig_2.0.3         gtable_0.3.6           \n [88] ComplexHeatmap_2.24.0   lmtest_0.9-40           S7_0.2.1               \n [91] XVector_0.48.0          htmltools_0.5.8.1       carData_3.0-5          \n [94] dotCall64_1.2           zigg_0.0.2              clue_0.3-66            \n [97] scales_1.4.0            png_0.1-8               reformulas_0.4.1       \n[100] spatstat.univar_3.1-3   knitr_1.50              reshape2_1.4.4         \n[103] rjson_0.2.23            nloptr_2.2.1            nlme_3.1-168           \n[106] proxy_0.4-27            zoo_1.8-14              GlobalOptions_0.1.2    \n[109] KernSmooth_2.23-26      parallel_4.5.2          miniUI_0.1.2           \n[112] pillar_1.10.2           grid_4.5.2              vctrs_0.6.5            \n[115] RANN_2.6.2              promises_1.3.2          car_3.1-3              \n[118] BiocSingular_1.24.0     beachmat_2.24.0         xtable_1.8-4           \n[121] cluster_2.1.8.1         evaluate_1.0.3          zeallot_0.2.0          \n[124] cli_3.6.5               compiler_4.5.2          rlang_1.1.6            \n[127] crayon_1.5.3            ggsignif_0.6.4          future.apply_1.20.0    \n[130] labeling_0.4.3          plyr_1.8.9              stringi_1.8.7          \n[133] viridisLite_0.4.2       deldir_2.0-4            BiocParallel_1.42.0    \n[136] assertthat_0.2.1        lazyeval_0.2.2          spatstat.geom_3.4-1    \n[139] Matrix_1.7-4            RcppHNSW_0.6.0          patchwork_1.3.2        \n[142] future_1.58.0           shiny_1.11.0            rbibutils_2.3          \n[145] ROCR_1.0-11             Rfast_2.1.5.1           broom_1.0.8            \n[148] igraph_2.1.4            RcppParallel_5.1.10"
  }
]