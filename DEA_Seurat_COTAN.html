<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>COTAN Datasets analysis - DEA comparison Seurat - Cotan</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./DEA_Seurat_COTAN.html">DEA evaluation</a></li><li class="breadcrumb-item"><a href="./DEA_Seurat_COTAN.html">DEA comparison Seurat - Cotan</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">COTAN Datasets analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Mouse Cortex Loo 2019</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Dataset1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneCoexAnalysisDataset1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coexpression analaysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Mouse Cortex Yuzwa 2017</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CorticalCells_GSM2861511_E135-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E13.5 Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneCoexAnalysisE13.5Yuzwa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation analysis for E13.5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CorticalCells_GSM2861514_E175-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E17.5 Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneCoexAnalysisE17.5Yuzwa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation analysis for E17.5</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Mouse Brain</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ForebrainDorsal_E135-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E13.5 Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneCoexAnalysisE13.5MouseBrain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation analysis for E13.5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ForebrainDorsal_E150-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E15.0 Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneCoexAnalysisE15.0MouseBrain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation analysis for E15.0</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ForebrainDorsal_E175-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E17.5 Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneCoexAnalysisE17.5MouseBrain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation analysis for E17.5</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Coex score evaluation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalCoexAssess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Coex Evaluation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">GDI sensitivity</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cd14_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CD14+ Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FindUniformOrigCluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cluster Unifomity and GDI score</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Cluster evaluation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cd14_clusterizations_comparisons.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CD14+ clusterizations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true">
 <span class="menu-text">DEA evaluation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DEA_Seurat_COTAN.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">DEA comparison Seurat - Cotan</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cotan-differential-expression" id="toc-cotan-differential-expression" class="nav-link active" data-scroll-target="#cotan-differential-expression">Cotan differential expression</a></li>
  <li><a href="#seurat-object-creation" id="toc-seurat-object-creation" class="nav-link" data-scroll-target="#seurat-object-creation">Seurat object creation</a></li>
  <li><a href="#comparision-cotan-seurat" id="toc-comparision-cotan-seurat" class="nav-link" data-scroll-target="#comparision-cotan-seurat">Comparision COTAN-Seurat</a>
  <ul class="collapse">
  <li><a href="#cajal-retzius-subclass" id="toc-cajal-retzius-subclass" class="nav-link" data-scroll-target="#cajal-retzius-subclass">Cajal-Retzius subclass</a></li>
  <li><a href="#cortical-or-hippocampal-glutamatergic-subclass" id="toc-cortical-or-hippocampal-glutamatergic-subclass" class="nav-link" data-scroll-target="#cortical-or-hippocampal-glutamatergic-subclass">Cortical or hippocampal glutamatergic subclass</a></li>
  <li><a href="#forebrain-gabaergic-subclass" id="toc-forebrain-gabaergic-subclass" class="nav-link" data-scroll-target="#forebrain-gabaergic-subclass">Forebrain GABAergic subclass</a></li>
  <li><a href="#cluster-neur509" id="toc-cluster-neur509" class="nav-link" data-scroll-target="#cluster-neur509">Cluster Neur509</a></li>
  <li><a href="#cluster-neur508" id="toc-cluster-neur508" class="nav-link" data-scroll-target="#cluster-neur508">Cluster Neur508</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">DEA comparison Seurat - Cotan</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tibble)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(zeallot)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(COTAN)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(rlang)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Seurat)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(wordcloud)</span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(assertr)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggVennDiagram)</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(enrichR)</span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>websiteLive <span class="ot">&lt;-</span> <span class="fu">getOption</span>(<span class="st">"enrichR.live"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> (websiteLive) dbs <span class="ot">&lt;-</span> <span class="fu">listEnrichrDbs</span>()</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dbs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  geneCoverage genesPerTerm                      libraryName
1        13362          275              Genome_Browser_PWMs
2        27884         1284         TRANSFAC_and_JASPAR_PWMs
3         6002           77        Transcription_Factor_PPIs
4        47172         1370                        ChEA_2013
5        47107          509 Drug_Perturbations_from_GEO_2014
6        21493         3713          ENCODE_TF_ChIP-seq_2014
                                                      link numTerms
1 http://hgdownload.cse.ucsc.edu/goldenPath/hg18/database/      615
2                 http://jaspar.genereg.net/html/DOWNLOAD/      326
3                                                               290
4           http://amp.pharm.mssm.edu/lib/cheadownload.jsp      353
5                         http://www.ncbi.nlm.nih.gov/geo/      701
6             http://genome.ucsc.edu/ENCODE/downloads.html      498
                                   appyter categoryId
1 ea115789fcbf12797fd692cec6df0ab4dbc79c6a          1
2 7d42eb43a64a4e3b20d721fc7148f685b53b6b30          1
3 849f222220618e2599d925b6b51868cf1dab3763          1
4 7ebe772afb55b63b41b79dd8d06ea0fdd9fa2630          7
5 ad270a6876534b7cb063e004289dcd4d3164f342          7
6 497787ebc418d308045efb63b8586f10c526af51          7</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#dbs &lt;- "Tabula_Muris"</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>dbs <span class="ot">&lt;-</span> <span class="st">"ARCHS4_Tissues"</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">parallelly.fork.enable =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>outDir <span class="ot">&lt;-</span> <span class="st">"./e15.0_FD_CheckClustersUniformity"</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">setLoggingLevel</span>(<span class="dv">1</span>)</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a><span class="fu">setLoggingFile</span>(<span class="fu">file.path</span>(outDir, <span class="st">"FindUniformGivenClustersInForebrainDorsal_E150.log"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>fb150ObjRaw <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="fu">file.path</span>(<span class="st">"Data/MouseCortexFromLoom/SourceData/"</span>, <span class="st">"e15.0_ForebrainDorsal.cotan.RDS"</span>))</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>fb150Obj <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="fu">file.path</span>(<span class="st">"Data/MouseCortexFromLoom/"</span>, <span class="st">"e15.0_ForebrainDorsal.cotan.RDS"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Align to cleaned cells’ list</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>metaC <span class="ot">&lt;-</span> <span class="fu">getMetadataCells</span>(fb150ObjRaw)[<span class="fu">getCells</span>(fb150Obj), ]</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co">#metaCDrop &lt;- getMetadataCells(fb150ObjRaw)[!getCells(fb150ObjRaw) %in% getCells(fb150Obj), ]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Extract the cells of class ‘Neuron’</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>metaNeuron <span class="ot">&lt;-</span> metaC[metaC[[<span class="st">"Class"</span>]] <span class="sc">==</span> <span class="st">"Neuron"</span>, ]</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">table</span>(metaNeuron[[<span class="st">"Subclass"</span>]]), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Cortical or hippocampal glutamatergic                   Forebrain GABAergic 
                                 3969                                   610 
                        Cajal-Retzius                Mixed region GABAergic 
                                  145                                    21 
                            Undefined               Forebrain glutamatergic 
                                   16                                    15 
                         Hypothalamus            Mixed region glutamatergic 
                                    8                                     5 
    Mixed region and neurotransmitter               Hindbrain glutamatergic 
                                    4                                     2 
                Hindbrain glycinergic            Hypothalamus glutamatergic 
                                    2                                     2 
        Dorsal midbrain glutamatergic                          Mixed region 
                                    1                                     1 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sort</span>(<span class="fu">table</span>(metaNeuron[[<span class="st">"ClusterName"</span>]]), <span class="at">decreasing =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Neur525 Neur511 Neur509 Neur510 Neur508 Neur507 Neur568 Neur504 Neur505 Neur516 
    826     540     402     402     397     183     181     174     147     137 
Neur565 Neur524 Neur679 Neur493 Neur498 Neur497 Neur506 Neur502 Neur494 Neur574 
    133     108     105      93      79      51      46      42      41      41 
Neur575 Neur492 Neur519 Neur526 Neur566 Neur501 Neur573 Neur499 Neur518 Neur560 
     41      38      31      28      28      24      24      23      22      20 
Neur514 Neur523 Neur569 Neur557 Neur495 Neur520 Neur535 Neur542 Neur677 Neur527 
     19      19      18      16      15      15      14      14      14      13 
Neur496 Neur512 Neur676 Neur517 Neur558 Neur503 Neur739 Neur559 Neur564 Neur538 
     11      11      11      10       9       8       8       7       7       6 
Neur549 Neur561 Neur671 Neur695 Neur738 Neur747 Neur500 Neur536 Neur678 Neur534 
      6       6       6       6       6       6       5       5       5       4 
Neur550 Neur570 Neur686 Neur731 Neur737 Neur513 Neur515 Neur528 Neur533 Neur539 
      4       4       4       4       4       3       3       3       3       3 
Neur544 Neur571 Neur674 Neur675 Neur732 Neur531 Neur543 Neur548 Neur552 Neur554 
      3       3       3       3       3       2       2       2       2       2 
Neur562 Neur670 Neur689 Neur740 Neur529 Neur530 Neur532 Neur537 Neur540 Neur553 
      2       2       2       2       1       1       1       1       1       1 
Neur567 Neur572 Neur601 Neur614 Neur634 Neur647 Neur649 Neur672 Neur680 Neur681 
      1       1       1       1       1       1       1       1       1       1 
Neur684 Neur693 Neur696 Neur726 Neur734 Neur749 Neur750 Neur751 Neur760 Neur771 
      1       1       1       1       1       1       1       1       1       1 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>cl.to.keep <span class="ot">&lt;-</span> <span class="fu">names</span>(<span class="fu">table</span>(metaNeuron[[<span class="st">"ClusterName"</span>]])[<span class="fu">table</span>(metaNeuron[[<span class="st">"ClusterName"</span>]]) <span class="sc">&gt;=</span> 20L])</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>meta.to.keep <span class="ot">&lt;-</span> metaNeuron[metaNeuron<span class="sc">$</span>ClusterName <span class="sc">%in%</span> cl.to.keep,]</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(meta.to.keep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4407   41</code></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(metaNeuron)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4801   41</code></pre>
</div>
</div>
<p>Dropped cell</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(metaNeuron)[<span class="dv">1</span>] <span class="sc">-</span> <span class="fu">dim</span>(meta.to.keep)[<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 394</code></pre>
</div>
</div>
<p>Removing cells</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>cell.to.drop <span class="ot">&lt;-</span> <span class="fu">getCells</span>(fb150Obj)[<span class="sc">!</span><span class="fu">getCells</span>(fb150Obj) <span class="sc">%in%</span> <span class="fu">rownames</span>(meta.to.keep)]</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>fb150Obj <span class="ot">&lt;-</span> <span class="fu">dropGenesCells</span>(fb150Obj,<span class="at">cells =</span> cell.to.drop)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(meta.to.keep)[<span class="dv">1</span>] <span class="sc">==</span> <span class="fu">dim</span>(<span class="fu">getRawData</span>(fb150Obj))[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>metaC <span class="ot">&lt;-</span> <span class="fu">getMetadataCells</span>(fb150ObjRaw)[<span class="fu">getCells</span>(fb150Obj), ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>fb150Obj <span class="ot">&lt;-</span> <span class="fu">clean</span>(fb150Obj)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>fb150Obj <span class="ot">&lt;-</span> <span class="fu">estimateDispersionBisection</span>(fb150Obj)</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(fb150Obj<span class="sc">@</span>metaCells), <span class="fu">rownames</span>(metaC))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>fb150Obj<span class="sc">@</span>metaCells <span class="ot">&lt;-</span> <span class="fu">cbind</span>(fb150Obj<span class="sc">@</span>metaCells,metaC)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>fb150Obj<span class="sc">@</span>metaCells[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>,]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                            feCells        nu feCells        nu   Age
10X74_4_A_1:TGGTAGACCCTACCx   FALSE 0.9375770   FALSE 0.9214807 e15.0
10X73_3_A_1:TACCGGCTTCAGTGx   FALSE 0.7855991   FALSE 0.7722440 e15.0
10X74_4_A_1:CCCAGTTGGAGGTGx   FALSE 0.6983103   FALSE 0.6863260 e15.0
10X73_3_A_1:AATTGATGAGAATGx   FALSE 1.1751850   FALSE 1.1548031 e15.0
10X74_4_A_1:TAGTGGTGAGTAGAx   FALSE 1.1001290   FALSE 1.0808973 e15.0
10X74_4_A_1:ATTATGGACTACGAx   FALSE 1.3074658   FALSE 1.2844945 e15.0
10X64_3_A_1:TGTATCTGCCTTATx   FALSE 1.4138296   FALSE 1.3891434 e15.0
10X64_3_A_1:TAGTATGACTATGGx   FALSE 1.6528889   FALSE 1.6249089 e15.0
10X73_3_A_1:ACTTGGGATTGCAGx   FALSE 0.7482785   FALSE 0.7355965 e15.0
10X74_4_A_1:AGCTCGCTCCATGAx   FALSE 1.1109106   FALSE 1.0914844 e15.0
                                       CellCycle                      CellID
10X74_4_A_1:TGGTAGACCCTACCx  0.00308982564555286 10X74_4_A_1:TGGTAGACCCTACCx
10X73_3_A_1:TACCGGCTTCAGTGx 0.000789058390320884 10X73_3_A_1:TACCGGCTTCAGTGx
10X74_4_A_1:CCCAGTTGGAGGTGx  0.00177988727380599 10X74_4_A_1:CCCAGTTGGAGGTGx
10X73_3_A_1:AATTGATGAGAATGx 0.000880436696601514 10X73_3_A_1:AATTGATGAGAATGx
10X74_4_A_1:TAGTGGTGAGTAGAx 0.000752021056589585 10X74_4_A_1:TAGTGGTGAGTAGAx
10X74_4_A_1:ATTATGGACTACGAx  0.00174133291119202 10X74_4_A_1:ATTATGGACTACGAx
10X64_3_A_1:TGTATCTGCCTTATx 0.000878348704435661 10X64_3_A_1:TGTATCTGCCTTATx
10X64_3_A_1:TAGTATGACTATGGx  0.00125156445556946 10X64_3_A_1:TAGTATGACTATGGx
10X73_3_A_1:ACTTGGGATTGCAGx  0.00221177771633951 10X73_3_A_1:ACTTGGGATTGCAGx
10X74_4_A_1:AGCTCGCTCCATGAx  0.00111835973904939 10X74_4_A_1:AGCTCGCTCCATGAx
                            Cell_Conc Chemistry ChipID  Class ClusterName
10X74_4_A_1:TGGTAGACCCTACCx       600        v2  10X74 Neuron     Neur492
10X73_3_A_1:TACCGGCTTCAGTGx       600        v2  10X73 Neuron     Neur492
10X74_4_A_1:CCCAGTTGGAGGTGx       600        v2  10X74 Neuron     Neur492
10X73_3_A_1:AATTGATGAGAATGx       600        v2  10X73 Neuron     Neur492
10X74_4_A_1:TAGTGGTGAGTAGAx       600        v2  10X74 Neuron     Neur492
10X74_4_A_1:ATTATGGACTACGAx       600        v2  10X74 Neuron     Neur492
10X64_3_A_1:TGTATCTGCCTTATx       600        v2  10X64 Neuron     Neur492
10X64_3_A_1:TAGTATGACTATGGx       600        v2  10X64 Neuron     Neur492
10X73_3_A_1:ACTTGGGATTGCAGx       600        v2  10X73 Neuron     Neur492
10X74_4_A_1:AGCTCGCTCCATGAx       600        v2  10X74 Neuron     Neur492
                            Clusters Date_Captured    DonorID
10X74_4_A_1:TGGTAGACCCTACCx      492    2016-11-30 Batch14K-2
10X73_3_A_1:TACCGGCTTCAGTGx      492    2016-11-30 Batch14K-2
10X74_4_A_1:CCCAGTTGGAGGTGx      492    2016-11-30 Batch14K-2
10X73_3_A_1:AATTGATGAGAATGx      492    2016-11-30 Batch14K-2
10X74_4_A_1:TAGTGGTGAGTAGAx      492    2016-11-30 Batch14K-2
10X74_4_A_1:ATTATGGACTACGAx      492    2016-11-30 Batch14K-2
10X64_3_A_1:TGTATCTGCCTTATx      492    2016-11-15 Batch11H-5
10X64_3_A_1:TAGTATGACTATGGx      492    2016-11-15 Batch11H-5
10X73_3_A_1:ACTTGGGATTGCAGx      492    2016-11-30 Batch14K-2
10X74_4_A_1:AGCTCGCTCCATGAx      492    2016-11-30 Batch14K-2
                              DoubletFinderPCA         HPF_LogPP IsCycling
10X74_4_A_1:TGGTAGACCCTACCx                  0 -881923.697556259         0
10X73_3_A_1:TACCGGCTTCAGTGx                  0 -621646.228431766         0
10X74_4_A_1:CCCAGTTGGAGGTGx 0.0303030303030303 -615788.630071891         0
10X73_3_A_1:AATTGATGAGAATGx  0.027027027027027 -1043580.43446046         0
10X74_4_A_1:TAGTGGTGAGTAGAx 0.0606060606060606 -892588.390822332         0
10X74_4_A_1:ATTATGGACTACGAx 0.0606060606060606 -1057464.46525045         0
10X64_3_A_1:TGTATCTGCCTTATx 0.0588235294117647 -1259381.55581998         0
10X64_3_A_1:TAGTATGACTATGGx  0.147058823529412 -1384562.64613975         0
10X73_3_A_1:ACTTGGGATTGCAGx  0.027027027027027 -766332.582748427         0
10X74_4_A_1:AGCTCGCTCCATGAx                  0 -760899.629760664         0
                            Label Location_E9_E11 NCellsCluster NGenes
10X74_4_A_1:TGGTAGACCCTACCx  G119             nan           457   2402
10X73_3_A_1:TACCGGCTTCAGTGx  G115             nan           457   2034
10X74_4_A_1:CCCAGTTGGAGGTGx  G119             nan           457   1915
10X73_3_A_1:AATTGATGAGAATGx  G115             nan           457   2555
10X74_4_A_1:TAGTGGTGAGTAGAx  G119             nan           457   2448
10X74_4_A_1:ATTATGGACTACGAx  G119             nan           457   2785
10X64_3_A_1:TGTATCTGCCTTATx   G94             nan           457   2842
10X64_3_A_1:TAGTATGACTATGGx   G94             nan           457   3160
10X73_3_A_1:ACTTGGGATTGCAGx  G115             nan           457   2033
10X74_4_A_1:AGCTCGCTCCATGAx  G119             nan           457   2469
                            Num_Pooled_Animals PCR_Cycles  Plug_Date Project
10X74_4_A_1:TGGTAGACCCTACCx                  3         13 2016-11-15     Dev
10X73_3_A_1:TACCGGCTTCAGTGx                  3         13 2016-11-15     Dev
10X74_4_A_1:CCCAGTTGGAGGTGx                  3         13 2016-11-15     Dev
10X73_3_A_1:AATTGATGAGAATGx                  3         13 2016-11-15     Dev
10X74_4_A_1:TAGTGGTGAGTAGAx                  3         13 2016-11-15     Dev
10X74_4_A_1:ATTATGGACTACGAx                  3         13 2016-11-15     Dev
10X64_3_A_1:TGTATCTGCCTTATx                  3         13 2016-10-31     Dev
10X64_3_A_1:TAGTATGACTATGGx                  3         13 2016-10-31     Dev
10X73_3_A_1:ACTTGGGATTGCAGx                  3         13 2016-11-15     Dev
10X74_4_A_1:AGCTCGCTCCATGAx                  3         13 2016-11-15     Dev
                            PseudoAge     PseudoTissue    Region SampleID
10X74_4_A_1:TGGTAGACCCTACCx    15.905  ForebrainDorsal Forebrain  10X74_4
10X73_3_A_1:TACCGGCTTCAGTGx    13.155  ForebrainDorsal Forebrain  10X73_3
10X74_4_A_1:CCCAGTTGGAGGTGx    13.935  ForebrainDorsal Forebrain  10X74_4
10X73_3_A_1:AATTGATGAGAATGx     15.54  ForebrainDorsal Forebrain  10X73_3
10X74_4_A_1:TAGTGGTGAGTAGAx    14.595  ForebrainDorsal Forebrain  10X74_4
10X74_4_A_1:ATTATGGACTACGAx   14.3725  ForebrainDorsal Forebrain  10X74_4
10X64_3_A_1:TGTATCTGCCTTATx   15.1275  ForebrainDorsal Forebrain  10X64_3
10X64_3_A_1:TAGTATGACTATGGx    16.225  ForebrainDorsal Forebrain  10X64_3
10X73_3_A_1:ACTTGGGATTGCAGx   12.8175 ForebrainVentral Forebrain  10X73_3
10X74_4_A_1:AGCTCGCTCCATGAx   14.7975  ForebrainDorsal Forebrain  10X74_4
                            SampleName Sample_Index Sex Species Split Strain
10X74_4_A_1:TGGTAGACCCTACCx       G119     SI-3A-E7   ?      Mm     0   CD-1
10X73_3_A_1:TACCGGCTTCAGTGx       G115     SI-3A-A7   ?      Mm     0   CD-1
10X74_4_A_1:CCCAGTTGGAGGTGx       G119     SI-3A-E7   ?      Mm     0   CD-1
10X73_3_A_1:AATTGATGAGAATGx       G115     SI-3A-A7   ?      Mm     0   CD-1
10X74_4_A_1:TAGTGGTGAGTAGAx       G119     SI-3A-E7   ?      Mm     0   CD-1
10X74_4_A_1:ATTATGGACTACGAx       G119     SI-3A-E7   ?      Mm     0   CD-1
10X64_3_A_1:TGTATCTGCCTTATx        G94     SI-3A-H3   ?      Mm     0   CD-1
10X64_3_A_1:TAGTATGACTATGGx        G94     SI-3A-H3   ?      Mm     0   CD-1
10X73_3_A_1:ACTTGGGATTGCAGx       G115     SI-3A-A7   ?      Mm     0   CD-1
10X74_4_A_1:AGCTCGCTCCATGAx       G119     SI-3A-E7   ?      Mm     0   CD-1
                                                         Subclass
10X74_4_A_1:TGGTAGACCCTACCx Cortical or hippocampal glutamatergic
10X73_3_A_1:TACCGGCTTCAGTGx Cortical or hippocampal glutamatergic
10X74_4_A_1:CCCAGTTGGAGGTGx Cortical or hippocampal glutamatergic
10X73_3_A_1:AATTGATGAGAATGx Cortical or hippocampal glutamatergic
10X74_4_A_1:TAGTGGTGAGTAGAx Cortical or hippocampal glutamatergic
10X74_4_A_1:ATTATGGACTACGAx Cortical or hippocampal glutamatergic
10X64_3_A_1:TGTATCTGCCTTATx Cortical or hippocampal glutamatergic
10X64_3_A_1:TAGTATGACTATGGx Cortical or hippocampal glutamatergic
10X73_3_A_1:ACTTGGGATTGCAGx Cortical or hippocampal glutamatergic
10X74_4_A_1:AGCTCGCTCCATGAx Cortical or hippocampal glutamatergic
                            Target_Num_Cells          Tissue TotalUMI
10X74_4_A_1:TGGTAGACCCTACCx             3500 ForebrainDorsal     4531
10X73_3_A_1:TACCGGCTTCAGTGx             3500 ForebrainDorsal     3802
10X74_4_A_1:CCCAGTTGGAGGTGx             3500 ForebrainDorsal     3371
10X73_3_A_1:AATTGATGAGAATGx             3500 ForebrainDorsal     5679
10X74_4_A_1:TAGTGGTGAGTAGAx             3500 ForebrainDorsal     5319
10X74_4_A_1:ATTATGGACTACGAx             3500 ForebrainDorsal     6317
10X64_3_A_1:TGTATCTGCCTTATx             3500 ForebrainDorsal     6831
10X64_3_A_1:TAGTATGACTATGGx             3500 ForebrainDorsal     7990
10X73_3_A_1:ACTTGGGATTGCAGx             3500 ForebrainDorsal     3617
10X74_4_A_1:AGCTCGCTCCATGAx             3500 ForebrainDorsal     5365
                            Transcriptome cDNA_Lib_Ok ngperul_cDNA
10X74_4_A_1:TGGTAGACCCTACCx          mm10           Y          3,1
10X73_3_A_1:TACCGGCTTCAGTGx          mm10           Y          3,4
10X74_4_A_1:CCCAGTTGGAGGTGx          mm10           Y          3,1
10X73_3_A_1:AATTGATGAGAATGx          mm10           Y          3,4
10X74_4_A_1:TAGTGGTGAGTAGAx          mm10           Y          3,1
10X74_4_A_1:ATTATGGACTACGAx          mm10           Y          3,1
10X64_3_A_1:TGTATCTGCCTTATx          mm10           Y          3,5
10X64_3_A_1:TAGTATGACTATGGx          mm10           Y          3,5
10X73_3_A_1:ACTTGGGATTGCAGx          mm10           Y          3,4
10X74_4_A_1:AGCTCGCTCCATGAx          mm10           Y          3,1</code></pre>
</div>
</div>
<section id="cotan-differential-expression" class="level2">
<h2 class="anchored" data-anchor-id="cotan-differential-expression">Cotan differential expression</h2>
<p>DEA on Subclass groups formed by just three cell types: Cortical or hippocampal glutamatergic, Forebrain GABAergic and Cajal-Retzius.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>clusters.cells <span class="ot">&lt;-</span> <span class="fu">set_names</span>(fb150Obj<span class="sc">@</span>metaCells<span class="sc">$</span>Subclass,<span class="at">nm =</span> <span class="fu">rownames</span>(fb150Obj<span class="sc">@</span>metaCells))</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>dea.Subclass <span class="ot">&lt;-</span> <span class="fu">DEAOnClusters</span>(fb150Obj,<span class="at">clusters =</span> clusters.cells)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dea.Subclass<span class="sc">$</span>coex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Cajal-Retzius Cortical or hippocampal glutamatergic Forebrain GABAergic
Lamc1   -0.026166913                          -0.003964787          0.02109719
Lama1   -0.021046008                          -0.059311990          0.08266931
Hs3st1   0.009828396                           0.072980864         -0.08910190
Fabp3   -0.090809976                           0.106706770         -0.06883822
Nrg2    -0.001594555                          -0.025294811          0.03037227
Bend4    0.009762501                          -0.192484391          0.21811993</code></pre>
</div>
</div>
<p>DEA on ClusterName: [1] “Neur492” “Neur493” “Neur494” “Neur497” “Neur498” “Neur499” “Neur501” “Neur502” “Neur504” [10] “Neur505” “Neur506” “Neur507” “Neur508” “Neur509” “Neur510” “Neur511” “Neur516” “Neur518” [19] “Neur519” “Neur524” “Neur525” “Neur526” “Neur560” “Neur565” “Neur566” “Neur568” “Neur573” [28] “Neur574” “Neur575” “Neur679”</p>
<p>30 different cell groups.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>clusters.cells <span class="ot">&lt;-</span> <span class="fu">set_names</span>(fb150Obj<span class="sc">@</span>metaCells<span class="sc">$</span>ClusterName,<span class="at">nm =</span> <span class="fu">rownames</span>(fb150Obj<span class="sc">@</span>metaCells))</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>dea.ClusterName <span class="ot">&lt;-</span> <span class="fu">DEAOnClusters</span>(fb150Obj,<span class="at">clusters =</span> clusters.cells)</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(dea.ClusterName<span class="sc">$</span>coex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            Neur492       Neur493      Neur494      Neur497      Neur498
Lamc1  -0.015142482  0.0052112095 -0.007566741  0.026741619  0.010599224
Lama1  -0.009632159 -0.0002343889 -0.010660671 -0.011372217 -0.004549478
Hs3st1  0.017614822 -0.0670123869  0.031852014 -0.033595679 -0.051990356
Fabp3  -0.013876113  0.0978372006  0.033870283 -0.018363993 -0.001097806
Nrg2   -0.005434727  0.0035304650  0.005300480 -0.008163350 -0.009236954
Bend4  -0.006635644 -0.0051243739 -0.007347493 -0.007827941 -0.014149243
            Neur499      Neur501      Neur502     Neur504      Neur505
Lamc1  -0.002987865  0.010825673 -0.020364010 -0.01240859 -0.008362820
Lama1  -0.004586508 -0.004627726  0.008897717 -0.02182153  0.013489025
Hs3st1 -0.028752186  0.116297848  0.039591917  0.09582077  0.080567467
Fabp3  -0.001637069 -0.017191649 -0.010664235 -0.06640263 -0.046594627
Nrg2   -0.010451945  0.004869471  0.015748204 -0.02610886 -0.001227308
Bend4   0.027951286  0.012358515 -0.004432487 -0.01802341 -0.003364840
             Neur506      Neur507      Neur508      Neur509      Neur510
Lamc1  -0.0137768308  0.013438810  0.003655012  0.015332401 -0.022982461
Lama1   0.0473493936 -0.001843277 -0.020074771 -0.004309732 -0.022499414
Hs3st1  0.0009883989 -0.044753051 -0.005629901  0.113439645 -0.017375581
Fabp3   0.0495867141 -0.030231847 -0.043623601 -0.077834754  0.043983043
Nrg2   -0.0005773858 -0.024882460 -0.051351834 -0.033940039 -0.006889284
Bend4  -0.0096820697 -0.023076428 -0.024799514 -0.026800103 -0.023813556
            Neur511      Neur516      Neur518      Neur519      Neur524
Lamc1  -0.006029846  0.029054227 -0.001584281 -0.023778455  0.010622135
Lama1  -0.007894555 -0.022458902 -0.008383886 -0.008774730 -0.008985542
Hs3st1  0.026348751  0.015910202 -0.022958194 -0.011012483 -0.026955014
Fabp3   0.025743620 -0.017541959  0.038232083  0.016478606  0.086814711
Nrg2   -0.041561278  0.008453141 -0.002869805  0.037131271  0.077391246
Bend4  -0.032179960  0.006955173 -0.005798012 -0.006054586  0.010811234
            Neur525       Neur526      Neur560     Neur565      Neur566
Lamc1  -0.005698386  8.098411e-03 -0.002777033  0.02760694  0.042467086
Lama1   0.021459376 -5.210111e-03  0.026547559  0.05971741  0.026773138
Hs3st1 -0.058540117 -5.159973e-03 -0.028545565 -0.03421586 -0.018237097
Fabp3   0.104026536 -4.399868e-05 -0.031478717 -0.01143598 -0.007057800
Nrg2    0.067456393  1.888367e-02  0.036151663  0.04125869  0.005918738
Bend4  -0.035214002 -3.580672e-03 -0.003135888  0.21473720  0.012669639
             Neur568      Neur573      Neur574      Neur575      Neur679
Lamc1  -0.0238073082  0.016259061  0.029273702 -0.006876455 -0.026166913
Lama1   0.0269694769  0.011948982 -0.005923828  0.009594151 -0.021046008
Hs3st1 -0.0557759330 -0.025415472 -0.033200908 -0.024987623  0.009828396
Fabp3  -0.0650712806 -0.026079990 -0.007401114 -0.012669512 -0.090809976
Nrg2    0.0004859691 -0.008135245  0.001663527 -0.013282661 -0.001594555
Bend4   0.1394771632 -0.002429324 -0.004063790  0.011455264  0.009762501</code></pre>
</div>
</div>
</section>
<section id="seurat-object-creation" class="level2">
<h2 class="anchored" data-anchor-id="seurat-object-creation">Seurat object creation</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>seurat.obj <span class="ot">&lt;-</span> <span class="fu">CreateSeuratObject</span>(<span class="at">counts =</span> <span class="fu">getRawData</span>(fb150Obj), <span class="at">project =</span> <span class="st">"fb15.0"</span>, <span class="at">min.cells =</span> <span class="dv">3</span>, <span class="at">min.features =</span> <span class="dv">200</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>seurat.obj[[<span class="st">"percent.mt"</span>]] <span class="ot">&lt;-</span> <span class="fu">PercentageFeatureSet</span>(seurat.obj, <span class="at">pattern =</span> <span class="st">"^mt."</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">VlnPlot</span>(seurat.obj, <span class="at">features =</span> <span class="fu">c</span>(<span class="st">"nFeature_RNA"</span>, <span class="st">"nCount_RNA"</span>, <span class="st">"percent.mt"</span>), <span class="at">ncol =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>seurat.obj <span class="ot">&lt;-</span> <span class="fu">NormalizeData</span>(seurat.obj, <span class="at">normalization.method =</span> <span class="st">"LogNormalize"</span>, <span class="at">scale.factor =</span> <span class="dv">10000</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>seurat.obj <span class="ot">&lt;-</span> <span class="fu">FindVariableFeatures</span>(seurat.obj, <span class="at">selection.method =</span> <span class="st">"vst"</span>, <span class="at">nfeatures =</span> <span class="dv">2000</span>)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>all.genes <span class="ot">&lt;-</span> <span class="fu">rownames</span>(seurat.obj)</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>seurat.obj <span class="ot">&lt;-</span> <span class="fu">ScaleData</span>(seurat.obj, <span class="at">features =</span> all.genes)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>seurat.obj <span class="ot">&lt;-</span> <span class="fu">RunPCA</span>(seurat.obj, <span class="at">features =</span> <span class="fu">VariableFeatures</span>(<span class="at">object =</span> seurat.obj))</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(seurat.obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ElbowPlot</span>(seurat.obj,<span class="at">ndims =</span> <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>seurat.obj <span class="ot">&lt;-</span> <span class="fu">FindNeighbors</span>(seurat.obj, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>seurat.obj <span class="ot">&lt;-</span> <span class="fu">FindClusters</span>(seurat.obj, <span class="at">resolution =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modularity Optimizer version 1.3.0 by Ludo Waltman and Nees Jan van Eck

Number of nodes: 4407
Number of edges: 148076

Running Louvain algorithm...
Maximum modularity in 10 random starts: 0.8695
Number of communities: 11
Elapsed time: 0 seconds</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>seurat.obj <span class="ot">&lt;-</span> <span class="fu">RunUMAP</span>(seurat.obj, <span class="at">dims =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(seurat.obj)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="fu">identical</span>(<span class="fu">rownames</span>(seurat.obj<span class="sc">@</span>meta.data),<span class="fu">rownames</span>(metaC))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] TRUE</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>seurat.obj<span class="sc">@</span>meta.data <span class="ot">&lt;-</span> <span class="fu">cbind</span>(seurat.obj<span class="sc">@</span>meta.data, metaC)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(seurat.obj,<span class="at">group.by =</span> <span class="st">"Subclass"</span>, <span class="at">label =</span> <span class="cn">TRUE</span>)<span class="sc">+</span><span class="fu">NoLegend</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">DimPlot</span>(seurat.obj,<span class="at">group.by =</span> <span class="st">"ClusterName"</span>, <span class="at">label =</span> T, <span class="at">label.size =</span> <span class="dv">3</span>)<span class="sc">+</span><span class="fu">NoLegend</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>seurat.obj <span class="ot">&lt;-</span> <span class="fu">SetIdent</span>(seurat.obj,<span class="at">value =</span> <span class="st">"Subclass"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>seurat.obj.markers.Subclass <span class="ot">&lt;-</span> <span class="fu">FindAllMarkers</span>(seurat.obj, <span class="at">logfc.threshold =</span> <span class="fl">0.1</span>,<span class="at">min.pct =</span> <span class="fl">0.01</span>, <span class="at">only.pos =</span> <span class="cn">TRUE</span>)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(seurat.obj.markers.Subclass)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                p_val avg_log2FC pct.1 pct.2     p_val_adj
Neurod6  0.000000e+00   4.090494 0.987 0.127  0.000000e+00
Neurod2 3.164351e-294   3.376326 0.957 0.065 4.101949e-290
Tiam2   4.807385e-256   3.542872 0.900 0.068 6.231813e-252
Sox5    2.989319e-249   3.598904 0.912 0.127 3.875055e-245
Ppp2r2b 9.140509e-235   2.193826 0.970 0.361 1.184884e-230
Rbfox1  3.234905e-206   2.318090 0.974 0.412 4.193407e-202
                                      cluster    gene
Neurod6 Cortical or hippocampal glutamatergic Neurod6
Neurod2 Cortical or hippocampal glutamatergic Neurod2
Tiam2   Cortical or hippocampal glutamatergic   Tiam2
Sox5    Cortical or hippocampal glutamatergic    Sox5
Ppp2r2b Cortical or hippocampal glutamatergic Ppp2r2b
Rbfox1  Cortical or hippocampal glutamatergic  Rbfox1</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a> seurat.obj <span class="ot">&lt;-</span> <span class="fu">SetIdent</span>(seurat.obj,<span class="at">value =</span> <span class="st">"ClusterName"</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a> seurat.obj.markers.ClusterName <span class="ot">&lt;-</span> <span class="fu">FindAllMarkers</span>(seurat.obj,<span class="at">densify =</span> <span class="cn">TRUE</span>, <span class="at">logfc.threshold =</span> <span class="fl">0.1</span>,<span class="at">min.pct =</span> <span class="fl">0.01</span>,<span class="at">only.pos =</span> <span class="cn">TRUE</span>)</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(seurat.obj.markers.ClusterName)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 p_val avg_log2FC pct.1 pct.2     p_val_adj cluster     gene
Wnt10a   4.836119e-259  0.9646853 0.316 0.000 6.269061e-255 Neur492   Wnt10a
Adamts19 2.737699e-201  0.8726592 0.316 0.001 3.548879e-197 Neur492 Adamts19
Tac2     1.894266e-172  2.0721515 0.316 0.002 2.455537e-168 Neur492     Tac2
Rmst     1.166934e-155  2.2966143 0.763 0.024 1.512697e-151 Neur492     Rmst
Eomes    1.978338e-139  1.6902540 0.579 0.015 2.564520e-135 Neur492    Eomes
Ebf1     4.915113e-109  1.9468755 0.526 0.016 6.371461e-105 Neur492     Ebf1</code></pre>
</div>
</div>
</section>
<section id="comparision-cotan-seurat" class="level2">
<h2 class="anchored" data-anchor-id="comparision-cotan-seurat">Comparision COTAN-Seurat</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>markers.list.names <span class="ot">&lt;-</span> <span class="fu">col_concat</span>(<span class="fu">crossing</span>(<span class="fu">colnames</span>(dea.Subclass<span class="sc">$</span>coex),<span class="fu">c</span>(<span class="st">"Seurat"</span>,<span class="st">"Cotan"</span>)),<span class="at">sep =</span> <span class="st">" "</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>markers.list <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="st">"list"</span>, <span class="fu">length</span>(markers.list.names))</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="fu">names</span>(markers.list) <span class="ot">&lt;-</span> markers.list.names</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a><span class="co"># I take positive coex significant genes </span></span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cl.name <span class="cf">in</span> <span class="fu">colnames</span>(dea.Subclass<span class="sc">$</span>coex)) {</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  genes <span class="ot">&lt;-</span> <span class="fu">rownames</span>(dea.Subclass<span class="sc">$</span>coex[dea.Subclass<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>[,cl.name] <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> dea.Subclass<span class="sc">$</span>coex[,cl.name] <span class="sc">&gt;</span> <span class="dv">0</span>,])</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  markers.list[[<span class="fu">paste0</span>(cl.name,<span class="st">" Cotan"</span>)]] <span class="ot">&lt;-</span> genes</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a><span class="co">#For seurat</span></span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cl.name <span class="cf">in</span> <span class="fu">colnames</span>(dea.Subclass<span class="sc">$</span>coex)) {</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>  genes <span class="ot">&lt;-</span> seurat.obj.markers.Subclass[seurat.obj.markers.Subclass<span class="sc">$</span>cluster <span class="sc">==</span> cl.name <span class="sc">&amp;</span> seurat.obj.markers.Subclass<span class="sc">$</span>p_val <span class="sc">&lt;</span> <span class="fl">0.01</span>,]<span class="sc">$</span>gene</span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a>  markers.list[[<span class="fu">paste0</span>(cl.name,<span class="st">" Seurat"</span>)]] <span class="ot">&lt;-</span> genes</span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="cajal-retzius-subclass" class="level3">
<h3 class="anchored" data-anchor-id="cajal-retzius-subclass">Cajal-Retzius subclass</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>ggvenn.CR <span class="ot">&lt;-</span> <span class="fu">ggVennDiagram</span>(markers.list[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>])</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>ggvenn.CR</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can observe that there is a good overlap among the detected markers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>genes.to.test <span class="ot">&lt;-</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cajal-Retzius Seurat</span><span class="st">`</span>[<span class="sc">!</span>markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cajal-Retzius Seurat</span><span class="st">`</span> <span class="sc">%in%</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cajal-Retzius Cotan</span><span class="st">`</span>]</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">getNumOfExpressingCells</span>(fb150Obj)[genes.to.test]</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Only Seurat Genes"</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>df.bk <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">getNumOfExpressingCells</span>(fb150Obj)[<span class="fu">sample</span>(<span class="fu">getGenes</span>(fb150Obj), <span class="at">size =</span> <span class="fu">length</span>(<span class="fu">rownames</span>(df)))])</span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df.bk) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df.bk) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a>df.bk<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Whole dataset Genes"</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df.bk)</span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">ddply</span>(df, <span class="st">"type"</span>, summarise, <span class="at">grp.mean=</span><span class="fu">mean</span>(CellNumber))</span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>CellNumber,<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>))<span class="sc">+</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">position=</span><span class="st">"identity"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">bins =</span> <span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>mu, <span class="fu">aes</span>(<span class="at">xintercept=</span>grp.mean, <span class="at">color=</span>type),</span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent, <span class="at">name =</span> <span class="st">"percent"</span>) <span class="sc">+</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">sample</span>(genes.to.test,<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>genes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Zfp579" "Lias"   "Tmed2"  "Srsf9"  "Dtx3"   "Srp14"  "Pofut2" "Rtn1"  
 [9] "Thap3"  "Cttn"   "Socs2"  "Ctxn1" </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (g <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)) {</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> g<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">FeaturePlot</span>(seurat.obj,<span class="at">features =</span> genes[n<span class="sc">+</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">label =</span> T))</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Generally if we look at the genes specifically detected by Seurat, they don’t seems so distinctive for CR cells.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(genes.to.test <span class="sc">%in%</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cortical or hippocampal glutamatergic Seurat</span><span class="st">`</span>)<span class="sc">/</span><span class="fu">length</span>(genes.to.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08626761</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>genes.to.test.Cotan <span class="ot">&lt;-</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cajal-Retzius Cotan</span><span class="st">`</span>[<span class="sc">!</span>markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cajal-Retzius Cotan</span><span class="st">`</span> <span class="sc">%in%</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cajal-Retzius Seurat</span><span class="st">`</span>]</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">sample</span>(genes.to.test.Cotan,<span class="at">size =</span> <span class="dv">30</span>)</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>genes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Fam149a"        "Slc35g2"        "Chst7"          "P2ry14"        
 [5] "Tusc3"          "A730056A06Rik"  "Zfp941"         "Gpx8"          
 [9] "Ripk1"          "Gm15441"        "Igsf10"         "X4930522L14Rik"
[13] "Gm16845"        "Gspt2"          "Scn2b"          "Akr1b10"       
[17] "Vegfa"          "X4933431E20Rik" "Rtkn"           "Gm38250"       
[21] "Fancf"          "Rab43"          "Grik1"          "Eya1"          
[25] "Pih1d2"         "Cldn12"         "Cacng2"         "Pias3"         
[29] "Gm26782"        "Mme"           </code></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (g <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)) {</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> g<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">FeaturePlot</span>(seurat.obj,<span class="at">features =</span> genes[n<span class="sc">+</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">label =</span> T))</span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-26-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-26-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">getNumOfExpressingCells</span>(fb150Obj)[genes.to.test.Cotan]</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Only Cotan Genes"</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>df.bk <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">getNumOfExpressingCells</span>(fb150Obj)[<span class="fu">sample</span>(<span class="fu">getGenes</span>(fb150Obj), <span class="at">size =</span> <span class="fu">length</span>(<span class="fu">rownames</span>(df)))])</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df.bk) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df.bk) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>df.bk<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Whole dataset Genes"</span></span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df.bk)</span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">ddply</span>(df, <span class="st">"type"</span>, summarise, <span class="at">grp.mean=</span><span class="fu">mean</span>(CellNumber))</span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>CellNumber,<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb53-16"><a href="#cb53-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#C69AFF"</span>, <span class="st">"#56B4E9"</span>))<span class="sc">+</span></span>
<span id="cb53-17"><a href="#cb53-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">position=</span><span class="st">"identity"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">bins =</span> <span class="dv">25</span>)<span class="sc">+</span><span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">4800</span>)<span class="sc">+</span></span>
<span id="cb53-18"><a href="#cb53-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>mu, <span class="fu">aes</span>(<span class="at">xintercept=</span>grp.mean, <span class="at">color=</span>type),</span>
<span id="cb53-19"><a href="#cb53-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb53-20"><a href="#cb53-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb53-21"><a href="#cb53-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent, <span class="at">name =</span> <span class="st">"percent"</span>) <span class="sc">+</span></span>
<span id="cb53-22"><a href="#cb53-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb53-23"><a href="#cb53-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now we can test the enrichment for the specific gene both in Seurat and in Cotan.</p>
<p>To make a comparison more equal we select the same number of genes (depending on the smallest group)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>genes.to.testTop <span class="ot">&lt;-</span> seurat.obj.markers.Subclass[seurat.obj.markers.Subclass<span class="sc">$</span>cluster <span class="sc">==</span> <span class="st">"Cajal-Retzius"</span> <span class="sc">&amp;</span> seurat.obj.markers.Subclass<span class="sc">$</span>gene <span class="sc">%in%</span> genes.to.test,]<span class="sc">$</span>gene[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(genes.to.test.Cotan)]</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>enriched <span class="ot">&lt;-</span> <span class="fu">enrichr</span>(genes.to.testTop, dbs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Uploading data to Enrichr... Done.
  Querying ARCHS4_Tissues... Done.
Parsing results... Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotEnrich</span>(enriched[[<span class="dv">1</span>]], <span class="at">showTerms =</span> <span class="dv">10</span>, <span class="at">numChar =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">orderBy =</span> <span class="st">"P.value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>wordcloud_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Terms =</span> <span class="fu">str_split</span>(enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Term[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>],<span class="at">pattern =</span> <span class="st">" CL"</span>,<span class="at">simplify =</span> T )[,<span class="dv">1</span>],</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Scores =</span> enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Combined.Score[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(wordcloud_data<span class="sc">$</span>Terms, wordcloud_data<span class="sc">$</span>Scores, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.1</span>,<span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>enriched <span class="ot">&lt;-</span> <span class="fu">enrichr</span>(genes.to.test.Cotan, dbs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Uploading data to Enrichr... Done.
  Querying ARCHS4_Tissues... Done.
Parsing results... Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotEnrich</span>(enriched[[<span class="dv">1</span>]], <span class="at">showTerms =</span> <span class="dv">10</span>, <span class="at">numChar =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">orderBy =</span> <span class="st">"P.value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>wordcloud_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Terms =</span> <span class="fu">str_split</span>(enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Term[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>],<span class="at">pattern =</span> <span class="st">" CL"</span>,<span class="at">simplify =</span> T )[,<span class="dv">1</span>],</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Scores =</span> enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Combined.Score[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(wordcloud_data<span class="sc">$</span>Terms, wordcloud_data<span class="sc">$</span>Scores, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.1</span>,<span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cortical-or-hippocampal-glutamatergic-subclass" class="level3">
<h3 class="anchored" data-anchor-id="cortical-or-hippocampal-glutamatergic-subclass">Cortical or hippocampal glutamatergic subclass</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>ggvenn.CHG <span class="ot">&lt;-</span> <span class="fu">ggVennDiagram</span>(markers.list[<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>])</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>ggvenn.CHG</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>genes.to.test <span class="ot">&lt;-</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cortical or hippocampal glutamatergic Seurat</span><span class="st">`</span>[<span class="sc">!</span>markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cortical or hippocampal glutamatergic Seurat</span><span class="st">`</span> <span class="sc">%in%</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cortical or hippocampal glutamatergic Cotan</span><span class="st">`</span>]</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">getNumOfExpressingCells</span>(fb150Obj)[genes.to.test]</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Only Seurat Genes"</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>df.bk <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">getNumOfExpressingCells</span>(fb150Obj)[<span class="fu">sample</span>(<span class="fu">getGenes</span>(fb150Obj), <span class="at">size =</span> <span class="fu">length</span>(<span class="fu">rownames</span>(df)))])</span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df.bk) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df.bk) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>df.bk<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Whole dataset Genes"</span></span>
<span id="cb63-13"><a href="#cb63-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df.bk)</span>
<span id="cb63-14"><a href="#cb63-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-15"><a href="#cb63-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb63-16"><a href="#cb63-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) </span>
<span id="cb63-17"><a href="#cb63-17" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">ddply</span>(df, <span class="st">"type"</span>, summarise, <span class="at">grp.mean=</span><span class="fu">mean</span>(CellNumber))</span>
<span id="cb63-18"><a href="#cb63-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-19"><a href="#cb63-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>CellNumber,<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb63-20"><a href="#cb63-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>))<span class="sc">+</span></span>
<span id="cb63-21"><a href="#cb63-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">position=</span><span class="st">"identity"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">bins =</span> <span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb63-22"><a href="#cb63-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>mu, <span class="fu">aes</span>(<span class="at">xintercept=</span>grp.mean, <span class="at">color=</span>type),</span>
<span id="cb63-23"><a href="#cb63-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb63-24"><a href="#cb63-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb63-25"><a href="#cb63-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent, <span class="at">name =</span> <span class="st">"percent"</span>) <span class="sc">+</span></span>
<span id="cb63-26"><a href="#cb63-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb63-27"><a href="#cb63-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">sample</span>(genes.to.test,<span class="at">size =</span> <span class="dv">18</span>)</span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>genes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Fam220a" "Taok3"   "Fau"     "Fzd1"    "Rpl7"    "Idh3a"   "Lgmn"   
 [8] "Mapkap1" "Apopt1"  "Tubg1"   "Rpl10"   "Rpl6"    "Ankrd45" "Nsa2"   
[15] "Reep2"   "Rpl14"   "Egfem1"  "Letm1"  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (g <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)) {</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> g<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">FeaturePlot</span>(seurat.obj,<span class="at">features =</span> genes[n<span class="sc">+</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">label =</span> T))</span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-35-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>genes.to.test.Cotan <span class="ot">&lt;-</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cortical or hippocampal glutamatergic Cotan</span><span class="st">`</span>[<span class="sc">!</span>markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cortical or hippocampal glutamatergic Cotan</span><span class="st">`</span> <span class="sc">%in%</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Cortical or hippocampal glutamatergic Seurat</span><span class="st">`</span>]</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">sample</span>(genes.to.test.Cotan,<span class="at">size =</span> <span class="dv">30</span>)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>genes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Pitpnm1"        "Nptx1"          "Tnfaip8l1"      "Dlc1"          
 [5] "Ttyh1"          "Pde11a"         "Adamts2"        "Pomk"          
 [9] "D6Ertd474e"     "Car12"          "Rspo3"          "Gm43517"       
[13] "X3830406C13Rik" "Grp"            "E2f1"           "Ntf3"          
[17] "Stim2"          "D030068K23Rik"  "Tspan17"        "Ube2t"         
[21] "Impa2"          "Egfl6"          "Serping1"       "Pttg1"         
[25] "Sh3bgrl3"       "Mcrip2"         "Map1lc3a"       "Nrn1"          
[29] "Gm42997"        "AC124490.1"    </code></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (g <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)) {</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> g<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">FeaturePlot</span>(seurat.obj,<span class="at">features =</span> genes[n<span class="sc">+</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">label =</span> T))</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-36-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-36-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">getNumOfExpressingCells</span>(fb150Obj)[genes.to.test.Cotan]</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Only Cotan Genes"</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a>df.bk <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">getNumOfExpressingCells</span>(fb150Obj)[<span class="fu">sample</span>(<span class="fu">getGenes</span>(fb150Obj), <span class="at">size =</span> <span class="fu">length</span>(<span class="fu">rownames</span>(df)))])</span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df.bk) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df.bk) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>df.bk<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Whole dataset Genes"</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df.bk)</span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">ddply</span>(df, <span class="st">"type"</span>, summarise, <span class="at">grp.mean=</span><span class="fu">mean</span>(CellNumber))</span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>CellNumber,<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#C69AFF"</span>, <span class="st">"#56B4E9"</span>))<span class="sc">+</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">position=</span><span class="st">"identity"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">bins =</span> <span class="dv">25</span>)<span class="sc">+</span><span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">4800</span>)<span class="sc">+</span></span>
<span id="cb70-18"><a href="#cb70-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>mu, <span class="fu">aes</span>(<span class="at">xintercept=</span>grp.mean, <span class="at">color=</span>type),</span>
<span id="cb70-19"><a href="#cb70-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb70-20"><a href="#cb70-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb70-21"><a href="#cb70-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent, <span class="at">name =</span> <span class="st">"percent"</span>) <span class="sc">+</span></span>
<span id="cb70-22"><a href="#cb70-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb70-23"><a href="#cb70-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>genes.to.testTop <span class="ot">&lt;-</span> seurat.obj.markers.Subclass[seurat.obj.markers.Subclass<span class="sc">$</span>cluster <span class="sc">==</span> <span class="st">"Cortical or hippocampal glutamatergic"</span> <span class="sc">&amp;</span> seurat.obj.markers.Subclass<span class="sc">$</span>gene <span class="sc">%in%</span> genes.to.test,]<span class="sc">$</span>gene[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(genes.to.test.Cotan)]</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>enriched <span class="ot">&lt;-</span> <span class="fu">enrichr</span>(genes.to.testTop, dbs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Uploading data to Enrichr... Done.
  Querying ARCHS4_Tissues... Done.
Parsing results... Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotEnrich</span>(enriched[[<span class="dv">1</span>]], <span class="at">showTerms =</span> <span class="dv">10</span>, <span class="at">numChar =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">orderBy =</span> <span class="st">"P.value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12333</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>wordcloud_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Terms =</span> <span class="fu">str_split</span>(enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Term[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>],<span class="at">pattern =</span> <span class="st">" CL"</span>,<span class="at">simplify =</span> T )[,<span class="dv">1</span>],</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Scores =</span> enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Combined.Score[<span class="dv">1</span><span class="sc">:</span><span class="dv">8</span>])</span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(wordcloud_data<span class="sc">$</span>Terms, wordcloud_data<span class="sc">$</span>Scores, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="fl">0.5</span>), <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.1</span>,<span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>enriched <span class="ot">&lt;-</span> <span class="fu">enrichr</span>(genes.to.test.Cotan, dbs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Uploading data to Enrichr... Done.
  Querying ARCHS4_Tissues... Done.
Parsing results... Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotEnrich</span>(enriched[[<span class="dv">1</span>]], <span class="at">showTerms =</span> <span class="dv">10</span>, <span class="at">numChar =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">orderBy =</span> <span class="st">"P.value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1233</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>wordcloud_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Terms =</span> <span class="fu">str_split</span>(enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Term[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>],<span class="at">pattern =</span> <span class="st">" CL"</span>,<span class="at">simplify =</span> T )[,<span class="dv">1</span>],</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Scores =</span> enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Combined.Score[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(wordcloud_data<span class="sc">$</span>Terms, wordcloud_data<span class="sc">$</span>Scores, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.1</span>,<span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="forebrain-gabaergic-subclass" class="level3">
<h3 class="anchored" data-anchor-id="forebrain-gabaergic-subclass">Forebrain GABAergic subclass</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>ggvenn.FGaba <span class="ot">&lt;-</span> <span class="fu">ggVennDiagram</span>(markers.list[<span class="dv">5</span><span class="sc">:</span><span class="dv">6</span>])</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>ggvenn.FGaba</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>genes.to.test <span class="ot">&lt;-</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Forebrain GABAergic Seurat</span><span class="st">`</span>[<span class="sc">!</span>markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Forebrain GABAergic Seurat</span><span class="st">`</span> <span class="sc">%in%</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Forebrain GABAergic Cotan</span><span class="st">`</span>]</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">getNumOfExpressingCells</span>(fb150Obj)[genes.to.test]</span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Only Seurat Genes"</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>df.bk <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">getNumOfExpressingCells</span>(fb150Obj)[<span class="fu">sample</span>(<span class="fu">getGenes</span>(fb150Obj), <span class="at">size =</span> <span class="fu">length</span>(<span class="fu">rownames</span>(df)))])</span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df.bk) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df.bk) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>df.bk<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Whole dataset Genes"</span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df.bk)</span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(plyr)</span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(scales) </span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">ddply</span>(df, <span class="st">"type"</span>, summarise, <span class="at">grp.mean=</span><span class="fu">mean</span>(CellNumber))</span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>CellNumber,<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>))<span class="sc">+</span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">position=</span><span class="st">"identity"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">bins =</span> <span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>mu, <span class="fu">aes</span>(<span class="at">xintercept=</span>grp.mean, <span class="at">color=</span>type),</span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent, <span class="at">name =</span> <span class="st">"percent"</span>) <span class="sc">+</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">sample</span>(genes.to.test,<span class="at">size =</span> <span class="dv">18</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>genes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Ddx5"    "Pycr2"   "Them4"   "Zfp647"  "Jpt1"    "Ybx1"    "Atp5a1" 
 [8] "Cdkn1c"  "Gm3764"  "Bex2"    "Ftl1"    "Kmt2a"   "Map2"    "Cntnap2"
[15] "Pogk"    "Rtn1"    "Scg5"    "H3f3b"  </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (g <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)) {</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> g<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">FeaturePlot</span>(seurat.obj,<span class="at">features =</span> genes[n<span class="sc">+</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">label =</span> T))</span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-45-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-45-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>genes.to.test.Cotan <span class="ot">&lt;-</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Forebrain GABAergic Cotan</span><span class="st">`</span>[<span class="sc">!</span>markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Forebrain GABAergic Cotan</span><span class="st">`</span> <span class="sc">%in%</span> markers.list<span class="sc">$</span><span class="st">`</span><span class="at">Forebrain GABAergic Seurat</span><span class="st">`</span>]</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">sample</span>(genes.to.test.Cotan,<span class="at">size =</span> <span class="dv">30</span>)</span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>genes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Met"        "Rsbn1l"     "Zfp358"     "Enpp5"      "Sft2d3"    
 [6] "Gng4"       "Gm14342"    "Msrb3"      "Ncaph2"     "Dtnbp1"    
[11] "Zfp62"      "Shprh"      "Bmf"        "AC174678.1" "Map7d1"    
[16] "Srsf1"      "Smim7"      "Rab39b"     "Depdc7"     "Prkg1"     
[21] "Rad21"      "Brinp1"     "Rbm5"       "Laptm4b"    "Dcbld2"    
[26] "Slf2"       "Fam173a"    "Sh3bp5l"    "Slc1a2"     "Sstr1"     </code></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (g <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)) {</span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> g<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">FeaturePlot</span>(seurat.obj,<span class="at">features =</span> genes[n<span class="sc">+</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">label =</span> T))</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-46-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-46-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">getNumOfExpressingCells</span>(fb150Obj)[genes.to.test.Cotan]</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Only Cotan Genes"</span></span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>df.bk <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">getNumOfExpressingCells</span>(fb150Obj)[<span class="fu">sample</span>(<span class="fu">getGenes</span>(fb150Obj), <span class="at">size =</span> <span class="fu">length</span>(<span class="fu">rownames</span>(df)))])</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df.bk) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df.bk) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>df.bk<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Whole dataset Genes"</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df.bk)</span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">ddply</span>(df, <span class="st">"type"</span>, summarise, <span class="at">grp.mean=</span><span class="fu">mean</span>(CellNumber))</span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>CellNumber,<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#C69AFF"</span>, <span class="st">"#56B4E9"</span>))<span class="sc">+</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">position=</span><span class="st">"identity"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">bins =</span> <span class="dv">25</span>)<span class="sc">+</span><span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">4800</span>)<span class="sc">+</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>mu, <span class="fu">aes</span>(<span class="at">xintercept=</span>grp.mean, <span class="at">color=</span>type),</span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent, <span class="at">name =</span> <span class="st">"percent"</span>) <span class="sc">+</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>enriched <span class="ot">&lt;-</span> <span class="fu">enrichr</span>(genes.to.test, dbs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Uploading data to Enrichr... Done.
  Querying ARCHS4_Tissues... Done.
Parsing results... Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotEnrich</span>(enriched[[<span class="dv">1</span>]], <span class="at">showTerms =</span> <span class="dv">10</span>, <span class="at">numChar =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">orderBy =</span> <span class="st">"P.value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">12333</span>)</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>wordcloud_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Terms =</span> <span class="fu">str_split</span>(enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Term[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>],<span class="at">pattern =</span> <span class="st">" CL"</span>,<span class="at">simplify =</span> T )[,<span class="dv">1</span>],</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Scores =</span> enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Combined.Score[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(wordcloud_data<span class="sc">$</span>Terms, wordcloud_data<span class="sc">$</span>Scores, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.1</span>,<span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a>subset.pval <span class="ot">&lt;-</span> dea.Subclass<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>[<span class="fu">rownames</span>(dea.Subclass<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>) <span class="sc">%in%</span> genes.to.test.Cotan,]</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a>genes.to.test.Cotan.Top <span class="ot">&lt;-</span> <span class="fu">rownames</span>(subset.pval[<span class="fu">order</span>(subset.pval<span class="sc">$</span><span class="st">`</span><span class="at">Forebrain GABAergic</span><span class="st">`</span>,<span class="at">decreasing =</span> F),])[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(genes.to.test)]</span>
<span id="cb92-4"><a href="#cb92-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-5"><a href="#cb92-5" aria-hidden="true" tabindex="-1"></a>enriched <span class="ot">&lt;-</span> <span class="fu">enrichr</span>(genes.to.test.Cotan.Top, dbs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Uploading data to Enrichr... Done.
  Querying ARCHS4_Tissues... Done.
Parsing results... Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotEnrich</span>(enriched[[<span class="dv">1</span>]], <span class="at">showTerms =</span> <span class="dv">10</span>, <span class="at">numChar =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">orderBy =</span> <span class="st">"P.value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>wordcloud_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Terms =</span> <span class="fu">str_split</span>(enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Term,<span class="at">pattern =</span> <span class="st">" CL"</span>,<span class="at">simplify =</span> T )[,<span class="dv">1</span>],</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Scores =</span> enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Combined.Score)</span>
<span id="cb95-4"><a href="#cb95-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb95-5"><a href="#cb95-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(wordcloud_data<span class="sc">$</span>Terms, wordcloud_data<span class="sc">$</span>Scores, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.1</span>,<span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cluster-neur509" class="level3">
<h3 class="anchored" data-anchor-id="cluster-neur509">Cluster Neur509</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># markers.list.namesNeur509 &lt;- col_concat(crossing(colnames(dea.ClusterName$coex),c("Seurat","Cotan")),sep = " ")</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="co"># markers.listNeur509 &lt;- vector("list", length(markers.list.namesNeur509))</span></span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a><span class="co"># names(markers.listNeur509) &lt;- markers.list.namesNeur509</span></span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a>markers.listNeur509 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"Neur509 Cotan"</span><span class="ot">=</span><span class="cn">NA</span>,<span class="st">"Neur509 Seurat"</span><span class="ot">=</span><span class="cn">NA</span>)</span>
<span id="cb96-7"><a href="#cb96-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-8"><a href="#cb96-8" aria-hidden="true" tabindex="-1"></a><span class="co"># I take positive coex significant genes </span></span>
<span id="cb96-9"><a href="#cb96-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cl.name <span class="cf">in</span> <span class="st">"Neur509"</span>) {</span>
<span id="cb96-10"><a href="#cb96-10" aria-hidden="true" tabindex="-1"></a>  genes <span class="ot">&lt;-</span> <span class="fu">rownames</span>(dea.ClusterName<span class="sc">$</span>coex[dea.ClusterName<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>[,cl.name] <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> dea.ClusterName<span class="sc">$</span>coex[,cl.name] <span class="sc">&gt;</span> <span class="dv">0</span>,])</span>
<span id="cb96-11"><a href="#cb96-11" aria-hidden="true" tabindex="-1"></a>  markers.listNeur509[[<span class="fu">paste0</span>(cl.name,<span class="st">" Cotan"</span>)]] <span class="ot">&lt;-</span> genes</span>
<span id="cb96-12"><a href="#cb96-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb96-13"><a href="#cb96-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-14"><a href="#cb96-14" aria-hidden="true" tabindex="-1"></a><span class="co">#For seurat</span></span>
<span id="cb96-15"><a href="#cb96-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cl.name <span class="cf">in</span> <span class="st">"Neur509"</span>) {</span>
<span id="cb96-16"><a href="#cb96-16" aria-hidden="true" tabindex="-1"></a>  genes <span class="ot">&lt;-</span> seurat.obj.markers.ClusterName[seurat.obj.markers.ClusterName<span class="sc">$</span>cluster <span class="sc">==</span> cl.name <span class="sc">&amp;</span> seurat.obj.markers.ClusterName<span class="sc">$</span>p_val <span class="sc">&lt;</span> <span class="fl">0.01</span>,]<span class="sc">$</span>gene</span>
<span id="cb96-17"><a href="#cb96-17" aria-hidden="true" tabindex="-1"></a>  markers.listNeur509[[<span class="fu">paste0</span>(cl.name,<span class="st">" Seurat"</span>)]] <span class="ot">&lt;-</span> genes</span>
<span id="cb96-18"><a href="#cb96-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggVennDiagram</span>(markers.listNeur509)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can observe that there is a good overlap among the detected markers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>genes.to.test <span class="ot">&lt;-</span> markers.listNeur509<span class="sc">$</span><span class="st">`</span><span class="at">Neur509 Seurat</span><span class="st">`</span>[<span class="sc">!</span>markers.listNeur509<span class="sc">$</span><span class="st">`</span><span class="at">Neur509 Seurat</span><span class="st">`</span> <span class="sc">%in%</span> markers.listNeur509<span class="sc">$</span><span class="st">`</span><span class="at">Neur509 Cotan</span><span class="st">`</span>]</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">getNumOfExpressingCells</span>(fb150Obj)[genes.to.test]</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Only Seurat Genes"</span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a>df.bk <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">getNumOfExpressingCells</span>(fb150Obj)[<span class="fu">sample</span>(<span class="fu">getGenes</span>(fb150Obj), <span class="at">size =</span> <span class="fu">length</span>(<span class="fu">rownames</span>(df)))])</span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df.bk) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df.bk) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a>df.bk<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Whole dataset Genes"</span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df.bk)</span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">ddply</span>(df, <span class="st">"type"</span>, summarise, <span class="at">grp.mean=</span><span class="fu">mean</span>(CellNumber))</span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>CellNumber,<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>))<span class="sc">+</span></span>
<span id="cb98-19"><a href="#cb98-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">position=</span><span class="st">"identity"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">bins =</span> <span class="dv">25</span>)<span class="sc">+</span><span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">4800</span>)<span class="sc">+</span></span>
<span id="cb98-20"><a href="#cb98-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>mu, <span class="fu">aes</span>(<span class="at">xintercept=</span>grp.mean, <span class="at">color=</span>type),</span>
<span id="cb98-21"><a href="#cb98-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb98-22"><a href="#cb98-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb98-23"><a href="#cb98-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent, <span class="at">name =</span> <span class="st">"percent of genes"</span>) <span class="sc">+</span></span>
<span id="cb98-24"><a href="#cb98-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb98-25"><a href="#cb98-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">sample</span>(genes.to.test,<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>genes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Grpel1"         "Ssna1"          "X1110004E09Rik" "Mri1"          
 [5] "Sod2"           "Bola1"          "Ppp4c"          "Draxin"        
 [9] "Peli2"          "Sfpq"           "Rpl22"          "Chmp5"         </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (g <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)) {</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> g<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">FeaturePlot</span>(seurat.obj,<span class="at">features =</span> genes[n<span class="sc">+</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">label =</span> T))</span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-56-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-56-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Generally if we look at the genes specifically detected by Seurat, they don’t seems so distinctive for CR cells.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(genes.to.test <span class="sc">%in%</span> markers.listNeur509<span class="sc">$</span><span class="st">`</span><span class="at">Cortical or hippocampal glutamatergic Seurat</span><span class="st">`</span>)<span class="sc">/</span><span class="fu">length</span>(genes.to.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>genes.to.test.Cotan <span class="ot">&lt;-</span> markers.listNeur509<span class="sc">$</span><span class="st">`</span><span class="at">Neur509 Cotan</span><span class="st">`</span>[<span class="sc">!</span>markers.listNeur509<span class="sc">$</span><span class="st">`</span><span class="at">Neur509 Cotan</span><span class="st">`</span> <span class="sc">%in%</span> markers.listNeur509<span class="sc">$</span><span class="st">`</span><span class="at">Neur509 Seurat</span><span class="st">`</span>]</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">sample</span>(genes.to.test.Cotan,<span class="at">size =</span> <span class="dv">30</span>)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>genes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Dusp14"     "Gm15594"    "Tnik"       "Sertad3"    "Sowahc"    
 [6] "Adgrg6"     "Rbfox1"     "Gm10073"    "Gm17231"    "Btf3"      
[11] "Khdrbs2"    "Adpgk"      "Pih1d2"     "Capzb"      "Cox6b1"    
[16] "Chst5"      "Dcxr"       "Tfdp2"      "Plcxd2"     "Prss41"    
[21] "Kcnq5"      "AC152827.1" "Atg4a"      "Fezf2"      "Gm15489"   
[26] "Cth"        "Zbtb44"     "Sec61a1"    "Rbm12b1"    "Hk2"       </code></pre>
</div>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (g <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)) {</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> g<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">FeaturePlot</span>(seurat.obj,<span class="at">features =</span> genes[n<span class="sc">+</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">label =</span> T))</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-58-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-58-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">getNumOfExpressingCells</span>(fb150Obj)[genes.to.test.Cotan]</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Only Cotan Genes"</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-7"><a href="#cb107-7" aria-hidden="true" tabindex="-1"></a>df.bk <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">getNumOfExpressingCells</span>(fb150Obj)[<span class="fu">sample</span>(<span class="fu">getGenes</span>(fb150Obj), <span class="at">size =</span> <span class="fu">length</span>(<span class="fu">rownames</span>(df)))])</span>
<span id="cb107-8"><a href="#cb107-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df.bk) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb107-9"><a href="#cb107-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df.bk) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb107-10"><a href="#cb107-10" aria-hidden="true" tabindex="-1"></a>df.bk<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Whole dataset Genes"</span></span>
<span id="cb107-11"><a href="#cb107-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df.bk)</span>
<span id="cb107-12"><a href="#cb107-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-13"><a href="#cb107-13" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">ddply</span>(df, <span class="st">"type"</span>, summarise, <span class="at">grp.mean=</span><span class="fu">mean</span>(CellNumber))</span>
<span id="cb107-14"><a href="#cb107-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-15"><a href="#cb107-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>CellNumber,<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb107-16"><a href="#cb107-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#C69AFF"</span>, <span class="st">"#56B4E9"</span>))<span class="sc">+</span></span>
<span id="cb107-17"><a href="#cb107-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">position=</span><span class="st">"identity"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">bins =</span> <span class="dv">25</span>)<span class="sc">+</span><span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">4800</span>)<span class="sc">+</span></span>
<span id="cb107-18"><a href="#cb107-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>mu, <span class="fu">aes</span>(<span class="at">xintercept=</span>grp.mean, <span class="at">color=</span>type),</span>
<span id="cb107-19"><a href="#cb107-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb107-20"><a href="#cb107-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb107-21"><a href="#cb107-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent, <span class="at">name =</span> <span class="st">"percent"</span>) <span class="sc">+</span></span>
<span id="cb107-22"><a href="#cb107-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb107-23"><a href="#cb107-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now we can test the enrichment for the specific gene both in Seurat and in Cotan.</p>
<p>To make a comparison more equal we select the same number of genes (depending on the smallest group)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>genes.to.testTop <span class="ot">&lt;-</span> seurat.obj.markers.ClusterName[seurat.obj.markers.ClusterName<span class="sc">$</span>cluster <span class="sc">==</span> <span class="st">"Neur509"</span> <span class="sc">&amp;</span> seurat.obj.markers.ClusterName<span class="sc">$</span>gene <span class="sc">%in%</span> genes.to.test,]<span class="sc">$</span>gene[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(genes.to.test.Cotan)]</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>enriched <span class="ot">&lt;-</span> <span class="fu">enrichr</span>(genes.to.testTop, dbs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Uploading data to Enrichr... Done.
  Querying ARCHS4_Tissues... Done.
Parsing results... Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotEnrich</span>(enriched[[<span class="dv">1</span>]], <span class="at">showTerms =</span> <span class="dv">10</span>, <span class="at">numChar =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">orderBy =</span> <span class="st">"P.value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>wordcloud_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Terms =</span> <span class="fu">str_split</span>(enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Term[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>],<span class="at">pattern =</span> <span class="st">" CL"</span>,<span class="at">simplify =</span> T )[,<span class="dv">1</span>],</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Scores =</span> enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Combined.Score[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb111-5"><a href="#cb111-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(wordcloud_data<span class="sc">$</span>Terms, wordcloud_data<span class="sc">$</span>Scores, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.1</span>,<span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a>enriched <span class="ot">&lt;-</span> <span class="fu">enrichr</span>(genes.to.test.Cotan, dbs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Uploading data to Enrichr... Done.
  Querying ARCHS4_Tissues... Done.
Parsing results... Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotEnrich</span>(enriched[[<span class="dv">1</span>]], <span class="at">showTerms =</span> <span class="dv">10</span>, <span class="at">numChar =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">orderBy =</span> <span class="st">"P.value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>wordcloud_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Terms =</span> <span class="fu">str_split</span>(enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Term[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>],<span class="at">pattern =</span> <span class="st">" CL"</span>,<span class="at">simplify =</span> T )[,<span class="dv">1</span>],</span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Scores =</span> enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Combined.Score[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(wordcloud_data<span class="sc">$</span>Terms, wordcloud_data<span class="sc">$</span>Scores, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.1</span>,<span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="cluster-neur508" class="level3">
<h3 class="anchored" data-anchor-id="cluster-neur508">Cluster Neur508</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="co"># markers.list.namesNeur508 &lt;- col_concat(crossing(colnames(dea.ClusterName$coex),c("Seurat","Cotan")),sep = " ")</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a><span class="co"># markers.listNeur508 &lt;- vector("list", length(markers.list.namesNeur508))</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a><span class="co"># names(markers.listNeur508) &lt;- markers.list.namesNeur508</span></span>
<span id="cb116-5"><a href="#cb116-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-6"><a href="#cb116-6" aria-hidden="true" tabindex="-1"></a>markers.listNeur508 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">"Neur508 Cotan"</span><span class="ot">=</span><span class="cn">NA</span>,<span class="st">"Neur508 Seurat"</span><span class="ot">=</span><span class="cn">NA</span>)</span>
<span id="cb116-7"><a href="#cb116-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-8"><a href="#cb116-8" aria-hidden="true" tabindex="-1"></a><span class="co"># I take positive coex significant genes </span></span>
<span id="cb116-9"><a href="#cb116-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cl.name <span class="cf">in</span> <span class="st">"Neur508"</span>) {</span>
<span id="cb116-10"><a href="#cb116-10" aria-hidden="true" tabindex="-1"></a>  genes <span class="ot">&lt;-</span> <span class="fu">rownames</span>(dea.ClusterName<span class="sc">$</span>coex[dea.ClusterName<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>[,cl.name] <span class="sc">&lt;</span> <span class="fl">0.01</span> <span class="sc">&amp;</span> dea.ClusterName<span class="sc">$</span>coex[,cl.name] <span class="sc">&gt;</span> <span class="dv">0</span>,])</span>
<span id="cb116-11"><a href="#cb116-11" aria-hidden="true" tabindex="-1"></a>  markers.listNeur508[[<span class="fu">paste0</span>(cl.name,<span class="st">" Cotan"</span>)]] <span class="ot">&lt;-</span> genes</span>
<span id="cb116-12"><a href="#cb116-12" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb116-13"><a href="#cb116-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb116-14"><a href="#cb116-14" aria-hidden="true" tabindex="-1"></a><span class="co">#For seurat</span></span>
<span id="cb116-15"><a href="#cb116-15" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (cl.name <span class="cf">in</span> <span class="st">"Neur508"</span>) {</span>
<span id="cb116-16"><a href="#cb116-16" aria-hidden="true" tabindex="-1"></a>  genes <span class="ot">&lt;-</span> seurat.obj.markers.ClusterName[seurat.obj.markers.ClusterName<span class="sc">$</span>cluster <span class="sc">==</span> cl.name <span class="sc">&amp;</span> seurat.obj.markers.ClusterName<span class="sc">$</span>p_val <span class="sc">&lt;</span> <span class="fl">0.01</span>,]<span class="sc">$</span>gene</span>
<span id="cb116-17"><a href="#cb116-17" aria-hidden="true" tabindex="-1"></a>  markers.listNeur508[[<span class="fu">paste0</span>(cl.name,<span class="st">" Seurat"</span>)]] <span class="ot">&lt;-</span> genes</span>
<span id="cb116-18"><a href="#cb116-18" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggVennDiagram</span>(markers.listNeur508)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can observe that there is a good overlap among the detected markers.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>genes.to.test <span class="ot">&lt;-</span> markers.listNeur508<span class="sc">$</span><span class="st">`</span><span class="at">Neur508 Seurat</span><span class="st">`</span>[<span class="sc">!</span>markers.listNeur508<span class="sc">$</span><span class="st">`</span><span class="at">Neur508 Seurat</span><span class="st">`</span> <span class="sc">%in%</span> markers.listNeur508<span class="sc">$</span><span class="st">`</span><span class="at">Neur508 Cotan</span><span class="st">`</span>]</span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">getNumOfExpressingCells</span>(fb150Obj)[genes.to.test]</span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb118-7"><a href="#cb118-7" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Only Seurat Genes"</span></span>
<span id="cb118-8"><a href="#cb118-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-9"><a href="#cb118-9" aria-hidden="true" tabindex="-1"></a>df.bk <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">getNumOfExpressingCells</span>(fb150Obj)[<span class="fu">sample</span>(<span class="fu">getGenes</span>(fb150Obj), <span class="at">size =</span> <span class="fu">length</span>(<span class="fu">rownames</span>(df)))])</span>
<span id="cb118-10"><a href="#cb118-10" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df.bk) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb118-11"><a href="#cb118-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df.bk) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb118-12"><a href="#cb118-12" aria-hidden="true" tabindex="-1"></a>df.bk<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Whole dataset Genes"</span></span>
<span id="cb118-13"><a href="#cb118-13" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df.bk)</span>
<span id="cb118-14"><a href="#cb118-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-15"><a href="#cb118-15" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">ddply</span>(df, <span class="st">"type"</span>, summarise, <span class="at">grp.mean=</span><span class="fu">mean</span>(CellNumber))</span>
<span id="cb118-16"><a href="#cb118-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-17"><a href="#cb118-17" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>CellNumber,<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb118-18"><a href="#cb118-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#E69F00"</span>, <span class="st">"#56B4E9"</span>))<span class="sc">+</span></span>
<span id="cb118-19"><a href="#cb118-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">position=</span><span class="st">"identity"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">bins =</span> <span class="dv">50</span>)<span class="sc">+</span></span>
<span id="cb118-20"><a href="#cb118-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>mu, <span class="fu">aes</span>(<span class="at">xintercept=</span>grp.mean, <span class="at">color=</span>type),</span>
<span id="cb118-21"><a href="#cb118-21" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb118-22"><a href="#cb118-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb118-23"><a href="#cb118-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent, <span class="at">name =</span> <span class="st">"percent"</span>) <span class="sc">+</span></span>
<span id="cb118-24"><a href="#cb118-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb118-25"><a href="#cb118-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">111</span>)</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">sample</span>(genes.to.test,<span class="at">size =</span> <span class="dv">12</span>)</span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>genes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Gm10131" "Topors"  "Agfg1"   "Pfdn4"   "Arhgdia" "Fam96b"  "Kif5c"  
 [8] "Rpl18"   "Akt3"    "Gm42743" "Papola"  "Uri1"   </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (g <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)) {</span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> g<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb121-4"><a href="#cb121-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">FeaturePlot</span>(seurat.obj,<span class="at">features =</span> genes[n<span class="sc">+</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">label =</span> T))</span>
<span id="cb121-5"><a href="#cb121-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-68-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-68-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Generally if we look at the genes specifically detected by Seurat, they don’t seems so distinctive for CR cells.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sum</span>(genes.to.test <span class="sc">%in%</span> markers.listNeur508<span class="sc">$</span><span class="st">`</span><span class="at">Cortical or hippocampal glutamatergic Seurat</span><span class="st">`</span>)<span class="sc">/</span><span class="fu">length</span>(genes.to.test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>genes.to.test.Cotan <span class="ot">&lt;-</span> markers.listNeur508<span class="sc">$</span><span class="st">`</span><span class="at">Neur508 Cotan</span><span class="st">`</span>[<span class="sc">!</span>markers.listNeur508<span class="sc">$</span><span class="st">`</span><span class="at">Neur508 Cotan</span><span class="st">`</span> <span class="sc">%in%</span> markers.listNeur508<span class="sc">$</span><span class="st">`</span><span class="at">Neur508 Seurat</span><span class="st">`</span>]</span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-4"><a href="#cb124-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb124-5"><a href="#cb124-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">11</span>)</span>
<span id="cb124-6"><a href="#cb124-6" aria-hidden="true" tabindex="-1"></a>genes <span class="ot">&lt;-</span> <span class="fu">sample</span>(genes.to.test.Cotan,<span class="at">size =</span> <span class="dv">30</span>)</span>
<span id="cb124-7"><a href="#cb124-7" aria-hidden="true" tabindex="-1"></a>genes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "X1700066M21Rik" "Gm44734"        "Zfp959"         "Rpl37"         
 [5] "Chodl"          "Mmp17"          "Atp5h"          "Acot6"         
 [9] "Cux2"           "Rps10"          "Rpl13a"         "Lurap1l"       
[13] "Tcf12"          "Sirt6"          "Gm12184"        "Etohd2"        
[17] "Laptm4b"        "Pomc"           "Rpl9"           "Inhbb"         
[21] "Gpr62"          "Sstr3"          "D830035M03Rik"  "Eef1b2"        
[25] "Bmpr1b"         "Rps4x"          "Tpd52"          "Selenow"       
[29] "Pla2g7"         "Kcnj11"        </code></pre>
</div>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>n<span class="ot">=</span><span class="dv">0</span></span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (g <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">0</span><span class="sc">:</span><span class="dv">2</span>)) {</span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  n <span class="ot">=</span> g<span class="sc">*</span><span class="dv">4</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="fu">FeaturePlot</span>(seurat.obj,<span class="at">features =</span> genes[n<span class="sc">+</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)], <span class="at">label =</span> T))</span>
<span id="cb126-5"><a href="#cb126-5" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-70-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-70-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">getNumOfExpressingCells</span>(fb150Obj)[genes.to.test.Cotan]</span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(df)</span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb127-5"><a href="#cb127-5" aria-hidden="true" tabindex="-1"></a>df<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Only Cotan Genes"</span></span>
<span id="cb127-6"><a href="#cb127-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-7"><a href="#cb127-7" aria-hidden="true" tabindex="-1"></a>df.bk <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">getNumOfExpressingCells</span>(fb150Obj)[<span class="fu">sample</span>(<span class="fu">getGenes</span>(fb150Obj), <span class="at">size =</span> <span class="fu">length</span>(<span class="fu">rownames</span>(df)))])</span>
<span id="cb127-8"><a href="#cb127-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(df.bk) <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb127-9"><a href="#cb127-9" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(df.bk) <span class="ot">&lt;-</span> <span class="st">"CellNumber"</span></span>
<span id="cb127-10"><a href="#cb127-10" aria-hidden="true" tabindex="-1"></a>df.bk<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="st">"Whole dataset Genes"</span></span>
<span id="cb127-11"><a href="#cb127-11" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(df,df.bk)</span>
<span id="cb127-12"><a href="#cb127-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-13"><a href="#cb127-13" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">ddply</span>(df, <span class="st">"type"</span>, summarise, <span class="at">grp.mean=</span><span class="fu">mean</span>(CellNumber))</span>
<span id="cb127-14"><a href="#cb127-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb127-15"><a href="#cb127-15" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(df,<span class="fu">aes</span>(<span class="at">x=</span>CellNumber,<span class="at">fill=</span>type))<span class="sc">+</span></span>
<span id="cb127-16"><a href="#cb127-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#C69AFF"</span>, <span class="st">"#56B4E9"</span>))<span class="sc">+</span></span>
<span id="cb127-17"><a href="#cb127-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y=</span>..density..), <span class="at">position=</span><span class="st">"identity"</span>, <span class="at">alpha=</span><span class="fl">0.5</span>,<span class="at">bins =</span> <span class="dv">25</span>)<span class="sc">+</span><span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">4800</span>)<span class="sc">+</span></span>
<span id="cb127-18"><a href="#cb127-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_vline</span>(<span class="at">data=</span>mu, <span class="fu">aes</span>(<span class="at">xintercept=</span>grp.mean, <span class="at">color=</span>type),</span>
<span id="cb127-19"><a href="#cb127-19" aria-hidden="true" tabindex="-1"></a>           <span class="at">linetype=</span><span class="st">"dashed"</span>)<span class="sc">+</span></span>
<span id="cb127-20"><a href="#cb127-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_density</span>(<span class="at">alpha=</span><span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb127-21"><a href="#cb127-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> percent, <span class="at">name =</span> <span class="st">"percent"</span>) <span class="sc">+</span></span>
<span id="cb127-22"><a href="#cb127-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>()<span class="sc">+</span></span>
<span id="cb127-23"><a href="#cb127-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Now we can test the enrichment for the specific gene both in Seurat and in Cotan.</p>
<p>To make a comparison more equal we select the same number of genes (depending on the smallest group)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="co">#genes.to.testTop &lt;- seurat.obj.markers.ClusterName[seurat.obj.markers.ClusterName$cluster == "Neur508" &amp; seurat.obj.markers.ClusterName$gene %in% genes.to.test,]$gene[1:length(genes.to.test.Cotan)]</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>enriched <span class="ot">&lt;-</span> <span class="fu">enrichr</span>(genes.to.test, dbs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Uploading data to Enrichr... Done.
  Querying ARCHS4_Tissues... Done.
Parsing results... Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotEnrich</span>(enriched[[<span class="dv">1</span>]], <span class="at">showTerms =</span> <span class="dv">10</span>, <span class="at">numChar =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">orderBy =</span> <span class="st">"P.value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>wordcloud_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Terms =</span> <span class="fu">str_split</span>(enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Term[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>],<span class="at">pattern =</span> <span class="st">" CL"</span>,<span class="at">simplify =</span> T )[,<span class="dv">1</span>],</span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Scores =</span> enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Combined.Score[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(wordcloud_data<span class="sc">$</span>Terms, wordcloud_data<span class="sc">$</span>Scores, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.1</span>,<span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>subset.pval <span class="ot">&lt;-</span> dea.ClusterName<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>[<span class="fu">rownames</span>(dea.ClusterName<span class="sc">$</span><span class="st">`</span><span class="at">p-value</span><span class="st">`</span>) <span class="sc">%in%</span> genes.to.test.Cotan,]</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>genes.to.test.Cotan.Top <span class="ot">&lt;-</span> <span class="fu">rownames</span>(subset.pval[<span class="fu">order</span>(subset.pval<span class="sc">$</span>Neur492,<span class="at">decreasing =</span> F),])[<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(genes.to.test)]</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>enriched <span class="ot">&lt;-</span> <span class="fu">enrichr</span>(genes.to.test.Cotan.Top, dbs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Uploading data to Enrichr... Done.
  Querying ARCHS4_Tissues... Done.
Parsing results... Done.</code></pre>
</div>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotEnrich</span>(enriched[[<span class="dv">1</span>]], <span class="at">showTerms =</span> <span class="dv">10</span>, <span class="at">numChar =</span> <span class="dv">40</span>, <span class="at">y =</span> <span class="st">"Count"</span>, <span class="at">orderBy =</span> <span class="st">"P.value"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>wordcloud_data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Terms =</span> <span class="fu">str_split</span>(enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Term[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>],<span class="at">pattern =</span> <span class="st">" CL"</span>,<span class="at">simplify =</span> T )[,<span class="dv">1</span>],</span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>                             <span class="at">Scores =</span> enriched[[<span class="dv">1</span>]]<span class="sc">$</span>Combined.Score[<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>])</span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="fu">wordcloud</span>(wordcloud_data<span class="sc">$</span>Terms, wordcloud_data<span class="sc">$</span>Scores, <span class="at">scale =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">1</span>), <span class="at">min.freq =</span> <span class="dv">1</span>, <span class="at">random.order=</span><span class="cn">FALSE</span>, <span class="at">rot.per=</span><span class="fl">0.1</span>,<span class="at">colors=</span><span class="fu">brewer.pal</span>(<span class="dv">8</span>, <span class="st">"Dark2"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggVennDiagram</span>(markers.list[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">5</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggVennDiagram</span>(markers.list[<span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">6</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DEA_Seurat_COTAN_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sessionInfo</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.0 (2023-04-21)
Platform: x86_64-pc-linux-gnu (64-bit)
Running under: Ubuntu 20.04.6 LTS

Matrix products: default
BLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 
LAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0

locale:
 [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       
 [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   
 [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          
[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   

time zone: Europe/Berlin
tzcode source: system (glibc)

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] enrichR_3.2         tidyr_1.3.0         ggVennDiagram_1.2.2
 [4] assertr_3.0.0       stringr_1.5.0       wordcloud_2.6      
 [7] RColorBrewer_1.1-3  SeuratObject_4.1.3  Seurat_4.3.0       
[10] rlang_1.1.0         scales_1.2.1        plyr_1.8.8         
[13] COTAN_2.1.5         zeallot_0.1.0       tibble_3.2.1       
[16] ggplot2_3.4.2      

loaded via a namespace (and not attached):
  [1] RcppAnnoy_0.0.20       splines_4.3.0          later_1.3.0           
  [4] polyclip_1.10-4        factoextra_1.0.7       lifecycle_1.0.3       
  [7] sf_1.0-13              doParallel_1.0.17      globals_0.16.2        
 [10] lattice_0.21-8         MASS_7.3-59            dendextend_1.17.1     
 [13] magrittr_2.0.3         limma_3.56.0           plotly_4.10.1         
 [16] rmarkdown_2.21         yaml_2.3.7             httpuv_1.6.9          
 [19] sctransform_0.3.5      askpass_1.1            sp_1.6-0              
 [22] spatstat.sparse_3.0-1  reticulate_1.30        cowplot_1.1.1         
 [25] pbapply_1.7-0          DBI_1.1.3              abind_1.4-5           
 [28] Rtsne_0.16             purrr_1.0.1            BiocGenerics_0.46.0   
 [31] WriteXLS_6.4.0         circlize_0.4.15        IRanges_2.34.0        
 [34] S4Vectors_0.38.0       ggrepel_0.9.3          irlba_2.3.5.1         
 [37] listenv_0.9.0          spatstat.utils_3.0-3   units_0.8-2           
 [40] umap_0.2.10.0          goftest_1.2-3          RSpectra_0.16-1       
 [43] spatstat.random_3.1-4  fitdistrplus_1.1-8     parallelly_1.36.0     
 [46] leiden_0.4.3           codetools_0.2-19       tidyselect_1.2.0      
 [49] shape_1.4.6            farver_2.1.1           viridis_0.6.2         
 [52] matrixStats_1.0.0      stats4_4.3.0           spatstat.explore_3.2-1
 [55] jsonlite_1.8.4         GetoptLong_1.0.5       e1071_1.7-13          
 [58] ellipsis_0.3.2         progressr_0.13.0       ggridges_0.5.4        
 [61] survival_3.5-5         iterators_1.0.14       foreach_1.5.2         
 [64] tools_4.3.0            ica_1.0-3              Rcpp_1.0.10           
 [67] glue_1.6.2             gridExtra_2.3          xfun_0.39             
 [70] ggthemes_4.2.4         dplyr_1.1.2            withr_2.5.0           
 [73] fastmap_1.1.1          fansi_1.0.4            openssl_2.0.6         
 [76] digest_0.6.31          parallelDist_0.2.6     R6_2.5.1              
 [79] mime_0.12              colorspace_2.1-0       scattermore_1.2       
 [82] tensor_1.5             spatstat.data_3.0-1    utf8_1.2.3            
 [85] generics_0.1.3         data.table_1.14.8      class_7.3-21          
 [88] httr_1.4.5             htmlwidgets_1.6.2      uwot_0.1.14           
 [91] pkgconfig_2.0.3        gtable_0.3.3           ComplexHeatmap_2.16.0 
 [94] lmtest_0.9-40          htmltools_0.5.5        clue_0.3-64           
 [97] png_0.1-8              knitr_1.42             rstudioapi_0.14       
[100] reshape2_1.4.4         rjson_0.2.21           nlme_3.1-162          
[103] curl_5.0.0             proxy_0.4-27           zoo_1.8-12            
[106] GlobalOptions_0.1.2    RVenn_1.1.0            KernSmooth_2.23-20    
[109] parallel_4.3.0         miniUI_0.1.1.1         vipor_0.4.5           
[112] RcppZiggurat_0.1.6     ggrastr_1.0.2          pillar_1.9.0          
[115] grid_4.3.0             vctrs_0.6.1            RANN_2.6.1            
[118] promises_1.2.0.1       xtable_1.8-4           cluster_2.1.4         
[121] beeswarm_0.4.0         evaluate_0.20          cli_3.6.1             
[124] compiler_4.3.0         crayon_1.5.2           future.apply_1.11.0   
[127] labeling_0.4.2         classInt_0.4-9         ggbeeswarm_0.7.2      
[130] stringi_1.7.12         viridisLite_0.4.1      deldir_1.0-6          
[133] assertthat_0.2.1       munsell_0.5.0          lazyeval_0.2.2        
[136] spatstat.geom_3.2-1    Matrix_1.5-4.1         patchwork_1.1.2       
[139] future_1.32.0          shiny_1.7.4            ROCR_1.0-11           
[142] Rfast_2.0.7            igraph_1.4.2           RcppParallel_5.1.7    </code></pre>
</div>
</div>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>