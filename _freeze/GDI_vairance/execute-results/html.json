{
  "hash": "bae09cde228b418cb97ae24ec707536e",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"GDI and variance\"\nauthor: \"Silvia Galfr√®\"\n---\n\n\n\n## Preamble\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyr)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(gghalves)\nlibrary(ggstatsplot)\nlibrary(\"gridExtra\")\nlibrary(cowplot)\nlibrary(Matrix)\nlibrary(ggstance)\nlibrary(scales)\n#library(COTAN)\n\n#Define colors\ncolors.methods <- c(\"#ed5537\",\"#a3505c\",\"#95ba8f\",\"#B3CDE3\",\"#8856A7\" )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlayer.genes <- read.csv(\"CoexData/aam8999_tables6.csv\", header = T,skip = 1)\n\nHK <- read.csv(\"CoexData/MouseconstitutiveGenesCerebralCortex.csv\")\n## From: https://housekeeping.unicamp.br/\ngenesList <- list(\n  \"NPGs\"= \n    c(\"Nes\", \"Vim\", \"Sox2\", \"Sox1\", \"Notch1\", \"Hes1\", \"Hes5\", \"Pax6\"),\n  \"PNGs\"= \n    c(\"Map2\", \"Tubb3\", \"Neurod1\", \"Nefm\", \"Nefl\", \"Dcx\", \"Tbr1\"),\n  \"hk\"=  c(sample(unique(HK$Gene.Symbol),size = 40),\n    \"Calm1\", \"Cox6b1\", \"Ppia\", \"Rpl18\", \"Cox7c\", \"Erh\", \"H3f3a\", \"Taf1\", \"Taf2\", \"Gapdh\", \"Actb\", \"Golph3\", \"Zfr\", \"Sub1\",\n      \"Tars\", \"Amacr\",\"Tbp\"),\n  \n  \"layers\" = unique(c(layer.genes[str_detect(layer.genes$Cluster,pattern = \"CTX PyrL5|CTX PyrL6\"),\"Gene\"],\n    \n      \"Rasgrf2\", \"Slc17a6\", \"Satb2\", \"Sema3c\",\"Thsd7a\", \"Rorb\", \"Cux2\", \"Pvrl3\",\"Rasgrf2\",\"Syt6\", \"Grik3\", \"Foxp2\", \"Tle4\", \"Htr1f\",\"Rxfp1\",\n      #others\n    #  \"Pax3\", \"Mki67\",\"Lhx6\",\"Trdn\", \"Cpa6\",\"Adarb2\",\"Pbx3\",\"Trp73\", \"Reln\"))\n    \"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Trp73\"))\n    #sample(unique(unlist(str_split(layer.genes$supertype.markers.combo,pattern = \",\"))),size = 50)\n    #c(\"Reln\",\"Lhx5\",\"Cux1\",\"Satb2\",\"Tle1\",\"Mef2c\",\"Rorb\",\"Sox5\",\"Bcl11b\",\"Fezf2\",\"Foxp2\",\"Ntf3\",\"Rasgrf2\",\"Pvrl3\", \"Cux2\",\"Slc17a6\", \"Sema3c\",\"Thsd7a\", \"Sulf2\", \"Kcnk2\",\"Grik3\", \"Etv1\", \"Tle4\", \"Tmem200a\", \"Glra2\", \"Etv1\",\"Htr1f\", \"Sulf1\",\"Rxfp1\", \"Syt6\") \n  # From https://www.science.org/doi/10.1126/science.aam8999\n)\n\nInDir <- \"CoexData/\"\n```\n:::\n\n\n\n## Import data\n\nImport COTAN GDI and Seurat variances data from files\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable.tot.hk <- NA\ntable.tot.neural <- NA\nfor (file in list.files(InDir,pattern = \"Variance\")) {\n  print(file)\n  data <- read.csv(paste0(InDir,file),row.names = 1)\n  #data <- as.data.frame(as.matrix(data))\n  if(str_detect(file,pattern = \"GDI\")){\n    code <- \"COTAN GDI\"\n    data$genes <- rownames(data)\n    #data <- data[,c(\"genes\",\"GDI\",\"sum.raw.norm\")]\n    data <- data[,c(\"genes\",\"GDI\",\"sum.raw.norm\")]\n    colnames(data) <- c(\"genes\",\"GDI_Variance\",\"sum.raw.norm\")\n    #data$GDI_Variance <- scale(data$GDI_Variance,center = T)\n    }else if(str_detect(file,pattern = \"SeuratSCT\")){\n    code <- \"Seurat SCT variance\"\n    data$genes <- rownames(data)\n    #data <- data[,c(\"genes\",\"residual_variance\")]\n    data <- data[,c(\"genes\",\"residual_variance\")]\n    colnames(data) <- c(\"genes\",\"GDI_Variance\")\n    data$sum.raw.norm <- NA\n    #data$GDI_Variance <- scale(data$GDI_Variance,center = T)\n  }else if(str_detect(file,pattern = \"Seurat_\")){\n    code <- \"Seurat variance\"\n    data$genes <- rownames(data)\n    #data <- data[,c(\"genes\",\"variance.standardized\")]\n    data <- data[,c(\"genes\",\"variance.standardized\")]\n    \n    colnames(data) <- c(\"genes\",\"GDI_Variance\")\n    data$sum.raw.norm <- NA\n    #data$GDI_Variance <- scale(data$GDI_Variance,center = T)\n    #print(\"ok\")\n  }\n  \n  data$Method <- code\n  file <- str_remove(file,pattern = \".csv\")\n  file <- str_flatten(str_split(file,\n                              pattern = \"_\",simplify = T)[,c(3,4)],\n                              collapse = \"_\")\n  file <- str_remove(file,pattern = \"genes\")\n  data$Dataset <-   file\n  table.hk <- data[rownames(data) %in% genesList$hk,]\n  table.tot.hk <- rbind(table.tot.hk,table.hk)\n  #table.tot.hk <- table.tot.hk[! table.tot.hk$Gene1 == table.tot.hk$Gene2,]\n \n  #Not hk\n  table.neural <- data[rownames(data) %in% c(genesList$NPGs,genesList$PNGs,genesList$layers),]\n  \n\n  table.tot.neural <- rbind(table.tot.neural,table.neural)\n  #table.tot.neural <- table.tot.neural[! table.tot.neural$Gene1 == table.tot.neural$Gene2,]\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"Variance_GDI_genesCorticalCells_GSM2861511_E135.csv\"\n[1] \"Variance_GDI_genesCorticalCells_GSM2861514_E175.csv\"\n[1] \"Variance_GDI_genese13.5_ForebrainDorsal.csv\"\n[1] \"Variance_GDI_genese15.0_ForebrainDorsal.csv\"\n[1] \"Variance_GDI_genese17.5_ForebrainDorsal.csv\"\n[1] \"Variance_GDI_genesMouseCortex_E14.5.csv\"\n[1] \"Variance_Seurat_genesCorticalCells_GSM2861511_E135.csv\"\n[1] \"Variance_Seurat_genesCorticalCells_GSM2861514_E175.csv\"\n[1] \"Variance_Seurat_genese13.5_ForebrainDorsal.csv\"\n[1] \"Variance_Seurat_genese15.0_ForebrainDorsal.csv\"\n[1] \"Variance_Seurat_genese17.5_ForebrainDorsal.csv\"\n[1] \"Variance_Seurat_genesMouseCortex_E14.5.csv\"\n[1] \"Variance_SeuratSCT_genesCorticalCells_GSM2861511_E135.csv\"\n[1] \"Variance_SeuratSCT_genesCorticalCells_GSM2861514_E175.csv\"\n[1] \"Variance_SeuratSCT_genese13.5_ForebrainDorsal.csv\"\n[1] \"Variance_SeuratSCT_genese15.0_ForebrainDorsal.csv\"\n[1] \"Variance_SeuratSCT_genese17.5_ForebrainDorsal.csv\"\n[1] \"Variance_SeuratSCT_genesMouseCortex_E14.5.csv\"\n```\n\n\n:::\n\n```{.r .cell-code}\ntable.tot.neural$Type <- \"Neural\"\ntable.tot.hk$Type <- \"Constitutive\"\n\ntable.tot.neural <- table.tot.neural[2:nrow(table.tot.neural),]\ntable.tot.hk <- table.tot.hk[2:nrow(table.tot.hk),]\n\n\n\n\n\ntable.tot <- rbind(table.tot.hk,table.tot.neural)\n\ntable.tot$Method_Type <- paste0(table.tot$Method,\":\",table.tot$Type)\n\nhead(table.tot)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        genes GDI_Variance sum.raw.norm    Method                  Dataset\nActb     Actb     0.894289     9.921265 COTAN GDI CorticalCells_GSM2861511\nAmacr   Amacr     1.096773     3.191098 COTAN GDI CorticalCells_GSM2861511\nAmfr     Amfr     1.314979     4.792456 COTAN GDI CorticalCells_GSM2861511\nApmap   Apmap     1.292071     4.029402 COTAN GDI CorticalCells_GSM2861511\nBap1     Bap1     1.282919     5.248490 COTAN GDI CorticalCells_GSM2861511\nCactin Cactin     1.215138     4.624020 COTAN GDI CorticalCells_GSM2861511\n               Type            Method_Type\nActb   Constitutive COTAN GDI:Constitutive\nAmacr  Constitutive COTAN GDI:Constitutive\nAmfr   Constitutive COTAN GDI:Constitutive\nApmap  Constitutive COTAN GDI:Constitutive\nBap1   Constitutive COTAN GDI:Constitutive\nCactin Constitutive COTAN GDI:Constitutive\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(table.tot,aes(x=(GDI_Variance), fill=Method_Type))+geom_histogram(bins = 50, alpha=0.7,position = \"dodge\")+ facet_grid(.~ Method,scales = \"free\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(table.tot,aes(x=(GDI_Variance), fill=Method_Type))+geom_density(alpha=0.5)+ facet_grid(.~ Method)+xlim(-3,5)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(table.tot,aes(y=log(abs(GDI_Variance)),x=Method_Type, fill=Method_Type))+geom_boxplot()+ facet_grid(.~ Method,scales = \"free\")\n```\n\n::: {.cell-output-display}\n![](GDI_vairance_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "GDI_vairance_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}