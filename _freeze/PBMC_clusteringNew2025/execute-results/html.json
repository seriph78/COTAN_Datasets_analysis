{
  "hash": "2af623cca0b81875ae6e89171196b05a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"COTAN coex clustering PBMCs\"\nauthor: \"Silvia Galfr√®\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(COTAN)\nlibrary(stringr)\nlibrary(ggplot2)\nlibrary(tibble)\nlibrary(zeallot)\n```\n:::\n\n\n\n## PBMC1\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npbmc1 <- readRDS(\"Data/PBMC1/COTAN/PBMC1.cotan.RDS\")\n\noptions(parallelly.fork.enable = TRUE)\n\nadvChecker <- new(\"AdvancedGDIUniformityCheck\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsetLoggingFile(\"Data/PBMC1/LogClustering.log\")\n\npbmc1 <- clean(pbmc1)\npbmc1 <- proceedToCoex(pbmc1,calcCoex = T,cores = 5,saveObj = F)\n\ncl <- cellsUniformClustering(pbmc1,cores = 5,initialResolution = 0.8,\n                             optimizeForSpeed = T,\n                             checker = advChecker,\n                             useCoexEigen = T,dataMethod = \"AB\",saveObj = T,\n                             outDir = \"Data/PBMC1/\")\n\ncl.merged <- mergeUniformCellsClusters(objCOTAN = pbmc1,clusters = cl$clusters,checkers = advChecker,cores = 5,optimizeForSpeed = T,saveObj = T,outDir = \"Data/PBMC1/\")\n\npbmc1 <- addClusterization(pbmc1,clName = \"AB_CoexEigenSplit\",clusters = cl$clusters,coexDF = cl$coex)\n\npbmc1 <- addClusterization(pbmc1,clName = \"AB_CoexEigenMerge\",clusters = cl.merged$clusters,coexDF = cl.merged$coex)\n\nwrite.csv(cl$clusters,\"Data/PBMC1/COTAN/AB_CoexEigenSplitCluster.csv\")\nwrite.csv(cl.merged$clusters,\"Data/PBMC1/COTAN/AB_CoexEigenMergeCluster.csv\")\n\nsaveRDS(pbmc1,\"Data/PBMC1/COTAN/PBMC1.cotan.RDS\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncl <- cellsUniformClustering(pbmc1,cores = 5,#initialResolution = 3.8,\n                             optimizeForSpeed = T,\n                             checker = advChecker,\n                             useCoexEigen = T,dataMethod = \"LL\",saveObj = T,\n                             outDir = \"Data/PBMC1/\")\n\ncl.merged <- mergeUniformCellsClusters(objCOTAN = pbmc1,clusters = cl$clusters,checkers = advChecker,cores = 5,optimizeForSpeed = T,saveObj = T,outDir = \"Data/PBMC1/\")\n\npbmc1 <- addClusterization(pbmc1,clName = \"LL_CoexEigenSplit\",clusters = cl$clusters,coexDF = cl$coex)\n\npbmc1 <- addClusterization(pbmc1,clName = \"LL_CoexEigenMerge\",clusters = cl.merged$clusters,coexDF = cl.merged$coex)\n\nwrite.csv(cl$clusters,\"Data/PBMC1/COTAN/LL_CoexEigenSplitCluster.csv\")\n\nwrite.csv(cl.merged$clusters,\"Data/PBMC1/COTAN/LL_CoexEigenMergeCluster.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveRDS(pbmc1,\"Data/PBMC1/COTAN/PBMC1.cotan.RDS\")\n```\n:::\n\n\n\n\n## PBMC2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npbmc2 <- readRDS(\"Data/PBMC2/filtered/PBMC2.cotan.RDS\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsetLoggingFile(\"Data/PBMC2/LogClustering.log\")\n\npbmc2 <- clean(pbmc2)\npbmc2 <- proceedToCoex(pbmc2,calcCoex = T,cores = 5,saveObj = F)\n\ncl <- cellsUniformClustering(pbmc2,cores = 5,initialResolution = 0.8,\n                             optimizeForSpeed = T,\n                             checker = advChecker,\n                             useCoexEigen = T,dataMethod = \"AB\",saveObj = T,\n                             outDir = \"Data/PBMC2/\")\n\ncl.merged <- mergeUniformCellsClusters(objCOTAN = pbmc2,clusters = cl$clusters,checkers = advChecker,cores = 5,optimizeForSpeed = T,saveObj = T,outDir = \"Data/PBMC2/\")\n\npbmc2 <- addClusterization(pbmc2,clName = \"AB_CoexEigenSplit\",clusters = cl$clusters,coexDF = cl$coex)\n\npbmc2 <- addClusterization(pbmc2,clName = \"AB_CoexEigenMerge\",clusters = cl.merged$clusters,coexDF = cl.merged$coex)\n\nwrite.csv(cl$clusters,\"Data/PBMC2/COTAN/AB_CoexEigenSplitCluster.csv\")\nwrite.csv(cl.merged$clusters,\"Data/PBMC2/COTAN/AB_CoexEigenMergeCluster.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncl <- cellsUniformClustering(pbmc2,cores = 5,#initialResolution = 3.8,\n                             optimizeForSpeed = T,\n                             checker = advChecker,\n                             useCoexEigen = T,dataMethod = \"LL\",saveObj = T,\n                             outDir = \"Data/PBMC2/\")\n\ncl.merged <- mergeUniformCellsClusters(objCOTAN = pbmc2,clusters = cl$clusters,checkers = advChecker,cores = 5,optimizeForSpeed = T,saveObj = T,outDir = \"Data/PBMC2/\")\n\npbmc2 <- addClusterization(pbmc2,clName = \"LL_CoexEigenSplit\",clusters = cl$clusters,coexDF = cl$coex)\n\npbmc2 <- addClusterization(pbmc2,clName = \"LL_CoexEigenMerge\",clusters = cl.merged$clusters,coexDF = cl.merged$coex)\n\nwrite.csv(cl$clusters,\"Data/PBMC2/COTAN/LL_CoexEigenSplitCluster.csv\")\n\nwrite.csv(cl.merged$clusters,\"Data/PBMC2/COTAN/LL_CoexEigenMergeCluster.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncl <- cellsUniformClustering(pbmc2,cores = 5,#initialResolution = 3.8,\n                             optimizeForSpeed = T,\n                             checker = advChecker,\n                             useCoexEigen = T,dataMethod = \"LL\",saveObj = T,\n                             outDir = \"Data/PBMC2/\")\n\ncl.merged <- mergeUniformCellsClusters(objCOTAN = pbmc2,clusters = cl$clusters,checkers = advChecker,cores = 5,optimizeForSpeed = T,saveObj = T,outDir = \"Data/PBMC2/\")\n\npbmc2 <- addClusterization(pbmc2,clName = \"LL_CoexEigenSplit\",clusters = cl$clusters,coexDF = cl$coex)\n\npbmc2 <- addClusterization(pbmc2,clName = \"LL_CoexEigenMerge\",clusters = cl.merged$clusters,coexDF = cl.merged$coex)\n\nwrite.csv(cl$clusters,\"Data/PBMC2/COTAN/LL_CoexEigenSplitCluster.csv\")\n\nwrite.csv(cl.merged$clusters,\"Data/PBMC2/COTAN/LL_CoexEigenMergeCluster.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsaveRDS(pbmc2,\"Data/PBMC1/COTAN/PBMC2.cotan.RDS\")\n```\n:::\n\n\n\n\n\n## PBMC3\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPBMC3 <- readRDS(\"Data/PBMC3/filtered/PBMC3.cotan.RDS\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsetLoggingFile(\"Data/PBMC3/LogClustering.log\")\n\nPBMC3 <- clean(PBMC3)\nPBMC3 <- proceedToCoex(PBMC3,calcCoex = T,cores = 5,saveObj = F)\n\ncl <- cellsUniformClustering(PBMC3,cores = 5,initialResolution = 0.8,\n                             optimizeForSpeed = T,\n                             checker = advChecker,\n                             useCoexEigen = T,dataMethod = \"AB\",saveObj = T,\n                             outDir = \"Data/PBMC3/\")\n\ncl.merged <- mergeUniformCellsClusters(objCOTAN = PBMC3,clusters = cl$clusters,checkers = advChecker,cores = 5,optimizeForSpeed = T,saveObj = T,outDir = \"Data/PBMC3/\")\n\nPBMC3 <- addClusterization(PBMC3,clName = \"AB_CoexEigenSplit\",clusters = cl$clusters,coexDF = cl$coex)\n\nPBMC3 <- addClusterization(PBMC3,clName = \"AB_CoexEigenMerge\",clusters = cl.merged$clusters,coexDF = cl.merged$coex)\n\nwrite.csv(cl$clusters,\"Data/PBMC3/COTAN/AB_CoexEigenSplitCluster.csv\")\nwrite.csv(cl.merged$clusters,\"Data/PBMC3/COTAN/AB_CoexEigenMergeCluster.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncl <- cellsUniformClustering(PBMC3,cores = 5,#initialResolution = 3.8,\n                             optimizeForSpeed = T,\n                             checker = advChecker,\n                             useCoexEigen = T,dataMethod = \"LL\",saveObj = T,\n                             outDir = \"Data/PBMC3/\")\n\ncl.merged <- mergeUniformCellsClusters(objCOTAN = PBMC3,clusters = cl$clusters,checkers = advChecker,cores = 5,optimizeForSpeed = T,saveObj = T,outDir = \"Data/PBMC3/\")\n\nPBMC3 <- addClusterization(PBMC3,clName = \"LL_CoexEigenSplit\",clusters = cl$clusters,coexDF = cl$coex)\n\nPBMC3 <- addClusterization(PBMC3,clName = \"LL_CoexEigenMerge\",clusters = cl.merged$clusters,coexDF = cl.merged$coex)\n\nwrite.csv(cl$clusters,\"Data/PBMC3/COTAN/LL_CoexEigenSplitCluster.csv\")\n\nwrite.csv(cl.merged$clusters,\"Data/PBMC3/COTAN/LL_CoexEigenMergeCluster.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncl <- cellsUniformClustering(PBMC3,cores = 5,#initialResolution = 3.8,\n                             optimizeForSpeed = T,\n                             checker = advChecker,\n                             useCoexEigen = T,dataMethod = \"LL\",saveObj = T,\n                             outDir = \"Data/PBMC3/\")\n\ncl.merged <- mergeUniformCellsClusters(objCOTAN = PBMC3,clusters = cl$clusters,checkers = advChecker,cores = 5,optimizeForSpeed = T,saveObj = T,outDir = \"Data/PBMC3/\")\n\nPBMC3 <- addClusterization(PBMC3,clName = \"LL_CoexEigenSplit\",clusters = cl$clusters,coexDF = cl$coex)\n\nPBMC3 <- addClusterization(PBMC3,clName = \"LL_CoexEigenMerge\",clusters = cl.merged$clusters,coexDF = cl.merged$coex)\n\nwrite.csv(cl$clusters,\"Data/PBMC3/COTAN/LL_CoexEigenSplitCluster.csv\")\n\nwrite.csv(cl.merged$clusters,\"Data/PBMC3/COTAN/LL_CoexEigenMergeCluster.csv\")\n```\n:::\n\n\n\n## PBMC4\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPBMC4 <- readRDS(\"Data/PBMC4/filtered/PBMC4.cotan.RDS\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsetLoggingFile(\"Data/PBMC4/LogClustering.log\")\n\nPBMC4 <- clean(PBMC4)\nPBMC4 <- proceedToCoex(PBMC4,calcCoex = T,cores = 5,saveObj = F)\n\ncl <- cellsUniformClustering(PBMC4,cores = 5,initialResolution = 0.8,\n                             optimizeForSpeed = T,\n                             checker = advChecker,\n                             useCoexEigen = T,dataMethod = \"AB\",saveObj = T,\n                             outDir = \"Data/PBMC4/\")\n\ncl.merged <- mergeUniformCellsClusters(objCOTAN = PBMC4,clusters = cl$clusters,checkers = advChecker,cores = 5,optimizeForSpeed = T,saveObj = T,outDir = \"Data/PBMC4/\")\n\nPBMC4 <- addClusterization(PBMC4,clName = \"AB_CoexEigenSplit\",clusters = cl$clusters,coexDF = cl$coex)\n\nPBMC4 <- addClusterization(PBMC4,clName = \"AB_CoexEigenMerge\",clusters = cl.merged$clusters,coexDF = cl.merged$coex)\n\nwrite.csv(cl$clusters,\"Data/PBMC4/COTAN/AB_CoexEigenSplitCluster.csv\")\nwrite.csv(cl.merged$clusters,\"Data/PBMC4/COTAN/AB_CoexEigenMergeCluster.csv\")\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncl <- cellsUniformClustering(PBMC4,cores = 5,#initialResolution = 3.8,\n                             optimizeForSpeed = T,\n                             checker = advChecker,\n                             useCoexEigen = T,dataMethod = \"LL\",saveObj = T,\n                             outDir = \"Data/PBMC4/\")\n\ncl.merged <- mergeUniformCellsClusters(objCOTAN = PBMC4,clusters = cl$clusters,checkers = advChecker,cores = 5,optimizeForSpeed = T,saveObj = T,outDir = \"Data/PBMC4/\")\n\nPBMC4 <- addClusterization(PBMC4,clName = \"LL_CoexEigenSplit\",clusters = cl$clusters,coexDF = cl$coex)\n\nPBMC4 <- addClusterization(PBMC4,clName = \"LL_CoexEigenMerge\",clusters = cl.merged$clusters,coexDF = cl.merged$coex)\n\nwrite.csv(cl$clusters,\"Data/PBMC4/COTAN/LL_CoexEigenSplitCluster.csv\")\n\nwrite.csv(cl.merged$clusters,\"Data/PBMC4/COTAN/LL_CoexEigenMergeCluster.csv\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}