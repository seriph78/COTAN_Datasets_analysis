{
  "hash": "2e6f65b8e6a3150a83be940d12054848",
  "result": {
    "markdown": "---\ntitle: \"Explorative analysis of gene expression\"\ndate: \"2024-01-26\"\noutput: html_document\nauthor: \"Silvia Galfr√®\"\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n#library(COTAN)\n#options(parallelly.fork.enable = TRUE)\n#library(Seurat)\n#library(monocle3)\n#library(reticulate)\nlibrary(ggplot2)\nlibrary(stringr)\nlibrary(dplyr)\n\ndirOut <- \"Results/GeneExpressionExploration/\"\nif (!exists(dirOut)) {\n  dir.create(dirOut)\n}\ndataSetDir <- \"Data/MouseCortexFromLoom/SingleClusterRawData/\"\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- NA\nfor (dataSetName in list.files(dataSetDir)) {\n  print(dataSetName)\n  name <- str_split(dataSetName,pattern = \"_\", simplify = T)[1]\n  cluster.name <- str_split(name,pattern = \"e\", simplify = T)[1]\n  time.point <- paste0(\"E\",str_split(name,pattern = \"e\", simplify = T)[2])\n  dataSet <- readRDS(paste0(dataSetDir,dataSetName))\n  print(dim(dataSet))\n  message(dim(dataSet))\n  df.temp <- as.data.frame(list(\"RowSums\"=rowSums(dataSet)))\n  df.temp$N.cells <- dim(dataSet)[2]\n  df.temp$genes <- rownames(df.temp)\n  df.temp$log10_exp <- log10((df.temp$RowSums+1)/df.temp$N.cells)\n  df.temp$cluster <- cluster.name\n  df.temp$time.point <- time.point\n  \n  df <- rbind(df,df.temp)\n  \n}\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Cl184e13.5_ForebrainDorsalRawData.RDS\"\nNULL\n[1] \"Cl187e13.5_ForebrainDorsalRawData.RDS\"\n[1] 13972   334\n[1] \"Cl428e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   318\n[1] \"Cl432e13.5_ForebrainDorsalRawData.RDS\"\n[1] 13972   536\n[1] \"Cl432e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   586\n[1] \"Cl434e13.5_ForebrainDorsalRawData.RDS\"\n[1] 13972   326\n[1] \"Cl434e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   273\n[1] \"Cl437e13.5_ForebrainDorsalRawData.RDS\"\n[1] 13972   259\n[1] \"Cl437e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   258\n[1] \"Cl505e17.5_ForebrainDorsalRawData.RDS\"\n[1] 13971   203\n[1] \"Cl508e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   397\n[1] \"Cl509e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   402\n[1] \"Cl510e13.5_ForebrainDorsalRawData.RDS\"\n[1] 13972   248\n[1] \"Cl510e15.0_ForebrainDorsalRawData.RDS\"\n[1] 13857   402\n[1] \"Cl516e17.5_ForebrainDorsalRawData.RDS\"\n[1] 13971   297\n```\n:::\n\n```{.r .cell-code}\n df <- df[2:nrow(df),]\n\ndf$cl_time <- paste0(df$cluster,\"_\",df$time.point)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nd_bg <- df[,-5] \n\nggplot(df[df$time.point == \"E13.5\",], \n       aes(x = log10_exp, fill = cluster)) +\n  geom_histogram(data = d_bg, \n                 fill = \"grey\", alpha = .8,binwidth = 0.1/6) +\n  geom_histogram(colour = \"black\",binwidth = 0.1) +\n  facet_wrap(~ cluster) + ylim(0,2500)+\n  guides(fill = FALSE) +  # to remove the legend\n  theme_bw()  \n```\n\n::: {.cell-output-display}\n![](geneExpressionAnalysisUniformClusters_files/figure-html/plot E13.5-1.png){width=960}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df[df$time.point == \"E15.0\",], \n       aes(x = log10_exp, fill = cluster)) +\n  geom_histogram(data = d_bg, \n                 fill = \"grey\", alpha = .8,binwidth = 0.1/6) +\n  geom_histogram(colour = \"black\",binwidth = 0.1) +\n  facet_wrap(~ cluster) + ylim(0,2500)+\n  guides(fill = FALSE) +  # to remove the legend\n  theme_bw()  \n```\n\n::: {.cell-output-display}\n![](geneExpressionAnalysisUniformClusters_files/figure-html/plot E15.0-1.png){width=960}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df[df$time.point == \"E17.5\",], \n       aes(x = log10_exp, fill = cluster)) +\n  geom_histogram(data = d_bg, \n                 fill = \"grey\", alpha = .8,binwidth = 0.1/6) +\n  geom_histogram(colour = \"black\") +\n  facet_wrap(~ cluster) +ylim(0,2500)+\n  guides(fill = FALSE) +  # to remove the legend\n  theme_bw()  \n```\n\n::: {.cell-output-display}\n![](geneExpressionAnalysisUniformClusters_files/figure-html/plot E17.5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nvenn <- list(\"Cl184\" = df[df$log10_exp > -1 & df$time.point == \"E13.5\" & df$cluster == \"Cl184\",]$genes,\n             \"Cl187\" = df[df$log10_exp > -1 & df$time.point == \"E13.5\" & df$cluster == \"Cl187\",]$genes,\n             \"Cl432\" = df[df$log10_exp > -1 & df$time.point == \"E13.5\" & df$cluster == \"Cl432\",]$genes,\n             \"Cl434\" = df[df$log10_exp > -1 & df$time.point == \"E13.5\" & df$cluster == \"Cl434\",]$genes,\n             \"Cl437\" = df[df$log10_exp > -1 & df$time.point == \"E13.5\" & df$cluster == \"Cl437\",]$genes,\n             \"Cl510\" = df[df$log10_exp > -1 & df$time.point == \"E13.5\" & df$cluster == \"Cl510\",]$genes)\nlibrary(ggVennDiagram)\n\nggVennDiagram(\n  venn,\n  #fill_color = c(\"#0073C2FF\", \"#EFC000FF\", \"#868686FF\",\"#009E73\",\"#993E83\",\"#007310FF\"),\n  stroke_size = 0.5, set_name_size = 4\n  )+ scale_fill_distiller(palette = \"RdBu\")\n```\n\n::: {.cell-output-display}\n![](geneExpressionAnalysisUniformClusters_files/figure-html/unnamed-chunk-3-1.png){width=768}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/blas/libblas.so.3.9.0 \nLAPACK: /usr/lib/x86_64-linux-gnu/lapack/liblapack.so.3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats     graphics  grDevices utils     datasets  methods   base     \n\nother attached packages:\n[1] ggVennDiagram_1.5.0 Matrix_1.6-3        dplyr_1.1.2        \n[4] stringr_1.5.0       ggplot2_3.4.2      \n\nloaded via a namespace (and not attached):\n [1] vctrs_0.6.3        cli_3.6.1          knitr_1.43         rlang_1.1.1       \n [5] xfun_0.39          stringi_1.8.1      generics_0.1.3     jsonlite_1.8.7    \n [9] labeling_0.4.2     glue_1.6.2         colorspace_2.1-0   htmltools_0.5.7   \n[13] scales_1.3.0       fansi_1.0.4        rmarkdown_2.24     grid_4.3.2        \n[17] evaluate_0.21      munsell_0.5.0      tibble_3.2.1       fastmap_1.1.1     \n[21] yaml_2.3.7         lifecycle_1.0.3    compiler_4.3.2     RColorBrewer_1.1-3\n[25] htmlwidgets_1.6.2  pkgconfig_2.0.3    rstudioapi_0.15.0  farver_2.1.1      \n[29] lattice_0.22-5     digest_0.6.33      R6_2.5.1           tidyselect_1.2.0  \n[33] utf8_1.2.3         pillar_1.9.0       magrittr_2.0.3     withr_2.5.0       \n[37] tools_4.3.2        gtable_0.3.3      \n```\n:::\n:::\n",
    "supporting": [
      "geneExpressionAnalysisUniformClusters_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}