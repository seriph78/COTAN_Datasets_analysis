{
  "hash": "dab849495cf8026bc77a888a71da9890",
  "result": {
    "markdown": "---\n  title: \"Probability score computation\"\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rlang)\nlibrary(testthat)\nlibrary(ggplot2)\nlibrary(tibble)\nlibrary(zeallot)\nlibrary(Seurat)\nlibrary(aricode)\nlibrary(funtimes)\nlibrary(monocle3)\nlibrary(cluster)\nlibrary(COTAN)\n\ntunings = c('default', 'antibody', 'celltypist')\ntools = c('monocle', 'scanpy', 'seurat', 'scvi-tools', 'COTAN')\n\n\naverageClustersDistance <- function(probMatrixDF,\n                                    clustersList, numDim) {\n  \n  squareDist <- function(subMatrix) {\n    subMatrix <- scale(subMatrix, scale = FALSE, center = TRUE)\n    return(sum(rowSums(subMatrix^2)))\n}\n  \n  pca <- PCAtools::pca(mat = probMatrixDF, rank = numDim, transposed = TRUE)\n\n  residual_variance = 100 - sum(pca[[\"variance\"]])\n\n  normMatrix <- scale(x = pca[[\"rotated\"]], center = TRUE, scale = TRUE)\n  rownames(normMatrix) <- rownames(probMatrixDF)\n\n  final_dimensions = dim(normMatrix)[2]\n\n  sumDist <- 0.0\n  for (cl in clustersList) {\n    sumDist <- sumDist + squareDist(normMatrix[cl, , drop = FALSE])\n  }\n  score = sumDist / ncol(normMatrix) / (nrow(normMatrix) - length(clustersList))\n  return(list(\"residual_variance\" = residual_variance, \"final_dimensions\" = final_dimensions, \"score\" = score))\n}\n```\n:::\n\n## PBMC1\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset = 'PBMC1'\ncelltypistPath = paste('Data/', dataset, '/celltypist/Immune_All_Low_probability_matrix.csv', sep='')\noutPath = paste('Data/', dataset, '/probabilistic_score.csv', sep='')\n```\n:::\n\n\n\nLoad CellTypist clusterization\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprobMatrixDF <- read.csv(celltypistPath, header = TRUE)\nprobMatrixDF <- column_to_rownames(probMatrixDF, var = \"X\")\nrownames(probMatrixDF) <- gsub(\"[.]\", \":\", rownames(probMatrixDF))\nrownames(probMatrixDF) <- gsub(\"X10X\", \"10X\", rownames(probMatrixDF))\nrownames(probMatrixDF) <- substr(rownames(probMatrixDF), 1, nchar(rownames(probMatrixDF)) - 2)\n```\n:::\n\n\nEstimate number of dimensions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprc <- PCAtools::pca(mat = probMatrixDF, rank = 50, transposed = TRUE)\nplot(prc$sdev)\n```\n\n::: {.cell-output-display}\n![](probability_score_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnDims <- 20\n```\n:::\n\n\nCalculate the projection to spherical distribution [Malahanobis distance]:\nthe sum of square distances from center of sub-cluster in pca-projected space\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscores = data.frame()#\"tool\" = NA, \"dataset\" = dataset, \"tuning\" = NA, \"score\" = NA, \"residual_variance\" = NA, \"final_dimensions\" = NA)\nfor (tool in tools) {\n  for (tuning in tunings) {\n    labelsPath = paste('Data/', dataset, '/', tool, '/', tuning, '/clustering_labels.csv', sep='')\n    labels <- read.csv(labelsPath, header = TRUE)\n    clustersList<- split(as.character(labels$cell), labels$cluster)\n    score_data = averageClustersDistance(probMatrixDF, clustersList,numDim = nDims)\n    scores = rbind(\n      scores,\n      data.frame(\n        \"tool\" = tool,\n        \"dataset\" = dataset,\n        \"tuning\" = tuning,\n        \"score\" = score_data$score,\n        \"residual_variance\" = score_data$residual_variance,\n        \"final_dimensions\" = score_data$final_dimensions\n      )\n    )\n  }\n}\nwrite.csv(scores, outPath, row.names = FALSE)\nscores\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         tool dataset     tuning     score residual_variance final_dimensions\n1     monocle   PBMC1    default 0.9064319         0.6614691               20\n2     monocle   PBMC1   antibody 0.7098190         0.6614691               20\n3     monocle   PBMC1 celltypist 0.6698957         0.6614691               20\n4      scanpy   PBMC1    default 0.5717224         0.6614691               20\n5      scanpy   PBMC1   antibody 0.6405931         0.6614691               20\n6      scanpy   PBMC1 celltypist 0.5765256         0.6614691               20\n7      seurat   PBMC1    default 0.6290241         0.6614691               20\n8      seurat   PBMC1   antibody 0.6275275         0.6614691               20\n9      seurat   PBMC1 celltypist 0.5283759         0.6614691               20\n10 scvi-tools   PBMC1    default 0.6027325         0.6614691               20\n11 scvi-tools   PBMC1   antibody 0.6605860         0.6614691               20\n12 scvi-tools   PBMC1 celltypist 0.5735559         0.6614691               20\n13      COTAN   PBMC1    default 0.5945573         0.6614691               20\n14      COTAN   PBMC1   antibody 0.7028721         0.6614691               20\n15      COTAN   PBMC1 celltypist 0.5945573         0.6614691               20\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nshuffledCells <- rownames(probMatrixDF)\nrndDist <- function(n) {\n  clusters <- set_names(rep(1:n, ceiling(9000/n))[1:nrow(probMatrixDF)], shuffledCells)\n  cluster_list <- split(names(clusters), clusters)\n  d <- averageClustersDistance(probMatrixDF, cluster_list,nDims)\n  return(d$score)\n}\nsizes <- c(1:15, seq(20, 50, by = 5), seq(60, 100, by = 10),\n           seq(150, 1000, by = 50), seq(1500, 9000, by = 500))\nsizesToDists <- vapply(sizes,rndDist, numeric(1)) \nnames(sizesToDists) <- sizes\npdf(paste('Data/', dataset, '/probability_score_dim_dependency.pdf', sep=''))\nplot(names(sizesToDists), sizesToDists)\ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\npng \n  2 \n```\n:::\n\n```{.r .cell-code}\nplot(names(sizesToDists), sizesToDists)\n```\n\n::: {.cell-output-display}\n![](probability_score_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n## PBMC2\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset = 'PBMC2'\ncelltypistPath = paste('Data/', dataset, '/celltypist/Immune_All_Low_probability_matrix.csv', sep='')\noutPath = paste('Data/', dataset, '/probabilistic_score.csv', sep='')\n```\n:::\n\n\n\nLoad CellTypist clusterization\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprobMatrixDF <- read.csv(celltypistPath, header = TRUE)\nprobMatrixDF <- column_to_rownames(probMatrixDF, var = \"X\")\nrownames(probMatrixDF) <- gsub(\"[.]\", \":\", rownames(probMatrixDF))\nrownames(probMatrixDF) <- gsub(\"X10X\", \"10X\", rownames(probMatrixDF))\nrownames(probMatrixDF) <- substr(rownames(probMatrixDF), 1, nchar(rownames(probMatrixDF)) - 2)\n```\n:::\n\n\nEstimate number of dimensions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprc <- PCAtools::pca(mat = probMatrixDF, rank = 50, transposed = TRUE)\nplot(prc$sdev)\n```\n\n::: {.cell-output-display}\n![](probability_score_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnDims <- 20\n```\n:::\n\n\nCalculate the projection to spherical distribution [Malahanobis distance]:\nthe sum of square distances from center of sub-cluster in pca-projected space\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscores = data.frame()#\"tool\" = NA, \"dataset\" = dataset, \"tuning\" = NA, \"score\" = NA, \"residual_variance\" = NA, \"final_dimensions\" = NA)\nfor (tool in tools) {\n  for (tuning in tunings) {\n    labelsPath = paste('Data/', dataset, '/', tool, '/', tuning, '/clustering_labels.csv', sep='')\n    labels <- read.csv(labelsPath, header = TRUE)\n    clustersList<- split(as.character(labels$cell), labels$cluster)\n    score_data = averageClustersDistance(probMatrixDF, clustersList,numDim = nDims)\n    scores = rbind(\n      scores,\n      data.frame(\n        \"tool\" = tool,\n        \"dataset\" = dataset,\n        \"tuning\" = tuning,\n        \"score\" = score_data$score,\n        \"residual_variance\" = score_data$residual_variance,\n        \"final_dimensions\" = score_data$final_dimensions\n      )\n    )\n  }\n}\nwrite.csv(scores, outPath, row.names = FALSE)\nscores\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         tool dataset     tuning     score residual_variance final_dimensions\n1     monocle   PBMC2    default 0.9547651          0.632864               20\n2     monocle   PBMC2   antibody 0.7238461          0.632864               20\n3     monocle   PBMC2 celltypist 0.6804478          0.632864               20\n4      scanpy   PBMC2    default 0.5757901          0.632864               20\n5      scanpy   PBMC2   antibody 0.4720212          0.632864               20\n6      scanpy   PBMC2 celltypist 0.5721244          0.632864               20\n7      seurat   PBMC2    default 0.5494186          0.632864               20\n8      seurat   PBMC2   antibody 0.3949425          0.632864               20\n9      seurat   PBMC2 celltypist 0.4951102          0.632864               20\n10 scvi-tools   PBMC2    default 0.5851914          0.632864               20\n11 scvi-tools   PBMC2   antibody 0.4727416          0.632864               20\n12 scvi-tools   PBMC2 celltypist 0.5576107          0.632864               20\n13      COTAN   PBMC2    default 0.5599573          0.632864               20\n14      COTAN   PBMC2   antibody 0.6612736          0.632864               20\n15      COTAN   PBMC2 celltypist 0.5599573          0.632864               20\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nshuffledCells <- rownames(probMatrixDF)\nrndDist <- function(n) {\n  clusters <- set_names(rep(1:n, ceiling(9000/n))[1:nrow(probMatrixDF)], shuffledCells)\n  cluster_list <- split(names(clusters), clusters)\n  d <- averageClustersDistance(probMatrixDF, cluster_list,nDims)\n  return(d$score)\n}\nsizes <- c(1:15, seq(20, 50, by = 5), seq(60, 100, by = 10),\n           seq(150, 1000, by = 50), seq(1500, 9000, by = 500))\nsizesToDists <- vapply(sizes, rndDist, numeric(1)) \nnames(sizesToDists) <- sizes\npdf(paste('Data/', dataset, '/probability_score_dim_dependency.pdf', sep=''))\nplot(names(sizesToDists), sizesToDists)\ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\npng \n  2 \n```\n:::\n\n```{.r .cell-code}\nplot(names(sizesToDists), sizesToDists)\n```\n\n::: {.cell-output-display}\n![](probability_score_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\n## PBMC3\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset = 'PBMC3'\ncelltypistPath = paste('Data/', dataset, '/celltypist/Immune_All_Low_probability_matrix.csv', sep='')\noutPath = paste('Data/', dataset, '/probabilistic_score.csv', sep='')\n```\n:::\n\n\n\nLoad CellTypist clusterization\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprobMatrixDF <- read.csv(celltypistPath, header = TRUE)\nprobMatrixDF <- column_to_rownames(probMatrixDF, var = \"X\")\nrownames(probMatrixDF) <- gsub(\"[.]\", \":\", rownames(probMatrixDF))\nrownames(probMatrixDF) <- gsub(\"X10X\", \"10X\", rownames(probMatrixDF))\nrownames(probMatrixDF) <- substr(rownames(probMatrixDF), 1, nchar(rownames(probMatrixDF)) - 2)\n```\n:::\n\n\nEstimate number of dimensions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprc <- PCAtools::pca(mat = probMatrixDF, rank = 50, transposed = TRUE)\nplot(prc$sdev)\n```\n\n::: {.cell-output-display}\n![](probability_score_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnDims <- 20\n```\n:::\n\n\nCalculate the projection to spherical distribution [Malahanobis distance]:\nthe sum of square distances from center of sub-cluster in pca-projected space\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscores = data.frame()#\"tool\" = NA, \"dataset\" = dataset, \"tuning\" = NA, \"score\" = NA, \"residual_variance\" = NA, \"final_dimensions\" = NA)\nfor (tool in tools) {\n  for (tuning in tunings) {\n    labelsPath = paste('Data/', dataset, '/', tool, '/', tuning, '/clustering_labels.csv', sep='')\n    labels <- read.csv(labelsPath, header = TRUE)\n    clustersList<- split(as.character(labels$cell), labels$cluster)\n    score_data = averageClustersDistance(probMatrixDF, clustersList,numDim = nDims)\n    scores = rbind(\n      scores,\n      data.frame(\n        \"tool\" = tool,\n        \"dataset\" = dataset,\n        \"tuning\" = tuning,\n        \"score\" = score_data$score,\n        \"residual_variance\" = score_data$residual_variance,\n        \"final_dimensions\" = score_data$final_dimensions\n      )\n    )\n  }\n}\nwrite.csv(scores, outPath, row.names = FALSE)\nscores\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         tool dataset     tuning     score residual_variance final_dimensions\n1     monocle   PBMC3    default 0.9116157          0.666637               20\n2     monocle   PBMC3   antibody 0.7342920          0.666637               20\n3     monocle   PBMC3 celltypist 0.7235588          0.666637               20\n4      scanpy   PBMC3    default 0.5771388          0.666637               20\n5      scanpy   PBMC3   antibody 0.4865492          0.666637               20\n6      scanpy   PBMC3 celltypist 0.5750278          0.666637               20\n7      seurat   PBMC3    default 0.5237283          0.666637               20\n8      seurat   PBMC3   antibody 0.4024118          0.666637               20\n9      seurat   PBMC3 celltypist 0.5238608          0.666637               20\n10 scvi-tools   PBMC3    default 0.5606163          0.666637               20\n11 scvi-tools   PBMC3   antibody 0.4673312          0.666637               20\n12 scvi-tools   PBMC3 celltypist 0.5082920          0.666637               20\n13      COTAN   PBMC3    default 0.5034928          0.666637               20\n14      COTAN   PBMC3   antibody 0.6774677          0.666637               20\n15      COTAN   PBMC3 celltypist 0.6318363          0.666637               20\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nshuffledCells <- rownames(probMatrixDF)\nrndDist <- function(n) {\n  clusters <- set_names(rep(1:n, ceiling(9000/n))[1:nrow(probMatrixDF)], shuffledCells)\n  cluster_list <- split(names(clusters), clusters)\n  d <- averageClustersDistance(probMatrixDF, cluster_list,nDims)\n  return(d$score)\n}\nsizes <- c(1:15, seq(20, 50, by = 5), seq(60, 100, by = 10),\n           seq(150, 1000, by = 50), seq(1500, 9000, by = 500))\nsizesToDists <- vapply(sizes, rndDist, numeric(1)) \nnames(sizesToDists) <- sizes\npdf(paste('Data/', dataset, '/probability_score_dim_dependency.pdf', sep=''))\nplot(names(sizesToDists), sizesToDists)\ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\npng \n  2 \n```\n:::\n\n```{.r .cell-code}\nplot(names(sizesToDists), sizesToDists)\n```\n\n::: {.cell-output-display}\n![](probability_score_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n## PBMC4\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndataset = 'PBMC4'\ncelltypistPath = paste('Data/', dataset, '/celltypist/Immune_All_Low_probability_matrix.csv', sep='')\noutPath = paste('Data/', dataset, '/probabilistic_score.csv', sep='')\n```\n:::\n\n\n\nLoad CellTypist clusterization\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprobMatrixDF <- read.csv(celltypistPath, header = TRUE)\nprobMatrixDF <- column_to_rownames(probMatrixDF, var = \"X\")\nrownames(probMatrixDF) <- gsub(\"[.]\", \":\", rownames(probMatrixDF))\nrownames(probMatrixDF) <- gsub(\"X10X\", \"10X\", rownames(probMatrixDF))\nrownames(probMatrixDF) <- substr(rownames(probMatrixDF), 1, nchar(rownames(probMatrixDF)) - 2)\n```\n:::\n\n\nEstimate number of dimensions\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprc <- PCAtools::pca(mat = probMatrixDF, rank = 50, transposed = TRUE)\nplot(prc$sdev)\n```\n\n::: {.cell-output-display}\n![](probability_score_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nnDims <- 20\n```\n:::\n\n\nCalculate the projection to spherical distribution [Malahanobis distance]:\nthe sum of square distances from center of sub-cluster in pca-projected space\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nscores = data.frame()#\"tool\" = NA, \"dataset\" = dataset, \"tuning\" = NA, \"score\" = NA, \"residual_variance\" = NA, \"final_dimensions\" = NA)\nfor (tool in tools) {\n  for (tuning in tunings) {\n    labelsPath = paste('Data/', dataset, '/', tool, '/', tuning, '/clustering_labels.csv', sep='')\n    labels <- read.csv(labelsPath, header = TRUE)\n    clustersList<- split(as.character(labels$cell), labels$cluster)\n    score_data = averageClustersDistance(probMatrixDF, clustersList,numDim = nDims)\n    scores = rbind(\n      scores,\n      data.frame(\n        \"tool\" = tool,\n        \"dataset\" = dataset,\n        \"tuning\" = tuning,\n        \"score\" = score_data$score,\n        \"residual_variance\" = score_data$residual_variance,\n        \"final_dimensions\" = score_data$final_dimensions\n      )\n    )\n  }\n}\nwrite.csv(scores, outPath, row.names = FALSE)\nscores\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n         tool dataset     tuning     score residual_variance final_dimensions\n1     monocle   PBMC4    default 0.9079955         0.7881445               20\n2     monocle   PBMC4   antibody 0.6896226         0.7881445               20\n3     monocle   PBMC4 celltypist 0.6513185         0.7881445               20\n4      scanpy   PBMC4    default 0.5667508         0.7881445               20\n5      scanpy   PBMC4   antibody 0.5639221         0.7881445               20\n6      scanpy   PBMC4 celltypist 0.5916285         0.7881445               20\n7      seurat   PBMC4    default 0.5272270         0.7881445               20\n8      seurat   PBMC4   antibody 0.4877846         0.7881445               20\n9      seurat   PBMC4 celltypist 0.5265706         0.7881445               20\n10 scvi-tools   PBMC4    default 0.6212800         0.7881445               20\n11 scvi-tools   PBMC4   antibody 0.5174726         0.7881445               20\n12 scvi-tools   PBMC4 celltypist 0.5219027         0.7881445               20\n13      COTAN   PBMC4    default 0.5755159         0.7881445               20\n14      COTAN   PBMC4   antibody 0.6613133         0.7881445               20\n15      COTAN   PBMC4 celltypist 0.5825237         0.7881445               20\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nset.seed(42)\nshuffledCells <- rownames(probMatrixDF)\nrndDist <- function(n) {\n  clusters <- set_names(rep(1:n, ceiling(9000/n))[1:nrow(probMatrixDF)], shuffledCells)\n  cluster_list <- split(names(clusters), clusters)\n  d <- averageClustersDistance(probMatrixDF, cluster_list,nDims)\n  return(d$score)\n}\nsizes <- c(1:15, seq(20, 50, by = 5), seq(60, 100, by = 10),\n           seq(150, 1000, by = 50), seq(1500, 9000, by = 500))\nsizesToDists <- vapply(sizes, rndDist, numeric(1)) \nnames(sizesToDists) <- sizes\npdf(paste('Data/', dataset, '/probability_score_dim_dependency.pdf', sep=''))\nplot(names(sizesToDists), sizesToDists)\ndev.off()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\npng \n  2 \n```\n:::\n\n```{.r .cell-code}\nplot(names(sizesToDists), sizesToDists)\n```\n\n::: {.cell-output-display}\n![](probability_score_files/figure-html/unnamed-chunk-25-1.png){width=672}\n:::\n:::\n\n\n\n------------------------------------------------------------------------\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSys.time()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2024-05-10 17:40:27 CEST\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsessionInfo()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR version 4.3.2 (2023-10-31)\nPlatform: x86_64-pc-linux-gnu (64-bit)\nRunning under: Ubuntu 20.04.6 LTS\n\nMatrix products: default\nBLAS:   /usr/lib/x86_64-linux-gnu/openblas-pthread/libblas.so.3 \nLAPACK: /usr/lib/x86_64-linux-gnu/openblas-pthread/liblapack.so.3;  LAPACK version 3.9.0\n\nlocale:\n [1] LC_CTYPE=C.UTF-8       LC_NUMERIC=C           LC_TIME=C.UTF-8       \n [4] LC_COLLATE=C.UTF-8     LC_MONETARY=C.UTF-8    LC_MESSAGES=C.UTF-8   \n [7] LC_PAPER=C.UTF-8       LC_NAME=C              LC_ADDRESS=C          \n[10] LC_TELEPHONE=C         LC_MEASUREMENT=C.UTF-8 LC_IDENTIFICATION=C   \n\ntime zone: Europe/Rome\ntzcode source: system (glibc)\n\nattached base packages:\n[1] stats4    stats     graphics  grDevices utils     datasets  methods  \n[8] base     \n\nother attached packages:\n [1] COTAN_2.5.0                 cluster_2.1.6              \n [3] monocle3_1.3.4              SingleCellExperiment_1.22.0\n [5] SummarizedExperiment_1.30.2 GenomicRanges_1.52.0       \n [7] GenomeInfoDb_1.36.1         IRanges_2.34.1             \n [9] S4Vectors_0.38.1            MatrixGenerics_1.12.3      \n[11] matrixStats_1.2.0           Biobase_2.60.0             \n[13] BiocGenerics_0.46.0         funtimes_9.1               \n[15] aricode_1.0.3               Seurat_5.0.0               \n[17] SeuratObject_5.0.0          sp_2.1-1                   \n[19] zeallot_0.1.0               tibble_3.2.1               \n[21] ggplot2_3.5.0               testthat_3.2.0             \n[23] rlang_1.1.1                \n\nloaded via a namespace (and not attached):\n  [1] spatstat.sparse_3.0-2     bitops_1.0-7             \n  [3] httr_1.4.6                RColorBrewer_1.1-3       \n  [5] doParallel_1.0.17         tools_4.3.2              \n  [7] sctransform_0.4.1         backports_1.4.1          \n  [9] utf8_1.2.3                R6_2.5.1                 \n [11] lazyeval_0.2.2            uwot_0.1.16              \n [13] GetoptLong_1.0.5          withr_3.0.0              \n [15] gridExtra_2.3             parallelDist_0.2.6       \n [17] fdrtool_1.2.17            progressr_0.14.0         \n [19] qgraph_1.9.8              cli_3.6.1                \n [21] spatstat.explore_3.2-1    fastDummies_1.7.3        \n [23] mvtnorm_1.2-2             spatstat.data_3.0-1      \n [25] askpass_1.2.0             ggridges_0.5.4           \n [27] pbapply_1.7-2             pbivnorm_0.6.0           \n [29] foreign_0.8-86            dbscan_1.1-11            \n [31] parallelly_1.37.1         rstudioapi_0.15.0        \n [33] generics_0.1.3            shape_1.4.6              \n [35] gtools_3.9.4              ica_1.0-3                \n [37] spatstat.random_3.2-1     dendextend_1.17.1        \n [39] graphicalVAR_0.3.3        dplyr_1.1.2              \n [41] Matrix_1.6-3              fansi_1.0.4              \n [43] abind_1.4-5               PCAtools_2.14.0          \n [45] terra_1.7-39              lifecycle_1.0.3          \n [47] yaml_2.3.7                clusterGeneration_1.3.8  \n [49] Rtsne_0.17                grid_4.3.2               \n [51] lavaan_0.6-16             mlVAR_0.5.1              \n [53] dqrng_0.3.0               promises_1.2.0.1         \n [55] crayon_1.5.2              miniUI_0.1.1.1           \n [57] lattice_0.22-5            beachmat_2.16.0          \n [59] cowplot_1.1.1             pillar_1.9.0             \n [61] knitr_1.43                ComplexHeatmap_2.16.0    \n [63] rjson_0.2.21              boot_1.3-28              \n [65] corpcor_1.6.10            future.apply_1.11.0      \n [67] codetools_0.2-19          leiden_0.4.3             \n [69] glue_1.7.0                data.table_1.15.0        \n [71] vctrs_0.6.3               png_0.1-8                \n [73] spam_2.10-0               Rdpack_2.6               \n [75] gtable_0.3.3              assertthat_0.2.1         \n [77] gsubfn_0.7                xfun_0.39                \n [79] rbibutils_2.2.15          S4Arrays_1.2.0           \n [81] mime_0.12                 Rfast_2.1.0              \n [83] coda_0.19-4               survival_3.5-8           \n [85] Kendall_2.2.1             iterators_1.0.14         \n [87] MplusAutomation_1.1.0     ellipsis_0.3.2           \n [89] fitdistrplus_1.1-11       ROCR_1.0-11              \n [91] nlme_3.1-163              RcppAnnoy_0.0.21         \n [93] irlba_2.3.5.1             KernSmooth_2.23-22       \n [95] rpart_4.1.23              colorspace_2.1-0         \n [97] Hmisc_5.1-0               nnet_7.3-19              \n [99] mnormt_2.1.1              tidyselect_1.2.0         \n[101] compiler_4.3.2            glmnet_4.1-8             \n[103] htmlTable_2.4.1           DelayedArray_0.26.7      \n[105] plotly_4.10.2             checkmate_2.3.0          \n[107] scales_1.3.0              psych_2.4.3              \n[109] lmtest_0.9-40             quadprog_1.5-8           \n[111] stringr_1.5.0             digest_0.6.33            \n[113] goftest_1.2-3             spatstat.utils_3.0-3     \n[115] minqa_1.2.5               rmarkdown_2.24           \n[117] XVector_0.40.0            htmltools_0.5.8          \n[119] pkgconfig_2.0.3           jpeg_0.1-10              \n[121] base64enc_0.1-3           umap_0.2.10.0            \n[123] lme4_1.1-34               sparseMatrixStats_1.12.2 \n[125] fastmap_1.1.1             ggthemes_5.1.0           \n[127] GlobalOptions_0.1.2       htmlwidgets_1.6.2        \n[129] DelayedMatrixStats_1.22.5 shiny_1.8.0              \n[131] zoo_1.8-12                jsonlite_1.8.7           \n[133] BiocParallel_1.34.2       BiocSingular_1.16.0      \n[135] RCurl_1.98-1.12           magrittr_2.0.3           \n[137] Formula_1.2-5             GenomeInfoDbData_1.2.10  \n[139] dotCall64_1.1-0           patchwork_1.2.0          \n[141] texreg_1.39.3             munsell_0.5.0            \n[143] Rcpp_1.0.11               viridis_0.6.4            \n[145] proto_1.0.0               reticulate_1.36.1        \n[147] RcppZiggurat_0.1.6        stringi_1.8.1            \n[149] brio_1.1.3                zlibbioc_1.46.0          \n[151] MASS_7.3-60               plyr_1.8.8               \n[153] parallel_4.3.2            listenv_0.9.0            \n[155] ggrepel_0.9.5             deldir_2.0-2             \n[157] splines_4.3.2             pander_0.6.5             \n[159] tensor_1.5                circlize_0.4.15          \n[161] igraph_2.0.3              spatstat.geom_3.2-4      \n[163] RcppHNSW_0.6.0            reshape2_1.4.4           \n[165] ScaledMatrix_1.8.1        evaluate_0.21            \n[167] RcppParallel_5.1.7        nloptr_2.0.3             \n[169] foreach_1.5.2             httpuv_1.6.11            \n[171] openssl_2.1.0             RANN_2.6.1               \n[173] tidyr_1.3.0               purrr_1.0.1              \n[175] polyclip_1.10-4           clue_0.3-64              \n[177] future_1.33.0             scattermore_1.2          \n[179] rsvd_1.0.5                xtable_1.8-4             \n[181] RSpectra_0.16-1           later_1.3.1              \n[183] glasso_1.11               viridisLite_0.4.2        \n[185] arm_1.13-1                globals_0.16.2           \n```\n:::\n:::",
    "supporting": [
      "probability_score_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}