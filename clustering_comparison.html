<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>COTAN Datasets analysis - Clustering Comparision</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>
<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>


<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./NonCT_clusters.html">Cluster evaluation</a></li><li class="breadcrumb-item"><a href="./clustering_comparison.html">PBMCs clustering comparison</a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">COTAN Datasets analysis</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Home</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Datasets</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false">
 <span class="menu-text">Mouse Cortex Loo 2019</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Mouse_Cortex_E14.5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneCoexAnalysisDataset1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Coexpression analaysis</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Mouse Cortex Yuzwa 2017</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CorticalCells_GSM2861511_E135-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E13.5 Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneCoexAnalysisE13.5Yuzwa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation analysis for E13.5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./CorticalCells_GSM2861514_E175-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E17.5 Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneCoexAnalysisE17.5Yuzwa.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation analysis for E17.5</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Mouse Brain LaManno 2021</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ForebrainDorsal_E135-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E13.5 Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneCoexAnalysisE13.5MouseBrain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation analysis for E13.5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ForebrainDorsal_E150-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E15.0 Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneCoexAnalysisE15.0MouseBrain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation analysis for E15.0</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ForebrainDorsal_E175-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">E17.5 Cleaning and cell clustering</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneCoexAnalysisE17.5MouseBrain.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Correlation analysis for E17.5</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ForebrainLaManno2021ClustersGDI.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Original Clusters GDI evaluation</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">CD14+</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cd14_analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CD14+ Cleaning and cell clustering</span></a>
  </div>
</li>
      </ul>
  </li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">PBMC form 10X site</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PBMC1_filtering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning PBMC1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PBMC2_filtering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning PBMC2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PBMC3_filtering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning PBMC3</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./PBMC4_filtering.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cleaning PBMC4</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false">
 <span class="menu-text">Coex score evaluation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalCoexAssess.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">General Coex Evaluation</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false">
 <span class="menu-text">GDI sensitivity</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-8" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-8" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./OriginalClustersDistanceEvaluation.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Clusters Distance Evaluation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FindUniformOrigCluster.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cluster Unifomity and GDI score</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./GDI_Increment_From_Mixing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">GDI Increment From Mixing</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true">
 <span class="menu-text">Cluster evaluation</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-9" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-9" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./NonCT_clusters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Not UT cluster with LR</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./Real_UT_clustersByCotan.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Real UT clusters with LR</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./clustering_comparison.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">PBMCs clustering comparison</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./cd14_clusterizations_comparisons.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CD14+ clusterizations</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false">
 <span class="menu-text">DEA evaluation</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-10" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-10" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./DEA_Type1Error.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Type I error</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./geneExpressionAnalysisUniformClusters.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Explorative analysis of gene expression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FDR_analisys.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">FDR analysis - define DE genes</span></a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false">
 <span class="menu-text">FDR and TPR - ROC curves</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-11" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-11" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FDR_analisysResults3_10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Results - thresholds true 3% 10%</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FDR_analisysResults5_20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Results - thresholds true 5% 20%</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FDR_analisysResults5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Results - thresholds true 5%</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./FDR_analysisResultsLFC.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Results - Log Fold Change</span></a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false">
 <span class="menu-text">Additional code and scripts</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-12" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-12" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./src/scanpyTypeIError.py" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ScamPy Type I Error code</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./src/scanpyFDR.py" class="sidebar-item-text sidebar-link">
 <span class="menu-text">ScamPy FDR code</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#preamble" id="toc-preamble" class="nav-link active" data-scroll-target="#preamble">Preamble</a></li>
  <li><a href="#default-parameters" id="toc-default-parameters" class="nav-link" data-scroll-target="#default-parameters">Default parameters</a></li>
  <li><a href="#matching-celltypist-clusters-number" id="toc-matching-celltypist-clusters-number" class="nav-link" data-scroll-target="#matching-celltypist-clusters-number">Matching cellTypist clusters number</a></li>
  <li><a href="#matching-antibody-clusters-number" id="toc-matching-antibody-clusters-number" class="nav-link" data-scroll-target="#matching-antibody-clusters-number">Matching antibody clusters number</a></li>
  <li><a href="#check-celltypist-vs-antibody" id="toc-check-celltypist-vs-antibody" class="nav-link" data-scroll-target="#check-celltypist-vs-antibody">Check cellTypist vs Antibody</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Clustering Comparision</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="preamble" class="level2">
<h2 class="anchored" data-anchor-id="preamble">Preamble</h2>
<div class="cell" data-execution_count="166">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scanpy <span class="im">as</span> sc</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics.cluster <span class="im">import</span> normalized_mutual_info_score, adjusted_rand_score</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.metrics <span class="im">import</span> homogeneity_score, completeness_score, fowlkes_mallows_score, silhouette_score, davies_bouldin_score</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> src.utils <span class="im">import</span> sankey_plot</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> kaleido</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> sklearn.preprocessing <span class="im">import</span> StandardScaler</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> plotly.io <span class="im">as</span> pio</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="167">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>DIR <span class="op">=</span> <span class="st">'Data/'</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>DATASET_NAMES <span class="op">=</span> [<span class="st">'PBMC1'</span>, <span class="st">'PBMC2'</span>, <span class="st">'PBMC3'</span>,<span class="st">'PBMC4'</span>]</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>TOOLS <span class="op">=</span> [<span class="st">'monocle'</span>, <span class="st">'scanpy'</span>, <span class="st">'scvi-tools'</span>, <span class="st">'seurat'</span>, <span class="st">'COTAN'</span>]</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>PARAMS_TUNING <span class="op">=</span> [<span class="st">'default'</span>, <span class="st">'celltypist'</span>, <span class="st">'antibody'</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="168">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_scores(<span class="bu">dir</span>, dataset, labels_df, labels_matched, ground_truth_labels):</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> {}</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    scores[<span class="st">'NMI'</span>] <span class="op">=</span> {}</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    scores[<span class="st">'ARI'</span>] <span class="op">=</span> {}</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    scores[<span class="st">'homogeneity'</span>] <span class="op">=</span> {}</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    scores[<span class="st">'completeness'</span>] <span class="op">=</span> {}</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    scores[<span class="st">'fowlkes_mallows'</span>] <span class="op">=</span> {}</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> tool <span class="kw">in</span> TOOLS:</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>        scores[<span class="st">'NMI'</span>][tool] <span class="op">=</span> normalized_mutual_info_score(labels_pred<span class="op">=</span>labels_df[<span class="st">'cluster_'</span><span class="op">+</span>tool], labels_true<span class="op">=</span>labels_df[<span class="ss">f'cluster_</span><span class="sc">{</span>ground_truth_labels<span class="sc">}</span><span class="ss">'</span>], average_method<span class="op">=</span><span class="st">'arithmetic'</span>)</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>        scores[<span class="st">'ARI'</span>][tool] <span class="op">=</span> adjusted_rand_score(labels_pred<span class="op">=</span>labels_df[<span class="st">'cluster_'</span><span class="op">+</span>tool], labels_true<span class="op">=</span>labels_df[<span class="ss">f'cluster_</span><span class="sc">{</span>ground_truth_labels<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>        scores[<span class="st">'homogeneity'</span>][tool] <span class="op">=</span> homogeneity_score(labels_pred<span class="op">=</span>labels_df[<span class="st">'cluster_'</span><span class="op">+</span>tool], labels_true<span class="op">=</span>labels_df[<span class="ss">f'cluster_</span><span class="sc">{</span>ground_truth_labels<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>        scores[<span class="st">'completeness'</span>][tool] <span class="op">=</span> completeness_score(labels_pred<span class="op">=</span>labels_df[<span class="st">'cluster_'</span><span class="op">+</span>tool], labels_true<span class="op">=</span>labels_df[<span class="ss">f'cluster_</span><span class="sc">{</span>ground_truth_labels<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>        scores[<span class="st">'fowlkes_mallows'</span>][tool] <span class="op">=</span> fowlkes_mallows_score(labels_pred<span class="op">=</span>labels_df[<span class="st">'cluster_'</span><span class="op">+</span>tool], labels_true<span class="op">=</span>labels_df[<span class="ss">f'cluster_</span><span class="sc">{</span>ground_truth_labels<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    scores_df <span class="op">=</span> pd.DataFrame(scores)</span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    scores_df.to_csv(<span class="ss">f'</span><span class="sc">{</span><span class="bu">dir</span><span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/scores_</span><span class="sc">{</span>labels_matched<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>ground_truth_labels<span class="sc">}</span><span class="ss">.csv'</span>)</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>    scores_df.to_latex(<span class="ss">f'</span><span class="sc">{</span><span class="bu">dir</span><span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/scores_</span><span class="sc">{</span>labels_matched<span class="sc">}</span><span class="ss">_</span><span class="sc">{</span>ground_truth_labels<span class="sc">}</span><span class="ss">.tex'</span>)</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>    display(scores_df)</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_scores(dataset,tuning):</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># concat tools labels</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>    labels_df <span class="op">=</span> pd.read_csv(<span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/COTAN/</span><span class="sc">{</span>tuning<span class="sc">}</span><span class="ss">/clustering_labels.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>    labels_df.rename(columns<span class="op">=</span>{<span class="st">"cluster"</span>: <span class="st">"cluster_COTAN"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> tool <span class="kw">in</span> [t <span class="cf">for</span> t <span class="kw">in</span> TOOLS <span class="cf">if</span> t <span class="op">!=</span> <span class="st">'COTAN'</span>]:</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>        tool_labels_df <span class="op">=</span> pd.read_csv(<span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>tool<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>tuning<span class="sc">}</span><span class="ss">/clustering_labels.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>        labels_df <span class="op">=</span> labels_df.merge(tool_labels_df, how<span class="op">=</span><span class="st">'inner'</span>, on<span class="op">=</span><span class="st">'cell'</span>)</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>        labels_df.rename(columns<span class="op">=</span>{<span class="st">"cluster"</span>: <span class="ss">f"cluster_</span><span class="sc">{</span>tool<span class="sc">}</span><span class="ss">"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="co"># load and concat celltypist labels</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>    celltypist_df <span class="op">=</span> pd.read_csv(<span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/celltypist/celltypist_labels.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>    celltypist_df.index <span class="op">=</span> celltypist_df.index.<span class="bu">str</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>    celltypist_df <span class="op">=</span> labels_df.merge(celltypist_df, how<span class="op">=</span><span class="st">'inner'</span>, on<span class="op">=</span><span class="st">'cell'</span>)</span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>    celltypist_df.rename(columns<span class="op">=</span>{<span class="st">"cluster.ids"</span>: <span class="ss">f"cluster_celltypist"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>    celltypist_mapping_df <span class="op">=</span> pd.read_csv(<span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/celltypist/celltypist_mapping.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>    <span class="co"># load and concat protein surface labels</span></span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>    antibody_df <span class="op">=</span> pd.read_csv(<span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/antibody_annotation/antibody_labels.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>    antibody_df <span class="op">=</span> labels_df.merge(antibody_df, how<span class="op">=</span><span class="st">'inner'</span>, on<span class="op">=</span><span class="st">'cell'</span>)</span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>    antibody_df.rename(columns<span class="op">=</span>{<span class="st">"cluster.ids"</span>: <span class="ss">f"cluster_antibody"</span>}, inplace<span class="op">=</span><span class="va">True</span>)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>    antibody_mapping_df <span class="op">=</span> pd.read_csv(<span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/antibody_annotation/antibody_mapping.csv'</span>, index_col<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>    <span class="co"># read dataset</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>    adata <span class="op">=</span> sc.read_10x_mtx(</span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>        <span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/filtered/10X/'</span>,</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>        var_names<span class="op">=</span><span class="st">'gene_symbols'</span>,</span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>        cache<span class="op">=</span><span class="va">False</span></span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb3-50"><a href="#cb3-50" aria-hidden="true" tabindex="-1"></a>    <span class="co"># keep only labelled cells</span></span>
<span id="cb3-51"><a href="#cb3-51" aria-hidden="true" tabindex="-1"></a>    adata.var_names_make_unique()</span>
<span id="cb3-52"><a href="#cb3-52" aria-hidden="true" tabindex="-1"></a>    subset_cells <span class="op">=</span> adata.obs_names.isin(labels_df.index)</span>
<span id="cb3-53"><a href="#cb3-53" aria-hidden="true" tabindex="-1"></a>    adata <span class="op">=</span> adata[subset_cells, :]</span>
<span id="cb3-54"><a href="#cb3-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-55"><a href="#cb3-55" aria-hidden="true" tabindex="-1"></a>    mito_genes <span class="op">=</span> adata.var_names.<span class="bu">str</span>.startswith(<span class="st">'MT-'</span>)</span>
<span id="cb3-56"><a href="#cb3-56" aria-hidden="true" tabindex="-1"></a>    <span class="co"># for each cell compute fraction of counts in mito genes vs. all genes</span></span>
<span id="cb3-57"><a href="#cb3-57" aria-hidden="true" tabindex="-1"></a>    <span class="co"># the `.A1` is only necessary as X is sparse (to transform to a dense array after summing)</span></span>
<span id="cb3-58"><a href="#cb3-58" aria-hidden="true" tabindex="-1"></a>    adata.obs[<span class="st">'percent_mito'</span>] <span class="op">=</span> np.<span class="bu">sum</span>(adata[:, mito_genes].X, axis<span class="op">=</span><span class="dv">1</span>).A1 <span class="op">/</span> np.<span class="bu">sum</span>(adata.X, axis<span class="op">=</span><span class="dv">1</span>).A1</span>
<span id="cb3-59"><a href="#cb3-59" aria-hidden="true" tabindex="-1"></a>    <span class="co"># add the total counts per cell as observations-annotation to adata</span></span>
<span id="cb3-60"><a href="#cb3-60" aria-hidden="true" tabindex="-1"></a>    adata.obs[<span class="st">'n_counts'</span>] <span class="op">=</span> adata.X.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>).A1</span>
<span id="cb3-61"><a href="#cb3-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-62"><a href="#cb3-62" aria-hidden="true" tabindex="-1"></a>    sc.pp.normalize_total(adata, target_sum<span class="op">=</span><span class="fl">1e4</span>)</span>
<span id="cb3-63"><a href="#cb3-63" aria-hidden="true" tabindex="-1"></a>    sc.pp.log1p(adata)</span>
<span id="cb3-64"><a href="#cb3-64" aria-hidden="true" tabindex="-1"></a>    sc.pp.highly_variable_genes(adata, min_mean<span class="op">=</span><span class="fl">0.0125</span>, max_mean<span class="op">=</span><span class="dv">3</span>, min_disp<span class="op">=</span><span class="fl">0.5</span>)</span>
<span id="cb3-65"><a href="#cb3-65" aria-hidden="true" tabindex="-1"></a>    adata.raw <span class="op">=</span> adata</span>
<span id="cb3-66"><a href="#cb3-66" aria-hidden="true" tabindex="-1"></a>    adata <span class="op">=</span> adata[:, adata.var.highly_variable]</span>
<span id="cb3-67"><a href="#cb3-67" aria-hidden="true" tabindex="-1"></a>    sc.pp.regress_out(adata, [<span class="st">'n_counts'</span>, <span class="st">'percent_mito'</span>])</span>
<span id="cb3-68"><a href="#cb3-68" aria-hidden="true" tabindex="-1"></a>    sc.pp.scale(adata, max_value<span class="op">=</span><span class="dv">10</span>)</span>
<span id="cb3-69"><a href="#cb3-69" aria-hidden="true" tabindex="-1"></a>    sc.tl.pca(adata, svd_solver<span class="op">=</span><span class="st">'arpack'</span>,n_comps<span class="op">=</span><span class="dv">20</span>)</span>
<span id="cb3-70"><a href="#cb3-70" aria-hidden="true" tabindex="-1"></a>    pca_matrix <span class="op">=</span> adata.obsm[<span class="st">'X_pca'</span>]</span>
<span id="cb3-71"><a href="#cb3-71" aria-hidden="true" tabindex="-1"></a>    scaler <span class="op">=</span> StandardScaler()</span>
<span id="cb3-72"><a href="#cb3-72" aria-hidden="true" tabindex="-1"></a>    scaled_pca_matrix <span class="op">=</span> scaler.fit_transform(pca_matrix)</span>
<span id="cb3-73"><a href="#cb3-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-74"><a href="#cb3-74" aria-hidden="true" tabindex="-1"></a>    <span class="co">#Custers number</span></span>
<span id="cb3-75"><a href="#cb3-75" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-76"><a href="#cb3-76" aria-hidden="true" tabindex="-1"></a>    df <span class="op">=</span> {}</span>
<span id="cb3-77"><a href="#cb3-77" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> tool <span class="kw">in</span> TOOLS:</span>
<span id="cb3-78"><a href="#cb3-78" aria-hidden="true" tabindex="-1"></a>        df[tool] <span class="op">=</span> labels_df[<span class="ss">f'cluster_</span><span class="sc">{</span>tool<span class="sc">}</span><span class="ss">'</span>].unique().shape[<span class="dv">0</span>]</span>
<span id="cb3-79"><a href="#cb3-79" aria-hidden="true" tabindex="-1"></a>    df_size <span class="op">=</span> pd.DataFrame(df, index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb3-80"><a href="#cb3-80" aria-hidden="true" tabindex="-1"></a>    display(<span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss"> - number of clusters'</span>)</span>
<span id="cb3-81"><a href="#cb3-81" aria-hidden="true" tabindex="-1"></a>    display(df_size)</span>
<span id="cb3-82"><a href="#cb3-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-83"><a href="#cb3-83" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute silhouette score</span></span>
<span id="cb3-84"><a href="#cb3-84" aria-hidden="true" tabindex="-1"></a>    silhouette <span class="op">=</span> {}</span>
<span id="cb3-85"><a href="#cb3-85" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> tool <span class="kw">in</span> TOOLS:</span>
<span id="cb3-86"><a href="#cb3-86" aria-hidden="true" tabindex="-1"></a>        silhouette[tool] <span class="op">=</span> silhouette_score(scaled_pca_matrix, labels_df[<span class="ss">f'cluster_</span><span class="sc">{</span>tool<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb3-87"><a href="#cb3-87" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> tuning<span class="op">==</span><span class="st">'celltypist'</span>:</span>
<span id="cb3-88"><a href="#cb3-88" aria-hidden="true" tabindex="-1"></a>        silhouette[<span class="st">'celltypist'</span>] <span class="op">=</span> silhouette_score(scaled_pca_matrix, celltypist_df[<span class="ss">f'cluster_celltypist'</span>])</span>
<span id="cb3-89"><a href="#cb3-89" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> tuning<span class="op">==</span><span class="st">'antibody'</span>:</span>
<span id="cb3-90"><a href="#cb3-90" aria-hidden="true" tabindex="-1"></a>        silhouette[<span class="st">'antibody'</span>] <span class="op">=</span> silhouette_score(scaled_pca_matrix, antibody_df[<span class="ss">f'cluster_antibody'</span>])</span>
<span id="cb3-91"><a href="#cb3-91" aria-hidden="true" tabindex="-1"></a>    silhouette_df <span class="op">=</span> pd.DataFrame(silhouette, index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb3-92"><a href="#cb3-92" aria-hidden="true" tabindex="-1"></a>    silhouette_df.to_csv(<span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>tuning<span class="sc">}</span><span class="ss">_silhouette.csv'</span>)</span>
<span id="cb3-93"><a href="#cb3-93" aria-hidden="true" tabindex="-1"></a>    silhouette_df.to_latex(<span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>tuning<span class="sc">}</span><span class="ss">_silhouette.tex'</span>)</span>
<span id="cb3-94"><a href="#cb3-94" aria-hidden="true" tabindex="-1"></a>    display(<span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss"> - Silhuette (higher is better)'</span>)</span>
<span id="cb3-95"><a href="#cb3-95" aria-hidden="true" tabindex="-1"></a>    display(silhouette_df)</span>
<span id="cb3-96"><a href="#cb3-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-97"><a href="#cb3-97" aria-hidden="true" tabindex="-1"></a>    <span class="co">#From https://evafast.github.io/blog/2019/06/28/example_content/</span></span>
<span id="cb3-98"><a href="#cb3-98" aria-hidden="true" tabindex="-1"></a>    davies_bouldin <span class="op">=</span> {}</span>
<span id="cb3-99"><a href="#cb3-99" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> tool <span class="kw">in</span> TOOLS:</span>
<span id="cb3-100"><a href="#cb3-100" aria-hidden="true" tabindex="-1"></a>        davies_bouldin[tool] <span class="op">=</span> davies_bouldin_score(adata.obsm[<span class="st">'X_pca'</span>], labels_df[<span class="ss">f'cluster_</span><span class="sc">{</span>tool<span class="sc">}</span><span class="ss">'</span>])</span>
<span id="cb3-101"><a href="#cb3-101" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> tuning<span class="op">==</span><span class="st">'celltypist'</span>:</span>
<span id="cb3-102"><a href="#cb3-102" aria-hidden="true" tabindex="-1"></a>        davies_bouldin[<span class="st">'celltypist'</span>] <span class="op">=</span> davies_bouldin_score(adata.obsm[<span class="st">'X_pca'</span>], celltypist_df[<span class="ss">f'cluster_celltypist'</span>])</span>
<span id="cb3-103"><a href="#cb3-103" aria-hidden="true" tabindex="-1"></a>    <span class="cf">elif</span> tuning<span class="op">==</span><span class="st">'antibody'</span>:</span>
<span id="cb3-104"><a href="#cb3-104" aria-hidden="true" tabindex="-1"></a>        davies_bouldin[<span class="st">'antibody'</span>] <span class="op">=</span> davies_bouldin_score(adata.obsm[<span class="st">'X_pca'</span>], antibody_df[<span class="ss">f'cluster_antibody'</span>])</span>
<span id="cb3-105"><a href="#cb3-105" aria-hidden="true" tabindex="-1"></a>    davies_bouldin_df <span class="op">=</span> pd.DataFrame(davies_bouldin, index<span class="op">=</span>[<span class="dv">0</span>])</span>
<span id="cb3-106"><a href="#cb3-106" aria-hidden="true" tabindex="-1"></a>    davies_bouldin_df.to_csv(<span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>tuning<span class="sc">}</span><span class="ss">_davies_bouldin.csv'</span>)</span>
<span id="cb3-107"><a href="#cb3-107" aria-hidden="true" tabindex="-1"></a>    davies_bouldin_df.to_latex(<span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>tuning<span class="sc">}</span><span class="ss">_davies_bouldin.tex'</span>)</span>
<span id="cb3-108"><a href="#cb3-108" aria-hidden="true" tabindex="-1"></a>    display(<span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss"> - davies_bouldin (lower is better)'</span>)</span>
<span id="cb3-109"><a href="#cb3-109" aria-hidden="true" tabindex="-1"></a>    display(davies_bouldin_df)</span>
<span id="cb3-110"><a href="#cb3-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-111"><a href="#cb3-111" aria-hidden="true" tabindex="-1"></a>    display(<span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss"> - matching </span><span class="sc">{</span>tuning<span class="sc">}</span><span class="ss"> labels'</span> <span class="cf">if</span> tuning <span class="op">!=</span> <span class="st">'default'</span> <span class="cf">else</span> <span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss"> - default labels'</span>)</span>
<span id="cb3-112"><a href="#cb3-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-113"><a href="#cb3-113" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute scores comparing each tool labels with celltypist labels</span></span>
<span id="cb3-114"><a href="#cb3-114" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> tuning <span class="op">==</span> <span class="st">'celltypist'</span> <span class="kw">or</span> tuning <span class="op">==</span> <span class="st">'default'</span>:</span>
<span id="cb3-115"><a href="#cb3-115" aria-hidden="true" tabindex="-1"></a>        compute_scores(DIR, dataset, celltypist_df, tuning, <span class="st">'celltypist'</span>)</span>
<span id="cb3-116"><a href="#cb3-116" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">=</span> []</span>
<span id="cb3-117"><a href="#cb3-117" aria-hidden="true" tabindex="-1"></a>        labels_titles <span class="op">=</span> []</span>
<span id="cb3-118"><a href="#cb3-118" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> tool <span class="kw">in</span> TOOLS:</span>
<span id="cb3-119"><a href="#cb3-119" aria-hidden="true" tabindex="-1"></a>            labels.append(celltypist_df[<span class="ss">f'cluster_</span><span class="sc">{</span>tool<span class="sc">}</span><span class="ss">'</span>].to_list())</span>
<span id="cb3-120"><a href="#cb3-120" aria-hidden="true" tabindex="-1"></a>            labels_titles.append(tool)</span>
<span id="cb3-121"><a href="#cb3-121" aria-hidden="true" tabindex="-1"></a>        labels.append(celltypist_df[<span class="ss">f'cluster_celltypist'</span>].<span class="bu">map</span>(celltypist_mapping_df[<span class="st">'go'</span>].to_dict()).to_list())</span>
<span id="cb3-122"><a href="#cb3-122" aria-hidden="true" tabindex="-1"></a>        labels_titles.append(<span class="st">'celltypist'</span>)</span>
<span id="cb3-123"><a href="#cb3-123" aria-hidden="true" tabindex="-1"></a>        title <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss"> - matching </span><span class="sc">{</span>tuning<span class="sc">}</span><span class="ss"> labels'</span> <span class="cf">if</span> tuning <span class="op">!=</span> <span class="st">'default'</span> <span class="cf">else</span> <span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss"> - default labels'</span></span>
<span id="cb3-124"><a href="#cb3-124" aria-hidden="true" tabindex="-1"></a>        sankey_plot(labels<span class="op">=</span>labels, labels_titles<span class="op">=</span>labels_titles, title<span class="op">=</span>title, path<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>tuning<span class="sc">}</span><span class="ss">_celltypist.html'</span>)</span>
<span id="cb3-125"><a href="#cb3-125" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-126"><a href="#cb3-126" aria-hidden="true" tabindex="-1"></a>    <span class="co"># compute scores comparing each tool labels with protein labels</span></span>
<span id="cb3-127"><a href="#cb3-127" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> tuning <span class="op">==</span> <span class="st">'antibody'</span> <span class="kw">or</span> tuning <span class="op">==</span> <span class="st">'default'</span>:</span>
<span id="cb3-128"><a href="#cb3-128" aria-hidden="true" tabindex="-1"></a>        compute_scores(DIR, dataset, antibody_df, tuning, <span class="st">'antibody'</span>)</span>
<span id="cb3-129"><a href="#cb3-129" aria-hidden="true" tabindex="-1"></a>        labels <span class="op">=</span> []</span>
<span id="cb3-130"><a href="#cb3-130" aria-hidden="true" tabindex="-1"></a>        labels_titles <span class="op">=</span> []</span>
<span id="cb3-131"><a href="#cb3-131" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> tool <span class="kw">in</span> TOOLS:</span>
<span id="cb3-132"><a href="#cb3-132" aria-hidden="true" tabindex="-1"></a>            labels.append(antibody_df[<span class="ss">f'cluster_</span><span class="sc">{</span>tool<span class="sc">}</span><span class="ss">'</span>].to_list())</span>
<span id="cb3-133"><a href="#cb3-133" aria-hidden="true" tabindex="-1"></a>            labels_titles.append(tool)</span>
<span id="cb3-134"><a href="#cb3-134" aria-hidden="true" tabindex="-1"></a>        labels.append(antibody_df[<span class="ss">f'cluster_antibody'</span>].<span class="bu">map</span>(antibody_mapping_df[<span class="st">'go'</span>].to_dict()).to_list())</span>
<span id="cb3-135"><a href="#cb3-135" aria-hidden="true" tabindex="-1"></a>        labels_titles.append(<span class="st">'antibody'</span>)</span>
<span id="cb3-136"><a href="#cb3-136" aria-hidden="true" tabindex="-1"></a>        title <span class="op">=</span> <span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss"> - matching </span><span class="sc">{</span>tuning<span class="sc">}</span><span class="ss"> labels'</span> <span class="cf">if</span> tuning <span class="op">!=</span> <span class="st">'default'</span> <span class="cf">else</span> <span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss"> - default labels'</span></span>
<span id="cb3-137"><a href="#cb3-137" aria-hidden="true" tabindex="-1"></a>        sankey_plot(labels<span class="op">=</span>labels, labels_titles<span class="op">=</span>labels_titles, title<span class="op">=</span>title, path<span class="op">=</span><span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/</span><span class="sc">{</span>tuning<span class="sc">}</span><span class="ss">_antibody.html'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="default-parameters" class="level2">
<h2 class="anchored" data-anchor-id="default-parameters">Default parameters</h2>
<div class="cell" data-execution_count="169">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>print_scores(tuning <span class="op">=</span> <span class="st">'default'</span>,dataset<span class="op">=</span><span class="st">"PBMC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - number of clusters'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3</td>
<td>18</td>
<td>13</td>
<td>11</td>
<td>14</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - Silhuette (higher is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.100032</td>
<td>0.043761</td>
<td>0.065534</td>
<td>0.148254</td>
<td>0.13383</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - davies_bouldin (lower is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.893661</td>
<td>2.47358</td>
<td>2.574291</td>
<td>1.392309</td>
<td>1.728304</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - default labels'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.578257</td>
<td>0.384609</td>
<td>0.410140</td>
<td>0.979930</td>
<td>0.602512</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.721042</td>
<td>0.404607</td>
<td>0.824980</td>
<td>0.640363</td>
<td>0.508176</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.776232</td>
<td>0.599664</td>
<td>0.809790</td>
<td>0.745344</td>
<td>0.666244</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.793630</td>
<td>0.649593</td>
<td>0.784165</td>
<td>0.803327</td>
<td>0.705921</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.787289</td>
<td>0.670392</td>
<td>0.803876</td>
<td>0.771373</td>
<td>0.723485</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="aed6daed-8a50-4900-bc15-dd56686d71ec" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("aed6daed-8a50-4900-bc15-dd56686d71ec")) {                    Plotly.newPlot(                        "aed6daed-8a50-4900-bc15-dd56686d71ec",                        [{"link":{"source":[0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,6,6,6,7,7,7,7,7,8,8,9,9,10,10,10,10,11,11,12,12,12,12,13,13,13,13,14,14,14,15,15,15,16,16,16,16,17,17,18,18,18,19,19,20,21,21,22,22,23,23,23,24,24,25,25,25,25,26,26,26,26,26,27,27,27,28,28,29,29,30,30,30,31,31,32,32,32,33,33,34,34,34,34,35,35,35,35,35,35,36,36,36,37,37,37,38,38,38,39,39,39,39,40,40,41,42,42,42,42,43,43,44,45,46,46,46,47,47,47,48,48,48,49,49,50,51,52,52,53,53,53,53,53,53,54,54,54,54,54,55,55,55,55,56,56,56,57,57,57,57,57,58,58,58,58,58,58],"target":[3,4,6,7,8,10,12,14,16,18,3,4,5,7,9,11,15,17,19,20,12,13,15,22,23,24,26,32,22,23,24,26,32,21,25,30,31,22,24,32,21,22,25,27,30,26,27,21,25,22,23,24,26,21,25,23,26,27,32,21,26,28,29,22,23,26,25,27,29,23,24,26,32,25,31,22,26,32,25,30,33,36,37,34,35,34,35,39,34,35,36,37,42,43,34,35,38,39,40,38,39,41,40,41,40,41,36,37,43,37,42,34,35,39,43,44,49,53,57,58,49,53,54,56,57,58,45,48,49,47,48,49,53,54,55,53,54,55,58,51,52,52,46,47,48,57,46,47,50,60,61,66,73,60,61,66,60,61,66,60,63,73,64,64,65,59,63,68,69,71,72,59,62,68,71,72,59,60,62,71,67,70,72,66,67,68,69,72,62,67,68,69,70,72],"value":[400,329,286,9,268,254,182,149,106,77,2,2,323,259,268,200,2,91,76,28,1,159,139,27,327,38,8,2,164,5,155,3,4,57,222,27,17,165,119,2,229,1,33,1,4,3,265,175,93,137,2,109,6,198,2,10,154,18,1,1,1,149,8,1,128,20,2,1,138,11,1,93,1,16,75,4,3,70,5,71,28,560,100,446,53,2,473,8,352,70,52,277,39,5,12,30,3,245,1,277,7,1,147,2,5,141,4,29,69,2,90,77,2,1,1,27,1,44,840,4,1,4,14,39,19,551,35,300,281,32,373,3,56,2,222,1,256,1,3,152,1,144,1,126,1,1,74,1,27,35,73,1,1,11,2,146,648,3,23,284,2,27,152,3,142,55,4,34,7,2,3,4,25,1,67,175,220,1,1,1,37,1,1,1,2,45,807,5,56,8,1,129,308,56]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728"],"label":[1,2,3,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,1,2,3,4,5,6,7,8,9,10,11,1,2,3,4,5,6,7,8,9,10,11,12,13,14,"CD16+ NK cells","Classical monocytes","DC2","MAIT cells","Megakaryocyte precursor","Memory B cells","Naive B cells","Non-classical monocytes","Regulatory T cells","Tcm\u002fNaive cytotoxic T cells","Tcm\u002fNaive helper T cells","Tem\u002fEffector helper T cells","Tem\u002fTemra cytotoxic T cells","Tem\u002fTrm cytotoxic T cells","pDC"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"celltypist","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC1 - default labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('aed6daed-8a50-4900-bc15-dd56686d71ec');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.611988</td>
<td>0.425929</td>
<td>0.446299</td>
<td>0.973344</td>
<td>0.635502</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.659645</td>
<td>0.391203</td>
<td>0.795577</td>
<td>0.563386</td>
<td>0.507730</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.708581</td>
<td>0.551051</td>
<td>0.776228</td>
<td>0.651780</td>
<td>0.632750</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.738344</td>
<td>0.643097</td>
<td>0.764146</td>
<td>0.714228</td>
<td>0.706018</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.732140</td>
<td>0.651092</td>
<td>0.784252</td>
<td>0.686521</td>
<td>0.713737</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="cd171040-3e94-4c00-8cc0-c4d247158b53" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("cd171040-3e94-4c00-8cc0-c4d247158b53")) {                    Plotly.newPlot(                        "cd171040-3e94-4c00-8cc0-c4d247158b53",                        [{"link":{"source":[0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,2,2,2,3,3,3,3,3,4,4,4,4,4,5,5,5,5,6,6,6,7,7,7,7,7,8,8,9,9,10,10,10,10,11,11,12,12,12,12,13,13,13,13,14,14,14,15,15,15,16,16,16,16,17,17,18,18,18,19,19,20,21,21,22,22,23,23,23,24,24,25,25,25,25,26,26,26,26,26,27,27,27,28,28,29,29,30,30,30,31,31,32,32,32,33,33,34,34,34,34,35,35,35,35,35,35,36,36,36,37,37,37,38,38,38,39,39,39,39,40,40,41,42,42,42,42,43,43,44,45,45,45,46,46,46,47,47,47,48,48,48,49,49,50,50,50,51,51,51,52,52,53,53,53,53,53,53,53,54,54,54,54,54,54,55,55,55,55,55,56,56,57,57,57,57,58,58,58,58],"target":[3,4,6,7,8,10,12,14,16,18,3,4,5,7,9,11,15,17,19,20,12,13,15,22,23,24,26,32,22,23,24,26,32,21,25,30,31,22,24,32,21,22,25,27,30,26,27,21,25,22,23,24,26,21,25,23,26,27,32,21,26,28,29,22,23,26,25,27,29,23,24,26,32,25,31,22,26,32,25,30,33,36,37,34,35,34,35,39,34,35,36,37,42,43,34,35,38,39,40,38,39,41,40,41,40,41,36,37,43,37,42,34,35,39,43,44,49,53,57,58,49,53,54,56,57,58,45,48,49,47,48,49,53,54,55,53,54,55,58,51,52,52,46,47,48,57,46,47,50,62,64,65,62,63,64,62,63,64,62,63,64,62,63,62,63,67,59,64,67,59,64,60,61,63,65,66,67,68,60,61,65,66,67,68,59,62,65,66,68,60,61,60,61,62,67,60,61,62,67],"value":[400,328,286,9,268,254,182,149,106,77,2,2,322,259,267,198,2,91,75,28,1,159,138,27,327,38,8,2,164,5,154,3,4,57,221,27,17,165,119,2,229,1,33,1,4,3,265,175,92,137,2,109,6,196,2,10,154,18,1,1,1,149,8,1,128,20,2,1,137,11,1,93,1,16,75,4,3,70,5,70,28,558,100,446,53,2,473,8,351,70,51,276,39,5,12,30,3,245,1,277,7,1,147,2,5,140,4,29,68,2,90,77,2,1,1,27,1,44,839,4,1,4,14,39,19,551,35,298,280,32,372,3,56,2,222,1,256,1,3,152,1,143,1,126,1,1,73,1,27,33,1,1,17,56,1,118,1,40,668,1,2,284,1,1,25,1,150,1,1,143,1,36,1,3,48,4,9,4,54,174,1,1,4,38,2,1,213,5,2,1,38,59,33,2,765,11,512,1,34]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22"],"label":[1,2,3,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,1,2,3,4,5,6,7,8,9,10,11,1,2,3,4,5,6,7,8,9,10,11,12,13,14,"B Cells","CD8+ T Cells","Central Memory T Cells","Classical Monocytes","Dendritic Cells","Intermediate Monocytes","NK Cells","NKT Cells","Naive T Cells","Terminal Effector T Cells"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"antibody","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC1 - default labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('cd171040-3e94-4c00-8cc0-c4d247158b53');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="170">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>print_scores(tuning <span class="op">=</span> <span class="st">'default'</span>,dataset<span class="op">=</span><span class="st">"PBMC2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - number of clusters'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2</td>
<td>18</td>
<td>20</td>
<td>14</td>
<td>17</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - Silhuette (higher is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.224441</td>
<td>0.059225</td>
<td>0.000832</td>
<td>0.111509</td>
<td>0.12581</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - davies_bouldin (lower is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.866736</td>
<td>2.073818</td>
<td>3.935702</td>
<td>1.630557</td>
<td>1.855098</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - default labels'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.393166</td>
<td>0.207180</td>
<td>0.245998</td>
<td>0.978626</td>
<td>0.521364</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.718820</td>
<td>0.457213</td>
<td>0.804000</td>
<td>0.649960</td>
<td>0.556684</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.699788</td>
<td>0.424696</td>
<td>0.785920</td>
<td>0.630670</td>
<td>0.525031</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.775988</td>
<td>0.562430</td>
<td>0.819560</td>
<td>0.736815</td>
<td>0.640108</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.729355</td>
<td>0.472800</td>
<td>0.745550</td>
<td>0.713848</td>
<td>0.562480</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="28f32292-8d23-4c5d-ac4f-c6ed382bf948" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("28f32292-8d23-4c5d-ac4f-c6ed382bf948")) {                    Plotly.newPlot(                        "28f32292-8d23-4c5d-ac4f-c6ed382bf948",                        [{"link":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,7,8,8,8,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,14,14,15,15,15,15,15,16,16,17,17,17,18,19,19,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,24,24,24,24,25,25,25,26,26,26,26,26,26,27,27,27,27,27,27,27,28,28,28,28,28,29,29,29,29,29,30,30,31,31,31,32,32,32,32,32,32,33,33,33,34,34,34,35,35,36,36,36,36,37,37,38,38,39,39,40,40,41,41,41,41,42,42,42,42,42,43,43,44,44,44,44,44,44,44,44,44,44,45,45,46,46,46,46,46,47,47,47,48,48,49,49,50,50,51,51,51,51,51,51,51,51,52,53,54,54,54,55,55,55,55,56,56,57,57,57,57,57,57,57,58,58,58,58,58,58,59,59,59,59,59,59,59,60,60,60,60,60,61,62,63,64,64,64,65,65,65,66,66,67,68,68,68,69,69,69,69,69,70,70,70,70,70,70],"target":[2,3,4,5,7,8,9,10,11,12,13,15,3,5,6,8,10,14,16,17,18,19,20,21,24,26,27,29,32,33,34,36,39,20,21,26,27,28,29,33,34,36,39,21,24,26,27,29,32,34,36,20,21,26,27,28,29,32,33,34,36,23,30,22,25,26,29,22,26,27,28,31,32,37,20,21,24,26,27,28,29,32,33,34,36,39,22,26,32,37,20,21,26,27,28,29,33,21,23,24,26,27,28,31,32,34,23,30,22,26,28,31,32,23,30,23,35,38,38,25,29,40,41,42,48,51,40,41,42,45,46,42,43,46,48,51,44,46,49,51,52,40,41,45,46,47,48,50,41,42,45,46,48,51,40,41,42,44,45,46,48,41,42,45,46,48,40,41,42,45,51,44,49,41,46,48,40,42,45,46,48,51,40,41,42,40,41,42,44,52,40,41,42,46,43,51,52,53,40,42,56,57,57,58,59,60,56,57,58,59,64,54,55,54,56,57,61,63,64,65,66,69,70,56,59,56,57,58,59,60,55,69,70,57,60,61,62,68,70,54,55,57,59,64,66,69,70,63,67,71,72,73,71,72,81,83,82,83,76,77,81,82,83,84,85,71,81,82,83,84,85,71,76,77,81,82,83,85,76,78,83,84,85,80,80,74,73,77,85,73,74,80,73,77,86,71,78,79,71,73,75,78,79,71,73,75,78,79,83],"value":[944,624,579,507,463,2,318,300,285,207,205,184,1,1,483,440,5,189,88,88,48,14,9,483,4,1,171,115,7,45,45,44,20,313,79,8,66,54,36,33,16,17,3,8,552,11,2,1,3,1,1,415,7,11,23,32,4,1,3,7,5,480,3,463,440,1,1,1,34,5,46,152,79,1,13,157,1,3,48,2,35,6,17,9,11,3,218,3,2,62,40,2,10,12,136,1,6,3,1,23,151,3,9,2,12,1,16,173,2,159,1,5,17,86,2,7,78,3,48,1,13,8,475,304,1,2,614,13,104,6,2,1,628,1,1,53,583,1,1,1,4,14,1,538,27,292,1,148,30,17,6,333,5,1,197,30,91,1,1,3,7,213,24,1,5,37,137,5,49,1,14,7,171,3,5,151,3,2,3,42,69,8,53,14,37,55,9,15,3,75,56,9,12,1,10,53,3,48,22,4,1153,6,787,4,3,8,25,513,114,7,1,635,3,1,1,1,6,4,88,315,174,3,1,553,3,22,10,1,385,2,1,96,195,3,269,148,24,147,1,5,106,1,2,1,3,13,1,82,48,639,1,1,56,51,1,2,568,1186,39,1,6,9,847,416,3,2,72,1,31,9,4,3,7,1,1,96,72,220,270,1,3,2,3,154,24,86,88,1,1,300,7,8,174,3,48,1,1,145,5,3,13,22,69,1,1,1,180,14,1]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2"],"label":[1,2,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,"CD16+ NK cells","CD16- NK cells","Classical monocytes","DC2","HSC\u002fMPP","MAIT cells","Megakaryocytes\u002fplatelets","Memory B cells","Naive B cells","Non-classical monocytes","Regulatory T cells","Tcm\u002fNaive cytotoxic T cells","Tcm\u002fNaive helper T cells","Tem\u002fEffector helper T cells","Tem\u002fTrm cytotoxic T cells","pDC"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"celltypist","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC2 - default labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('28f32292-8d23-4c5d-ac4f-c6ed382bf948');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.277314</td>
<td>0.107135</td>
<td>0.165534</td>
<td>0.853977</td>
<td>0.450594</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.682604</td>
<td>0.524109</td>
<td>0.759388</td>
<td>0.619922</td>
<td>0.602311</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.652891</td>
<td>0.485961</td>
<td>0.734303</td>
<td>0.587729</td>
<td>0.567847</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.743681</td>
<td>0.679941</td>
<td>0.777650</td>
<td>0.712555</td>
<td>0.730603</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.701021</td>
<td>0.636547</td>
<td>0.691258</td>
<td>0.711064</td>
<td>0.702879</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="d8b1a025-d567-42e2-9cd7-62296e75dce8" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("d8b1a025-d567-42e2-9cd7-62296e75dce8")) {                    Plotly.newPlot(                        "d8b1a025-d567-42e2-9cd7-62296e75dce8",                        [{"link":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,6,6,7,8,8,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,14,14,15,15,15,15,15,16,16,17,17,17,18,19,20,20,20,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,24,24,24,24,25,25,25,26,26,26,26,26,26,27,27,27,27,27,27,27,28,28,28,28,28,29,29,29,29,29,30,30,31,31,31,32,32,32,32,32,32,33,33,33,34,34,34,35,35,36,36,36,36,37,37,38,38,39,39,40,40,41,41,41,41,42,42,42,42,42,43,43,44,44,44,44,44,44,44,44,44,45,45,46,46,46,46,46,47,47,47,48,48,49,49,50,50,51,51,51,51,51,51,52,53,54,54,54,55,55,55,55,56,56,56,56,56,56,56,56,57,57,57,57,57,57,57,58,58,58,58,58,58,59,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,61,61,61,61,62,62,62,63,63,63,63,63,64,64,64,64,64,64,64,64,65,65,65,66,66,66,66,67,67,67,67,67,67,67,68,68,68,68,69,69,69,69,69,69,70,70,70],"target":[2,3,4,5,7,8,9,10,11,12,13,15,3,5,6,8,10,14,16,17,18,19,20,21,24,26,27,29,32,33,34,36,39,20,21,26,27,28,29,33,34,36,39,21,24,26,27,29,32,34,36,20,21,26,27,28,29,32,33,34,36,23,30,22,25,26,22,26,27,28,31,32,37,20,21,24,26,27,28,29,32,33,34,36,39,22,26,32,37,20,21,26,27,28,29,33,21,24,26,27,28,31,32,34,23,30,22,26,28,31,32,23,30,23,35,38,38,29,40,41,42,48,51,40,41,42,45,46,42,43,46,48,51,44,51,52,40,41,45,46,47,48,50,41,42,45,46,48,51,40,41,42,44,45,46,48,41,42,45,46,48,40,41,42,45,51,44,49,41,46,48,40,42,45,46,48,51,40,41,42,40,41,42,44,52,40,41,42,46,43,51,52,53,40,42,56,57,57,58,59,60,56,57,58,59,64,54,55,56,57,61,63,64,65,66,69,70,56,59,56,57,58,59,60,55,69,70,57,60,61,62,68,70,54,55,57,59,66,69,63,67,71,80,81,71,80,81,82,71,73,74,75,76,77,81,82,71,73,74,75,76,77,81,71,73,74,75,76,77,71,73,74,75,76,77,81,82,71,72,73,74,75,76,77,82,71,78,79,81,79,80,81,71,74,75,77,78,71,72,74,76,77,78,79,81,71,78,79,71,77,78,79,71,72,74,75,77,80,82,72,74,80,82,71,72,74,77,80,82,72,74,82],"value":[943,621,578,504,462,2,315,300,284,207,203,184,1,1,117,273,2,174,53,87,46,13,9,482,4,1,171,115,7,45,45,44,20,312,79,8,64,54,36,33,16,17,3,8,551,11,2,1,3,1,1,413,7,11,23,32,4,1,3,6,5,114,3,462,274,1,1,33,5,46,151,78,1,13,157,1,3,48,2,35,3,17,9,11,3,217,3,2,62,40,2,10,12,136,1,6,3,23,150,3,9,2,12,1,9,165,2,159,1,5,17,51,2,6,78,3,46,13,8,473,303,1,2,613,13,104,6,2,1,627,1,1,52,175,1,4,14,1,537,27,167,1,106,30,17,5,332,5,1,197,30,89,1,1,3,7,213,24,1,5,37,137,5,49,1,13,6,164,3,5,150,3,2,3,42,68,5,53,14,37,55,9,14,3,75,56,9,12,1,10,53,3,46,22,4,1152,6,785,4,3,8,25,510,113,7,1,634,3,1,1,3,4,32,82,58,3,1,551,3,22,10,1,383,2,1,33,133,3,267,141,23,105,1,5,105,1,2,1,13,82,46,1,630,8,9,50,49,1,4,19,1082,32,11,76,1,526,7,6,27,16,23,1235,2,1,1,4,1,1,110,1,65,1,15,261,16,1,38,1,1,105,1,4,120,44,1,2,4,137,1,4,2,17,70,2,5,4,5,19,5,1,1,3,1,2,1,3,76,3,24,1,33,1,37,1,1,2,3,1,1,102,1,1,1,13,29,3,1,2,1,133,1,1]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c"],"label":[1,2,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,"?","B Cells","CD3+ Cells","CD4+ Cells","CD4+\u002fCD8+ Cells","CD8+ Cells","Central Memory T Cells","Classical Monocytes","Intermediate Monocytes","NK Cells","Non Classical Monocytes","Terminal Effector T Cells"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"antibody","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC2 - default labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('d8b1a025-d567-42e2-9cd7-62296e75dce8');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="171">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>print_scores(tuning <span class="op">=</span> <span class="st">'default'</span>,dataset<span class="op">=</span><span class="st">"PBMC3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - number of clusters'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3</td>
<td>22</td>
<td>17</td>
<td>18</td>
<td>28</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - Silhuette (higher is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.171584</td>
<td>0.007616</td>
<td>0.055559</td>
<td>0.111834</td>
<td>0.091091</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - davies_bouldin (lower is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.999779</td>
<td>2.376915</td>
<td>2.058343</td>
<td>1.698551</td>
<td>2.301621</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - default labels'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.500696</td>
<td>0.233560</td>
<td>0.338609</td>
<td>0.960446</td>
<td>0.500077</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.685919</td>
<td>0.462762</td>
<td>0.763719</td>
<td>0.622505</td>
<td>0.541286</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.738418</td>
<td>0.579677</td>
<td>0.757237</td>
<td>0.720511</td>
<td>0.635237</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.770512</td>
<td>0.585110</td>
<td>0.821173</td>
<td>0.725738</td>
<td>0.644073</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.701377</td>
<td>0.510672</td>
<td>0.798585</td>
<td>0.625266</td>
<td>0.582490</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="5c05cb84-73ba-43af-8bc8-15bb5f6cdc8d" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("5c05cb84-73ba-43af-8bc8-15bb5f6cdc8d")) {                    Plotly.newPlot(                        "5c05cb84-73ba-43af-8bc8-15bb5f6cdc8d",                        [{"link":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,3,3,3,4,4,4,4,5,5,5,5,5,5,5,5,5,6,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,12,13,14,14,14,14,14,14,14,14,14,15,15,15,15,16,16,17,17,17,17,17,17,17,18,18,18,18,19,19,19,19,19,19,19,20,20,21,21,21,22,22,22,23,23,23,23,23,24,25,25,25,25,25,26,26,26,26,26,27,27,27,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,29,29,29,29,29,29,29,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,33,33,33,33,33,34,34,34,34,34,35,35,35,35,35,36,36,36,36,36,36,37,37,37,38,38,38,39,39,40,40,41,42,42,42,42,42,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,45,45,45,45,45,45,46,46,46,46,46,46,46,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,51,51,51,52,52,52,52,52,52,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,55,55,55,55,55,56,56,57,57,57,57,57,57,57,57,57,57,58,59,59,59,59,60,60,60,60,61,62,62,63,63,63,64,64,64,65,65,65,65,65,66,66,66,66,67,67,68,68,69,69,69,70,70,71,71,72,72,72,73,73,74,74,74,74,74,75,75,75,76,76,76,76,76,76,76,76,77,77,77,77,77,78,78,78,78,78,79,79,79,79,79,79,79,80,80,80,80,80,80,80,81,81,81,81,81,81,81,81,81,82,82,83,83,84,84,84,84,84,84,84,84,84,84,85,85,85,85,86,86,86,86,86,86,87],"target":[3,4,5,8,9,10,11,12,14,15,17,18,19,23,24,4,7,13,16,18,19,20,21,22,24,6,11,19,22,25,26,30,33,35,36,28,31,38,40,25,26,27,29,30,31,32,33,35,29,27,34,37,26,28,30,31,32,33,35,36,25,28,30,31,32,36,38,25,26,31,32,33,35,36,25,26,28,29,30,31,32,33,35,36,38,25,26,27,28,30,31,32,33,34,35,36,27,25,26,29,30,31,32,33,35,36,28,31,32,38,27,34,25,26,30,31,32,35,36,27,34,37,41,27,28,29,30,31,33,38,27,37,27,29,39,27,29,34,25,26,30,31,33,40,42,43,46,48,50,42,43,46,47,48,42,44,46,49,50,52,53,54,55,56,57,58,43,45,46,47,48,50,54,43,48,49,51,53,57,58,42,43,46,47,48,59,42,43,45,46,47,48,50,54,57,42,43,45,46,48,50,42,43,46,49,57,44,48,52,53,55,42,43,46,47,48,42,43,46,47,48,50,44,53,56,45,48,54,56,58,45,59,59,74,75,76,79,80,74,76,77,78,79,80,81,84,60,62,63,64,65,66,67,82,76,79,82,83,84,85,74,76,78,79,80,81,84,74,75,76,81,84,74,75,76,77,78,79,80,81,84,86,68,69,70,71,72,73,86,76,77,81,85,68,69,72,61,62,63,64,65,66,63,64,65,66,70,71,82,84,69,78,79,81,83,84,85,62,64,65,66,67,60,66,65,68,69,70,71,72,74,80,81,86,87,76,81,84,86,89,90,91,106,99,89,99,88,89,99,88,89,99,88,89,91,96,99,88,89,91,99,88,89,96,98,88,96,98,88,96,89,96,88,96,98,96,98,101,102,103,104,105,102,103,105,88,94,95,96,102,103,104,105,94,102,103,104,105,88,101,103,104,105,88,97,101,102,103,104,105,88,94,96,101,102,103,104,94,95,96,97,101,102,103,104,105,88,89,88,97,88,93,94,96,97,101,102,103,104,105,88,94,97,105,92,93,95,100,103,105,106],"value":[1439,967,953,835,758,721,488,461,392,322,310,5,1,29,4,1,914,392,313,264,12,161,57,37,16,938,1,152,1,35,1147,30,131,89,7,959,4,4,1,793,8,1,1,1,6,3,83,57,938,895,11,8,10,1,811,8,1,1,2,1,13,5,1,302,282,149,6,479,111,12,6,60,47,6,278,2,2,3,1,98,49,8,16,29,3,103,248,2,1,9,8,3,43,1,42,1,392,125,101,2,57,44,13,24,18,8,227,9,1,85,12,301,9,6,45,205,12,6,27,255,1,2,11,2,1,140,12,1,8,1,9,152,1,1,55,36,1,1,2,21,1,1,4,20,42,1132,621,22,20,1401,24,211,5,13,2,1095,1,1,1,14,247,1,232,8,2,1,1,1036,1,1,3,2,152,1,2,592,338,1,151,1,22,2,1,888,43,12,1,31,4,11,12,631,4,3,1,1,47,1,5,11,305,171,94,89,7,1,5,1,305,3,1,121,91,57,1,7,8,16,3,1,64,136,8,2,152,6,1,92,5,50,1,20,11,1756,3,2,2,6,1,3,13,15,162,487,755,3,1,63,12,54,239,251,484,4,1,1,12,3,3,1028,181,2,278,67,455,8,9,92,811,2,2,1,9,7,395,7,12,7,14,241,72,34,13,1,64,123,246,146,7,1,463,2,2,336,1,1,217,59,39,2,1,1,136,2,64,32,1,1,16,1,1,1,1,1,87,152,5,1,222,8,1,1,161,4,1,5,132,5,2,6,1,1,1,1,52,3,1,1,38,3,8,146,5,217,10,113,2,145,40,1,274,5,4,289,1,1,18,1,264,9,15,1,484,5,349,26,107,2,3,67,1,125,3,220,30,131,15,61,103,1871,3,2,805,15,1,1,2,3,2,5,98,3,295,465,1,6,9,2,1,144,130,27,4,1,1,4,4,197,26,7,1,2,1,12,7,455,485,10,1,1,1,1,155,219,555,68,30,2,4,86,138,1,2,2,17,11,20,28,5,18,1025,3,6,1,11,11,16,8,2,32,52]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2"],"label":[1,2,3,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,"CD16+ NK cells","Classical monocytes","DC1","DC2","Epithelial cells","HSC\u002fMPP","MAIT cells","Megakaryocytes\u002fplatelets","Memory B cells","NK cells","Naive B cells","Non-classical monocytes","Plasma cells","Regulatory T cells","Tcm\u002fNaive cytotoxic T cells","Tcm\u002fNaive helper T cells","Tem\u002fEffector helper T cells","Tem\u002fTrm cytotoxic T cells","pDC"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"celltypist","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC3 - default labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('5c05cb84-73ba-43af-8bc8-15bb5f6cdc8d');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.429744</td>
<td>0.168276</td>
<td>0.280823</td>
<td>0.914939</td>
<td>0.437511</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.664567</td>
<td>0.542630</td>
<td>0.702416</td>
<td>0.630588</td>
<td>0.596647</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.691391</td>
<td>0.620339</td>
<td>0.677930</td>
<td>0.705398</td>
<td>0.662580</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.735217</td>
<td>0.664188</td>
<td>0.744324</td>
<td>0.726330</td>
<td>0.701375</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.660422</td>
<td>0.532024</td>
<td>0.710462</td>
<td>0.616968</td>
<td>0.583615</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="cf4e3915-fd14-49fb-b686-b7b1b5cc7be6" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("cf4e3915-fd14-49fb-b686-b7b1b5cc7be6")) {                    Plotly.newPlot(                        "cf4e3915-fd14-49fb-b686-b7b1b5cc7be6",                        [{"link":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,2,2,2,3,3,3,3,3,3,4,4,4,4,5,5,5,5,5,5,5,5,5,6,7,7,7,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,12,12,13,14,14,14,14,14,14,14,14,14,15,15,15,15,16,16,17,17,17,17,17,17,17,18,18,18,18,19,19,19,19,19,19,19,20,20,21,21,21,22,22,22,23,23,23,23,23,24,25,25,25,25,25,26,26,26,26,26,27,27,27,27,27,27,27,27,27,28,28,28,28,28,28,28,29,29,29,29,29,29,29,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,33,33,33,33,33,34,34,34,34,35,35,35,35,35,36,36,36,36,36,36,37,37,37,38,38,38,39,39,40,40,41,42,42,42,42,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,45,45,45,45,45,45,46,46,46,46,46,46,46,47,47,47,47,47,48,48,48,48,48,48,48,48,48,48,49,49,49,49,49,49,49,50,50,50,50,51,51,51,52,52,52,52,52,52,53,53,53,53,53,53,53,54,54,54,54,54,54,54,55,55,55,55,56,56,57,57,57,57,57,57,57,57,57,58,59,59,59,60,60,60,60,60,60,61,61,61,61,61,61,61,62,62,62,62,63,63,63,63,63,63,63,63,63,64,64,64,65,65,65,65,65,65,65,66,66,66,66,66,67,67,67,68,69,69,69,69,69,69,70,70,71,72,72,72,73,74,74,74,74,74,74,74,74,75,75,75,75,75,75,76,76,76,76,76,76,76,76,77,77,77,77,77,77,77,77,77,78,78,78,78,78,78,78,78,79,79,79,79,79,79,79,79,79,79,79,80,80,80,80,80,80,80,80,81,81,81,81,81,81,81,81,81,82,82,82,82,83,83,83,83,83,83,84,84,84,84,84,84,84,84,84,84,85,85,85,85,85,85,85,86,86,86,86,86,86,86,86,86,86,87,87,87,87,87,87],"target":[3,4,5,8,9,10,11,12,14,15,17,18,19,23,24,4,7,13,16,18,19,20,21,22,24,6,11,19,25,26,30,33,35,36,28,31,38,40,25,26,27,29,30,31,32,33,35,29,27,34,37,26,28,30,31,32,33,35,36,25,28,30,31,32,36,38,25,26,31,32,33,35,36,25,26,28,29,30,31,32,33,35,36,38,25,26,28,30,31,32,33,34,35,36,27,25,26,29,30,31,32,33,35,36,28,31,32,38,27,34,25,26,30,31,32,35,36,27,34,37,41,27,28,29,30,31,33,38,27,37,27,29,39,27,29,34,25,26,30,31,33,40,42,43,46,48,50,42,43,46,47,48,44,50,52,53,54,55,56,57,58,43,45,46,47,48,50,54,43,48,49,51,53,57,58,42,43,46,47,48,59,42,43,45,46,47,48,50,54,57,42,43,45,46,48,50,42,43,46,49,57,44,48,52,53,42,43,46,47,48,42,43,46,47,48,50,44,53,56,45,48,54,56,58,45,59,59,74,75,76,80,74,76,77,78,79,80,81,84,60,62,63,64,65,66,67,82,76,79,82,83,84,85,74,76,78,79,80,81,84,74,75,76,81,84,74,75,76,77,78,79,80,81,84,86,68,69,70,71,72,73,86,76,77,81,85,68,69,72,61,62,63,64,65,66,63,64,65,66,70,82,84,69,78,79,81,83,84,85,64,65,66,67,60,66,65,68,69,70,71,72,80,81,86,87,76,84,86,88,89,93,97,99,100,88,89,90,92,96,99,101,89,99,100,101,88,90,92,94,96,97,99,100,101,88,99,101,88,89,90,93,95,99,101,88,89,94,99,101,88,99,101,89,89,91,92,94,96,100,89,91,89,89,90,97,89,88,92,93,94,95,97,98,100,88,93,94,95,96,100,88,92,93,94,95,96,97,100,88,89,92,93,94,95,96,97,100,88,92,93,94,95,97,98,100,88,90,91,92,93,94,95,97,98,99,100,88,92,93,95,97,98,99,100,88,89,91,92,93,94,95,97,100,89,90,99,101,88,89,90,91,92,95,88,90,92,93,94,95,96,97,100,101,88,90,91,92,96,100,101,88,89,90,91,93,94,95,97,99,100,88,89,92,99,100,101],"value":[1421,950,943,830,749,712,481,452,372,320,307,5,1,29,2,1,759,276,296,207,12,159,56,30,15,874,1,138,35,1133,30,130,86,7,942,4,4,1,785,8,1,1,1,6,3,81,57,874,741,10,8,10,1,806,8,1,1,2,1,13,5,1,296,280,148,6,472,110,12,6,60,46,6,274,2,2,3,1,95,49,8,16,29,3,102,248,1,9,8,3,40,1,39,1,276,116,97,1,55,41,13,23,18,8,225,9,1,85,12,284,9,6,44,203,12,6,27,207,1,2,2,1,1,127,12,1,8,1,9,150,1,1,54,28,1,1,2,21,1,1,4,17,41,1119,608,21,19,1388,24,205,5,13,886,1,13,198,1,167,8,1,1,1,1017,1,1,3,2,152,1,2,543,327,1,133,1,22,2,1,881,42,12,1,31,4,10,12,618,4,3,1,1,47,1,5,11,303,168,93,86,7,1,5,1,288,3,115,91,56,1,7,8,16,3,1,64,135,8,2,150,6,1,92,5,49,1,17,2,1733,3,2,6,1,3,13,15,156,486,748,3,1,59,9,39,183,208,396,4,1,1,12,3,3,1009,178,2,274,54,450,8,9,90,806,2,2,1,8,7,386,7,12,7,14,238,71,33,12,1,60,114,228,128,7,1,459,2,2,325,1,1,209,52,37,1,1,1,116,2,46,26,1,12,1,1,1,1,1,87,152,5,159,6,1,1,159,4,1,4,115,5,2,6,1,1,1,51,2,1,28,123,2,2,5,24,4,1,3,9,4,2,1,189,5,64,1,41,6,1,16,1,10,4,109,3,12,2,198,1,4,3,1,1,1,226,1,1,26,1,209,3,1,393,3,341,111,1,1,1,1,3,65,1,116,233,1,1,128,60,19,19,81,4,246,9,1572,10,50,739,13,1,3,80,1,13,44,234,1,21,5,195,1,5,15,4,227,1,28,3,11,7,2,3,4,162,110,3,29,1,3,2,10,3,5,159,4,1,2,10,32,19,16,854,7,1,18,14,1,1,7,34,20,202,719,2,1,12,1,14,1,1,11,72,4,1,7,2,120,46,5,16,28,10,6,1,5,968,8,14,17,2,2,28,8,2,1,1,6,18,2,1,2,40,2,4,2,2,1]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e"],"label":[1,2,3,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,"?","B Cells","CD16+ NK Cells","CD16- NK Cells","CD4+ T Cells","CD4+\u002fCD8+ Cells","CD8 Terminal Effector Cells","CD8+ Effector Memory Cells","CD8+ T Cells","Central Effector Memory T Cells","Central Memory T Cells","Classical Monocytes","Effector Memory T Cells","Intermediate Monocytes"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"antibody","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC3 - default labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('cf4e3915-fd14-49fb-b686-b7b1b5cc7be6');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="172">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>print_scores(tuning <span class="op">=</span> <span class="st">'default'</span>,dataset<span class="op">=</span><span class="st">"PBMC4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - number of clusters'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3</td>
<td>22</td>
<td>16</td>
<td>19</td>
<td>20</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - Silhuette (higher is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.081765</td>
<td>0.050853</td>
<td>0.061618</td>
<td>0.112255</td>
<td>0.102525</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - davies_bouldin (lower is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.954689</td>
<td>2.100956</td>
<td>2.087707</td>
<td>1.442075</td>
<td>1.995982</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - default labels'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.617025</td>
<td>0.470070</td>
<td>0.453383</td>
<td>0.965513</td>
<td>0.647279</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.701228</td>
<td>0.380357</td>
<td>0.819943</td>
<td>0.612541</td>
<td>0.487560</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.739299</td>
<td>0.504966</td>
<td>0.788229</td>
<td>0.696088</td>
<td>0.584900</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.760207</td>
<td>0.494746</td>
<td>0.847372</td>
<td>0.689301</td>
<td>0.583823</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.717429</td>
<td>0.440485</td>
<td>0.795735</td>
<td>0.653154</td>
<td>0.529504</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="834fc63b-c255-442a-9ae4-35d26b8240e4" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("834fc63b-c255-442a-9ae4-35d26b8240e4")) {                    Plotly.newPlot(                        "834fc63b-c255-442a-9ae4-35d26b8240e4",                        [{"link":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,5,5,5,5,6,6,6,6,6,6,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,15,15,15,15,15,15,15,16,16,16,16,17,17,18,18,18,18,18,18,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,21,21,21,22,22,22,22,22,23,23,24,25,25,25,25,25,26,26,26,26,26,27,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,33,33,33,33,33,34,34,34,35,35,35,35,35,35,36,36,36,37,37,37,37,37,37,38,38,38,38,38,39,39,39,39,40,40,41,41,41,42,42,43,43,43,43,44,44,44,44,44,45,45,45,45,46,46,46,46,46,46,47,47,47,48,48,49,49,49,49,49,49,50,50,50,51,51,51,51,52,53,54,54,54,54,54,55,55,56,56,56,56,56,57,58,58,58,58,58,59,59,59,59,60,60,60,61,61,62,63,63,63,64,64,64,65,66,66,67,67,67,68,68,68,69,70,70,70,70,70,71,71,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,73,73,73,73,73,73,74,74,75,75,75,76,76,76,77,77,77,78,79],"target":[3,7,8,9,10,11,13,15,16,17,20,21,22,5,6,9,11,12,14,15,18,19,20,22,23,4,13,15,19,22,24,26,27,28,31,32,33,37,40,25,35,28,29,30,35,28,29,30,34,35,38,26,27,31,26,27,31,40,28,29,30,35,27,31,32,33,37,28,31,32,37,27,28,29,30,35,36,25,27,28,31,33,35,28,30,34,35,25,26,27,28,31,39,40,26,27,31,33,26,31,28,29,30,31,35,36,25,28,29,30,34,35,36,28,29,30,32,33,35,36,37,31,32,37,28,29,30,34,38,36,39,25,45,49,51,58,59,41,42,50,51,53,41,42,47,50,51,54,58,41,43,44,46,47,48,49,51,52,54,55,56,59,43,44,46,54,55,56,59,43,44,46,52,54,55,56,59,41,42,46,47,48,50,51,53,58,41,47,48,49,50,54,41,43,47,50,54,46,52,59,43,44,46,49,52,54,46,55,57,41,47,48,50,54,58,43,44,46,47,56,41,55,57,58,41,51,71,72,73,72,73,62,63,64,65,62,63,64,65,66,74,75,76,77,60,61,62,63,64,65,68,69,71,68,69,60,69,74,75,76,77,71,72,73,60,70,72,73,66,73,60,63,64,65,66,65,67,61,62,65,77,79,78,73,74,75,76,77,60,61,63,75,81,82,88,81,88,81,81,82,88,81,82,88,81,81,88,81,82,83,80,83,93,80,80,89,90,91,94,80,81,84,87,89,90,91,92,93,94,81,83,84,89,90,91,92,94,83,87,89,90,91,92,86,87,81,86,87,83,86,87,81,86,87,95,85],"value":[832,509,447,1,399,359,11,211,193,190,7,101,1,596,530,427,1,284,217,4,181,155,142,74,59,719,261,2,12,2,39,106,673,1,7,6,13,2,24,718,1,260,225,68,43,30,163,323,1,11,2,456,49,4,345,95,6,1,343,66,6,13,6,8,4,302,79,2,7,348,3,1,23,212,45,1,2,260,2,1,2,1,6,6,18,192,1,1,76,120,2,9,5,4,3,3,172,15,2,188,15,34,28,1,102,1,4,42,11,10,1,1,98,98,31,11,4,2,1,1,1,90,6,5,4,4,1,1,67,1,58,39,633,337,1,48,3,131,792,3,58,4,724,53,4,5,160,1,2,4,104,530,53,2,2,2,1,6,85,2,1,35,411,151,142,29,8,1,4,118,34,318,16,15,7,1,1,32,24,1,3,1,231,13,188,1,5,3,352,1,3,4,10,1,313,8,1,3,191,1,143,13,14,8,1,1,1,101,1,1,82,1,4,1,1,3,3,2,1,60,3,1,58,1,26,3,11,825,100,9,860,139,8,180,453,1,703,12,14,1,1,14,68,550,1,130,13,12,246,132,1,1,406,263,93,2,1,156,140,40,9,247,3,4,1,67,143,25,214,192,121,6,8,1,1,1,118,3,26,4,2,28,59,1,1,1,48,2,40,1,2,1,163,1,1,58,76,179,724,1,6,436,1,9,605,1,215,27,90,1,262,1,1,95,1,40,4,20,2,1,2,404,2,1,71,2,1,107,73,2,9,3,64,24,346,530,2,1,1,1,209,963,7,134,24,1,63,92,1,26,129,2,1,560,59,28]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b"],"label":[1,2,3,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,"CD16+ NK cells","Classical monocytes","DC2","ILC3","MAIT cells","Megakaryocytes\u002fplatelets","Memory B cells","Naive B cells","Non-classical monocytes","Regulatory T cells","Tcm\u002fNaive cytotoxic T cells","Tcm\u002fNaive helper T cells","Tem\u002fEffector helper T cells","Tem\u002fTemra cytotoxic T cells","Tem\u002fTrm cytotoxic T cells","pDC"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"celltypist","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC4 - default labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('834fc63b-c255-442a-9ae4-35d26b8240e4');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.536861</td>
<td>0.325029</td>
<td>0.372515</td>
<td>0.960701</td>
<td>0.532810</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.622945</td>
<td>0.371655</td>
<td>0.659143</td>
<td>0.590516</td>
<td>0.439575</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.651550</td>
<td>0.425369</td>
<td>0.634107</td>
<td>0.669980</td>
<td>0.487767</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.669274</td>
<td>0.436706</td>
<td>0.676741</td>
<td>0.661971</td>
<td>0.496402</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.622735</td>
<td>0.383434</td>
<td>0.626009</td>
<td>0.619496</td>
<td>0.448828</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="bd6ac951-4c27-4163-b290-f38b4b8a5f72" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("bd6ac951-4c27-4163-b290-f38b4b8a5f72")) {                    Plotly.newPlot(                        "bd6ac951-4c27-4163-b290-f38b4b8a5f72",                        [{"link":{"source":[0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,3,3,3,3,3,3,3,3,4,4,5,5,5,5,6,6,6,6,6,6,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,10,11,11,11,11,12,12,12,12,12,13,13,13,13,13,13,14,14,14,14,15,15,15,15,15,15,15,16,16,16,16,17,17,18,18,18,18,18,18,19,19,19,19,19,19,19,20,20,20,20,20,20,20,21,21,21,22,22,22,22,22,23,23,24,25,25,25,25,25,26,26,26,26,26,27,27,27,27,27,27,28,28,28,28,28,28,28,28,28,28,28,28,28,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,31,31,32,32,32,32,32,32,33,33,33,33,33,34,34,34,35,35,35,35,35,36,36,36,37,37,37,37,37,37,38,38,38,38,39,39,39,39,40,40,41,41,41,42,42,43,43,43,43,44,44,44,44,44,45,45,45,45,46,46,46,46,46,46,47,47,47,48,48,49,49,49,49,49,49,50,50,50,51,51,51,51,52,53,54,54,54,54,55,55,56,56,56,56,56,57,58,58,58,58,59,59,59,59,60,60,60,60,60,61,61,62,62,62,62,63,63,63,63,64,64,65,65,65,66,66,66,66,66,67,67,67,67,67,67,67,68,68,68,68,68,68,68,69,69,69,69,69,70,70,70,70,70,71,71,71,71,71,71,71,71,72,72,72,72,72,72,72,72,72,72,72,72,73,73,73,73,73,73,73,73,73,73,74,74,75,75,76,76,76,77,78,78,78,78,79,79],"target":[3,7,8,9,10,11,13,15,16,17,20,21,5,6,9,12,14,15,18,19,20,22,23,4,13,15,19,22,24,26,27,28,31,32,33,37,40,25,35,28,29,30,35,28,29,30,34,35,38,26,27,31,26,27,31,40,28,29,30,35,27,31,32,33,37,28,31,32,37,28,29,30,35,36,25,27,28,31,33,35,28,30,34,35,25,26,27,28,31,39,40,26,27,31,33,26,31,28,29,30,31,35,36,25,28,29,30,34,35,36,28,29,30,32,33,36,37,31,32,37,28,29,30,34,38,36,39,25,45,49,51,58,59,41,42,50,51,53,41,42,47,50,51,58,41,43,44,46,47,48,49,51,52,54,55,56,59,43,44,46,54,55,56,59,43,44,46,52,54,55,56,59,41,42,46,47,48,50,51,53,58,41,47,48,49,50,54,41,43,47,50,54,46,52,59,43,44,46,49,52,46,55,57,41,47,48,50,54,58,43,44,46,56,41,55,57,58,41,51,71,72,73,72,73,62,63,64,65,62,63,64,65,66,74,75,76,77,60,61,62,63,64,65,68,69,71,68,69,60,69,74,75,76,77,71,72,73,60,70,72,73,66,73,60,63,64,66,65,67,61,62,65,77,79,78,73,74,76,77,60,61,63,75,80,81,88,89,91,81,89,80,81,89,91,80,81,89,91,80,89,81,89,91,80,81,83,89,91,80,85,86,88,89,90,91,81,82,83,87,88,90,91,80,81,83,90,91,80,85,87,88,92,80,82,84,85,87,88,89,90,80,81,82,84,85,86,87,88,89,90,91,92,80,81,82,84,85,86,87,88,89,92,80,81,80,81,80,81,90,81,80,86,88,89,80,89],"value":[830,508,447,1,398,354,11,208,193,189,4,101,579,516,410,278,211,4,179,149,128,69,59,658,245,2,7,2,37,106,671,1,7,6,13,2,24,657,1,250,221,66,42,28,162,312,1,11,2,455,49,4,345,95,6,1,326,66,6,13,6,8,4,302,78,1,7,343,3,20,210,45,1,2,244,2,1,2,1,6,5,18,187,1,1,76,118,1,9,5,4,3,3,172,15,2,187,14,33,28,1,102,1,2,33,11,10,1,1,98,84,30,11,3,2,1,1,90,6,5,4,4,1,1,61,1,58,37,600,296,1,42,2,131,791,3,58,4,721,53,4,5,159,2,3,95,506,48,2,1,2,1,4,75,1,1,29,403,151,142,28,8,1,4,112,34,312,15,15,7,1,1,32,23,1,3,1,231,13,188,1,5,3,347,1,3,3,10,1,313,8,1,3,186,1,142,13,14,8,1,1,101,1,1,81,1,4,1,1,3,3,2,55,3,1,58,1,26,3,11,822,99,9,858,138,8,176,434,1,679,12,14,1,1,14,54,531,1,127,13,11,239,132,1,1,404,260,90,1,1,144,119,35,7,247,3,4,1,66,143,25,206,192,113,3,6,1,1,117,3,23,4,2,26,59,1,1,43,2,34,1,1,1,1,34,1,105,9,1,130,1,1,172,1,9,4,687,2,3,430,2,581,2,3,1,9,26,169,80,1,1,3,25,4,3,2,1,11,3,1,242,1,2,3,1,83,3,3,6,2,40,15,114,1,16,436,80,13,1,1,7,1,4,9,26,10,3,857,3,9,1,47,4,1,187,17,12,333,191,431,2,1,2,144,1,133,17,114,1,542,54,1,1,3,25,1]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c"],"label":[1,2,3,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,"?","B Cells","CD4 TEMRA","CD4+ T Cells","CD4+\u002fCD8+ Cells","CD8+ Cells","CD8+ Naive","CD8+ Terminal Effector T Cells","Central Memory T Cells","Classical Monocytes","NK Cells","Non Classical Monocytes","T Regulatory Cells"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"antibody","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC4 - default labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('bd6ac951-4c27-4163-b290-f38b4b8a5f72');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="matching-celltypist-clusters-number" class="level2">
<h2 class="anchored" data-anchor-id="matching-celltypist-clusters-number">Matching cellTypist clusters number</h2>
<div class="cell" data-execution_count="173">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>print_scores(tuning <span class="op">=</span> <span class="st">'celltypist'</span>,dataset<span class="op">=</span><span class="st">"PBMC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - number of clusters'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>18</td>
<td>17</td>
<td>20</td>
<td>21</td>
<td>14</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - Silhuette (higher is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">celltypist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.005501</td>
<td>0.050843</td>
<td>0.063871</td>
<td>0.088209</td>
<td>0.13383</td>
<td>0.090989</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - davies_bouldin (lower is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">celltypist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2.83457</td>
<td>2.286672</td>
<td>2.797123</td>
<td>1.984746</td>
<td>1.728304</td>
<td>1.491801</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - matching celltypist labels'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.658065</td>
<td>0.341945</td>
<td>0.757164</td>
<td>0.581903</td>
<td>0.448601</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.735830</td>
<td>0.459735</td>
<td>0.822412</td>
<td>0.665742</td>
<td>0.553086</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.699950</td>
<td>0.375082</td>
<td>0.808964</td>
<td>0.616828</td>
<td>0.479652</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.730468</td>
<td>0.423069</td>
<td>0.849278</td>
<td>0.640820</td>
<td>0.527386</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.787289</td>
<td>0.670392</td>
<td>0.803876</td>
<td>0.771373</td>
<td>0.723485</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="6b67c488-2d7d-4009-8e90-72e48fa485f8" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("6b67c488-2d7d-4009-8e90-72e48fa485f8")) {                    Plotly.newPlot(                        "6b67c488-2d7d-4009-8e90-72e48fa485f8",                        [{"link":{"source":[0,0,0,0,0,0,1,1,1,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,8,8,8,8,9,9,9,9,10,10,10,10,10,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,13,13,13,13,14,14,14,14,14,15,15,15,15,15,16,16,16,17,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,20,20,20,20,21,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,23,23,23,24,24,24,24,25,25,25,25,25,25,26,26,26,26,26,26,27,27,27,27,28,29,29,29,29,29,29,29,30,30,30,31,31,31,31,31,32,32,33,33,33,33,33,33,33,33,33,33,34,35,35,35,35,35,35,35,35,35,36,36,36,36,36,37,37,37,37,37,37,37,38,38,38,38,38,38,38,38,39,39,39,39,39,39,39,39,40,40,40,40,40,40,41,41,41,41,41,41,42,42,42,42,42,42,43,43,43,43,43,44,44,44,44,45,45,45,46,46,46,46,46,47,47,47,48,48,48,49,49,50,50,51,51,51,51,52,52,52,52,53,53,54,54,54,54,54,54,55,55,55,56,56,56,56,56,57,57,58,58,58,59,59,59,60,60,61,61,62,62,62,63,63,64,64,65,65,66,67,67,67,67,68,68,69,69,70,70,71,71,72,72,72,73,73,74,74,75,76,77,77,77,78,78,78,79,79,79,80,80,81,82,83,83,84,84,84,84,84,84,85,85,85,85,85,86,86,86,86,87,87,87,88,88,88,88,88,89,89,89,89,89,89],"target":[18,19,23,25,26,29,26,27,28,24,26,33,24,25,26,33,20,21,22,33,18,19,23,29,31,18,19,23,29,31,18,19,23,29,31,20,21,22,33,20,21,22,33,20,21,22,32,33,18,19,23,25,26,29,31,33,18,19,23,25,26,29,33,21,22,30,33,18,19,23,25,29,19,20,21,22,33,19,21,32,34,35,38,40,41,43,51,52,35,38,39,40,41,43,47,51,52,54,36,37,42,46,36,37,42,46,49,50,36,37,42,46,50,35,38,40,41,43,51,52,54,39,44,45,48,35,39,40,43,52,54,35,39,43,44,48,54,42,45,47,54,45,35,38,40,41,43,51,52,37,42,50,38,40,41,51,54,37,49,35,36,37,38,39,41,42,44,46,48,53,55,56,59,61,63,65,68,73,74,57,58,60,70,73,57,58,60,67,70,71,73,55,56,59,61,63,72,73,74,56,62,63,65,68,72,73,74,55,56,59,61,72,74,55,56,59,61,65,73,57,58,60,67,70,73,55,56,59,61,63,62,68,69,73,64,66,69,57,58,60,70,73,56,64,72,62,68,69,58,71,60,67,55,59,61,72,55,56,61,74,71,75,55,56,59,63,64,72,84,88,89,80,84,87,88,89,79,80,78,79,80,84,88,89,79,80,88,89,84,85,86,85,89,82,83,85,89,83,77,78,79,88,84,85,84,86,79,80,77,78,80,84,88,76,79,87,89,81,91,92,97,104,91,92,97,91,92,97,91,94,104,95,95,96,90,94,99,100,102,103,90,93,99,102,103,90,91,93,102,98,101,103,97,98,99,100,103,93,98,99,100,101,103],"value":[12,230,4,76,5,7,1,159,139,261,27,3,7,140,138,1,143,44,76,11,154,4,51,23,24,128,1,94,8,16,128,1,30,61,20,86,2,139,10,134,59,13,23,4,174,7,3,1,55,5,78,2,1,13,16,1,1,124,1,12,6,3,6,41,3,91,2,3,51,15,13,1,2,2,2,56,17,3,1,73,28,3,151,123,96,101,3,4,288,40,11,24,6,5,3,1,40,3,171,61,65,72,14,248,9,31,19,2,150,10,101,32,1,5,67,75,78,35,2,3,8,3,154,1,110,121,112,1,1,1,7,8,148,1,3,16,2,1,12,145,1,139,2,41,15,8,44,5,1,11,1,79,1,2,1,70,2,3,73,1,18,19,1,2,2,10,4,17,1,28,1,280,2,1,4,134,2,1,3,155,22,167,3,6,41,226,6,51,11,3,14,136,43,58,54,1,3,1,5,3,3,135,12,117,3,2,1,110,30,77,19,3,1,86,12,71,20,1,1,121,23,22,1,10,10,88,11,30,56,2,146,6,5,4,7,144,1,34,17,33,67,1,1,145,2,6,2,119,21,71,1,81,10,9,15,47,3,20,1,25,1,27,1,2,6,11,1,2,6,428,1,1,4,6,10,381,280,71,30,278,1,12,238,3,20,209,150,16,54,1,100,144,9,152,1,1,146,144,1,128,3,1,1,126,2,123,88,3,74,1,1,26,33,35,5,33,2,27,35,73,1,1,11,2,146,648,3,23,284,2,27,152,3,142,55,4,34,7,2,3,4,25,1,67,175,220,1,1,1,37,1,1,1,2,45,807,5,56,8,1,129,308,56]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd"],"label":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,1,2,3,4,5,6,7,8,9,10,11,12,13,14,"CD16+ NK cells","Classical monocytes","DC2","MAIT cells","Megakaryocyte precursor","Memory B cells","Naive B cells","Non-classical monocytes","Regulatory T cells","Tcm\u002fNaive cytotoxic T cells","Tcm\u002fNaive helper T cells","Tem\u002fEffector helper T cells","Tem\u002fTemra cytotoxic T cells","Tem\u002fTrm cytotoxic T cells","pDC"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"celltypist","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC1 - matching celltypist labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('6b67c488-2d7d-4009-8e90-72e48fa485f8');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="174">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>print_scores(tuning <span class="op">=</span> <span class="st">'celltypist'</span>,dataset<span class="op">=</span><span class="st">"PBMC2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - number of clusters'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>18</td>
<td>20</td>
<td>19</td>
<td>20</td>
<td>17</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - Silhuette (higher is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">celltypist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.03374</td>
<td>0.025173</td>
<td>0.030773</td>
<td>0.060901</td>
<td>0.12581</td>
<td>0.131097</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - davies_bouldin (lower is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">celltypist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3.167255</td>
<td>2.376025</td>
<td>3.431314</td>
<td>2.147939</td>
<td>1.855098</td>
<td>1.231923</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - matching celltypist labels'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.605942</td>
<td>0.312112</td>
<td>0.699644</td>
<td>0.534375</td>
<td>0.425421</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.697287</td>
<td>0.377675</td>
<td>0.809335</td>
<td>0.612491</td>
<td>0.492889</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.709450</td>
<td>0.398779</td>
<td>0.791930</td>
<td>0.642531</td>
<td>0.500807</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.738307</td>
<td>0.418942</td>
<td>0.850535</td>
<td>0.652244</td>
<td>0.529176</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.729355</td>
<td>0.472800</td>
<td>0.745550</td>
<td>0.713848</td>
<td>0.562480</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="0d52e586-7798-4b93-a895-85d872568e98" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("0d52e586-7798-4b93-a895-85d872568e98")) {                    Plotly.newPlot(                        "0d52e586-7798-4b93-a895-85d872568e98",                        [{"link":{"source":[0,0,0,0,0,1,1,1,1,1,2,2,2,2,2,3,3,3,4,4,4,4,4,5,5,5,5,5,5,5,5,6,6,6,6,6,6,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,11,11,11,11,11,11,12,12,12,12,12,12,12,12,13,13,13,13,13,13,13,13,13,13,14,14,14,14,14,14,14,14,14,15,15,16,16,16,16,16,16,17,17,17,17,17,18,18,18,18,18,18,19,19,19,19,19,19,20,20,20,20,20,20,20,21,21,22,22,23,23,24,24,24,24,24,24,24,24,25,25,25,25,25,25,26,26,26,26,26,26,26,26,27,27,27,27,27,27,27,27,28,28,28,28,28,28,29,29,29,29,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,31,32,32,32,33,33,33,33,33,34,34,35,35,35,36,37,37,38,38,38,38,38,38,38,38,39,39,39,39,39,39,40,40,40,40,40,40,41,41,41,41,42,42,42,42,43,43,43,43,43,43,43,43,44,44,44,44,44,44,44,44,44,44,45,45,45,45,45,45,45,46,46,46,46,46,46,46,46,46,47,47,47,47,47,47,47,47,48,48,48,48,48,48,48,48,49,49,49,50,50,50,50,50,51,51,52,52,52,53,53,54,54,55,56,57,57,57,58,58,59,59,60,60,61,61,62,62,62,62,62,63,63,63,64,64,64,65,65,65,65,65,65,66,66,67,67,67,67,67,67,67,67,67,68,68,68,68,69,69,69,70,70,70,70,71,71,72,72,73,73,73,74,75,76,76,76,76,76,76,77,77,77,78,78,78,78,79,79,80,80,80,80,80,80,80,81,81,81,81,81,81,82,82,82,82,82,82,82,83,83,83,83,83,84,85,86,87,87,87,88,88,88,89,89,90,91,91,91,92,92,92,92,92,93,93,93,93,93,93],"target":[22,23,28,29,33,21,27,32,34,35,18,19,20,27,30,23,32,37,18,19,20,27,30,24,25,26,27,28,30,31,33,18,19,20,26,27,30,24,26,28,29,30,31,33,18,19,20,24,25,26,27,30,31,18,19,20,27,30,18,19,20,24,25,26,27,28,30,31,33,18,24,25,26,27,28,29,30,31,33,24,25,26,27,28,30,31,33,20,22,24,26,27,28,29,30,31,33,18,20,24,25,26,27,30,31,33,21,32,23,25,26,35,36,37,22,28,29,31,33,41,43,44,45,46,47,38,41,43,45,46,47,38,41,43,44,45,46,47,40,49,39,53,42,55,38,43,44,45,46,47,48,50,38,44,46,47,48,55,38,43,44,45,46,47,48,55,38,40,43,44,45,46,47,48,38,39,44,48,50,52,39,44,52,53,38,40,41,44,45,46,47,48,50,38,39,43,44,46,48,50,40,49,56,39,44,48,50,52,40,49,40,51,54,54,42,55,57,59,60,64,65,66,68,69,57,58,65,66,69,73,62,67,69,71,73,74,59,60,61,69,63,65,66,72,57,59,60,61,64,65,68,69,57,59,61,64,65,66,68,69,70,73,57,59,60,61,64,65,69,57,59,60,64,65,66,67,68,69,57,59,60,61,64,65,68,69,57,59,64,65,66,68,69,70,62,67,71,64,66,68,69,70,62,74,66,70,73,58,73,74,75,76,67,80,81,82,77,78,79,80,79,80,79,82,84,86,87,88,89,78,92,93,79,80,81,79,80,81,82,83,87,80,83,77,79,80,84,87,88,89,92,93,80,81,82,83,79,80,82,80,81,82,83,84,85,91,93,77,78,82,86,90,80,82,87,89,92,93,94,95,96,94,95,104,106,105,106,99,100,104,105,106,107,108,94,104,105,106,107,108,94,99,100,104,105,106,108,99,101,106,107,108,103,103,97,96,100,108,96,97,103,96,100,109,94,101,102,94,96,98,101,102,94,96,98,101,102,106],"value":[422,2,1,196,1,478,1,18,89,11,144,154,151,21,4,439,1,1,32,233,141,29,4,127,190,37,10,4,10,57,2,69,155,140,2,31,10,2,1,235,2,17,38,59,1,10,15,89,11,68,120,13,6,291,24,8,3,2,6,1,6,80,11,51,64,2,38,39,2,1,31,10,10,1,10,2,106,51,3,39,99,35,5,1,9,9,6,2,1,1,18,1,22,45,9,11,84,35,27,4,34,79,3,1,2,1,3,170,1,1,5,77,48,13,48,8,32,3,26,552,3,11,3,2,8,3,3,140,171,130,130,13,2,178,1,121,90,85,479,2,470,1,441,1,262,15,3,4,20,22,46,1,314,10,5,2,24,1,163,32,3,28,30,21,24,5,92,1,51,1,30,47,55,12,1,4,23,32,150,73,201,5,2,69,1,1,19,172,1,4,7,12,6,41,3,2,3,2,160,5,8,172,9,2,175,1,5,1,88,1,4,80,4,48,1,13,542,9,7,112,166,4,48,2,1,620,1,2,2,54,319,255,1,3,1,2,9,2,542,23,292,1,1,148,12,199,139,1,44,21,3,2,18,1,5,1,6,4,4,176,188,4,3,166,154,1,28,5,1,8,86,145,44,34,1,1,7,4,7,115,121,7,45,28,1,6,69,1,16,23,33,160,5,4,1,5,169,1,158,5,2,1,4,76,70,5,1,17,53,4,48,20,9,656,3,1,635,2,582,4,566,2,553,3,1,4,12,293,14,1,96,195,26,264,1,4,159,113,7,1,1,4,269,1,1,1,5,76,22,160,3,1,217,1,3,7,22,12,190,1,1,194,2,148,24,147,1,5,107,1,82,48,1,1,1,3,13,1,639,1,1,56,51,1,2,568,1186,39,1,6,9,847,416,3,2,72,1,31,9,4,3,7,1,1,96,72,220,270,1,3,2,3,154,24,86,88,1,1,300,7,8,174,3,48,1,1,145,5,3,13,22,69,1,1,1,180,14,1]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],"label":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,"CD16+ NK cells","CD16- NK cells","Classical monocytes","DC2","HSC\u002fMPP","MAIT cells","Megakaryocytes\u002fplatelets","Memory B cells","Naive B cells","Non-classical monocytes","Regulatory T cells","Tcm\u002fNaive cytotoxic T cells","Tcm\u002fNaive helper T cells","Tem\u002fEffector helper T cells","Tem\u002fTrm cytotoxic T cells","pDC"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"celltypist","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC2 - matching celltypist labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('0d52e586-7798-4b93-a895-85d872568e98');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="175">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>print_scores(tuning <span class="op">=</span> <span class="st">'celltypist'</span>,dataset<span class="op">=</span><span class="st">"PBMC3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - number of clusters'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>17</td>
<td>18</td>
<td>20</td>
<td>18</td>
<td>20</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - Silhuette (higher is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">celltypist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.039293</td>
<td>0.040964</td>
<td>0.003634</td>
<td>0.112264</td>
<td>0.05994</td>
<td>0.130032</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - davies_bouldin (lower is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">celltypist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3.778924</td>
<td>1.889045</td>
<td>2.221019</td>
<td>1.698481</td>
<td>2.149262</td>
<td>1.140713</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - matching celltypist labels'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.593459</td>
<td>0.350206</td>
<td>0.643738</td>
<td>0.550465</td>
<td>0.432058</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.712344</td>
<td>0.545918</td>
<td>0.758076</td>
<td>0.671816</td>
<td>0.609354</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.735127</td>
<td>0.565025</td>
<td>0.767444</td>
<td>0.705423</td>
<td>0.623277</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.771047</td>
<td>0.586941</td>
<td>0.821567</td>
<td>0.726381</td>
<td>0.645653</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.666259</td>
<td>0.455690</td>
<td>0.686098</td>
<td>0.647534</td>
<td>0.529329</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="e78d2608-e9bf-4043-8728-bcb9bb3856a5" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("e78d2608-e9bf-4043-8728-bcb9bb3856a5")) {                    Plotly.newPlot(                        "e78d2608-e9bf-4043-8728-bcb9bb3856a5",                        [{"link":{"source":[0,0,0,0,0,0,1,1,1,1,1,2,2,2,2,3,3,3,4,4,4,4,4,5,5,5,5,5,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,8,8,8,8,8,8,9,9,9,9,9,10,10,10,10,10,10,10,10,10,11,11,11,11,12,12,12,12,12,12,12,12,13,13,13,14,14,14,14,14,14,14,14,15,15,15,15,16,16,17,17,17,17,17,17,17,17,17,17,18,18,18,19,19,19,19,19,20,20,20,20,20,20,20,20,20,21,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,25,25,25,25,25,25,25,25,26,26,26,26,26,26,26,26,26,26,26,27,27,28,28,28,28,29,29,29,30,30,30,30,30,30,31,31,32,32,33,33,33,34,35,35,35,35,35,35,35,35,35,35,36,36,36,36,36,37,37,37,37,37,37,38,38,38,38,38,39,39,39,39,39,39,39,40,40,40,40,40,41,41,41,41,41,41,41,42,42,42,42,42,42,42,42,42,43,43,43,44,44,44,44,45,45,45,45,45,45,45,45,46,46,46,47,47,47,47,48,48,48,48,48,49,49,49,50,50,51,51,52,52,52,52,53,53,54,54,55,55,55,55,56,56,56,56,56,56,57,57,57,57,57,57,58,58,58,58,58,59,59,59,59,59,59,60,60,60,60,61,61,61,61,61,61,61,62,62,62,62,62,63,63,63,64,64,65,65,65,65,65,66,66,66,66,66,66,66,66,67,67,67,67,67,67,68,68,68,69,69,70,70,70,70,70,70,70,70,71,72,72,72,72,73,73,73,73,73,73,73,73,74,74,74,74,75,75,75,75,75,75,75,75,75,75,76,76,76,76,76,77,77,77,77,77,78,78,78,78,78,78,78,79,79,79,79,79,79,79,79,79,79,80,80,81,81,81,81,82,83,83,83,84,84,84,85,85,85,85,85,86,86,86,86,87,87,88,88,88,89,89,89,90,90,90,91,91,91,91,91,91,92],"target":[17,22,23,24,26,34,18,27,28,31,33,19,25,28,29,21,23,30,19,20,23,25,29,17,22,23,24,26,17,20,23,24,25,26,28,17,20,22,23,24,25,26,34,17,20,23,24,26,30,17,22,23,24,26,17,19,20,22,23,24,25,26,29,18,27,28,33,17,19,20,22,23,24,25,26,18,27,33,18,19,26,28,30,31,32,34,19,23,25,29,18,33,35,36,37,40,41,45,47,48,51,52,35,44,46,38,42,45,49,53,36,37,41,42,43,47,48,51,52,39,37,40,41,42,45,48,36,37,38,39,40,41,42,43,45,47,48,49,52,36,37,39,41,42,45,47,48,51,52,36,38,39,41,42,43,45,49,36,37,38,39,40,41,42,45,47,48,52,35,44,35,44,46,50,38,42,49,35,38,39,42,45,54,35,46,46,50,35,39,44,53,55,57,59,62,63,65,66,68,69,70,55,56,59,61,63,55,56,59,60,61,70,56,58,59,61,67,56,61,62,64,66,67,70,55,56,60,61,70,55,56,59,60,61,63,67,55,56,58,59,60,61,63,67,70,56,61,63,57,65,66,68,55,56,58,59,60,61,63,72,57,66,69,55,56,59,61,55,56,59,60,61,58,63,67,71,72,55,59,55,56,59,61,58,72,62,70,73,77,78,79,73,75,76,77,78,79,80,81,83,84,85,86,73,74,75,78,80,73,75,76,77,78,79,73,75,77,79,73,75,76,77,78,79,91,87,88,89,90,91,73,74,79,88,89,82,83,84,85,86,75,80,83,84,85,86,87,90,74,75,76,78,79,88,84,85,86,81,86,77,79,85,87,88,89,90,91,92,73,75,79,91,93,99,100,101,107,108,109,110,93,99,102,110,93,98,99,101,102,106,107,108,109,110,93,106,108,109,110,106,107,108,109,110,93,102,106,107,108,109,110,93,99,100,101,102,106,107,108,109,110,93,94,94,95,96,111,104,93,94,104,93,94,104,93,94,96,101,104,93,94,96,104,93,101,93,101,103,93,101,103,94,101,103,97,98,100,105,108,110,111],"value":[807,394,17,47,6,1,965,4,164,12,2,1022,19,4,81,938,1,152,3,24,212,661,30,517,292,25,39,6,26,272,121,221,7,125,1,20,300,2,187,193,9,23,3,12,245,38,203,13,1,310,149,8,13,2,8,1,103,2,215,54,17,38,2,331,3,73,2,16,1,14,4,11,10,50,276,23,306,1,9,1,1,2,12,151,57,16,16,3,7,125,1,33,2,50,1197,39,343,4,1,34,26,20,1306,16,7,1031,3,2,7,1,671,1,221,10,2,44,7,1,1,938,10,772,2,9,3,47,261,1,1,2,36,76,353,46,43,6,8,4,1,396,141,1,183,13,2,19,10,8,7,19,11,1,1,301,287,146,4,187,105,2,2,57,7,21,1,99,5,4,6,307,230,1,2,11,164,3,71,3,1,140,1,12,8,8,155,5,52,36,1,1,20,1,1092,2,1,1,5,248,234,4,3,46,1044,449,25,20,1285,5,157,6,1,1,2,1040,1,5,162,2,3,592,338,1,1,148,23,1,844,35,1,323,296,192,2,15,3,2,2,38,1,13,8,639,10,2,1,28,4,303,13,309,2,1,4,1,2,1,1,62,130,12,6,2,161,1,19,145,4,40,12,9,47,3,4,1,81,52,11,26,9,22,6,4,1,1,20,7,1,2,1761,2,8,16,4,23,2,162,1247,4,1,12,54,721,319,1,1031,3,1,12,2,9,270,178,67,456,2,1,903,2,402,71,12,16,7,255,34,64,1,259,269,7,464,2,2,1,337,217,39,2,1,55,1,16,136,2,64,32,1,1,92,152,1,1,1,1,222,11,2,161,4,1,2,1,5,132,11,2,1,52,3,1,1,38,1,467,3,2,6,104,12,297,1029,3,92,1,138,1,2,2,17,11,20,28,5,18,1,144,130,27,4,61,908,1886,3,3,1,1,4,4,197,26,7,1,12,1,2,1,13,162,674,1040,68,30,2,3,8,146,5,217,2,145,40,1,274,5,5,773,1,1,18,1,274,9,128,3,67,26,107,2,3,225,379,1,256,15,11,11,16,8,2,32,52]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e"],"label":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,"CD16+ NK cells","Classical monocytes","DC1","DC2","Epithelial cells","HSC\u002fMPP","MAIT cells","Megakaryocytes\u002fplatelets","Memory B cells","NK cells","Naive B cells","Non-classical monocytes","Plasma cells","Regulatory T cells","Tcm\u002fNaive cytotoxic T cells","Tcm\u002fNaive helper T cells","Tem\u002fEffector helper T cells","Tem\u002fTrm cytotoxic T cells","pDC"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"celltypist","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC3 - matching celltypist labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('e78d2608-e9bf-4043-8728-bcb9bb3856a5');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="176">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>print_scores(tuning <span class="op">=</span> <span class="st">'celltypist'</span>,dataset<span class="op">=</span><span class="st">"PBMC4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - number of clusters'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>16</td>
<td>18</td>
<td>18</td>
<td>19</td>
<td>17</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - Silhuette (higher is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">celltypist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.022385</td>
<td>0.048061</td>
<td>0.107921</td>
<td>0.111704</td>
<td>0.107635</td>
<td>0.081772</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - davies_bouldin (lower is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">celltypist</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2.007518</td>
<td>1.898663</td>
<td>1.612564</td>
<td>1.442525</td>
<td>2.031442</td>
<td>1.194603</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - matching celltypist labels'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.686019</td>
<td>0.421166</td>
<td>0.747399</td>
<td>0.633956</td>
<td>0.512728</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.730100</td>
<td>0.473433</td>
<td>0.810168</td>
<td>0.664434</td>
<td>0.562407</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.752718</td>
<td>0.500477</td>
<td>0.831022</td>
<td>0.687899</td>
<td>0.587099</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.759495</td>
<td>0.492528</td>
<td>0.846776</td>
<td>0.688525</td>
<td>0.581840</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.724306</td>
<td>0.448608</td>
<td>0.787864</td>
<td>0.670238</td>
<td>0.535988</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="15b620cd-b312-45de-9cc1-fac877420ece" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("15b620cd-b312-45de-9cc1-fac877420ece")) {                    Plotly.newPlot(                        "15b620cd-b312-45de-9cc1-fac877420ece",                        [{"link":{"source":[0,0,0,0,0,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,4,4,4,4,4,4,5,5,5,5,5,5,5,6,6,6,6,6,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,9,9,9,9,9,9,9,9,10,10,10,10,10,10,10,10,10,10,10,11,11,11,11,12,12,12,13,13,13,14,15,15,16,16,16,16,16,16,17,17,17,17,17,17,17,17,18,18,18,18,18,18,19,19,19,20,20,20,20,21,21,21,21,22,22,22,22,22,22,22,23,23,23,23,23,23,24,24,24,25,25,25,25,25,25,25,25,26,26,27,27,27,27,27,28,28,28,28,28,28,28,29,29,29,29,29,29,29,29,29,30,30,30,30,31,31,31,31,32,32,32,32,32,32,33,33,33,34,34,34,34,34,34,34,34,35,35,35,35,35,35,35,36,36,36,36,36,36,36,36,36,36,37,37,37,37,37,37,37,38,38,38,38,38,38,39,39,39,39,39,39,39,39,39,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,42,42,42,42,43,43,43,43,43,43,44,44,44,44,45,45,45,45,45,46,46,46,47,47,47,47,48,48,48,48,49,49,49,49,49,49,49,49,50,51,51,52,52,52,53,53,54,54,54,54,55,55,55,55,55,56,56,56,57,57,57,57,57,58,58,59,60,60,60,60,60,61,61,61,62,62,62,62,63,64,65,65,65,65,65,66,66,67,67,67,67,68,69,69,69,69,70,70,70,70,71,71,71,72,72,72,73,73,74,74,74,75,76,76,77,77,77,78,78,78,79,79,79,79,79,79,79,79,79,79,80,80,80,80,80,81,81,81,81,81,81,81,81,82,82,82,82,82,82,83,83,83,84,84,84,85,85,85,86,87],"target":[17,19,25,28,32,17,20,21,23,25,29,31,17,20,21,22,23,25,29,30,31,16,18,27,28,29,32,16,18,27,28,29,32,16,18,26,27,28,29,32,17,20,21,23,31,22,23,24,25,29,30,16,17,18,21,24,26,27,28,29,32,17,22,23,24,25,29,30,32,17,18,20,21,22,23,24,25,29,30,31,16,26,29,32,27,28,29,17,28,33,32,19,25,36,37,39,43,47,49,34,35,36,41,42,45,46,49,36,37,39,43,47,49,38,42,44,34,35,41,46,34,35,41,46,34,40,42,45,46,48,49,34,35,40,41,42,45,40,45,48,34,35,38,41,42,44,45,49,36,43,36,37,39,43,47,36,37,38,39,43,44,47,34,35,36,37,39,40,43,48,49,40,41,45,48,34,35,41,46,36,37,38,39,45,51,39,47,50,52,53,58,59,61,62,65,69,52,53,61,62,64,65,69,52,54,55,57,60,63,65,66,67,70,54,55,57,65,66,67,70,56,60,61,67,69,70,54,55,57,63,65,66,67,68,70,55,58,59,60,61,65,66,69,52,53,58,61,62,64,66,69,52,58,61,69,55,57,63,65,66,70,56,60,69,70,58,59,61,62,69,52,53,62,54,57,66,68,52,58,61,65,52,54,55,57,58,60,62,65,68,55,67,79,81,82,81,82,72,73,74,75,72,73,74,75,76,83,84,85,71,72,73,74,75,78,79,78,71,78,83,84,85,79,81,82,71,80,81,82,76,82,71,72,74,75,76,75,77,73,75,85,87,86,82,83,84,85,71,72,73,83,89,90,96,89,90,96,89,96,89,90,96,89,89,96,89,90,91,88,91,101,88,89,92,95,97,98,99,100,101,102,88,97,98,99,102,89,91,92,97,98,99,100,102,91,95,97,98,99,100,89,94,95,91,94,95,89,94,95,103,93],"value":[1,716,260,3,2,43,395,249,189,2,2,35,536,12,25,3,131,1,1,2,8,228,362,46,14,9,2,398,87,43,28,89,5,362,8,5,98,3,4,2,205,100,123,18,30,17,10,355,1,1,90,7,1,366,2,1,2,4,14,30,6,15,377,18,1,3,3,8,1,127,1,16,55,3,13,3,4,1,1,26,7,210,5,1,2,105,2,4,3,59,57,3,40,115,447,335,99,5,1,760,65,1,10,11,2,82,1,576,191,45,2,2,8,619,1,99,68,439,10,6,93,330,4,27,2,5,301,8,1,82,1,9,3,1,318,10,38,354,5,1,1,1,73,1,9,223,2,1,4,213,11,36,136,8,2,45,8,1,5,4,3,104,1,1,33,13,1,16,4,2,76,7,2,87,5,54,31,7,7,7,5,1,14,1,48,1,1,57,795,94,4,1,7,85,1,1,83,736,2,44,3,1,1,1,94,567,56,1,4,27,2,2,38,366,114,193,13,9,3,2,624,41,1,1,26,1,306,45,167,2,3,1,11,1,1,1,3,354,1,8,14,1,1,31,25,1,97,6,189,1,2,8,310,5,9,7,109,208,4,1,1,9,304,11,1,3,1,131,6,2,20,3,100,1,8,104,1,1,84,3,2,2,4,4,1,3,1,1,72,57,2,46,11,825,105,7,851,7,137,180,447,704,3,12,20,1,15,68,550,1,12,143,246,132,2,406,356,2,1,296,40,9,247,3,4,1,67,145,29,214,192,121,6,8,1,1,1,118,29,4,2,28,59,1,2,48,2,40,2,1,1,163,1,1,724,1,6,237,76,436,1,9,605,1,215,27,90,1,357,1,1,1,2,404,2,1,71,2,1,107,73,1,40,4,20,2,2,9,3,64,24,346,530,2,1,1,1,209,963,7,1,197,116,1,26,129,2,1,560,59,28]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728"],"label":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,"CD16+ NK cells","Classical monocytes","DC2","ILC3","MAIT cells","Megakaryocytes\u002fplatelets","Memory B cells","Naive B cells","Non-classical monocytes","Regulatory T cells","Tcm\u002fNaive cytotoxic T cells","Tcm\u002fNaive helper T cells","Tem\u002fEffector helper T cells","Tem\u002fTemra cytotoxic T cells","Tem\u002fTrm cytotoxic T cells","pDC"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"celltypist","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC4 - matching celltypist labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('15b620cd-b312-45de-9cc1-fac877420ece');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="matching-antibody-clusters-number" class="level2">
<h2 class="anchored" data-anchor-id="matching-antibody-clusters-number">Matching antibody clusters number</h2>
<div class="cell" data-execution_count="177">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>print_scores(tuning <span class="op">=</span> <span class="st">'antibody'</span>,dataset<span class="op">=</span><span class="st">"PBMC1"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - number of clusters'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>9</td>
<td>11</td>
<td>10</td>
<td>11</td>
<td>11</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - Silhuette (higher is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">antibody</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.099643</td>
<td>0.073115</td>
<td>0.069687</td>
<td>0.150193</td>
<td>0.090531</td>
<td>0.042617</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - davies_bouldin (lower is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">antibody</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>1.498221</td>
<td>1.689467</td>
<td>1.560514</td>
<td>1.392406</td>
<td>2.067883</td>
<td>1.721174</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - matching antibody labels'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.715777</td>
<td>0.633217</td>
<td>0.707203</td>
<td>0.724563</td>
<td>0.698798</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.736466</td>
<td>0.645073</td>
<td>0.769273</td>
<td>0.706342</td>
<td>0.707927</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.746355</td>
<td>0.650567</td>
<td>0.757864</td>
<td>0.735189</td>
<td>0.712214</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.739813</td>
<td>0.640616</td>
<td>0.767621</td>
<td>0.713949</td>
<td>0.704048</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.721550</td>
<td>0.649977</td>
<td>0.737446</td>
<td>0.706326</td>
<td>0.711698</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="616daed8-43a3-4dc6-b879-9ea08629a424" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("616daed8-43a3-4dc6-b879-9ea08629a424")) {                    Plotly.newPlot(                        "616daed8-43a3-4dc6-b879-9ea08629a424",                        [{"link":{"source":[0,0,0,0,1,1,1,2,2,2,3,3,3,3,4,4,4,5,5,5,6,6,6,7,7,7,8,9,9,9,9,10,10,10,11,11,11,11,11,12,12,12,12,12,13,13,13,14,14,14,15,15,16,17,17,17,17,18,19,19,20,20,20,21,21,21,21,21,21,21,22,22,22,22,23,23,23,24,24,24,25,25,26,26,26,27,27,28,28,28,29,29,30,30,30,30,31,31,31,31,31,32,32,32,33,33,33,33,34,34,34,35,35,35,36,37,38,38,38,38,39,39,40,41,41,41,42,42,42,43,43,43,44,44,44,45,45,46,46,46,47,47,47,48,48,48,48,48,48,48,49,49,49,49,49,49,49,49,50,50,50,50,51,51,51,51],"target":[9,11,12,19,10,13,17,9,11,12,10,11,12,14,12,15,16,10,11,13,10,13,18,9,13,17,17,20,21,23,28,21,22,25,20,21,23,26,28,20,23,25,26,28,21,22,27,24,25,26,21,24,24,21,22,27,29,22,20,28,30,31,35,30,31,32,33,34,36,39,32,33,38,39,30,31,35,34,36,37,34,35,31,34,35,33,39,30,31,35,39,40,45,48,50,51,45,48,49,50,51,41,44,45,41,43,44,45,41,48,49,48,49,50,47,47,42,43,44,51,42,43,46,55,57,58,55,56,57,55,56,57,55,56,57,55,56,55,56,60,52,57,60,53,54,56,58,59,60,61,52,53,54,55,58,59,60,61,53,54,55,60,53,54,55,60],"value":[822,10,1,76,427,307,3,51,432,93,4,4,293,268,1,159,138,271,2,3,1,42,91,3,1,72,28,855,1,10,10,585,117,1,67,2,368,9,2,8,115,20,243,2,58,281,14,1,262,5,2,157,138,1,5,69,28,91,8,68,805,125,8,1,2,484,159,1,1,1,42,318,129,5,2,473,18,1,152,143,274,9,9,6,242,16,67,79,1,2,1,27,1,44,3,839,1,4,1,585,19,33,216,277,1,32,454,6,1,56,225,1,269,9,153,143,1,126,1,1,73,1,27,33,1,1,17,56,1,118,1,40,668,1,2,284,1,1,25,1,293,2,1,36,1,3,48,4,9,4,2,54,174,1,214,6,4,40,12,550,1,34,59,33,2,765]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e"],"label":[1,2,3,4,5,6,7,8,9,1,2,3,4,5,6,7,8,9,10,11,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,11,1,2,3,4,5,6,7,8,9,10,11,"B Cells","CD8+ T Cells","Central Memory T Cells","Classical Monocytes","Dendritic Cells","Intermediate Monocytes","NK Cells","NKT Cells","Naive T Cells","Terminal Effector T Cells"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"antibody","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC1 - matching antibody labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('616daed8-43a3-4dc6-b879-9ea08629a424');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="178">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>print_scores(tuning <span class="op">=</span> <span class="st">'antibody'</span>,dataset<span class="op">=</span><span class="st">"PBMC2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - number of clusters'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>11</td>
<td>10</td>
<td>12</td>
<td>12</td>
<td>12</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - Silhuette (higher is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">antibody</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.041184</td>
<td>0.037491</td>
<td>-0.021431</td>
<td>0.091472</td>
<td>0.074925</td>
<td>0.04853</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - davies_bouldin (lower is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">antibody</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3.22287</td>
<td>1.702317</td>
<td>4.327977</td>
<td>1.463008</td>
<td>2.077179</td>
<td>2.208843</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - matching antibody labels'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.585175</td>
<td>0.443933</td>
<td>0.599091</td>
<td>0.571891</td>
<td>0.531050</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.739559</td>
<td>0.636764</td>
<td>0.742414</td>
<td>0.736726</td>
<td>0.695610</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.666315</td>
<td>0.562966</td>
<td>0.694832</td>
<td>0.640047</td>
<td>0.632909</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.763984</td>
<td>0.764614</td>
<td>0.773986</td>
<td>0.754238</td>
<td>0.803575</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.740643</td>
<td>0.676510</td>
<td>0.686522</td>
<td>0.804027</td>
<td>0.746725</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="411d14df-8591-48c4-8e8f-67b478b0cfeb" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("411d14df-8591-48c4-8e8f-67b478b0cfeb")) {                    Plotly.newPlot(                        "411d14df-8591-48c4-8e8f-67b478b0cfeb",                        [{"link":{"source":[0,0,0,0,0,1,1,1,1,1,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,5,6,6,6,6,6,6,7,7,8,8,8,8,8,9,9,10,10,10,10,11,11,11,11,11,11,11,12,12,13,13,13,13,13,13,14,14,14,14,14,14,14,14,15,15,15,15,15,15,15,15,15,16,16,16,16,16,16,17,17,17,18,19,20,20,21,21,21,21,21,22,22,22,22,22,23,23,23,23,23,23,23,24,24,24,24,25,25,25,25,25,25,25,25,26,26,26,26,26,27,27,27,27,27,28,28,28,29,29,29,29,30,30,30,30,30,30,31,31,31,32,33,33,33,33,33,34,34,34,35,35,36,36,36,37,37,37,38,38,39,39,40,41,41,41,41,41,41,42,42,42,43,44,45,45,46,46,46,47,47,47,47,47,47,47,48,48,48,48,48,48,49,49,49,49,49,49,49,49,50,50,50,50,51,51,51,51,52,52,52,52,52,52,52,53,53,53,54,54,54,54,54,54,55,55,55,55,56,56,56,56,56],"target":[11,13,14,15,16,11,13,14,15,16,12,14,17,11,14,15,16,11,15,18,19,11,13,14,15,16,11,12,13,14,15,16,17,18,11,13,14,15,16,18,19,13,15,19,20,21,22,24,26,27,30,31,23,25,21,22,25,27,29,30,21,22,23,24,25,27,29,30,21,22,24,25,26,27,29,30,31,22,24,25,27,30,31,23,25,28,26,26,23,32,33,34,37,38,42,33,34,36,37,42,35,37,38,39,41,43,44,33,34,36,37,33,34,35,36,37,38,42,43,33,36,39,40,41,33,34,36,38,42,38,39,43,33,37,38,42,33,34,36,37,38,42,33,34,42,41,47,48,49,52,56,47,48,49,45,46,47,49,52,47,48,49,48,49,55,56,51,50,51,52,53,54,56,48,49,52,55,46,65,66,65,66,67,58,59,60,61,62,66,67,58,59,60,61,62,66,57,58,59,60,61,62,66,67,59,60,62,63,63,64,65,66,57,59,61,62,63,64,66,62,63,64,57,59,60,62,65,67,57,59,65,67,57,59,62,65,67],"value":[693,1,11,20,323,30,459,153,339,2,735,31,2,369,8,16,215,2,2,11,123,8,207,73,208,4,2,3,19,410,21,2,273,1,23,44,34,82,35,160,1,1,1,12,9,28,758,6,2,168,94,71,734,4,598,9,16,35,4,69,63,8,6,15,376,2,239,11,356,162,1,6,2,81,2,64,15,14,551,12,2,1,1,3,2,270,172,136,1,8,892,23,12,35,83,134,792,8,6,11,688,4,1,1,1,1,48,4,9,550,10,30,2,2,7,360,8,6,1,3,1,1,161,146,105,171,2,2,8,1,167,102,6,3,235,1,119,99,1,1,9,10,12,73,2,8,12,1287,3,1,2,1161,5,3,638,52,567,1,1,7,6,383,15,276,136,33,161,16,4,11,114,9,1,113,7,1,104,48,630,8,50,49,1,19,1082,32,11,76,1,526,7,31,17,24,1345,2,1,170,2,19,381,60,1,39,2,5,4,5,4,141,2,18,5,1,1,3,1,2,1,1,109,4,1,1,2,3,1,1,235,2,1,2,29,3,1,2,1]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f"],"label":[1,2,3,4,5,6,7,8,9,10,11,1,2,3,4,5,6,7,8,9,10,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,"B Cells","CD3+ Cells","CD4+ Cells","CD4+\u002fCD8+ Cells","CD8+ Cells","Central Memory T Cells","Classical Monocytes","Intermediate Monocytes","NK Cells","Non Classical Monocytes","Terminal Effector T Cells"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"antibody","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC2 - matching antibody labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('411d14df-8591-48c4-8e8f-67b478b0cfeb');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="179">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>print_scores(tuning <span class="op">=</span> <span class="st">'antibody'</span>,dataset<span class="op">=</span><span class="st">"PBMC3"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - number of clusters'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>12</td>
<td>14</td>
<td>13</td>
<td>14</td>
<td>20</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - Silhuette (higher is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">antibody</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.048747</td>
<td>0.024448</td>
<td>-0.007328</td>
<td>0.063501</td>
<td>0.040846</td>
<td>0.031805</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - davies_bouldin (lower is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">antibody</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>3.082757</td>
<td>2.048357</td>
<td>2.967632</td>
<td>1.617082</td>
<td>2.237114</td>
<td>3.287867</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - matching antibody labels'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.633333</td>
<td>0.503352</td>
<td>0.609373</td>
<td>0.659256</td>
<td>0.567586</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.737439</td>
<td>0.695008</td>
<td>0.736412</td>
<td>0.738468</td>
<td>0.732379</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.712286</td>
<td>0.638310</td>
<td>0.692394</td>
<td>0.733355</td>
<td>0.684119</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.760367</td>
<td>0.695131</td>
<td>0.769539</td>
<td>0.751412</td>
<td>0.732928</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.670272</td>
<td>0.539203</td>
<td>0.665531</td>
<td>0.675080</td>
<td>0.603803</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="24a8f038-c962-4bc6-a00f-9d93cfa2c3d0" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("24a8f038-c962-4bc6-a00f-9d93cfa2c3d0")) {                    Plotly.newPlot(                        "24a8f038-c962-4bc6-a00f-9d93cfa2c3d0",                        [{"link":{"source":[0,0,0,0,0,1,1,1,1,1,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,5,5,5,5,5,5,6,6,6,6,6,6,6,6,7,7,7,7,7,8,8,8,9,9,9,9,9,9,10,10,10,10,10,11,11,11,11,11,11,11,12,12,12,12,12,12,12,13,13,13,13,13,13,14,14,15,15,15,16,17,17,17,17,17,17,17,17,18,18,18,18,18,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,21,21,22,22,22,23,24,24,24,24,24,24,25,26,26,26,26,26,26,26,27,27,27,27,27,27,27,28,28,28,28,28,29,29,29,29,29,29,30,30,30,30,30,31,31,31,31,32,32,32,32,32,32,32,32,32,33,33,33,33,33,33,34,34,34,35,35,35,36,36,36,36,37,37,37,37,37,38,38,39,39,39,39,39,39,40,40,40,40,40,40,40,40,41,41,41,41,41,41,41,41,41,42,42,42,42,42,42,43,43,43,44,44,44,44,44,44,45,45,45,45,45,45,45,46,46,46,46,46,46,46,47,47,48,48,48,49,49,50,50,50,50,50,50,51,51,51,51,52,52,52,53,53,53,53,53,53,53,53,54,54,54,54,54,54,54,54,55,55,55,55,55,55,55,55,55,56,56,56,56,56,56,56,57,57,57,57,57,57,57,57,58,58,58,58,58,58,58,58,58,58,59,59,59,59,59,59,59,59,59,59,60,60,60,60,61,61,61,61,61,62,62,62,62,62,62,63,63,63,63,63,63,63,63,64,64,65,65,65,65,65,65,66,66,66,66,66,67,67,68,68,68,68,68,68,69,69,69,70,71,71,71,71,71,71,71,71,71,72,72,72,72,72],"target":[12,13,17,18,20,12,13,17,18,19,20,22,23,24,14,20,21,23,15,17,22,23,16,23,24,12,15,17,19,22,24,12,13,15,17,18,19,20,24,12,13,17,18,20,14,21,23,12,14,15,23,24,25,12,13,17,18,20,12,13,15,17,18,19,20,26,27,29,32,33,36,37,26,27,31,33,36,37,28,34,29,32,37,30,26,27,29,31,32,33,35,36,27,31,32,36,37,26,27,32,33,35,36,37,26,27,30,31,32,33,36,37,28,34,29,32,35,28,26,27,29,30,32,38,38,39,40,44,45,46,49,51,39,40,43,44,45,46,51,41,42,45,48,52,40,42,44,45,46,50,40,42,45,47,50,39,43,44,46,39,40,42,43,44,45,46,49,50,39,40,43,44,46,51,41,48,52,40,46,49,39,40,43,44,39,40,41,42,44,41,45,53,55,57,58,59,71,53,55,56,57,58,59,68,71,55,60,61,63,64,65,66,71,72,53,54,55,58,60,71,53,57,59,53,55,56,57,58,59,59,67,68,69,70,71,72,53,55,56,57,58,59,71,68,69,62,63,66,53,59,54,55,56,58,59,68,55,56,58,59,63,64,65,73,76,77,78,79,80,81,84,73,74,75,76,79,80,84,85,74,76,77,78,79,80,81,84,85,76,77,78,79,81,82,84,76,77,78,79,80,81,82,84,74,75,76,77,78,79,81,82,83,84,73,75,76,77,78,79,81,82,83,84,73,74,83,85,73,77,81,83,84,73,74,76,80,83,85,74,76,78,80,81,83,84,85,83,85,73,74,77,79,83,85,73,78,83,84,85,73,75,73,75,76,78,80,84,73,74,81,73,73,74,75,77,78,79,81,83,84,73,76,83,84,85],"value":[113,1286,26,648,12,1190,37,219,2,222,24,2,1,1,1060,1,8,193,991,3,101,4,875,1,137,2,6,501,92,170,2,430,16,1,109,2,85,123,2,15,323,7,175,3,11,286,1,3,32,1,1,3,11,2,13,1,4,139,14,2,1,8,2,2,12,1322,233,2,29,136,27,20,45,1335,34,84,101,78,1102,1,996,3,1,875,55,3,9,26,533,4,243,1,9,808,12,3,1,306,2,51,25,13,3,1,114,100,1,56,14,15,9,5,36,258,263,9,1,201,2,3,2,124,6,8,11,30,1217,418,1,25,31,122,1390,18,1,264,1,3,8,1191,1,1,29,117,1,1020,1,1,6,243,1,1,662,334,2,20,863,4,37,1,33,4,12,13,4,586,1,3,87,96,1,67,5,8,7,251,1,20,5,232,105,8,1,30,82,4,1,2,17,2,17,3,1,1706,1,3,1,26,3,20,1,131,1215,1,1,1,16,37,43,198,587,316,1,2,2,1009,3,1,12,1,1,873,4,1,7,134,162,49,461,1,66,114,244,244,9,9,311,63,5,14,6,240,28,2,332,208,38,34,259,5,91,153,1,1,1,1,3,131,1,3,75,1,42,1,6,28,48,461,2,49,8,1,979,80,18,1,17,2,2,2,120,46,5,16,28,10,6,1,7,2,3,4,162,110,3,19,69,820,17,1,246,9,1575,1,3,2,10,3,5,159,4,1,2,1,1,39,53,20,218,1573,7,1,20,1,12,1,14,2,2,5,24,4,3,9,4,2,1,189,1,16,1,10,4,109,3,12,198,1,3,1,1,1,619,4,31,1,273,1,44,65,1,111,1,1,1,1,3,574,1,1,244,8,2,1,1,6,18,2,1,2,2,4,2,2,1]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b"],"label":[1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,13,14,1,2,3,4,5,6,7,8,9,10,11,12,13,1,2,3,4,5,6,7,8,9,10,11,12,13,14,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,"B Cells","CD16+ NK Cells","CD16- NK Cells","CD4+ T Cells","CD4+\u002fCD8+ Cells","CD8 Terminal Effector Cells","CD8+ Effector Memory Cells","CD8+ T Cells","Central Effector Memory T Cells","Central Memory T Cells","Classical Monocytes","Effector Memory T Cells","Intermediate Monocytes"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"antibody","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC3 - matching antibody labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('24a8f038-c962-4bc6-a00f-9d93cfa2c3d0');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
<div class="cell" data-execution_count="180">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>print_scores(tuning <span class="op">=</span> <span class="st">'antibody'</span>,dataset<span class="op">=</span><span class="st">"PBMC4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - number of clusters'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>13</td>
<td>11</td>
<td>11</td>
<td>13</td>
<td>20</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - Silhuette (higher is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">antibody</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>-0.009349</td>
<td>0.036425</td>
<td>0.038929</td>
<td>0.059369</td>
<td>0.078876</td>
<td>-0.038177</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - davies_bouldin (lower is better)'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">monocle</th>
<th data-quarto-table-cell-role="th">scanpy</th>
<th data-quarto-table-cell-role="th">scvi-tools</th>
<th data-quarto-table-cell-role="th">seurat</th>
<th data-quarto-table-cell-role="th">COTAN</th>
<th data-quarto-table-cell-role="th">antibody</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>2.412446</td>
<td>1.784603</td>
<td>1.670777</td>
<td>1.621226</td>
<td>2.070131</td>
<td>9.337289</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - matching antibody labels'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">homogeneity</th>
<th data-quarto-table-cell-role="th">completeness</th>
<th data-quarto-table-cell-role="th">fowlkes_mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">monocle</td>
<td>0.606252</td>
<td>0.394823</td>
<td>0.583563</td>
<td>0.630776</td>
<td>0.467547</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">scanpy</td>
<td>0.684939</td>
<td>0.495584</td>
<td>0.645785</td>
<td>0.729147</td>
<td>0.560952</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">scvi-tools</td>
<td>0.673692</td>
<td>0.484543</td>
<td>0.629449</td>
<td>0.724624</td>
<td>0.551156</td>
</tr>
<tr class="even">
<td data-quarto-table-cell-role="th">seurat</td>
<td>0.687849</td>
<td>0.514398</td>
<td>0.665613</td>
<td>0.711622</td>
<td>0.574629</td>
</tr>
<tr class="odd">
<td data-quarto-table-cell-role="th">COTAN</td>
<td>0.617723</td>
<td>0.385947</td>
<td>0.630907</td>
<td>0.605079</td>
<td>0.456617</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">

<div>                            <div id="eb76c64b-2261-4046-bacc-03c53d1b7003" class="plotly-graph-div" style="height:450px; width:700px;"></div>            <script type="text/javascript">                require(["plotly"], function(Plotly) {                    window.PLOTLYENV=window.PLOTLYENV || {};                                    if (document.getElementById("eb76c64b-2261-4046-bacc-03c53d1b7003")) {                    Plotly.newPlot(                        "eb76c64b-2261-4046-bacc-03c53d1b7003",                        [{"link":{"source":[0,0,0,0,0,0,0,0,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,4,5,5,5,5,5,6,6,7,7,7,7,7,8,8,8,8,8,9,9,9,9,10,10,10,10,11,11,12,13,13,13,13,13,14,14,14,15,15,15,15,15,15,15,16,16,16,16,16,16,17,17,17,18,18,18,18,18,18,19,19,19,19,20,20,20,21,21,21,22,22,22,22,22,23,23,23,23,24,24,24,24,24,24,24,25,25,25,25,25,26,26,26,26,26,27,27,27,27,27,28,28,28,28,29,29,29,29,29,29,29,30,30,30,30,30,30,30,30,30,31,31,31,31,31,31,32,32,32,32,33,33,33,33,33,33,33,34,35,35,35,35,35,35,35,35,36,36,36,36,36,37,37,38,38,38,38,38,38,39,39,39,39,40,40,40,40,40,41,41,42,42,42,42,42,42,43,43,43,44,45,45,46,46,46,46,46,46,47,47,47,47,47,48,48,48,48,49,49,50,50,50,51,51,51,52,53,53,53,54,54,54,54,55,55,55,55,55,55,56,56,56,56,56,56,56,57,57,57,57,58,58,58,58,59,59,59,59,59,59,59,60,60,60,60,60,60,60,60,60,60,60,61,61,61,61,61,61,61,61,61,62,63,64,64,65,66,66,66,67],"target":[14,15,16,17,18,19,20,22,15,16,23,14,15,16,19,13,17,22,23,13,17,21,22,23,13,17,21,22,23,18,19,15,18,19,20,22,14,15,19,20,22,13,21,22,23,13,15,16,22,16,20,23,24,25,30,32,33,26,28,29,24,26,27,28,29,30,31,24,26,27,30,33,34,24,25,34,26,28,29,30,31,33,26,28,29,31,26,29,31,24,25,32,24,25,29,30,31,24,25,27,33,35,36,38,39,42,44,46,35,36,38,44,46,36,37,39,41,43,36,37,39,42,46,36,37,43,45,36,37,40,41,43,45,46,35,36,37,38,39,40,41,42,46,36,38,39,41,43,46,35,38,44,46,35,38,39,42,43,44,47,42,49,50,51,52,53,54,55,66,58,59,60,61,64,60,61,50,51,52,53,54,55,62,63,64,65,48,56,57,60,64,59,66,48,57,62,63,64,65,59,60,61,54,58,61,48,49,51,52,54,55,49,50,51,53,67,68,75,76,78,68,76,68,76,78,68,76,78,76,68,76,78,68,70,76,78,72,73,75,76,77,78,68,69,70,74,75,77,78,68,70,77,78,72,74,75,79,69,71,72,74,75,76,77,68,69,71,72,73,74,75,76,77,78,79,68,69,71,72,73,74,75,76,79,68,68,68,77,68,73,75,76,76],"value":[118,733,4,1,4,142,5,1,1,897,8,638,186,1,120,631,60,85,43,104,552,5,30,24,597,25,5,3,3,435,11,15,6,19,288,2,268,29,87,1,1,5,198,3,1,13,2,5,3,25,1,7,397,941,2,6,4,211,795,18,3,820,1,103,9,9,21,1,2,916,5,1,7,586,51,1,1,1,89,351,1,2,7,6,356,10,5,3,287,3,13,192,48,41,7,11,21,32,8,6,40,383,3,610,1,1,1,71,908,1,87,12,46,958,80,2,4,2,1,1,624,292,5,136,764,1,4,37,18,1,2,226,191,7,7,4,1,1,1,352,2,1,9,15,1,1,298,6,19,9,1,187,1,5,2,2,1,2,1,34,8,126,149,17,414,567,2,33,4,62,10,961,121,1,7,857,1,673,11,14,1,2,1,11,80,539,1,261,89,1,1,305,1,1,1,143,122,33,3,233,1,3,201,1,194,147,1,2,5,1,2,4,24,1,4,1,34,1,105,9,1,130,1,172,1,4,687,2,430,2,581,2,1,9,26,169,1,1,3,25,4,3,2,1,11,3,1,242,1,3,1,83,3,6,2,40,15,1,16,436,80,13,1,1,1,4,9,26,10,3,857,3,9,1,47,1,187,17,12,333,191,431,2,1,144,133,114,1,542,1,1,3,1]},"node":{"color":["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf","#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],"label":[1,2,3,4,5,6,7,8,9,10,11,12,13,1,2,3,4,5,6,7,8,9,10,11,1,2,3,4,5,6,7,8,9,10,11,1,2,3,4,5,6,7,8,9,10,11,12,13,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,"B Cells","CD4 TEMRA","CD4+ T Cells","CD4+\u002fCD8+ Cells","CD8+ Cells","CD8+ Naive","CD8+ Terminal Effector T Cells","Central Memory T Cells","Classical Monocytes","NK Cells","Non Classical Monocytes","T Regulatory Cells"],"line":{"color":"black","width":0.5},"pad":15,"thickness":20},"type":"sankey"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmapgl":[{"type":"heatmapgl","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"white","linecolor":"white","minorgridcolor":"white","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"#E5ECF6","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"#E5ECF6","polar":{"bgcolor":"#E5ECF6","angularaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"radialaxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"ternary":{"bgcolor":"#E5ECF6","aaxis":{"gridcolor":"white","linecolor":"white","ticks":""},"baxis":{"gridcolor":"white","linecolor":"white","ticks":""},"caxis":{"gridcolor":"white","linecolor":"white","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"white","linecolor":"white","ticks":"","title":{"standoff":15},"zerolinecolor":"white","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"yaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2},"zaxis":{"backgroundcolor":"#E5ECF6","gridcolor":"white","linecolor":"white","showbackground":true,"ticks":"","zerolinecolor":"white","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"#E5ECF6","subunitcolor":"white","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"annotations":[{"showarrow":false,"text":"monocle","x":0,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scanpy","x":1,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"scvi-tools","x":2,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"seurat","x":3,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"COTAN","x":4,"xref":"x","y":1.05,"yref":"paper"},{"showarrow":false,"text":"antibody","x":5,"xref":"x","y":1.05,"yref":"paper"}],"title":{"text":"PBMC4 - matching antibody labels"},"xaxis":{"showgrid":false,"zeroline":false,"visible":false},"yaxis":{"showgrid":false,"zeroline":false,"visible":false},"font":{"size":10},"plot_bgcolor":"rgba(0,0,0,0)","width":700,"height":450},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('eb76c64b-2261-4046-bacc-03c53d1b7003');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };                });            </script>        </div>
</div>
</div>
</section>
<section id="check-celltypist-vs-antibody" class="level2">
<h2 class="anchored" data-anchor-id="check-celltypist-vs-antibody">Check cellTypist vs Antibody</h2>
<div class="cell" data-execution_count="181">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> compute_clustering_scores(celltypist_df, antibody_df, output_dir, dataset):</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Merge the dataframes on the common 'cell' column</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>    <span class="co">#cotan_df = pd.read_csv(f'{DIR}{dataset}/COTAN/antibody/clustering_labels.csv', index_col=0)</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#display("Cotan clusters objetc dimension ",cotan_df.shape)</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">#display("----------------------------------------")</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>    celltypist_df <span class="op">=</span> pd.read_csv(<span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/celltypist/celltypist_labels.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>    celltypist_df.index <span class="op">=</span> celltypist_df.index.<span class="bu">str</span>[:<span class="op">-</span><span class="dv">2</span>]</span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>    antibody_df <span class="op">=</span> pd.read_csv(<span class="ss">f'</span><span class="sc">{</span>DIR<span class="sc">}{</span>dataset<span class="sc">}</span><span class="ss">/antibody_annotation/antibody_labels.csv'</span>, index_col<span class="op">=</span><span class="dv">0</span>)</span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>    <span class="co">#antibody_df = labels_df.merge(antibody_df, how='inner', on='cell')</span></span>
<span id="cb64-11"><a href="#cb64-11" aria-hidden="true" tabindex="-1"></a>    <span class="co">#all_in_antibody = celltypist_df.index.isin(antibody_df.index).all()</span></span>
<span id="cb64-12"><a href="#cb64-12" aria-hidden="true" tabindex="-1"></a>    <span class="co">#all_in_celltypist = antibody_df.index.isin(celltypist_df.index).all()</span></span>
<span id="cb64-13"><a href="#cb64-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-14"><a href="#cb64-14" aria-hidden="true" tabindex="-1"></a>    <span class="co">#display("All celltypist indices in antibody: ",all_in_antibody, celltypist_df.index.isin(antibody_df.index).sum(),celltypist_df.shape)</span></span>
<span id="cb64-15"><a href="#cb64-15" aria-hidden="true" tabindex="-1"></a>    <span class="co">#display("All antibody indices in cellTypist:", all_in_celltypist)</span></span>
<span id="cb64-16"><a href="#cb64-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-17"><a href="#cb64-17" aria-hidden="true" tabindex="-1"></a>    <span class="co">#display("----------------------------------------")</span></span>
<span id="cb64-18"><a href="#cb64-18" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-19"><a href="#cb64-19" aria-hidden="true" tabindex="-1"></a>    merged_df <span class="op">=</span> celltypist_df.merge(antibody_df, how<span class="op">=</span><span class="st">'inner'</span>,left_index<span class="op">=</span><span class="va">True</span>, right_index<span class="op">=</span><span class="va">True</span>)<span class="co"># on='cell')</span></span>
<span id="cb64-20"><a href="#cb64-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-21"><a href="#cb64-21" aria-hidden="true" tabindex="-1"></a>    merged_df.columns <span class="op">=</span> [<span class="st">'cluster_celltypist'</span>,<span class="st">'cluster_antibody'</span>]</span>
<span id="cb64-22"><a href="#cb64-22" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-23"><a href="#cb64-23" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Initialize scores dictionary</span></span>
<span id="cb64-24"><a href="#cb64-24" aria-hidden="true" tabindex="-1"></a>    scores <span class="op">=</span> {</span>
<span id="cb64-25"><a href="#cb64-25" aria-hidden="true" tabindex="-1"></a>        <span class="st">'NMI'</span>: normalized_mutual_info_score(merged_df[<span class="st">'cluster_celltypist'</span>], merged_df[<span class="st">'cluster_antibody'</span>], average_method<span class="op">=</span><span class="st">'arithmetic'</span>),</span>
<span id="cb64-26"><a href="#cb64-26" aria-hidden="true" tabindex="-1"></a>        <span class="st">'ARI'</span>: adjusted_rand_score(merged_df[<span class="st">'cluster_celltypist'</span>], merged_df[<span class="st">'cluster_antibody'</span>]),</span>
<span id="cb64-27"><a href="#cb64-27" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Homogeneity'</span>: homogeneity_score(merged_df[<span class="st">'cluster_celltypist'</span>], merged_df[<span class="st">'cluster_antibody'</span>]),</span>
<span id="cb64-28"><a href="#cb64-28" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Completeness'</span>: completeness_score(merged_df[<span class="st">'cluster_celltypist'</span>], merged_df[<span class="st">'cluster_antibody'</span>]),</span>
<span id="cb64-29"><a href="#cb64-29" aria-hidden="true" tabindex="-1"></a>        <span class="st">'Fowlkes_Mallows'</span>: fowlkes_mallows_score(merged_df[<span class="st">'cluster_celltypist'</span>], merged_df[<span class="st">'cluster_antibody'</span>])</span>
<span id="cb64-30"><a href="#cb64-30" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb64-31"><a href="#cb64-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-32"><a href="#cb64-32" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Convert scores to DataFrame</span></span>
<span id="cb64-33"><a href="#cb64-33" aria-hidden="true" tabindex="-1"></a>    scores_df <span class="op">=</span> pd.DataFrame([scores])</span>
<span id="cb64-34"><a href="#cb64-34" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-35"><a href="#cb64-35" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Save scores to CSV and LaTeX</span></span>
<span id="cb64-36"><a href="#cb64-36" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scores_df.to_csv(f'{output_dir}{dataset}/clustering_comparison_scores.csv')</span></span>
<span id="cb64-37"><a href="#cb64-37" aria-hidden="true" tabindex="-1"></a>    <span class="co">#scores_df.to_latex(f'{output_dir}{dataset}/clustering_comparison_scores.tex')</span></span>
<span id="cb64-38"><a href="#cb64-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb64-39"><a href="#cb64-39" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Display scores DataFrame</span></span>
<span id="cb64-40"><a href="#cb64-40" aria-hidden="true" tabindex="-1"></a>    display(scores_df)</span>
<span id="cb64-41"><a href="#cb64-41" aria-hidden="true" tabindex="-1"></a></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-execution_count="182">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> dataset <span class="kw">in</span> DATASET_NAMES:</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>    <span class="co">#display('------------------------------')</span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>    display(<span class="ss">f'</span><span class="sc">{</span>dataset<span class="sc">}</span><span class="ss"> - Clustering Comparison between CellTypist and Antibody'</span>)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>    <span class="co"># Assuming celltypist_df and antibody_df are defined elsewhere and available here</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>    compute_clustering_scores(celltypist_df, antibody_df, DIR, dataset)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC1 - Clustering Comparison between CellTypist and Antibody'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">Homogeneity</th>
<th data-quarto-table-cell-role="th">Completeness</th>
<th data-quarto-table-cell-role="th">Fowlkes_Mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.742338</td>
<td>0.713159</td>
<td>0.709696</td>
<td>0.778128</td>
<td>0.764437</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC2 - Clustering Comparison between CellTypist and Antibody'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">Homogeneity</th>
<th data-quarto-table-cell-role="th">Completeness</th>
<th data-quarto-table-cell-role="th">Fowlkes_Mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.660455</td>
<td>0.48564</td>
<td>0.673828</td>
<td>0.647602</td>
<td>0.582832</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC3 - Clustering Comparison between CellTypist and Antibody'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">Homogeneity</th>
<th data-quarto-table-cell-role="th">Completeness</th>
<th data-quarto-table-cell-role="th">Fowlkes_Mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.665993</td>
<td>0.513896</td>
<td>0.698774</td>
<td>0.636149</td>
<td>0.57817</td>
</tr>
</tbody>
</table>

</div>
</div>
<div class="cell-output cell-output-display">
<pre><code>'PBMC4 - Clustering Comparison between CellTypist and Antibody'</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>


<table class="dataframe table table-sm table-striped small" data-quarto-postprocess="true" data-border="1">
<thead>
<tr class="header">
<th data-quarto-table-cell-role="th"></th>
<th data-quarto-table-cell-role="th">NMI</th>
<th data-quarto-table-cell-role="th">ARI</th>
<th data-quarto-table-cell-role="th">Homogeneity</th>
<th data-quarto-table-cell-role="th">Completeness</th>
<th data-quarto-table-cell-role="th">Fowlkes_Mallows</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td data-quarto-table-cell-role="th">0</td>
<td>0.690424</td>
<td>0.505103</td>
<td>0.758068</td>
<td>0.633863</td>
<td>0.582394</td>
</tr>
</tbody>
</table>

</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>